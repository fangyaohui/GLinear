Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='ETTh1_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_12_DNGLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8293
val 2869
test 2869
	iters: 100, epoch: 1 | loss: 0.3708490
	speed: 0.0134s/iter; left time: 137.7418s
	iters: 200, epoch: 1 | loss: 0.2424628
	speed: 0.0069s/iter; left time: 70.3249s
	iters: 300, epoch: 1 | loss: 0.1698297
	speed: 0.0068s/iter; left time: 68.6985s
	iters: 400, epoch: 1 | loss: 0.2130084
	speed: 0.0069s/iter; left time: 68.3274s
	iters: 500, epoch: 1 | loss: 0.1718348
	speed: 0.0068s/iter; left time: 67.3940s
	iters: 600, epoch: 1 | loss: 0.1581569
	speed: 0.0069s/iter; left time: 66.9715s
	iters: 700, epoch: 1 | loss: 0.3365118
	speed: 0.0069s/iter; left time: 66.4759s
	iters: 800, epoch: 1 | loss: 0.1874694
	speed: 0.0068s/iter; left time: 64.9314s
	iters: 900, epoch: 1 | loss: 0.2972755
	speed: 0.0068s/iter; left time: 64.6767s
	iters: 1000, epoch: 1 | loss: 0.2480342
	speed: 0.0068s/iter; left time: 64.0485s
Epoch: 1 cost time: 7.827868700027466
Epoch: 1, Steps: 1036 | Train Loss: 0.2435259 Vali Loss: 0.3492164 Test Loss: 0.3104368
Validation loss decreased (inf --> 0.349216).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3085068
	speed: 0.0572s/iter; left time: 527.4049s
	iters: 200, epoch: 2 | loss: 0.2374399
	speed: 0.0070s/iter; left time: 64.1109s
	iters: 300, epoch: 2 | loss: 0.1510683
	speed: 0.0071s/iter; left time: 64.1908s
	iters: 400, epoch: 2 | loss: 0.2358530
	speed: 0.0070s/iter; left time: 62.3183s
	iters: 500, epoch: 2 | loss: 0.2403743
	speed: 0.0070s/iter; left time: 61.8064s
	iters: 600, epoch: 2 | loss: 0.2385937
	speed: 0.0070s/iter; left time: 61.3720s
	iters: 700, epoch: 2 | loss: 0.1821397
	speed: 0.0071s/iter; left time: 60.9660s
	iters: 800, epoch: 2 | loss: 0.2826497
	speed: 0.0072s/iter; left time: 60.9738s
	iters: 900, epoch: 2 | loss: 0.2606041
	speed: 0.0070s/iter; left time: 58.7824s
	iters: 1000, epoch: 2 | loss: 0.2341447
	speed: 0.0070s/iter; left time: 58.3877s
Epoch: 2 cost time: 7.9994282722473145
Epoch: 2, Steps: 1036 | Train Loss: 0.2243208 Vali Loss: 0.3306735 Test Loss: 0.3033861
Validation loss decreased (0.349216 --> 0.330674).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2356391
	speed: 0.0572s/iter; left time: 468.6067s
	iters: 200, epoch: 3 | loss: 0.1609758
	speed: 0.0069s/iter; left time: 55.9713s
	iters: 300, epoch: 3 | loss: 0.2502393
	speed: 0.0069s/iter; left time: 54.9280s
	iters: 400, epoch: 3 | loss: 0.2698179
	speed: 0.0071s/iter; left time: 56.3517s
	iters: 500, epoch: 3 | loss: 0.1345322
	speed: 0.0070s/iter; left time: 54.5062s
	iters: 600, epoch: 3 | loss: 0.1984285
	speed: 0.0069s/iter; left time: 53.3684s
	iters: 700, epoch: 3 | loss: 0.1703855
	speed: 0.0070s/iter; left time: 53.0815s
	iters: 800, epoch: 3 | loss: 0.2627178
	speed: 0.0071s/iter; left time: 53.2824s
	iters: 900, epoch: 3 | loss: 0.2187602
	speed: 0.0070s/iter; left time: 52.0332s
	iters: 1000, epoch: 3 | loss: 0.2949958
	speed: 0.0071s/iter; left time: 51.6342s
Epoch: 3 cost time: 7.964393615722656
Epoch: 3, Steps: 1036 | Train Loss: 0.2066545 Vali Loss: 0.3343172 Test Loss: 0.3055405
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2262232
	speed: 0.0571s/iter; left time: 408.6556s
	iters: 200, epoch: 4 | loss: 0.1460326
	speed: 0.0070s/iter; left time: 49.3684s
	iters: 300, epoch: 4 | loss: 0.1340507
	speed: 0.0067s/iter; left time: 46.6737s
	iters: 400, epoch: 4 | loss: 0.2410710
	speed: 0.0062s/iter; left time: 42.4649s
	iters: 500, epoch: 4 | loss: 0.1811257
	speed: 0.0070s/iter; left time: 47.3727s
	iters: 600, epoch: 4 | loss: 0.2226107
	speed: 0.0071s/iter; left time: 46.9842s
	iters: 700, epoch: 4 | loss: 0.1842051
	speed: 0.0072s/iter; left time: 47.2664s
	iters: 800, epoch: 4 | loss: 0.2668724
	speed: 0.0074s/iter; left time: 47.7221s
	iters: 900, epoch: 4 | loss: 0.1190055
	speed: 0.0072s/iter; left time: 45.8072s
	iters: 1000, epoch: 4 | loss: 0.1533001
	speed: 0.0072s/iter; left time: 44.8597s
Epoch: 4 cost time: 7.964199781417847
Epoch: 4, Steps: 1036 | Train Loss: 0.1943104 Vali Loss: 0.3497251 Test Loss: 0.2976992
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2324017
	speed: 0.0576s/iter; left time: 352.5351s
	iters: 200, epoch: 5 | loss: 0.2673960
	speed: 0.0069s/iter; left time: 41.7663s
	iters: 300, epoch: 5 | loss: 0.1510417
	speed: 0.0069s/iter; left time: 40.9234s
	iters: 400, epoch: 5 | loss: 0.0910891
	speed: 0.0069s/iter; left time: 40.3451s
	iters: 500, epoch: 5 | loss: 0.1316779
	speed: 0.0070s/iter; left time: 40.0382s
	iters: 600, epoch: 5 | loss: 0.1702373
	speed: 0.0069s/iter; left time: 38.4850s
	iters: 700, epoch: 5 | loss: 0.1709717
	speed: 0.0069s/iter; left time: 38.1327s
	iters: 800, epoch: 5 | loss: 0.3720495
	speed: 0.0069s/iter; left time: 37.4163s
	iters: 900, epoch: 5 | loss: 0.2723941
	speed: 0.0071s/iter; left time: 37.5403s
	iters: 1000, epoch: 5 | loss: 0.1659243
	speed: 0.0070s/iter; left time: 36.7272s
Epoch: 5 cost time: 7.918733596801758
Epoch: 5, Steps: 1036 | Train Loss: 0.1863465 Vali Loss: 0.3452133 Test Loss: 0.2914952
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_12_DNGLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2869
mse:0.3034803569316864, mae:0.3598785698413849
