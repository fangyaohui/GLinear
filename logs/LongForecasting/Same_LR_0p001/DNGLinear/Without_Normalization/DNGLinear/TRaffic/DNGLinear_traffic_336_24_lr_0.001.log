Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='traffic_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_24_DNGLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11921
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.2317690
	speed: 0.0297s/iter; left time: 217.9575s
	iters: 200, epoch: 1 | loss: 0.2444713
	speed: 0.0221s/iter; left time: 159.9055s
	iters: 300, epoch: 1 | loss: 0.2116060
	speed: 0.0223s/iter; left time: 159.3644s
	iters: 400, epoch: 1 | loss: 0.2008785
	speed: 0.0223s/iter; left time: 157.4165s
	iters: 500, epoch: 1 | loss: 0.2226786
	speed: 0.0233s/iter; left time: 162.0799s
	iters: 600, epoch: 1 | loss: 0.1711130
	speed: 0.0238s/iter; left time: 162.8613s
	iters: 700, epoch: 1 | loss: 0.2148113
	speed: 0.0225s/iter; left time: 151.8965s
Epoch: 1 cost time: 17.69871687889099
Epoch: 1, Steps: 745 | Train Loss: 0.2470332 Vali Loss: 0.3201500 Test Loss: 0.3612363
Validation loss decreased (inf --> 0.320150).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2759812
	speed: 0.1234s/iter; left time: 814.9438s
	iters: 200, epoch: 2 | loss: 0.1935753
	speed: 0.0223s/iter; left time: 144.9643s
	iters: 300, epoch: 2 | loss: 0.2099989
	speed: 0.0230s/iter; left time: 147.6505s
	iters: 400, epoch: 2 | loss: 0.2219368
	speed: 0.0227s/iter; left time: 143.4549s
	iters: 500, epoch: 2 | loss: 0.2083071
	speed: 0.0231s/iter; left time: 143.1040s
	iters: 600, epoch: 2 | loss: 0.2027773
	speed: 0.0227s/iter; left time: 138.7456s
	iters: 700, epoch: 2 | loss: 0.2193637
	speed: 0.0225s/iter; left time: 134.9709s
Epoch: 2 cost time: 17.71672511100769
Epoch: 2, Steps: 745 | Train Loss: 0.2181903 Vali Loss: 0.3195911 Test Loss: 0.3550124
Validation loss decreased (0.320150 --> 0.319591).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1886043
	speed: 0.1263s/iter; left time: 740.2718s
	iters: 200, epoch: 3 | loss: 0.1941536
	speed: 0.0235s/iter; left time: 135.4666s
	iters: 300, epoch: 3 | loss: 0.2330508
	speed: 0.0231s/iter; left time: 130.9428s
	iters: 400, epoch: 3 | loss: 0.1742828
	speed: 0.0231s/iter; left time: 128.1877s
	iters: 500, epoch: 3 | loss: 0.2284946
	speed: 0.0228s/iter; left time: 124.6489s
	iters: 600, epoch: 3 | loss: 0.1955155
	speed: 0.0228s/iter; left time: 121.9696s
	iters: 700, epoch: 3 | loss: 0.2005974
	speed: 0.0232s/iter; left time: 122.1478s
Epoch: 3 cost time: 18.079190015792847
Epoch: 3, Steps: 745 | Train Loss: 0.2116754 Vali Loss: 0.3125865 Test Loss: 0.3445374
Validation loss decreased (0.319591 --> 0.312587).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2428402
	speed: 0.1228s/iter; left time: 628.4204s
	iters: 200, epoch: 4 | loss: 0.2232525
	speed: 0.0226s/iter; left time: 113.5354s
	iters: 300, epoch: 4 | loss: 0.2467955
	speed: 0.0232s/iter; left time: 114.0800s
	iters: 400, epoch: 4 | loss: 0.2401006
	speed: 0.0231s/iter; left time: 111.0972s
	iters: 500, epoch: 4 | loss: 0.2068893
	speed: 0.0234s/iter; left time: 110.5706s
	iters: 600, epoch: 4 | loss: 0.2320623
	speed: 0.0230s/iter; left time: 106.1401s
	iters: 700, epoch: 4 | loss: 0.2470332
	speed: 0.0238s/iter; left time: 107.6420s
Epoch: 4 cost time: 18.033888816833496
Epoch: 4, Steps: 745 | Train Loss: 0.2086417 Vali Loss: 0.3115627 Test Loss: 0.3425085
Validation loss decreased (0.312587 --> 0.311563).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2291849
	speed: 0.1244s/iter; left time: 543.5929s
	iters: 200, epoch: 5 | loss: 0.2424853
	speed: 0.0230s/iter; left time: 98.2442s
	iters: 300, epoch: 5 | loss: 0.1831340
	speed: 0.0229s/iter; left time: 95.6499s
	iters: 400, epoch: 5 | loss: 0.2131389
	speed: 0.0231s/iter; left time: 94.0314s
	iters: 500, epoch: 5 | loss: 0.2876586
	speed: 0.0229s/iter; left time: 90.9307s
	iters: 600, epoch: 5 | loss: 0.2233866
	speed: 0.0226s/iter; left time: 87.4625s
	iters: 700, epoch: 5 | loss: 0.2148666
	speed: 0.0224s/iter; left time: 84.6321s
Epoch: 5 cost time: 17.80315136909485
Epoch: 5, Steps: 745 | Train Loss: 0.2071276 Vali Loss: 0.3105895 Test Loss: 0.3411494
Validation loss decreased (0.311563 --> 0.310590).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2372193
	speed: 0.1238s/iter; left time: 448.8691s
	iters: 200, epoch: 6 | loss: 0.2002895
	speed: 0.0228s/iter; left time: 80.4170s
	iters: 300, epoch: 6 | loss: 0.2398588
	speed: 0.0232s/iter; left time: 79.5026s
	iters: 400, epoch: 6 | loss: 0.2010278
	speed: 0.0233s/iter; left time: 77.6042s
	iters: 500, epoch: 6 | loss: 0.1661101
	speed: 0.0222s/iter; left time: 71.7684s
	iters: 600, epoch: 6 | loss: 0.1873329
	speed: 0.0235s/iter; left time: 73.4380s
	iters: 700, epoch: 6 | loss: 0.1825724
	speed: 0.0231s/iter; left time: 69.7747s
Epoch: 6 cost time: 17.885244369506836
Epoch: 6, Steps: 745 | Train Loss: 0.2063504 Vali Loss: 0.3098600 Test Loss: 0.3401404
Validation loss decreased (0.310590 --> 0.309860).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2124607
	speed: 0.1278s/iter; left time: 368.0890s
	iters: 200, epoch: 7 | loss: 0.2216259
	speed: 0.0229s/iter; left time: 63.6165s
	iters: 300, epoch: 7 | loss: 0.2120819
	speed: 0.0229s/iter; left time: 61.3587s
	iters: 400, epoch: 7 | loss: 0.2351035
	speed: 0.0232s/iter; left time: 59.9815s
	iters: 500, epoch: 7 | loss: 0.1867782
	speed: 0.0230s/iter; left time: 57.1680s
	iters: 600, epoch: 7 | loss: 0.2101799
	speed: 0.0235s/iter; left time: 55.9202s
	iters: 700, epoch: 7 | loss: 0.2219407
	speed: 0.0229s/iter; left time: 52.2006s
Epoch: 7 cost time: 17.90312123298645
Epoch: 7, Steps: 745 | Train Loss: 0.2059249 Vali Loss: 0.3096033 Test Loss: 0.3397245
Validation loss decreased (0.309860 --> 0.309603).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2038760
	speed: 0.1229s/iter; left time: 262.4177s
	iters: 200, epoch: 8 | loss: 0.1747868
	speed: 0.0228s/iter; left time: 46.3384s
	iters: 300, epoch: 8 | loss: 0.1696902
	speed: 0.0223s/iter; left time: 43.2585s
	iters: 400, epoch: 8 | loss: 0.1785403
	speed: 0.0230s/iter; left time: 42.2674s
	iters: 500, epoch: 8 | loss: 0.1789825
	speed: 0.0231s/iter; left time: 40.0834s
	iters: 600, epoch: 8 | loss: 0.1915258
	speed: 0.0225s/iter; left time: 36.8408s
	iters: 700, epoch: 8 | loss: 0.2076868
	speed: 0.0235s/iter; left time: 36.0679s
Epoch: 8 cost time: 17.85086488723755
Epoch: 8, Steps: 745 | Train Loss: 0.2057191 Vali Loss: 0.3097000 Test Loss: 0.3396248
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1778344
	speed: 0.1240s/iter; left time: 172.4981s
	iters: 200, epoch: 9 | loss: 0.2273380
	speed: 0.0231s/iter; left time: 29.8442s
	iters: 300, epoch: 9 | loss: 0.1760847
	speed: 0.0228s/iter; left time: 27.1492s
	iters: 400, epoch: 9 | loss: 0.1683514
	speed: 0.0230s/iter; left time: 25.0619s
	iters: 500, epoch: 9 | loss: 0.1914925
	speed: 0.0222s/iter; left time: 22.0468s
	iters: 600, epoch: 9 | loss: 0.2105006
	speed: 0.0228s/iter; left time: 20.3445s
	iters: 700, epoch: 9 | loss: 0.2007519
	speed: 0.0224s/iter; left time: 17.7107s
Epoch: 9 cost time: 17.728355884552002
Epoch: 9, Steps: 745 | Train Loss: 0.2055774 Vali Loss: 0.3091207 Test Loss: 0.3393473
Validation loss decreased (0.309603 --> 0.309121).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1641080
	speed: 0.1242s/iter; left time: 80.2019s
	iters: 200, epoch: 10 | loss: 0.2118861
	speed: 0.0227s/iter; left time: 12.3927s
	iters: 300, epoch: 10 | loss: 0.2149168
	speed: 0.0229s/iter; left time: 10.2031s
	iters: 400, epoch: 10 | loss: 0.2463625
	speed: 0.0231s/iter; left time: 8.0032s
	iters: 500, epoch: 10 | loss: 0.2206732
	speed: 0.0237s/iter; left time: 5.8399s
	iters: 600, epoch: 10 | loss: 0.1603754
	speed: 0.0238s/iter; left time: 3.4815s
	iters: 700, epoch: 10 | loss: 0.2771201
	speed: 0.0224s/iter; left time: 1.0285s
Epoch: 10 cost time: 17.90786600112915
Epoch: 10, Steps: 745 | Train Loss: 0.2055373 Vali Loss: 0.3090885 Test Loss: 0.3393292
Validation loss decreased (0.309121 --> 0.309088).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_24_DNGLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.3394700288772583, mae:0.24732337892055511
