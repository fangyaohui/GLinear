Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DNGLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.2883596
	speed: 0.0386s/iter; left time: 279.2851s
	iters: 200, epoch: 1 | loss: 0.2779943
	speed: 0.0305s/iter; left time: 217.5881s
	iters: 300, epoch: 1 | loss: 0.2615851
	speed: 0.0318s/iter; left time: 223.8597s
	iters: 400, epoch: 1 | loss: 0.2577531
	speed: 0.0311s/iter; left time: 215.6582s
	iters: 500, epoch: 1 | loss: 0.2745831
	speed: 0.0311s/iter; left time: 212.7973s
	iters: 600, epoch: 1 | loss: 0.2466897
	speed: 0.0310s/iter; left time: 208.7970s
	iters: 700, epoch: 1 | loss: 0.2655032
	speed: 0.0312s/iter; left time: 206.9141s
Epoch: 1 cost time: 23.640671730041504
Epoch: 1, Steps: 734 | Train Loss: 0.2790910 Vali Loss: 0.3511931 Test Loss: 0.4226369
Validation loss decreased (inf --> 0.351193).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2892066
	speed: 0.1706s/iter; left time: 1110.0954s
	iters: 200, epoch: 2 | loss: 0.2318448
	speed: 0.0324s/iter; left time: 207.2690s
	iters: 300, epoch: 2 | loss: 0.2656864
	speed: 0.0312s/iter; left time: 196.6358s
	iters: 400, epoch: 2 | loss: 0.2462668
	speed: 0.0304s/iter; left time: 188.9565s
	iters: 500, epoch: 2 | loss: 0.2290630
	speed: 0.0311s/iter; left time: 189.6827s
	iters: 600, epoch: 2 | loss: 0.2389741
	speed: 0.0320s/iter; left time: 191.9280s
	iters: 700, epoch: 2 | loss: 0.2429797
	speed: 0.0318s/iter; left time: 187.7453s
Epoch: 2 cost time: 23.95152711868286
Epoch: 2, Steps: 734 | Train Loss: 0.2469468 Vali Loss: 0.3465377 Test Loss: 0.4137022
Validation loss decreased (0.351193 --> 0.346538).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2647095
	speed: 0.1741s/iter; left time: 1005.2225s
	iters: 200, epoch: 3 | loss: 0.2464150
	speed: 0.0317s/iter; left time: 180.1131s
	iters: 300, epoch: 3 | loss: 0.2684553
	speed: 0.0321s/iter; left time: 179.0744s
	iters: 400, epoch: 3 | loss: 0.2487388
	speed: 0.0334s/iter; left time: 182.8419s
	iters: 500, epoch: 3 | loss: 0.2198522
	speed: 0.0324s/iter; left time: 174.3311s
	iters: 600, epoch: 3 | loss: 0.2530967
	speed: 0.0329s/iter; left time: 173.5718s
	iters: 700, epoch: 3 | loss: 0.2661142
	speed: 0.0329s/iter; left time: 170.0745s
Epoch: 3 cost time: 24.894208192825317
Epoch: 3, Steps: 734 | Train Loss: 0.2412331 Vali Loss: 0.3449425 Test Loss: 0.4101203
Validation loss decreased (0.346538 --> 0.344943).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2233425
	speed: 0.1780s/iter; left time: 896.7802s
	iters: 200, epoch: 4 | loss: 0.2481213
	speed: 0.0308s/iter; left time: 152.0782s
	iters: 300, epoch: 4 | loss: 0.2691213
	speed: 0.0302s/iter; left time: 145.9881s
	iters: 400, epoch: 4 | loss: 0.2163191
	speed: 0.0306s/iter; left time: 145.0667s
	iters: 500, epoch: 4 | loss: 0.2615373
	speed: 0.0319s/iter; left time: 147.7718s
	iters: 600, epoch: 4 | loss: 0.2365927
	speed: 0.0309s/iter; left time: 140.4262s
	iters: 700, epoch: 4 | loss: 0.2713691
	speed: 0.0318s/iter; left time: 141.1609s
Epoch: 4 cost time: 23.63748788833618
Epoch: 4, Steps: 734 | Train Loss: 0.2388414 Vali Loss: 0.3424985 Test Loss: 0.4074423
Validation loss decreased (0.344943 --> 0.342498).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2225244
	speed: 0.1733s/iter; left time: 745.9076s
	iters: 200, epoch: 5 | loss: 0.2684326
	speed: 0.0322s/iter; left time: 135.3244s
	iters: 300, epoch: 5 | loss: 0.2289674
	speed: 0.0327s/iter; left time: 134.1677s
	iters: 400, epoch: 5 | loss: 0.2492429
	speed: 0.0323s/iter; left time: 129.3532s
	iters: 500, epoch: 5 | loss: 0.2112951
	speed: 0.0316s/iter; left time: 123.2732s
	iters: 600, epoch: 5 | loss: 0.2460410
	speed: 0.0325s/iter; left time: 123.4728s
	iters: 700, epoch: 5 | loss: 0.2499955
	speed: 0.0328s/iter; left time: 121.7044s
Epoch: 5 cost time: 24.50452709197998
Epoch: 5, Steps: 734 | Train Loss: 0.2376213 Vali Loss: 0.3407691 Test Loss: 0.4055882
Validation loss decreased (0.342498 --> 0.340769).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2173087
	speed: 0.1706s/iter; left time: 609.2587s
	iters: 200, epoch: 6 | loss: 0.2330476
	speed: 0.0301s/iter; left time: 104.3366s
	iters: 300, epoch: 6 | loss: 0.2537304
	speed: 0.0320s/iter; left time: 107.9314s
	iters: 400, epoch: 6 | loss: 0.2330094
	speed: 0.0309s/iter; left time: 101.1799s
	iters: 500, epoch: 6 | loss: 0.2345231
	speed: 0.0309s/iter; left time: 97.8646s
	iters: 600, epoch: 6 | loss: 0.2036661
	speed: 0.0307s/iter; left time: 94.1582s
	iters: 700, epoch: 6 | loss: 0.2602039
	speed: 0.0312s/iter; left time: 92.7129s
Epoch: 6 cost time: 23.556207418441772
Epoch: 6, Steps: 734 | Train Loss: 0.2370113 Vali Loss: 0.3401481 Test Loss: 0.4049554
Validation loss decreased (0.340769 --> 0.340148).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2146018
	speed: 0.1745s/iter; left time: 494.9378s
	iters: 200, epoch: 7 | loss: 0.2340163
	speed: 0.0316s/iter; left time: 86.6214s
	iters: 300, epoch: 7 | loss: 0.2258763
	speed: 0.0318s/iter; left time: 83.8815s
	iters: 400, epoch: 7 | loss: 0.2564003
	speed: 0.0330s/iter; left time: 83.6734s
	iters: 500, epoch: 7 | loss: 0.2671133
	speed: 0.0332s/iter; left time: 80.9866s
	iters: 600, epoch: 7 | loss: 0.2387423
	speed: 0.0334s/iter; left time: 78.1696s
	iters: 700, epoch: 7 | loss: 0.2514167
	speed: 0.0323s/iter; left time: 72.2155s
Epoch: 7 cost time: 24.723965883255005
Epoch: 7, Steps: 734 | Train Loss: 0.2366800 Vali Loss: 0.3403806 Test Loss: 0.4047538
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2174690
	speed: 0.1764s/iter; left time: 370.9233s
	iters: 200, epoch: 8 | loss: 0.2541593
	speed: 0.0319s/iter; left time: 63.9870s
	iters: 300, epoch: 8 | loss: 0.2404754
	speed: 0.0320s/iter; left time: 60.9006s
	iters: 400, epoch: 8 | loss: 0.2178594
	speed: 0.0313s/iter; left time: 56.3863s
	iters: 500, epoch: 8 | loss: 0.2338187
	speed: 0.0312s/iter; left time: 53.1914s
	iters: 600, epoch: 8 | loss: 0.2328999
	speed: 0.0312s/iter; left time: 49.9473s
	iters: 700, epoch: 8 | loss: 0.2577195
	speed: 0.0320s/iter; left time: 48.0978s
Epoch: 8 cost time: 23.93071722984314
Epoch: 8, Steps: 734 | Train Loss: 0.2364613 Vali Loss: 0.3403858 Test Loss: 0.4047161
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2408122
	speed: 0.1727s/iter; left time: 236.4204s
	iters: 200, epoch: 9 | loss: 0.2173591
	speed: 0.0301s/iter; left time: 38.1450s
	iters: 300, epoch: 9 | loss: 0.2375310
	speed: 0.0304s/iter; left time: 35.5275s
	iters: 400, epoch: 9 | loss: 0.2321571
	speed: 0.0312s/iter; left time: 33.3660s
	iters: 500, epoch: 9 | loss: 0.2417138
	speed: 0.0308s/iter; left time: 29.8460s
	iters: 600, epoch: 9 | loss: 0.2248501
	speed: 0.0294s/iter; left time: 25.5394s
	iters: 700, epoch: 9 | loss: 0.2460560
	speed: 0.0304s/iter; left time: 23.3932s
Epoch: 9 cost time: 23.355106830596924
Epoch: 9, Steps: 734 | Train Loss: 0.2363799 Vali Loss: 0.3407409 Test Loss: 0.4046120
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_192_DNGLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4046834111213684, mae:0.27953091263771057
