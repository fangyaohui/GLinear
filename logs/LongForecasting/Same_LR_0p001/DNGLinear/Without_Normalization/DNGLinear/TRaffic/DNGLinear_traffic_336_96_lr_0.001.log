Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DNGLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.2687754
	speed: 0.0332s/iter; left time: 242.4685s
	iters: 200, epoch: 1 | loss: 0.2890994
	speed: 0.0252s/iter; left time: 181.7729s
	iters: 300, epoch: 1 | loss: 0.2261594
	speed: 0.0253s/iter; left time: 179.3591s
	iters: 400, epoch: 1 | loss: 0.2205582
	speed: 0.0261s/iter; left time: 182.4940s
	iters: 500, epoch: 1 | loss: 0.2639071
	speed: 0.0263s/iter; left time: 181.4986s
	iters: 600, epoch: 1 | loss: 0.2495962
	speed: 0.0259s/iter; left time: 175.8282s
	iters: 700, epoch: 1 | loss: 0.2378435
	speed: 0.0264s/iter; left time: 176.8074s
Epoch: 1 cost time: 19.93890690803528
Epoch: 1, Steps: 740 | Train Loss: 0.2701406 Vali Loss: 0.3430719 Test Loss: 0.4058047
Validation loss decreased (inf --> 0.343072).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2555608
	speed: 0.1473s/iter; left time: 966.3230s
	iters: 200, epoch: 2 | loss: 0.2950669
	speed: 0.0252s/iter; left time: 162.5225s
	iters: 300, epoch: 2 | loss: 0.2477338
	speed: 0.0264s/iter; left time: 168.0621s
	iters: 400, epoch: 2 | loss: 0.2263993
	speed: 0.0264s/iter; left time: 165.0939s
	iters: 500, epoch: 2 | loss: 0.2479609
	speed: 0.0264s/iter; left time: 162.6770s
	iters: 600, epoch: 2 | loss: 0.2405740
	speed: 0.0270s/iter; left time: 163.6129s
	iters: 700, epoch: 2 | loss: 0.3021849
	speed: 0.0267s/iter; left time: 158.8685s
Epoch: 2 cost time: 20.370027780532837
Epoch: 2, Steps: 740 | Train Loss: 0.2390127 Vali Loss: 0.3411620 Test Loss: 0.3988686
Validation loss decreased (0.343072 --> 0.341162).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2325228
	speed: 0.1486s/iter; left time: 864.8472s
	iters: 200, epoch: 3 | loss: 0.2218921
	speed: 0.0264s/iter; left time: 150.7631s
	iters: 300, epoch: 3 | loss: 0.2399054
	speed: 0.0257s/iter; left time: 144.5562s
	iters: 400, epoch: 3 | loss: 0.2599311
	speed: 0.0269s/iter; left time: 148.4033s
	iters: 500, epoch: 3 | loss: 0.2670395
	speed: 0.0269s/iter; left time: 145.7464s
	iters: 600, epoch: 3 | loss: 0.2104530
	speed: 0.0282s/iter; left time: 150.2813s
	iters: 700, epoch: 3 | loss: 0.2309177
	speed: 0.0275s/iter; left time: 143.6130s
Epoch: 3 cost time: 20.58049178123474
Epoch: 3, Steps: 740 | Train Loss: 0.2330980 Vali Loss: 0.3363557 Test Loss: 0.3913429
Validation loss decreased (0.341162 --> 0.336356).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2266960
	speed: 0.1511s/iter; left time: 767.7451s
	iters: 200, epoch: 4 | loss: 0.2210972
	speed: 0.0271s/iter; left time: 135.0345s
	iters: 300, epoch: 4 | loss: 0.2250580
	speed: 0.0268s/iter; left time: 130.7132s
	iters: 400, epoch: 4 | loss: 0.2250140
	speed: 0.0268s/iter; left time: 128.3343s
	iters: 500, epoch: 4 | loss: 0.2546646
	speed: 0.0268s/iter; left time: 125.6568s
	iters: 600, epoch: 4 | loss: 0.2329882
	speed: 0.0275s/iter; left time: 125.8553s
	iters: 700, epoch: 4 | loss: 0.2881480
	speed: 0.0275s/iter; left time: 123.2918s
Epoch: 4 cost time: 20.833870887756348
Epoch: 4, Steps: 740 | Train Loss: 0.2303763 Vali Loss: 0.3345172 Test Loss: 0.3890962
Validation loss decreased (0.336356 --> 0.334517).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2093336
	speed: 0.1516s/iter; left time: 657.9670s
	iters: 200, epoch: 5 | loss: 0.2986345
	speed: 0.0264s/iter; left time: 112.0605s
	iters: 300, epoch: 5 | loss: 0.2243750
	speed: 0.0269s/iter; left time: 111.4027s
	iters: 400, epoch: 5 | loss: 0.2150409
	speed: 0.0256s/iter; left time: 103.4018s
	iters: 500, epoch: 5 | loss: 0.1987367
	speed: 0.0262s/iter; left time: 103.1203s
	iters: 600, epoch: 5 | loss: 0.2081540
	speed: 0.0271s/iter; left time: 103.9766s
	iters: 700, epoch: 5 | loss: 0.2292895
	speed: 0.0264s/iter; left time: 98.5797s
Epoch: 5 cost time: 20.460996866226196
Epoch: 5, Steps: 740 | Train Loss: 0.2290439 Vali Loss: 0.3343673 Test Loss: 0.3884510
Validation loss decreased (0.334517 --> 0.334367).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2138235
	speed: 0.1493s/iter; left time: 537.6270s
	iters: 200, epoch: 6 | loss: 0.2823331
	speed: 0.0268s/iter; left time: 93.8391s
	iters: 300, epoch: 6 | loss: 0.2469178
	speed: 0.0268s/iter; left time: 91.2060s
	iters: 400, epoch: 6 | loss: 0.2121711
	speed: 0.0267s/iter; left time: 88.0061s
	iters: 500, epoch: 6 | loss: 0.2194665
	speed: 0.0274s/iter; left time: 87.5701s
	iters: 600, epoch: 6 | loss: 0.2410113
	speed: 0.0266s/iter; left time: 82.4451s
	iters: 700, epoch: 6 | loss: 0.2125162
	speed: 0.0271s/iter; left time: 81.2820s
Epoch: 6 cost time: 20.672332763671875
Epoch: 6, Steps: 740 | Train Loss: 0.2283456 Vali Loss: 0.3341883 Test Loss: 0.3874842
Validation loss decreased (0.334367 --> 0.334188).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2596893
	speed: 0.1507s/iter; left time: 431.2775s
	iters: 200, epoch: 7 | loss: 0.2270166
	speed: 0.0275s/iter; left time: 75.8154s
	iters: 300, epoch: 7 | loss: 0.2474905
	speed: 0.0268s/iter; left time: 71.3272s
	iters: 400, epoch: 7 | loss: 0.2546130
	speed: 0.0260s/iter; left time: 66.4898s
	iters: 500, epoch: 7 | loss: 0.2096947
	speed: 0.0261s/iter; left time: 64.1617s
	iters: 600, epoch: 7 | loss: 0.2533945
	speed: 0.0266s/iter; left time: 62.7505s
	iters: 700, epoch: 7 | loss: 0.2250520
	speed: 0.0264s/iter; left time: 59.6184s
Epoch: 7 cost time: 20.56565260887146
Epoch: 7, Steps: 740 | Train Loss: 0.2279540 Vali Loss: 0.3338920 Test Loss: 0.3872874
Validation loss decreased (0.334188 --> 0.333892).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2003512
	speed: 0.1507s/iter; left time: 319.6552s
	iters: 200, epoch: 8 | loss: 0.1964843
	speed: 0.0267s/iter; left time: 54.0353s
	iters: 300, epoch: 8 | loss: 0.2544383
	speed: 0.0262s/iter; left time: 50.3234s
	iters: 400, epoch: 8 | loss: 0.2364031
	speed: 0.0270s/iter; left time: 49.2127s
	iters: 500, epoch: 8 | loss: 0.2489462
	speed: 0.0269s/iter; left time: 46.3178s
	iters: 600, epoch: 8 | loss: 0.2333188
	speed: 0.0271s/iter; left time: 43.9859s
	iters: 700, epoch: 8 | loss: 0.2533593
	speed: 0.0273s/iter; left time: 41.4797s
Epoch: 8 cost time: 20.65401029586792
Epoch: 8, Steps: 740 | Train Loss: 0.2277854 Vali Loss: 0.3338232 Test Loss: 0.3869089
Validation loss decreased (0.333892 --> 0.333823).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2736181
	speed: 0.1459s/iter; left time: 201.5040s
	iters: 200, epoch: 9 | loss: 0.2100194
	speed: 0.0252s/iter; left time: 32.2211s
	iters: 300, epoch: 9 | loss: 0.2273366
	speed: 0.0273s/iter; left time: 32.2446s
	iters: 400, epoch: 9 | loss: 0.2095690
	speed: 0.0269s/iter; left time: 29.1041s
	iters: 500, epoch: 9 | loss: 0.2479386
	speed: 0.0265s/iter; left time: 25.9697s
	iters: 600, epoch: 9 | loss: 0.2217349
	speed: 0.0273s/iter; left time: 24.0397s
	iters: 700, epoch: 9 | loss: 0.2070625
	speed: 0.0267s/iter; left time: 20.8674s
Epoch: 9 cost time: 20.4189236164093
Epoch: 9, Steps: 740 | Train Loss: 0.2277073 Vali Loss: 0.3338760 Test Loss: 0.3869314
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2322319
	speed: 0.1435s/iter; left time: 91.9901s
	iters: 200, epoch: 10 | loss: 0.2277401
	speed: 0.0264s/iter; left time: 14.3018s
	iters: 300, epoch: 10 | loss: 0.2182614
	speed: 0.0272s/iter; left time: 11.9987s
	iters: 400, epoch: 10 | loss: 0.2523394
	speed: 0.0261s/iter; left time: 8.8852s
	iters: 500, epoch: 10 | loss: 0.2453776
	speed: 0.0258s/iter; left time: 6.2179s
	iters: 600, epoch: 10 | loss: 0.2025839
	speed: 0.0267s/iter; left time: 3.7587s
	iters: 700, epoch: 10 | loss: 0.2310837
	speed: 0.0266s/iter; left time: 1.0901s
Epoch: 10 cost time: 20.27997589111328
Epoch: 10, Steps: 740 | Train Loss: 0.2276416 Vali Loss: 0.3335450 Test Loss: 0.3869175
Validation loss decreased (0.333823 --> 0.333545).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_96_DNGLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.38732248544692993, mae:0.27067407965660095
