Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DNGLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.3050734
	speed: 0.0455s/iter; left time: 325.2700s
	iters: 200, epoch: 1 | loss: 0.2930281
	speed: 0.0373s/iter; left time: 263.3030s
	iters: 300, epoch: 1 | loss: 0.2852626
	speed: 0.0371s/iter; left time: 258.0629s
	iters: 400, epoch: 1 | loss: 0.2648081
	speed: 0.0378s/iter; left time: 258.7445s
	iters: 500, epoch: 1 | loss: 0.2619107
	speed: 0.0376s/iter; left time: 254.0165s
	iters: 600, epoch: 1 | loss: 0.2453040
	speed: 0.0374s/iter; left time: 248.5254s
	iters: 700, epoch: 1 | loss: 0.2394263
	speed: 0.0376s/iter; left time: 246.3173s
Epoch: 1 cost time: 28.013699054718018
Epoch: 1, Steps: 725 | Train Loss: 0.2900979 Vali Loss: 0.3673590 Test Loss: 0.4367481
Validation loss decreased (inf --> 0.367359).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2501857
	speed: 0.2079s/iter; left time: 1336.2696s
	iters: 200, epoch: 2 | loss: 0.2595955
	speed: 0.0392s/iter; left time: 247.9477s
	iters: 300, epoch: 2 | loss: 0.2491087
	speed: 0.0390s/iter; left time: 242.9862s
	iters: 400, epoch: 2 | loss: 0.2532996
	speed: 0.0385s/iter; left time: 235.9901s
	iters: 500, epoch: 2 | loss: 0.2519588
	speed: 0.0389s/iter; left time: 234.1512s
	iters: 600, epoch: 2 | loss: 0.2335106
	speed: 0.0381s/iter; left time: 225.5216s
	iters: 700, epoch: 2 | loss: 0.2496724
	speed: 0.0384s/iter; left time: 223.7379s
Epoch: 2 cost time: 29.17738151550293
Epoch: 2, Steps: 725 | Train Loss: 0.2576804 Vali Loss: 0.3657556 Test Loss: 0.4319764
Validation loss decreased (0.367359 --> 0.365756).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2502590
	speed: 0.2136s/iter; left time: 1217.4836s
	iters: 200, epoch: 3 | loss: 0.2499655
	speed: 0.0385s/iter; left time: 215.3765s
	iters: 300, epoch: 3 | loss: 0.2450045
	speed: 0.0380s/iter; left time: 209.1689s
	iters: 400, epoch: 3 | loss: 0.2666306
	speed: 0.0386s/iter; left time: 208.7419s
	iters: 500, epoch: 3 | loss: 0.2341932
	speed: 0.0391s/iter; left time: 207.0272s
	iters: 600, epoch: 3 | loss: 0.2249117
	speed: 0.0384s/iter; left time: 199.5038s
	iters: 700, epoch: 3 | loss: 0.2525171
	speed: 0.0371s/iter; left time: 189.1581s
Epoch: 3 cost time: 28.779919862747192
Epoch: 3, Steps: 725 | Train Loss: 0.2520008 Vali Loss: 0.3614346 Test Loss: 0.4253809
Validation loss decreased (0.365756 --> 0.361435).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2512328
	speed: 0.2105s/iter; left time: 1047.6799s
	iters: 200, epoch: 4 | loss: 0.2758268
	speed: 0.0385s/iter; left time: 187.6704s
	iters: 300, epoch: 4 | loss: 0.2353343
	speed: 0.0384s/iter; left time: 183.5921s
	iters: 400, epoch: 4 | loss: 0.2663656
	speed: 0.0384s/iter; left time: 179.4372s
	iters: 500, epoch: 4 | loss: 0.2476234
	speed: 0.0391s/iter; left time: 178.9413s
	iters: 600, epoch: 4 | loss: 0.2280577
	speed: 0.0386s/iter; left time: 172.8325s
	iters: 700, epoch: 4 | loss: 0.2398108
	speed: 0.0391s/iter; left time: 171.1566s
Epoch: 4 cost time: 28.842515230178833
Epoch: 4, Steps: 725 | Train Loss: 0.2495214 Vali Loss: 0.3582400 Test Loss: 0.4215618
Validation loss decreased (0.361435 --> 0.358240).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2692947
	speed: 0.2092s/iter; left time: 889.3929s
	iters: 200, epoch: 5 | loss: 0.2421112
	speed: 0.0381s/iter; left time: 158.2166s
	iters: 300, epoch: 5 | loss: 0.2654439
	speed: 0.0383s/iter; left time: 154.9893s
	iters: 400, epoch: 5 | loss: 0.2547955
	speed: 0.0370s/iter; left time: 146.2816s
	iters: 500, epoch: 5 | loss: 0.2397880
	speed: 0.0382s/iter; left time: 147.2131s
	iters: 600, epoch: 5 | loss: 0.2446310
	speed: 0.0394s/iter; left time: 147.9010s
	iters: 700, epoch: 5 | loss: 0.2543483
	speed: 0.0399s/iter; left time: 145.5499s
Epoch: 5 cost time: 28.71979260444641
Epoch: 5, Steps: 725 | Train Loss: 0.2483036 Vali Loss: 0.3581869 Test Loss: 0.4210079
Validation loss decreased (0.358240 --> 0.358187).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2740911
	speed: 0.2033s/iter; left time: 716.8387s
	iters: 200, epoch: 6 | loss: 0.2398194
	speed: 0.0374s/iter; left time: 128.0562s
	iters: 300, epoch: 6 | loss: 0.2472815
	speed: 0.0383s/iter; left time: 127.5250s
	iters: 400, epoch: 6 | loss: 0.2541736
	speed: 0.0375s/iter; left time: 120.8717s
	iters: 500, epoch: 6 | loss: 0.2623193
	speed: 0.0384s/iter; left time: 120.1196s
	iters: 600, epoch: 6 | loss: 0.2495873
	speed: 0.0373s/iter; left time: 112.7687s
	iters: 700, epoch: 6 | loss: 0.2704952
	speed: 0.0381s/iter; left time: 111.5666s
Epoch: 6 cost time: 28.375336408615112
Epoch: 6, Steps: 725 | Train Loss: 0.2476858 Vali Loss: 0.3574166 Test Loss: 0.4204298
Validation loss decreased (0.358187 --> 0.357417).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2570002
	speed: 0.2044s/iter; left time: 572.4974s
	iters: 200, epoch: 7 | loss: 0.2343085
	speed: 0.0389s/iter; left time: 105.0895s
	iters: 300, epoch: 7 | loss: 0.2296702
	speed: 0.0381s/iter; left time: 99.1366s
	iters: 400, epoch: 7 | loss: 0.2446465
	speed: 0.0386s/iter; left time: 96.4629s
	iters: 500, epoch: 7 | loss: 0.2739319
	speed: 0.0388s/iter; left time: 93.0436s
	iters: 600, epoch: 7 | loss: 0.2161136
	speed: 0.0389s/iter; left time: 89.4730s
	iters: 700, epoch: 7 | loss: 0.2409769
	speed: 0.0391s/iter; left time: 85.9576s
Epoch: 7 cost time: 29.068458318710327
Epoch: 7, Steps: 725 | Train Loss: 0.2473386 Vali Loss: 0.3567258 Test Loss: 0.4196465
Validation loss decreased (0.357417 --> 0.356726).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2587685
	speed: 0.2068s/iter; left time: 429.2221s
	iters: 200, epoch: 8 | loss: 0.2462524
	speed: 0.0382s/iter; left time: 75.5815s
	iters: 300, epoch: 8 | loss: 0.2384892
	speed: 0.0392s/iter; left time: 73.4713s
	iters: 400, epoch: 8 | loss: 0.2569114
	speed: 0.0385s/iter; left time: 68.4316s
	iters: 500, epoch: 8 | loss: 0.2452652
	speed: 0.0384s/iter; left time: 64.3332s
	iters: 600, epoch: 8 | loss: 0.2710935
	speed: 0.0391s/iter; left time: 61.6442s
	iters: 700, epoch: 8 | loss: 0.2392598
	speed: 0.0392s/iter; left time: 57.8297s
Epoch: 8 cost time: 28.956534147262573
Epoch: 8, Steps: 725 | Train Loss: 0.2471359 Vali Loss: 0.3569548 Test Loss: 0.4197048
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2553828
	speed: 0.2125s/iter; left time: 287.1064s
	iters: 200, epoch: 9 | loss: 0.2597291
	speed: 0.0399s/iter; left time: 49.9774s
	iters: 300, epoch: 9 | loss: 0.2305559
	speed: 0.0380s/iter; left time: 43.7337s
	iters: 400, epoch: 9 | loss: 0.2506975
	speed: 0.0390s/iter; left time: 40.9821s
	iters: 500, epoch: 9 | loss: 0.2442275
	speed: 0.0391s/iter; left time: 37.1747s
	iters: 600, epoch: 9 | loss: 0.2404535
	speed: 0.0387s/iter; left time: 32.9317s
	iters: 700, epoch: 9 | loss: 0.2795668
	speed: 0.0389s/iter; left time: 29.1837s
Epoch: 9 cost time: 29.23706555366516
Epoch: 9, Steps: 725 | Train Loss: 0.2470869 Vali Loss: 0.3570306 Test Loss: 0.4195347
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2568086
	speed: 0.2072s/iter; left time: 129.7379s
	iters: 200, epoch: 10 | loss: 0.2454478
	speed: 0.0388s/iter; left time: 20.4227s
	iters: 300, epoch: 10 | loss: 0.2432777
	speed: 0.0396s/iter; left time: 16.8833s
	iters: 400, epoch: 10 | loss: 0.2239044
	speed: 0.0391s/iter; left time: 12.7568s
	iters: 500, epoch: 10 | loss: 0.2749518
	speed: 0.0401s/iter; left time: 9.0659s
	iters: 600, epoch: 10 | loss: 0.2304691
	speed: 0.0400s/iter; left time: 5.0431s
	iters: 700, epoch: 10 | loss: 0.2644868
	speed: 0.0385s/iter; left time: 0.9999s
Epoch: 10 cost time: 29.262165307998657
Epoch: 10, Steps: 725 | Train Loss: 0.2469973 Vali Loss: 0.3567128 Test Loss: 0.4195583
Validation loss decreased (0.356726 --> 0.356713).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_336_DNGLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.418623149394989, mae:0.2857832610607147
