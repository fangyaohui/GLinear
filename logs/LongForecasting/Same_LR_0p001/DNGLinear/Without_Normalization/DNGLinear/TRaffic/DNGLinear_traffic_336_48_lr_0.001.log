Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='traffic_336_48', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=48, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_48_DNGLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1709
test 3461
	iters: 100, epoch: 1 | loss: 0.2856317
	speed: 0.0306s/iter; left time: 224.5457s
	iters: 200, epoch: 1 | loss: 0.2420359
	speed: 0.0233s/iter; left time: 168.8159s
	iters: 300, epoch: 1 | loss: 0.2247233
	speed: 0.0237s/iter; left time: 168.8614s
	iters: 400, epoch: 1 | loss: 0.2209470
	speed: 0.0243s/iter; left time: 170.9454s
	iters: 500, epoch: 1 | loss: 0.2270121
	speed: 0.0244s/iter; left time: 169.2182s
	iters: 600, epoch: 1 | loss: 0.2430384
	speed: 0.0233s/iter; left time: 159.2136s
	iters: 700, epoch: 1 | loss: 0.2081548
	speed: 0.0237s/iter; left time: 159.7372s
Epoch: 1 cost time: 18.432191610336304
Epoch: 1, Steps: 743 | Train Loss: 0.2605104 Vali Loss: 0.3336730 Test Loss: 0.3842304
Validation loss decreased (inf --> 0.333673).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2060798
	speed: 0.1317s/iter; left time: 867.6913s
	iters: 200, epoch: 2 | loss: 0.2330137
	speed: 0.0245s/iter; left time: 159.2494s
	iters: 300, epoch: 2 | loss: 0.2095419
	speed: 0.0231s/iter; left time: 147.3118s
	iters: 400, epoch: 2 | loss: 0.2779113
	speed: 0.0238s/iter; left time: 149.4353s
	iters: 500, epoch: 2 | loss: 0.1783055
	speed: 0.0236s/iter; left time: 146.2235s
	iters: 600, epoch: 2 | loss: 0.2191974
	speed: 0.0239s/iter; left time: 145.5017s
	iters: 700, epoch: 2 | loss: 0.2373592
	speed: 0.0246s/iter; left time: 147.1796s
Epoch: 2 cost time: 18.637626886367798
Epoch: 2, Steps: 743 | Train Loss: 0.2303951 Vali Loss: 0.3308815 Test Loss: 0.3745774
Validation loss decreased (0.333673 --> 0.330882).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1908689
	speed: 0.1320s/iter; left time: 771.5413s
	iters: 200, epoch: 3 | loss: 0.1742470
	speed: 0.0250s/iter; left time: 143.8709s
	iters: 300, epoch: 3 | loss: 0.2246585
	speed: 0.0245s/iter; left time: 138.0309s
	iters: 400, epoch: 3 | loss: 0.2030609
	speed: 0.0244s/iter; left time: 135.2668s
	iters: 500, epoch: 3 | loss: 0.2817545
	speed: 0.0251s/iter; left time: 136.4050s
	iters: 600, epoch: 3 | loss: 0.2626726
	speed: 0.0238s/iter; left time: 127.3346s
	iters: 700, epoch: 3 | loss: 0.2311265
	speed: 0.0237s/iter; left time: 124.2002s
Epoch: 3 cost time: 18.924383878707886
Epoch: 3, Steps: 743 | Train Loss: 0.2236316 Vali Loss: 0.3292793 Test Loss: 0.3699067
Validation loss decreased (0.330882 --> 0.329279).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2157046
	speed: 0.1314s/iter; left time: 670.2085s
	iters: 200, epoch: 4 | loss: 0.2282140
	speed: 0.0240s/iter; left time: 120.0187s
	iters: 300, epoch: 4 | loss: 0.2362244
	speed: 0.0247s/iter; left time: 120.9040s
	iters: 400, epoch: 4 | loss: 0.2132705
	speed: 0.0238s/iter; left time: 114.1766s
	iters: 500, epoch: 4 | loss: 0.2426701
	speed: 0.0240s/iter; left time: 112.6807s
	iters: 600, epoch: 4 | loss: 0.2237112
	speed: 0.0243s/iter; left time: 111.9038s
	iters: 700, epoch: 4 | loss: 0.2416620
	speed: 0.0238s/iter; left time: 107.0185s
Epoch: 4 cost time: 18.74216651916504
Epoch: 4, Steps: 743 | Train Loss: 0.2206095 Vali Loss: 0.3261273 Test Loss: 0.3664063
Validation loss decreased (0.329279 --> 0.326127).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1905155
	speed: 0.1332s/iter; left time: 580.7096s
	iters: 200, epoch: 5 | loss: 0.1981198
	speed: 0.0252s/iter; left time: 107.1254s
	iters: 300, epoch: 5 | loss: 0.2450307
	speed: 0.0262s/iter; left time: 108.8708s
	iters: 400, epoch: 5 | loss: 0.1949210
	speed: 0.0245s/iter; left time: 99.5006s
	iters: 500, epoch: 5 | loss: 0.2451853
	speed: 0.0254s/iter; left time: 100.5434s
	iters: 600, epoch: 5 | loss: 0.2061636
	speed: 0.0250s/iter; left time: 96.3995s
	iters: 700, epoch: 5 | loss: 0.1974590
	speed: 0.0245s/iter; left time: 92.1100s
Epoch: 5 cost time: 19.47746777534485
Epoch: 5, Steps: 743 | Train Loss: 0.2191704 Vali Loss: 0.3255551 Test Loss: 0.3651458
Validation loss decreased (0.326127 --> 0.325555).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2187451
	speed: 0.1351s/iter; left time: 488.5233s
	iters: 200, epoch: 6 | loss: 0.1637547
	speed: 0.0237s/iter; left time: 83.3048s
	iters: 300, epoch: 6 | loss: 0.2496206
	speed: 0.0239s/iter; left time: 81.7659s
	iters: 400, epoch: 6 | loss: 0.2351369
	speed: 0.0243s/iter; left time: 80.4992s
	iters: 500, epoch: 6 | loss: 0.2125001
	speed: 0.0249s/iter; left time: 80.1739s
	iters: 600, epoch: 6 | loss: 0.2446293
	speed: 0.0249s/iter; left time: 77.5238s
	iters: 700, epoch: 6 | loss: 0.2707472
	speed: 0.0241s/iter; left time: 72.7012s
Epoch: 6 cost time: 18.806913375854492
Epoch: 6, Steps: 743 | Train Loss: 0.2184195 Vali Loss: 0.3250526 Test Loss: 0.3643703
Validation loss decreased (0.325555 --> 0.325053).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2577694
	speed: 0.1312s/iter; left time: 376.8699s
	iters: 200, epoch: 7 | loss: 0.1965151
	speed: 0.0241s/iter; left time: 66.9115s
	iters: 300, epoch: 7 | loss: 0.1880682
	speed: 0.0240s/iter; left time: 64.2337s
	iters: 400, epoch: 7 | loss: 0.2582125
	speed: 0.0243s/iter; left time: 62.5387s
	iters: 500, epoch: 7 | loss: 0.2006761
	speed: 0.0241s/iter; left time: 59.5481s
	iters: 600, epoch: 7 | loss: 0.2115199
	speed: 0.0249s/iter; left time: 59.1589s
	iters: 700, epoch: 7 | loss: 0.2053957
	speed: 0.0240s/iter; left time: 54.4892s
Epoch: 7 cost time: 18.81345534324646
Epoch: 7, Steps: 743 | Train Loss: 0.2180133 Vali Loss: 0.3252474 Test Loss: 0.3644144
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2254850
	speed: 0.1298s/iter; left time: 276.5042s
	iters: 200, epoch: 8 | loss: 0.2166934
	speed: 0.0230s/iter; left time: 46.6978s
	iters: 300, epoch: 8 | loss: 0.2207911
	speed: 0.0240s/iter; left time: 46.2648s
	iters: 400, epoch: 8 | loss: 0.2087897
	speed: 0.0243s/iter; left time: 44.4363s
	iters: 500, epoch: 8 | loss: 0.2411134
	speed: 0.0237s/iter; left time: 40.9489s
	iters: 600, epoch: 8 | loss: 0.1663783
	speed: 0.0236s/iter; left time: 38.4882s
	iters: 700, epoch: 8 | loss: 0.1884727
	speed: 0.0250s/iter; left time: 38.2868s
Epoch: 8 cost time: 18.450407028198242
Epoch: 8, Steps: 743 | Train Loss: 0.2177945 Vali Loss: 0.3251383 Test Loss: 0.3640329
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2093297
	speed: 0.1284s/iter; left time: 178.0598s
	iters: 200, epoch: 9 | loss: 0.2304103
	speed: 0.0234s/iter; left time: 30.1544s
	iters: 300, epoch: 9 | loss: 0.2333759
	speed: 0.0239s/iter; left time: 28.3225s
	iters: 400, epoch: 9 | loss: 0.2295916
	speed: 0.0237s/iter; left time: 25.7349s
	iters: 500, epoch: 9 | loss: 0.2447938
	speed: 0.0242s/iter; left time: 23.9108s
	iters: 600, epoch: 9 | loss: 0.2013740
	speed: 0.0246s/iter; left time: 21.8391s
	iters: 700, epoch: 9 | loss: 0.1892373
	speed: 0.0248s/iter; left time: 19.5149s
Epoch: 9 cost time: 18.699241161346436
Epoch: 9, Steps: 743 | Train Loss: 0.2176959 Vali Loss: 0.3250361 Test Loss: 0.3639620
Validation loss decreased (0.325053 --> 0.325036).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2073027
	speed: 0.1301s/iter; left time: 83.7736s
	iters: 200, epoch: 10 | loss: 0.1863490
	speed: 0.0242s/iter; left time: 13.1732s
	iters: 300, epoch: 10 | loss: 0.2324893
	speed: 0.0235s/iter; left time: 10.4486s
	iters: 400, epoch: 10 | loss: 0.2531328
	speed: 0.0247s/iter; left time: 8.5019s
	iters: 500, epoch: 10 | loss: 0.1993258
	speed: 0.0250s/iter; left time: 6.1002s
	iters: 600, epoch: 10 | loss: 0.1984165
	speed: 0.0237s/iter; left time: 3.4162s
	iters: 700, epoch: 10 | loss: 0.1981582
	speed: 0.0238s/iter; left time: 1.0481s
Epoch: 10 cost time: 18.727115631103516
Epoch: 10, Steps: 743 | Train Loss: 0.2176480 Vali Loss: 0.3250832 Test Loss: 0.3639018
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_48_DNGLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3461
mse:0.36455845832824707, mae:0.2598450183868408
