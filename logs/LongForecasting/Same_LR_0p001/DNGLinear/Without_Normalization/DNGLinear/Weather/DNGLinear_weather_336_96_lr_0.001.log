Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_96_DNGLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3521025
	speed: 0.0147s/iter; left time: 332.6281s
	iters: 200, epoch: 1 | loss: 0.4361329
	speed: 0.0078s/iter; left time: 177.1609s
	iters: 300, epoch: 1 | loss: 0.3278575
	speed: 0.0084s/iter; left time: 188.4005s
	iters: 400, epoch: 1 | loss: 0.2609604
	speed: 0.0083s/iter; left time: 185.4247s
	iters: 500, epoch: 1 | loss: 0.8180194
	speed: 0.0083s/iter; left time: 184.9218s
	iters: 600, epoch: 1 | loss: 0.3186152
	speed: 0.0080s/iter; left time: 177.7018s
	iters: 700, epoch: 1 | loss: 0.3668297
	speed: 0.0079s/iter; left time: 173.7293s
	iters: 800, epoch: 1 | loss: 0.1937510
	speed: 0.0079s/iter; left time: 173.1156s
	iters: 900, epoch: 1 | loss: 0.3975961
	speed: 0.0080s/iter; left time: 174.4132s
	iters: 1000, epoch: 1 | loss: 0.2632198
	speed: 0.0096s/iter; left time: 209.4492s
	iters: 1100, epoch: 1 | loss: 0.3118057
	speed: 0.0084s/iter; left time: 182.5101s
	iters: 1200, epoch: 1 | loss: 0.2545109
	speed: 0.0083s/iter; left time: 178.3768s
	iters: 1300, epoch: 1 | loss: 0.2993545
	speed: 0.0074s/iter; left time: 159.9503s
	iters: 1400, epoch: 1 | loss: 0.3226468
	speed: 0.0082s/iter; left time: 174.3550s
	iters: 1500, epoch: 1 | loss: 0.6558019
	speed: 0.0081s/iter; left time: 172.9307s
	iters: 1600, epoch: 1 | loss: 0.2391685
	speed: 0.0082s/iter; left time: 172.8232s
	iters: 1700, epoch: 1 | loss: 0.2836744
	speed: 0.0085s/iter; left time: 178.4483s
	iters: 1800, epoch: 1 | loss: 0.2920870
	speed: 0.0080s/iter; left time: 167.3477s
	iters: 1900, epoch: 1 | loss: 0.9921429
	speed: 0.0087s/iter; left time: 180.8744s
	iters: 2000, epoch: 1 | loss: 0.3121056
	speed: 0.0081s/iter; left time: 169.2088s
	iters: 2100, epoch: 1 | loss: 0.4152906
	speed: 0.0078s/iter; left time: 161.8905s
	iters: 2200, epoch: 1 | loss: 0.2659007
	speed: 0.0081s/iter; left time: 166.1056s
Epoch: 1 cost time: 19.376274347305298
Epoch: 1, Steps: 2278 | Train Loss: 0.4545310 Vali Loss: 0.4085828 Test Loss: 0.1634256
Validation loss decreased (inf --> 0.408583).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3588870
	speed: 0.0809s/iter; left time: 1650.9831s
	iters: 200, epoch: 2 | loss: 0.4318125
	speed: 0.0082s/iter; left time: 165.5424s
	iters: 300, epoch: 2 | loss: 0.2166960
	speed: 0.0087s/iter; left time: 175.4345s
	iters: 400, epoch: 2 | loss: 0.6175218
	speed: 0.0086s/iter; left time: 172.1141s
	iters: 500, epoch: 2 | loss: 0.2845761
	speed: 0.0086s/iter; left time: 171.6915s
	iters: 600, epoch: 2 | loss: 0.6068136
	speed: 0.0080s/iter; left time: 158.7045s
	iters: 700, epoch: 2 | loss: 0.3214498
	speed: 0.0077s/iter; left time: 152.0834s
	iters: 800, epoch: 2 | loss: 0.3096404
	speed: 0.0083s/iter; left time: 162.9380s
	iters: 900, epoch: 2 | loss: 0.3090352
	speed: 0.0081s/iter; left time: 159.2346s
	iters: 1000, epoch: 2 | loss: 0.3012551
	speed: 0.0079s/iter; left time: 154.0802s
	iters: 1100, epoch: 2 | loss: 0.2368131
	speed: 0.0086s/iter; left time: 165.9357s
	iters: 1200, epoch: 2 | loss: 0.3065683
	speed: 0.0082s/iter; left time: 159.0479s
	iters: 1300, epoch: 2 | loss: 0.3295232
	speed: 0.0080s/iter; left time: 152.7649s
	iters: 1400, epoch: 2 | loss: 2.2553697
	speed: 0.0084s/iter; left time: 159.5853s
	iters: 1500, epoch: 2 | loss: 0.2531940
	speed: 0.0091s/iter; left time: 172.1258s
	iters: 1600, epoch: 2 | loss: 0.3283426
	speed: 0.0079s/iter; left time: 149.7851s
	iters: 1700, epoch: 2 | loss: 0.4319262
	speed: 0.0081s/iter; left time: 151.7975s
	iters: 1800, epoch: 2 | loss: 0.2498161
	speed: 0.0080s/iter; left time: 149.8437s
	iters: 1900, epoch: 2 | loss: 0.7484705
	speed: 0.0080s/iter; left time: 148.9865s
	iters: 2000, epoch: 2 | loss: 0.5330392
	speed: 0.0080s/iter; left time: 148.6971s
	iters: 2100, epoch: 2 | loss: 0.6426274
	speed: 0.0077s/iter; left time: 141.7654s
	iters: 2200, epoch: 2 | loss: 0.3559194
	speed: 0.0081s/iter; left time: 147.3808s
Epoch: 2 cost time: 19.33731436729431
Epoch: 2, Steps: 2278 | Train Loss: 0.4279914 Vali Loss: 0.3914997 Test Loss: 0.1569991
Validation loss decreased (0.408583 --> 0.391500).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3156635
	speed: 0.0810s/iter; left time: 1467.5552s
	iters: 200, epoch: 3 | loss: 0.4897707
	speed: 0.0079s/iter; left time: 142.6063s
	iters: 300, epoch: 3 | loss: 0.3250763
	speed: 0.0074s/iter; left time: 132.9954s
	iters: 400, epoch: 3 | loss: 0.6878052
	speed: 0.0082s/iter; left time: 146.7387s
	iters: 500, epoch: 3 | loss: 0.2140595
	speed: 0.0081s/iter; left time: 143.8014s
	iters: 600, epoch: 3 | loss: 0.2573675
	speed: 0.0076s/iter; left time: 134.4210s
	iters: 700, epoch: 3 | loss: 0.2652574
	speed: 0.0089s/iter; left time: 155.7100s
	iters: 800, epoch: 3 | loss: 0.2578934
	speed: 0.0077s/iter; left time: 134.5842s
	iters: 900, epoch: 3 | loss: 0.2801372
	speed: 0.0082s/iter; left time: 142.0417s
	iters: 1000, epoch: 3 | loss: 0.3529584
	speed: 0.0079s/iter; left time: 135.7754s
	iters: 1100, epoch: 3 | loss: 0.4104590
	speed: 0.0084s/iter; left time: 144.4081s
	iters: 1200, epoch: 3 | loss: 0.3581331
	speed: 0.0085s/iter; left time: 144.0168s
	iters: 1300, epoch: 3 | loss: 0.2260136
	speed: 0.0079s/iter; left time: 133.6779s
	iters: 1400, epoch: 3 | loss: 0.2379675
	speed: 0.0082s/iter; left time: 137.4496s
	iters: 1500, epoch: 3 | loss: 0.2038179
	speed: 0.0079s/iter; left time: 132.6229s
	iters: 1600, epoch: 3 | loss: 0.1581544
	speed: 0.0082s/iter; left time: 135.5922s
	iters: 1700, epoch: 3 | loss: 0.2433461
	speed: 0.0080s/iter; left time: 132.9369s
	iters: 1800, epoch: 3 | loss: 0.2080510
	speed: 0.0079s/iter; left time: 129.6310s
	iters: 1900, epoch: 3 | loss: 0.2209338
	speed: 0.0086s/iter; left time: 139.9252s
	iters: 2000, epoch: 3 | loss: 0.2731738
	speed: 0.0089s/iter; left time: 144.0190s
	iters: 2100, epoch: 3 | loss: 0.1964542
	speed: 0.0082s/iter; left time: 131.6213s
	iters: 2200, epoch: 3 | loss: 0.2918327
	speed: 0.0080s/iter; left time: 128.1985s
Epoch: 3 cost time: 19.20971965789795
Epoch: 3, Steps: 2278 | Train Loss: 0.4035944 Vali Loss: 0.3727565 Test Loss: 0.1508771
Validation loss decreased (0.391500 --> 0.372757).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3366958
	speed: 0.0830s/iter; left time: 1314.7647s
	iters: 200, epoch: 4 | loss: 0.2821621
	speed: 0.0080s/iter; left time: 125.9743s
	iters: 300, epoch: 4 | loss: 0.2927571
	speed: 0.0079s/iter; left time: 123.4981s
	iters: 400, epoch: 4 | loss: 0.7650728
	speed: 0.0081s/iter; left time: 126.4981s
	iters: 500, epoch: 4 | loss: 0.3223712
	speed: 0.0082s/iter; left time: 126.3530s
	iters: 600, epoch: 4 | loss: 2.1186593
	speed: 0.0080s/iter; left time: 123.1243s
	iters: 700, epoch: 4 | loss: 0.2463050
	speed: 0.0083s/iter; left time: 125.8226s
	iters: 800, epoch: 4 | loss: 0.1978266
	speed: 0.0083s/iter; left time: 124.9851s
	iters: 900, epoch: 4 | loss: 0.3952225
	speed: 0.0082s/iter; left time: 123.9237s
	iters: 1000, epoch: 4 | loss: 0.3165171
	speed: 0.0099s/iter; left time: 147.2621s
	iters: 1100, epoch: 4 | loss: 0.1952554
	speed: 0.0080s/iter; left time: 119.2637s
	iters: 1200, epoch: 4 | loss: 0.2502569
	speed: 0.0080s/iter; left time: 117.7881s
	iters: 1300, epoch: 4 | loss: 0.2871840
	speed: 0.0079s/iter; left time: 115.9941s
	iters: 1400, epoch: 4 | loss: 0.3725779
	speed: 0.0086s/iter; left time: 125.4458s
	iters: 1500, epoch: 4 | loss: 0.2817608
	speed: 0.0074s/iter; left time: 107.1344s
	iters: 1600, epoch: 4 | loss: 2.2152832
	speed: 0.0071s/iter; left time: 102.4958s
	iters: 1700, epoch: 4 | loss: 0.2507773
	speed: 0.0080s/iter; left time: 113.5738s
	iters: 1800, epoch: 4 | loss: 0.2226380
	speed: 0.0082s/iter; left time: 116.2854s
	iters: 1900, epoch: 4 | loss: 0.2498909
	speed: 0.0082s/iter; left time: 114.9491s
	iters: 2000, epoch: 4 | loss: 0.1880347
	speed: 0.0079s/iter; left time: 110.2214s
	iters: 2100, epoch: 4 | loss: 0.2200080
	speed: 0.0080s/iter; left time: 110.7895s
	iters: 2200, epoch: 4 | loss: 0.2106185
	speed: 0.0081s/iter; left time: 111.7804s
Epoch: 4 cost time: 19.330210208892822
Epoch: 4, Steps: 2278 | Train Loss: 0.3950459 Vali Loss: 0.3717076 Test Loss: 0.1519258
Validation loss decreased (0.372757 --> 0.371708).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2176455
	speed: 0.0824s/iter; left time: 1118.1982s
	iters: 200, epoch: 5 | loss: 0.2603723
	speed: 0.0084s/iter; left time: 113.4577s
	iters: 300, epoch: 5 | loss: 0.3388282
	speed: 0.0083s/iter; left time: 111.0917s
	iters: 400, epoch: 5 | loss: 0.2208929
	speed: 0.0079s/iter; left time: 105.1181s
	iters: 500, epoch: 5 | loss: 0.2122107
	speed: 0.0078s/iter; left time: 103.0206s
	iters: 600, epoch: 5 | loss: 0.2518350
	speed: 0.0088s/iter; left time: 115.4280s
	iters: 700, epoch: 5 | loss: 0.5162004
	speed: 0.0079s/iter; left time: 102.8266s
	iters: 800, epoch: 5 | loss: 1.5154151
	speed: 0.0079s/iter; left time: 101.2039s
	iters: 900, epoch: 5 | loss: 0.4956352
	speed: 0.0080s/iter; left time: 102.2938s
	iters: 1000, epoch: 5 | loss: 0.4142087
	speed: 0.0083s/iter; left time: 104.9331s
	iters: 1100, epoch: 5 | loss: 1.5324879
	speed: 0.0077s/iter; left time: 97.3948s
	iters: 1200, epoch: 5 | loss: 0.1650337
	speed: 0.0080s/iter; left time: 99.7154s
	iters: 1300, epoch: 5 | loss: 1.4994315
	speed: 0.0080s/iter; left time: 99.0031s
	iters: 1400, epoch: 5 | loss: 0.2700782
	speed: 0.0079s/iter; left time: 96.5823s
	iters: 1500, epoch: 5 | loss: 0.4366051
	speed: 0.0081s/iter; left time: 98.4861s
	iters: 1600, epoch: 5 | loss: 0.2252639
	speed: 0.0076s/iter; left time: 92.1048s
	iters: 1700, epoch: 5 | loss: 0.2334275
	speed: 0.0079s/iter; left time: 95.1457s
	iters: 1800, epoch: 5 | loss: 2.1168287
	speed: 0.0079s/iter; left time: 94.2205s
	iters: 1900, epoch: 5 | loss: 0.2853914
	speed: 0.0086s/iter; left time: 100.8648s
	iters: 2000, epoch: 5 | loss: 0.2654461
	speed: 0.0074s/iter; left time: 85.9100s
	iters: 2100, epoch: 5 | loss: 0.5380226
	speed: 0.0076s/iter; left time: 88.3406s
	iters: 2200, epoch: 5 | loss: 0.2343490
	speed: 0.0079s/iter; left time: 90.8738s
Epoch: 5 cost time: 18.93586254119873
Epoch: 5, Steps: 2278 | Train Loss: 0.3888392 Vali Loss: 0.3724272 Test Loss: 0.1516166
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.8869795
	speed: 0.0808s/iter; left time: 911.8272s
	iters: 200, epoch: 6 | loss: 0.2060994
	speed: 0.0083s/iter; left time: 92.5509s
	iters: 300, epoch: 6 | loss: 0.2786319
	speed: 0.0080s/iter; left time: 89.2587s
	iters: 400, epoch: 6 | loss: 0.2726550
	speed: 0.0076s/iter; left time: 83.2471s
	iters: 500, epoch: 6 | loss: 0.1886024
	speed: 0.0080s/iter; left time: 87.5275s
	iters: 600, epoch: 6 | loss: 0.7363524
	speed: 0.0089s/iter; left time: 96.4493s
	iters: 700, epoch: 6 | loss: 2.1737509
	speed: 0.0080s/iter; left time: 85.7255s
	iters: 800, epoch: 6 | loss: 0.2125826
	speed: 0.0078s/iter; left time: 82.1872s
	iters: 900, epoch: 6 | loss: 0.3489336
	speed: 0.0081s/iter; left time: 84.8185s
	iters: 1000, epoch: 6 | loss: 0.3090163
	speed: 0.0086s/iter; left time: 89.0969s
	iters: 1100, epoch: 6 | loss: 0.2638471
	speed: 0.0083s/iter; left time: 85.8246s
	iters: 1200, epoch: 6 | loss: 0.2929849
	speed: 0.0077s/iter; left time: 78.1528s
	iters: 1300, epoch: 6 | loss: 0.2506239
	speed: 0.0081s/iter; left time: 81.6347s
	iters: 1400, epoch: 6 | loss: 0.2215579
	speed: 0.0077s/iter; left time: 76.5198s
	iters: 1500, epoch: 6 | loss: 0.2786219
	speed: 0.0079s/iter; left time: 77.7879s
	iters: 1600, epoch: 6 | loss: 0.2706590
	speed: 0.0077s/iter; left time: 75.8139s
	iters: 1700, epoch: 6 | loss: 0.4078906
	speed: 0.0083s/iter; left time: 80.5011s
	iters: 1800, epoch: 6 | loss: 0.2379629
	speed: 0.0084s/iter; left time: 80.4955s
	iters: 1900, epoch: 6 | loss: 0.2447747
	speed: 0.0076s/iter; left time: 72.2466s
	iters: 2000, epoch: 6 | loss: 0.6059139
	speed: 0.0078s/iter; left time: 73.2433s
	iters: 2100, epoch: 6 | loss: 0.4931140
	speed: 0.0077s/iter; left time: 71.3854s
	iters: 2200, epoch: 6 | loss: 0.3843588
	speed: 0.0089s/iter; left time: 81.8255s
Epoch: 6 cost time: 19.15615963935852
Epoch: 6, Steps: 2278 | Train Loss: 0.3860817 Vali Loss: 0.3719528 Test Loss: 0.1525774
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2139363
	speed: 0.0825s/iter; left time: 743.6887s
	iters: 200, epoch: 7 | loss: 0.1826582
	speed: 0.0084s/iter; left time: 75.1933s
	iters: 300, epoch: 7 | loss: 0.2945136
	speed: 0.0079s/iter; left time: 69.8260s
	iters: 400, epoch: 7 | loss: 0.2299151
	speed: 0.0083s/iter; left time: 71.9890s
	iters: 500, epoch: 7 | loss: 0.2629459
	speed: 0.0084s/iter; left time: 72.4588s
	iters: 600, epoch: 7 | loss: 0.5453367
	speed: 0.0080s/iter; left time: 67.7866s
	iters: 700, epoch: 7 | loss: 0.3429884
	speed: 0.0077s/iter; left time: 65.1314s
	iters: 800, epoch: 7 | loss: 0.2093152
	speed: 0.0078s/iter; left time: 64.5140s
	iters: 900, epoch: 7 | loss: 0.2048608
	speed: 0.0080s/iter; left time: 65.6731s
	iters: 1000, epoch: 7 | loss: 0.3690904
	speed: 0.0078s/iter; left time: 63.4830s
	iters: 1100, epoch: 7 | loss: 0.2893347
	speed: 0.0086s/iter; left time: 68.5583s
	iters: 1200, epoch: 7 | loss: 0.4001655
	speed: 0.0077s/iter; left time: 60.7429s
	iters: 1300, epoch: 7 | loss: 0.2624898
	speed: 0.0087s/iter; left time: 67.5852s
	iters: 1400, epoch: 7 | loss: 0.3262756
	speed: 0.0085s/iter; left time: 65.9243s
	iters: 1500, epoch: 7 | loss: 0.3462552
	speed: 0.0084s/iter; left time: 64.1295s
	iters: 1600, epoch: 7 | loss: 0.2179039
	speed: 0.0085s/iter; left time: 64.1217s
	iters: 1700, epoch: 7 | loss: 0.6055897
	speed: 0.0084s/iter; left time: 62.2363s
	iters: 1800, epoch: 7 | loss: 0.2693187
	speed: 0.0081s/iter; left time: 59.0124s
	iters: 1900, epoch: 7 | loss: 0.2805326
	speed: 0.0079s/iter; left time: 57.1103s
	iters: 2000, epoch: 7 | loss: 0.2044448
	speed: 0.0078s/iter; left time: 55.5355s
	iters: 2100, epoch: 7 | loss: 0.2058177
	speed: 0.0082s/iter; left time: 57.4584s
	iters: 2200, epoch: 7 | loss: 0.2731703
	speed: 0.0078s/iter; left time: 53.7850s
Epoch: 7 cost time: 19.343417167663574
Epoch: 7, Steps: 2278 | Train Loss: 0.3844830 Vali Loss: 0.3719387 Test Loss: 0.1517849
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_96_DNGLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1519652009010315, mae:0.21112821996212006
