Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_DNGLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.4095228
	speed: 0.0167s/iter; left time: 371.7114s
	iters: 200, epoch: 1 | loss: 0.5133078
	speed: 0.0093s/iter; left time: 205.2804s
	iters: 300, epoch: 1 | loss: 0.4962732
	speed: 0.0089s/iter; left time: 196.1362s
	iters: 400, epoch: 1 | loss: 0.4354440
	speed: 0.0088s/iter; left time: 194.4013s
	iters: 500, epoch: 1 | loss: 0.7496409
	speed: 0.0100s/iter; left time: 219.9761s
	iters: 600, epoch: 1 | loss: 0.6514819
	speed: 0.0089s/iter; left time: 194.9161s
	iters: 700, epoch: 1 | loss: 0.5805771
	speed: 0.0084s/iter; left time: 181.9686s
	iters: 800, epoch: 1 | loss: 0.7182031
	speed: 0.0091s/iter; left time: 197.2303s
	iters: 900, epoch: 1 | loss: 0.4000611
	speed: 0.0094s/iter; left time: 202.7697s
	iters: 1000, epoch: 1 | loss: 0.4893758
	speed: 0.0094s/iter; left time: 200.7432s
	iters: 1100, epoch: 1 | loss: 0.7296202
	speed: 0.0110s/iter; left time: 234.7620s
	iters: 1200, epoch: 1 | loss: 0.7024474
	speed: 0.0090s/iter; left time: 190.8514s
	iters: 1300, epoch: 1 | loss: 0.6395227
	speed: 0.0086s/iter; left time: 180.7946s
	iters: 1400, epoch: 1 | loss: 0.4803551
	speed: 0.0090s/iter; left time: 188.2177s
	iters: 1500, epoch: 1 | loss: 0.5088798
	speed: 0.0087s/iter; left time: 180.9087s
	iters: 1600, epoch: 1 | loss: 0.4559751
	speed: 0.0087s/iter; left time: 180.8333s
	iters: 1700, epoch: 1 | loss: 0.5539311
	speed: 0.0086s/iter; left time: 178.7900s
	iters: 1800, epoch: 1 | loss: 0.3808300
	speed: 0.0088s/iter; left time: 181.8179s
	iters: 1900, epoch: 1 | loss: 0.4800062
	speed: 0.0087s/iter; left time: 178.2223s
	iters: 2000, epoch: 1 | loss: 0.5854161
	speed: 0.0090s/iter; left time: 183.4901s
	iters: 2100, epoch: 1 | loss: 0.8751794
	speed: 0.0086s/iter; left time: 174.8345s
	iters: 2200, epoch: 1 | loss: 0.4034612
	speed: 0.0086s/iter; left time: 173.0892s
Epoch: 1 cost time: 21.04460310935974
Epoch: 1, Steps: 2239 | Train Loss: 0.5991805 Vali Loss: 0.6404324 Test Loss: 0.3341514
Validation loss decreased (inf --> 0.640432).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6949592
	speed: 0.0962s/iter; left time: 1929.1876s
	iters: 200, epoch: 2 | loss: 0.7131475
	speed: 0.0087s/iter; left time: 172.5927s
	iters: 300, epoch: 2 | loss: 0.4630849
	speed: 0.0086s/iter; left time: 170.0258s
	iters: 400, epoch: 2 | loss: 0.7521006
	speed: 0.0089s/iter; left time: 176.6878s
	iters: 500, epoch: 2 | loss: 0.5481595
	speed: 0.0085s/iter; left time: 167.4353s
	iters: 600, epoch: 2 | loss: 0.8358968
	speed: 0.0086s/iter; left time: 168.8860s
	iters: 700, epoch: 2 | loss: 0.7562217
	speed: 0.0079s/iter; left time: 153.9819s
	iters: 800, epoch: 2 | loss: 0.5620819
	speed: 0.0082s/iter; left time: 158.3032s
	iters: 900, epoch: 2 | loss: 0.5725763
	speed: 0.0085s/iter; left time: 163.0730s
	iters: 1000, epoch: 2 | loss: 0.4711180
	speed: 0.0088s/iter; left time: 168.5066s
	iters: 1100, epoch: 2 | loss: 0.5678912
	speed: 0.0089s/iter; left time: 170.4623s
	iters: 1200, epoch: 2 | loss: 0.4747879
	speed: 0.0091s/iter; left time: 173.4071s
	iters: 1300, epoch: 2 | loss: 0.5038454
	speed: 0.0093s/iter; left time: 176.0425s
	iters: 1400, epoch: 2 | loss: 0.4217463
	speed: 0.0090s/iter; left time: 169.0839s
	iters: 1500, epoch: 2 | loss: 0.4991961
	speed: 0.0089s/iter; left time: 165.3904s
	iters: 1600, epoch: 2 | loss: 0.5475776
	speed: 0.0087s/iter; left time: 161.0638s
	iters: 1700, epoch: 2 | loss: 0.5243732
	speed: 0.0096s/iter; left time: 176.3639s
	iters: 1800, epoch: 2 | loss: 0.5901618
	speed: 0.0099s/iter; left time: 181.7104s
	iters: 1900, epoch: 2 | loss: 0.4473544
	speed: 0.0093s/iter; left time: 169.4006s
	iters: 2000, epoch: 2 | loss: 0.4640885
	speed: 0.0095s/iter; left time: 171.7563s
	iters: 2100, epoch: 2 | loss: 0.5097836
	speed: 0.0089s/iter; left time: 160.2933s
	iters: 2200, epoch: 2 | loss: 0.4488504
	speed: 0.0099s/iter; left time: 177.9631s
Epoch: 2 cost time: 20.856241464614868
Epoch: 2, Steps: 2239 | Train Loss: 0.5782473 Vali Loss: 0.6119772 Test Loss: 0.3166423
Validation loss decreased (0.640432 --> 0.611977).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4397623
	speed: 0.0977s/iter; left time: 1740.0938s
	iters: 200, epoch: 3 | loss: 0.4307105
	speed: 0.0087s/iter; left time: 153.9715s
	iters: 300, epoch: 3 | loss: 0.4141614
	speed: 0.0084s/iter; left time: 147.7244s
	iters: 400, epoch: 3 | loss: 0.3872942
	speed: 0.0085s/iter; left time: 149.6168s
	iters: 500, epoch: 3 | loss: 0.5314484
	speed: 0.0081s/iter; left time: 141.8545s
	iters: 600, epoch: 3 | loss: 0.5690590
	speed: 0.0081s/iter; left time: 140.9811s
	iters: 700, epoch: 3 | loss: 0.4609820
	speed: 0.0080s/iter; left time: 138.2018s
	iters: 800, epoch: 3 | loss: 0.4414902
	speed: 0.0085s/iter; left time: 145.3954s
	iters: 900, epoch: 3 | loss: 0.7402356
	speed: 0.0086s/iter; left time: 145.6234s
	iters: 1000, epoch: 3 | loss: 0.5600895
	speed: 0.0084s/iter; left time: 142.8765s
	iters: 1100, epoch: 3 | loss: 0.5285292
	speed: 0.0085s/iter; left time: 143.2537s
	iters: 1200, epoch: 3 | loss: 0.8145358
	speed: 0.0086s/iter; left time: 144.1971s
	iters: 1300, epoch: 3 | loss: 0.4855670
	speed: 0.0081s/iter; left time: 134.2173s
	iters: 1400, epoch: 3 | loss: 0.4239092
	speed: 0.0091s/iter; left time: 150.0482s
	iters: 1500, epoch: 3 | loss: 0.4877328
	speed: 0.0085s/iter; left time: 140.2528s
	iters: 1600, epoch: 3 | loss: 0.5677102
	speed: 0.0085s/iter; left time: 138.8410s
	iters: 1700, epoch: 3 | loss: 0.6602710
	speed: 0.0087s/iter; left time: 141.4908s
	iters: 1800, epoch: 3 | loss: 0.4547526
	speed: 0.0087s/iter; left time: 140.2355s
	iters: 1900, epoch: 3 | loss: 0.4283315
	speed: 0.0086s/iter; left time: 137.4146s
	iters: 2000, epoch: 3 | loss: 0.4205646
	speed: 0.0084s/iter; left time: 133.8480s
	iters: 2100, epoch: 3 | loss: 0.8032194
	speed: 0.0086s/iter; left time: 135.4564s
	iters: 2200, epoch: 3 | loss: 0.5580372
	speed: 0.0088s/iter; left time: 138.0920s
Epoch: 3 cost time: 19.79850673675537
Epoch: 3, Steps: 2239 | Train Loss: 0.5607062 Vali Loss: 0.6083565 Test Loss: 0.3202463
Validation loss decreased (0.611977 --> 0.608357).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3926144
	speed: 0.0940s/iter; left time: 1464.6996s
	iters: 200, epoch: 4 | loss: 0.6215902
	speed: 0.0086s/iter; left time: 133.5380s
	iters: 300, epoch: 4 | loss: 0.4875522
	speed: 0.0084s/iter; left time: 128.5491s
	iters: 400, epoch: 4 | loss: 0.4953527
	speed: 0.0082s/iter; left time: 124.5001s
	iters: 500, epoch: 4 | loss: 1.0896980
	speed: 0.0086s/iter; left time: 130.0961s
	iters: 600, epoch: 4 | loss: 0.4662383
	speed: 0.0086s/iter; left time: 129.8918s
	iters: 700, epoch: 4 | loss: 0.4082948
	speed: 0.0083s/iter; left time: 124.9805s
	iters: 800, epoch: 4 | loss: 0.4720720
	speed: 0.0082s/iter; left time: 122.1207s
	iters: 900, epoch: 4 | loss: 0.4173881
	speed: 0.0084s/iter; left time: 123.6800s
	iters: 1000, epoch: 4 | loss: 0.4258911
	speed: 0.0084s/iter; left time: 123.7282s
	iters: 1100, epoch: 4 | loss: 0.4482705
	speed: 0.0083s/iter; left time: 121.5278s
	iters: 1200, epoch: 4 | loss: 0.4631662
	speed: 0.0083s/iter; left time: 120.8411s
	iters: 1300, epoch: 4 | loss: 0.7580281
	speed: 0.0085s/iter; left time: 121.6932s
	iters: 1400, epoch: 4 | loss: 0.5219693
	speed: 0.0087s/iter; left time: 124.0584s
	iters: 1500, epoch: 4 | loss: 0.4711388
	speed: 0.0086s/iter; left time: 122.0901s
	iters: 1600, epoch: 4 | loss: 0.3873649
	speed: 0.0090s/iter; left time: 126.0079s
	iters: 1700, epoch: 4 | loss: 0.4796796
	speed: 0.0085s/iter; left time: 118.9121s
	iters: 1800, epoch: 4 | loss: 0.4856274
	speed: 0.0086s/iter; left time: 118.8840s
	iters: 1900, epoch: 4 | loss: 0.4241402
	speed: 0.0084s/iter; left time: 115.6026s
	iters: 2000, epoch: 4 | loss: 0.5662102
	speed: 0.0083s/iter; left time: 113.4049s
	iters: 2100, epoch: 4 | loss: 0.5591770
	speed: 0.0085s/iter; left time: 115.0957s
	iters: 2200, epoch: 4 | loss: 0.3930334
	speed: 0.0085s/iter; left time: 114.3989s
Epoch: 4 cost time: 19.69632649421692
Epoch: 4, Steps: 2239 | Train Loss: 0.5524697 Vali Loss: 0.6014106 Test Loss: 0.3213683
Validation loss decreased (0.608357 --> 0.601411).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5809820
	speed: 0.0992s/iter; left time: 1322.5049s
	iters: 200, epoch: 5 | loss: 0.6137769
	speed: 0.0085s/iter; left time: 113.0272s
	iters: 300, epoch: 5 | loss: 0.4609444
	speed: 0.0087s/iter; left time: 113.7443s
	iters: 400, epoch: 5 | loss: 0.6876698
	speed: 0.0084s/iter; left time: 109.3170s
	iters: 500, epoch: 5 | loss: 0.6245200
	speed: 0.0084s/iter; left time: 108.8052s
	iters: 600, epoch: 5 | loss: 0.5371158
	speed: 0.0083s/iter; left time: 105.9931s
	iters: 700, epoch: 5 | loss: 0.5466502
	speed: 0.0085s/iter; left time: 107.7207s
	iters: 800, epoch: 5 | loss: 0.5915105
	speed: 0.0084s/iter; left time: 106.6121s
	iters: 900, epoch: 5 | loss: 0.4113807
	speed: 0.0085s/iter; left time: 106.8679s
	iters: 1000, epoch: 5 | loss: 0.4698972
	speed: 0.0087s/iter; left time: 107.8183s
	iters: 1100, epoch: 5 | loss: 0.4509293
	speed: 0.0087s/iter; left time: 107.8015s
	iters: 1200, epoch: 5 | loss: 0.4086349
	speed: 0.0085s/iter; left time: 103.6782s
	iters: 1300, epoch: 5 | loss: 0.5134065
	speed: 0.0086s/iter; left time: 104.0833s
	iters: 1400, epoch: 5 | loss: 0.4260881
	speed: 0.0086s/iter; left time: 102.9109s
	iters: 1500, epoch: 5 | loss: 0.5153993
	speed: 0.0087s/iter; left time: 103.6017s
	iters: 1600, epoch: 5 | loss: 0.5650135
	speed: 0.0089s/iter; left time: 105.3539s
	iters: 1700, epoch: 5 | loss: 0.6309094
	speed: 0.0086s/iter; left time: 100.7406s
	iters: 1800, epoch: 5 | loss: 0.9995605
	speed: 0.0084s/iter; left time: 97.8405s
	iters: 1900, epoch: 5 | loss: 0.3534395
	speed: 0.0083s/iter; left time: 95.2626s
	iters: 2000, epoch: 5 | loss: 0.4045680
	speed: 0.0084s/iter; left time: 95.5197s
	iters: 2100, epoch: 5 | loss: 0.4558199
	speed: 0.0082s/iter; left time: 92.6320s
	iters: 2200, epoch: 5 | loss: 0.5107513
	speed: 0.0084s/iter; left time: 94.3100s
Epoch: 5 cost time: 19.79601788520813
Epoch: 5, Steps: 2239 | Train Loss: 0.5483062 Vali Loss: 0.6035248 Test Loss: 0.3195614
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.7752118
	speed: 0.0920s/iter; left time: 1021.1363s
	iters: 200, epoch: 6 | loss: 0.4455741
	speed: 0.0086s/iter; left time: 95.0561s
	iters: 300, epoch: 6 | loss: 0.4586833
	speed: 0.0090s/iter; left time: 98.5060s
	iters: 400, epoch: 6 | loss: 0.4564108
	speed: 0.0100s/iter; left time: 108.4698s
	iters: 500, epoch: 6 | loss: 0.3682918
	speed: 0.0095s/iter; left time: 101.4618s
	iters: 600, epoch: 6 | loss: 0.6236373
	speed: 0.0098s/iter; left time: 103.3498s
	iters: 700, epoch: 6 | loss: 0.5086033
	speed: 0.0092s/iter; left time: 96.2867s
	iters: 800, epoch: 6 | loss: 0.4712832
	speed: 0.0095s/iter; left time: 98.8038s
	iters: 900, epoch: 6 | loss: 0.4156194
	speed: 0.0092s/iter; left time: 95.0811s
	iters: 1000, epoch: 6 | loss: 0.3472844
	speed: 0.0095s/iter; left time: 96.8311s
	iters: 1100, epoch: 6 | loss: 0.4107656
	speed: 0.0096s/iter; left time: 96.5616s
	iters: 1200, epoch: 6 | loss: 0.4709391
	speed: 0.0095s/iter; left time: 94.6269s
	iters: 1300, epoch: 6 | loss: 0.4857491
	speed: 0.0101s/iter; left time: 99.7597s
	iters: 1400, epoch: 6 | loss: 0.4387860
	speed: 0.0089s/iter; left time: 87.3417s
	iters: 1500, epoch: 6 | loss: 0.5023345
	speed: 0.0076s/iter; left time: 73.2708s
	iters: 1600, epoch: 6 | loss: 0.6072044
	speed: 0.0086s/iter; left time: 82.6464s
	iters: 1700, epoch: 6 | loss: 0.3899059
	speed: 0.0086s/iter; left time: 81.9802s
	iters: 1800, epoch: 6 | loss: 0.4436556
	speed: 0.0088s/iter; left time: 82.6557s
	iters: 1900, epoch: 6 | loss: 0.4072081
	speed: 0.0090s/iter; left time: 83.9212s
	iters: 2000, epoch: 6 | loss: 0.3742607
	speed: 0.0100s/iter; left time: 91.9788s
	iters: 2100, epoch: 6 | loss: 0.4457685
	speed: 0.0095s/iter; left time: 86.1203s
	iters: 2200, epoch: 6 | loss: 0.4839266
	speed: 0.0089s/iter; left time: 80.0051s
Epoch: 6 cost time: 21.291526794433594
Epoch: 6, Steps: 2239 | Train Loss: 0.5458682 Vali Loss: 0.6015153 Test Loss: 0.3194722
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3929905
	speed: 0.0914s/iter; left time: 809.7860s
	iters: 200, epoch: 7 | loss: 0.6684918
	speed: 0.0083s/iter; left time: 72.7371s
	iters: 300, epoch: 7 | loss: 0.3857031
	speed: 0.0084s/iter; left time: 73.0388s
	iters: 400, epoch: 7 | loss: 0.4418410
	speed: 0.0083s/iter; left time: 70.8273s
	iters: 500, epoch: 7 | loss: 0.4699309
	speed: 0.0084s/iter; left time: 71.0033s
	iters: 600, epoch: 7 | loss: 0.7240574
	speed: 0.0084s/iter; left time: 70.3478s
	iters: 700, epoch: 7 | loss: 0.6454189
	speed: 0.0086s/iter; left time: 70.9643s
	iters: 800, epoch: 7 | loss: 0.3627942
	speed: 0.0085s/iter; left time: 69.6701s
	iters: 900, epoch: 7 | loss: 0.4819293
	speed: 0.0083s/iter; left time: 66.9284s
	iters: 1000, epoch: 7 | loss: 0.4701187
	speed: 0.0081s/iter; left time: 64.2316s
	iters: 1100, epoch: 7 | loss: 0.3992930
	speed: 0.0085s/iter; left time: 66.4724s
	iters: 1200, epoch: 7 | loss: 0.4624784
	speed: 0.0085s/iter; left time: 65.6164s
	iters: 1300, epoch: 7 | loss: 0.4116154
	speed: 0.0080s/iter; left time: 60.9381s
	iters: 1400, epoch: 7 | loss: 0.4902841
	speed: 0.0085s/iter; left time: 64.3544s
	iters: 1500, epoch: 7 | loss: 0.8307602
	speed: 0.0085s/iter; left time: 63.6439s
	iters: 1600, epoch: 7 | loss: 0.4353190
	speed: 0.0081s/iter; left time: 59.8434s
	iters: 1700, epoch: 7 | loss: 0.4262613
	speed: 0.0083s/iter; left time: 60.4893s
	iters: 1800, epoch: 7 | loss: 0.7488182
	speed: 0.0083s/iter; left time: 59.5783s
	iters: 1900, epoch: 7 | loss: 0.6520468
	speed: 0.0082s/iter; left time: 57.9878s
	iters: 2000, epoch: 7 | loss: 0.4442266
	speed: 0.0083s/iter; left time: 57.7062s
	iters: 2100, epoch: 7 | loss: 0.5684624
	speed: 0.0087s/iter; left time: 59.5291s
	iters: 2200, epoch: 7 | loss: 0.6196954
	speed: 0.0083s/iter; left time: 55.7915s
Epoch: 7 cost time: 19.433656930923462
Epoch: 7, Steps: 2239 | Train Loss: 0.5447462 Vali Loss: 0.6035222 Test Loss: 0.3178174
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_720_DNGLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32131925225257874, mae:0.3504825830459595
