Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='traffic_336_48', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=48, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_48_DNGRevLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1709
test 3461
	iters: 100, epoch: 1 | loss: 0.2643132
	speed: 0.8609s/iter; left time: 6311.2878s
	iters: 200, epoch: 1 | loss: 0.2311525
	speed: 0.8102s/iter; left time: 5858.3433s
	iters: 300, epoch: 1 | loss: 0.2274343
	speed: 0.7949s/iter; left time: 5668.4314s
	iters: 400, epoch: 1 | loss: 0.2285824
	speed: 0.8297s/iter; left time: 5833.5468s
	iters: 500, epoch: 1 | loss: 0.2612929
	speed: 0.8166s/iter; left time: 5659.5429s
	iters: 600, epoch: 1 | loss: 0.2380447
	speed: 0.8360s/iter; left time: 5711.0513s
	iters: 700, epoch: 1 | loss: 0.2023782
	speed: 0.8109s/iter; left time: 5458.0376s
Epoch: 1 cost time: 612.2794196605682
Epoch: 1, Steps: 743 | Train Loss: 0.2550144 Vali Loss: 0.3479015 Test Loss: 0.4049342
Validation loss decreased (inf --> 0.347901).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2565586
	speed: 1.7410s/iter; left time: 11469.8596s
	iters: 200, epoch: 2 | loss: 0.2133892
	speed: 0.8073s/iter; left time: 5237.8461s
	iters: 300, epoch: 2 | loss: 0.2295379
	speed: 0.7962s/iter; left time: 5086.3963s
	iters: 400, epoch: 2 | loss: 0.2222684
	speed: 0.8208s/iter; left time: 5161.2969s
	iters: 500, epoch: 2 | loss: 0.2524820
	speed: 0.7985s/iter; left time: 4941.1104s
	iters: 600, epoch: 2 | loss: 0.2047244
	speed: 0.8009s/iter; left time: 4875.9073s
	iters: 700, epoch: 2 | loss: 0.1974365
	speed: 0.8068s/iter; left time: 4831.1571s
Epoch: 2 cost time: 601.1703569889069
Epoch: 2, Steps: 743 | Train Loss: 0.2251879 Vali Loss: 0.3457748 Test Loss: 0.3979907
Validation loss decreased (0.347901 --> 0.345775).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2014819
	speed: 1.7597s/iter; left time: 10285.2107s
	iters: 200, epoch: 3 | loss: 0.1912209
	speed: 0.8405s/iter; left time: 4828.9306s
	iters: 300, epoch: 3 | loss: 0.2057136
	speed: 0.8132s/iter; left time: 4590.2781s
	iters: 400, epoch: 3 | loss: 0.1907397
	speed: 0.8020s/iter; left time: 4446.9484s
	iters: 500, epoch: 3 | loss: 0.1807187
	speed: 0.8103s/iter; left time: 4412.1768s
	iters: 600, epoch: 3 | loss: 0.1792924
	speed: 0.7948s/iter; left time: 4248.0971s
	iters: 700, epoch: 3 | loss: 0.1686286
	speed: 0.8061s/iter; left time: 4227.8324s
Epoch: 3 cost time: 606.9886696338654
Epoch: 3, Steps: 743 | Train Loss: 0.2143462 Vali Loss: 0.3364913 Test Loss: 0.3866137
Validation loss decreased (0.345775 --> 0.336491).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2229642
	speed: 1.7497s/iter; left time: 8926.7723s
	iters: 200, epoch: 4 | loss: 0.2242827
	speed: 0.8010s/iter; left time: 4006.6069s
	iters: 300, epoch: 4 | loss: 0.1854484
	speed: 0.7939s/iter; left time: 3891.5025s
	iters: 400, epoch: 4 | loss: 0.1831598
	speed: 0.8035s/iter; left time: 3858.3559s
	iters: 500, epoch: 4 | loss: 0.1751649
	speed: 0.8261s/iter; left time: 3884.5210s
	iters: 600, epoch: 4 | loss: 0.2064743
	speed: 0.8158s/iter; left time: 3754.3334s
	iters: 700, epoch: 4 | loss: 0.2082510
	speed: 0.8157s/iter; left time: 3672.0568s
Epoch: 4 cost time: 601.4970502853394
Epoch: 4, Steps: 743 | Train Loss: 0.2095959 Vali Loss: 0.3349356 Test Loss: 0.3835827
Validation loss decreased (0.336491 --> 0.334936).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1851951
	speed: 1.7209s/iter; left time: 7501.2342s
	iters: 200, epoch: 5 | loss: 0.1955546
	speed: 0.8379s/iter; left time: 3568.4476s
	iters: 300, epoch: 5 | loss: 0.2230114
	speed: 0.8086s/iter; left time: 3362.8752s
	iters: 400, epoch: 5 | loss: 0.2563787
	speed: 0.7984s/iter; left time: 3240.8234s
	iters: 500, epoch: 5 | loss: 0.2199512
	speed: 0.8059s/iter; left time: 3190.5841s
	iters: 600, epoch: 5 | loss: 0.2091179
	speed: 0.8114s/iter; left time: 3131.0054s
	iters: 700, epoch: 5 | loss: 0.2508160
	speed: 0.7918s/iter; left time: 2976.2777s
Epoch: 5 cost time: 599.887204170227
Epoch: 5, Steps: 743 | Train Loss: 0.2072200 Vali Loss: 0.3337422 Test Loss: 0.3821174
Validation loss decreased (0.334936 --> 0.333742).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2123218
	speed: 1.6967s/iter; left time: 6135.2628s
	iters: 200, epoch: 6 | loss: 0.1838629
	speed: 0.7919s/iter; left time: 2784.2060s
	iters: 300, epoch: 6 | loss: 0.1846963
	speed: 0.7997s/iter; left time: 2731.8363s
	iters: 400, epoch: 6 | loss: 0.2079971
	speed: 0.7998s/iter; left time: 2651.9894s
	iters: 500, epoch: 6 | loss: 0.2043307
	speed: 0.8034s/iter; left time: 2583.7500s
	iters: 600, epoch: 6 | loss: 0.2075185
	speed: 0.7951s/iter; left time: 2477.6370s
	iters: 700, epoch: 6 | loss: 0.2086489
	speed: 0.8073s/iter; left time: 2434.8169s
Epoch: 6 cost time: 593.6768145561218
Epoch: 6, Steps: 743 | Train Loss: 0.2059278 Vali Loss: 0.3331586 Test Loss: 0.3809263
Validation loss decreased (0.333742 --> 0.333159).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2591789
	speed: 1.7406s/iter; left time: 5000.7294s
	iters: 200, epoch: 7 | loss: 0.1969468
	speed: 0.8055s/iter; left time: 2233.5599s
	iters: 300, epoch: 7 | loss: 0.1822435
	speed: 0.8173s/iter; left time: 2184.5988s
	iters: 400, epoch: 7 | loss: 0.2094415
	speed: 0.8057s/iter; left time: 2073.1789s
	iters: 500, epoch: 7 | loss: 0.1968370
	speed: 0.8571s/iter; left time: 2119.6046s
	iters: 600, epoch: 7 | loss: 0.1730114
	speed: 0.8128s/iter; left time: 1928.7191s
	iters: 700, epoch: 7 | loss: 0.2118517
	speed: 0.8162s/iter; left time: 1855.2943s
Epoch: 7 cost time: 608.9456467628479
Epoch: 7, Steps: 743 | Train Loss: 0.2053117 Vali Loss: 0.3326414 Test Loss: 0.3807991
Validation loss decreased (0.333159 --> 0.332641).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1897380
	speed: 1.7113s/iter; left time: 3645.1676s
	iters: 200, epoch: 8 | loss: 0.2008824
	speed: 0.7847s/iter; left time: 1593.0291s
	iters: 300, epoch: 8 | loss: 0.2300082
	speed: 0.8049s/iter; left time: 1553.5377s
	iters: 400, epoch: 8 | loss: 0.2228878
	speed: 0.8290s/iter; left time: 1517.1070s
	iters: 500, epoch: 8 | loss: 0.2076712
	speed: 0.8249s/iter; left time: 1427.0882s
	iters: 600, epoch: 8 | loss: 0.2166553
	speed: 0.8475s/iter; left time: 1381.4691s
	iters: 700, epoch: 8 | loss: 0.1895469
	speed: 0.7911s/iter; left time: 1210.4214s
Epoch: 8 cost time: 602.2962429523468
Epoch: 8, Steps: 743 | Train Loss: 0.2049621 Vali Loss: 0.3326661 Test Loss: 0.3803780
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1973022
	speed: 1.6922s/iter; left time: 2347.0731s
	iters: 200, epoch: 9 | loss: 0.2068301
	speed: 0.8068s/iter; left time: 1038.3003s
	iters: 300, epoch: 9 | loss: 0.1749052
	speed: 0.8093s/iter; left time: 960.6392s
	iters: 400, epoch: 9 | loss: 0.2346391
	speed: 0.7938s/iter; left time: 862.8577s
	iters: 500, epoch: 9 | loss: 0.2254901
	speed: 0.8342s/iter; left time: 823.3884s
	iters: 600, epoch: 9 | loss: 0.2525189
	speed: 0.7909s/iter; left time: 701.5716s
	iters: 700, epoch: 9 | loss: 0.1849571
	speed: 0.7899s/iter; left time: 621.6355s
Epoch: 9 cost time: 596.6572473049164
Epoch: 9, Steps: 743 | Train Loss: 0.2047539 Vali Loss: 0.3321374 Test Loss: 0.3802528
Validation loss decreased (0.332641 --> 0.332137).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2315215
	speed: 1.6988s/iter; left time: 1094.0369s
	iters: 200, epoch: 10 | loss: 0.1894571
	speed: 0.8030s/iter; left time: 436.8209s
	iters: 300, epoch: 10 | loss: 0.1855452
	speed: 0.7906s/iter; left time: 351.0225s
	iters: 400, epoch: 10 | loss: 0.1518288
	speed: 0.7898s/iter; left time: 271.6946s
	iters: 500, epoch: 10 | loss: 0.2046232
	speed: 0.8021s/iter; left time: 195.7094s
	iters: 600, epoch: 10 | loss: 0.1825194
	speed: 0.8072s/iter; left time: 116.2435s
	iters: 700, epoch: 10 | loss: 0.2015128
	speed: 0.8192s/iter; left time: 36.0430s
Epoch: 10 cost time: 595.8707933425903
Epoch: 10, Steps: 743 | Train Loss: 0.2046767 Vali Loss: 0.3325735 Test Loss: 0.3802165
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_48_DNGRevLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3461
mse:0.3808808922767639, mae:0.27041909098625183
