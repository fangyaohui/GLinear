Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DNGRevLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.2678088
	speed: 0.8355s/iter; left time: 6049.7440s
	iters: 200, epoch: 1 | loss: 0.2520383
	speed: 0.8276s/iter; left time: 5909.5795s
	iters: 300, epoch: 1 | loss: 0.2478035
	speed: 0.8312s/iter; left time: 5852.4108s
	iters: 400, epoch: 1 | loss: 0.2449371
	speed: 0.8335s/iter; left time: 5785.3212s
	iters: 500, epoch: 1 | loss: 0.2742965
	speed: 0.8499s/iter; left time: 5814.1425s
	iters: 600, epoch: 1 | loss: 0.2721639
	speed: 0.8157s/iter; left time: 5498.7315s
	iters: 700, epoch: 1 | loss: 0.2658568
	speed: 0.8098s/iter; left time: 5378.1291s
Epoch: 1 cost time: 609.4704613685608
Epoch: 1, Steps: 734 | Train Loss: 0.2727376 Vali Loss: 0.3633098 Test Loss: 0.4388084
Validation loss decreased (inf --> 0.363310).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2709652
	speed: 1.7360s/iter; left time: 11296.3979s
	iters: 200, epoch: 2 | loss: 0.2371356
	speed: 0.7881s/iter; left time: 5049.0861s
	iters: 300, epoch: 2 | loss: 0.2259791
	speed: 0.8201s/iter; left time: 5172.2069s
	iters: 400, epoch: 2 | loss: 0.2407304
	speed: 0.8155s/iter; left time: 5061.6172s
	iters: 500, epoch: 2 | loss: 0.2321461
	speed: 0.7971s/iter; left time: 4867.6471s
	iters: 600, epoch: 2 | loss: 0.2479584
	speed: 0.9195s/iter; left time: 5523.3232s
	iters: 700, epoch: 2 | loss: 0.2267357
	speed: 0.8977s/iter; left time: 5302.9769s
Epoch: 2 cost time: 616.81338763237
Epoch: 2, Steps: 734 | Train Loss: 0.2417989 Vali Loss: 0.3602962 Test Loss: 0.4323796
Validation loss decreased (0.363310 --> 0.360296).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2349116
	speed: 1.7979s/iter; left time: 10379.5385s
	iters: 200, epoch: 3 | loss: 0.2297589
	speed: 0.8680s/iter; left time: 4924.2530s
	iters: 300, epoch: 3 | loss: 0.2152128
	speed: 0.8574s/iter; left time: 4778.5546s
	iters: 400, epoch: 3 | loss: 0.2424304
	speed: 0.9454s/iter; left time: 5174.3831s
	iters: 500, epoch: 3 | loss: 0.2371043
	speed: 0.8585s/iter; left time: 4612.6307s
	iters: 600, epoch: 3 | loss: 0.2233999
	speed: 0.8674s/iter; left time: 4573.7843s
	iters: 700, epoch: 3 | loss: 0.2469658
	speed: 0.8784s/iter; left time: 4544.1700s
Epoch: 3 cost time: 645.079491853714
Epoch: 3, Steps: 734 | Train Loss: 0.2317196 Vali Loss: 0.3567250 Test Loss: 0.4274319
Validation loss decreased (0.360296 --> 0.356725).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2167491
	speed: 1.7736s/iter; left time: 8937.2708s
	iters: 200, epoch: 4 | loss: 0.2257189
	speed: 0.8622s/iter; left time: 4258.3087s
	iters: 300, epoch: 4 | loss: 0.2391872
	speed: 0.8928s/iter; left time: 4320.1791s
	iters: 400, epoch: 4 | loss: 0.2135627
	speed: 0.7995s/iter; left time: 3789.0122s
	iters: 500, epoch: 4 | loss: 0.2121489
	speed: 0.8444s/iter; left time: 3917.2594s
	iters: 600, epoch: 4 | loss: 0.2279247
	speed: 0.8241s/iter; left time: 3740.6774s
	iters: 700, epoch: 4 | loss: 0.2522436
	speed: 0.8293s/iter; left time: 3681.2162s
Epoch: 4 cost time: 629.4415752887726
Epoch: 4, Steps: 734 | Train Loss: 0.2272452 Vali Loss: 0.3548675 Test Loss: 0.4247209
Validation loss decreased (0.356725 --> 0.354867).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2234997
	speed: 1.8287s/iter; left time: 7872.6219s
	iters: 200, epoch: 5 | loss: 0.2075731
	speed: 0.8713s/iter; left time: 3663.9878s
	iters: 300, epoch: 5 | loss: 0.2133628
	speed: 0.8778s/iter; left time: 3603.2101s
	iters: 400, epoch: 5 | loss: 0.2224257
	speed: 0.8227s/iter; left time: 3295.0649s
	iters: 500, epoch: 5 | loss: 0.2482563
	speed: 0.8636s/iter; left time: 3372.4307s
	iters: 600, epoch: 5 | loss: 0.2171258
	speed: 0.9021s/iter; left time: 3432.6547s
	iters: 700, epoch: 5 | loss: 0.2318788
	speed: 0.8819s/iter; left time: 3267.4447s
Epoch: 5 cost time: 636.0909903049469
Epoch: 5, Steps: 734 | Train Loss: 0.2249033 Vali Loss: 0.3543770 Test Loss: 0.4235390
Validation loss decreased (0.354867 --> 0.354377).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2050152
	speed: 1.7186s/iter; left time: 6137.0557s
	iters: 200, epoch: 6 | loss: 0.2431165
	speed: 0.8602s/iter; left time: 2985.8530s
	iters: 300, epoch: 6 | loss: 0.2572733
	speed: 0.7935s/iter; left time: 2674.7745s
	iters: 400, epoch: 6 | loss: 0.2082675
	speed: 0.8446s/iter; left time: 2762.6738s
	iters: 500, epoch: 6 | loss: 0.2075523
	speed: 0.8467s/iter; left time: 2684.7815s
	iters: 600, epoch: 6 | loss: 0.2311197
	speed: 0.8346s/iter; left time: 2562.9049s
	iters: 700, epoch: 6 | loss: 0.2249808
	speed: 0.8578s/iter; left time: 2548.4346s
Epoch: 6 cost time: 618.7595074176788
Epoch: 6, Steps: 734 | Train Loss: 0.2237296 Vali Loss: 0.3532119 Test Loss: 0.4224174
Validation loss decreased (0.354377 --> 0.353212).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2091546
	speed: 1.8532s/iter; left time: 5257.5513s
	iters: 200, epoch: 7 | loss: 0.2166124
	speed: 0.8598s/iter; left time: 2353.1810s
	iters: 300, epoch: 7 | loss: 0.2282806
	speed: 0.8229s/iter; left time: 2170.0320s
	iters: 400, epoch: 7 | loss: 0.2152672
	speed: 0.8281s/iter; left time: 2100.9709s
	iters: 500, epoch: 7 | loss: 0.2162820
	speed: 0.8158s/iter; left time: 1988.0689s
	iters: 600, epoch: 7 | loss: 0.2201919
	speed: 0.8166s/iter; left time: 1908.4090s
	iters: 700, epoch: 7 | loss: 0.2105558
	speed: 0.8516s/iter; left time: 1905.1032s
Epoch: 7 cost time: 621.8983163833618
Epoch: 7, Steps: 734 | Train Loss: 0.2231255 Vali Loss: 0.3534584 Test Loss: 0.4224812
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2362839
	speed: 1.7748s/iter; left time: 3732.4992s
	iters: 200, epoch: 8 | loss: 0.2652581
	speed: 0.8843s/iter; left time: 1771.3116s
	iters: 300, epoch: 8 | loss: 0.2067979
	speed: 0.8335s/iter; left time: 1586.1421s
	iters: 400, epoch: 8 | loss: 0.2363116
	speed: 0.8226s/iter; left time: 1483.0726s
	iters: 500, epoch: 8 | loss: 0.1906622
	speed: 0.9244s/iter; left time: 1574.3338s
	iters: 600, epoch: 8 | loss: 0.2058498
	speed: 0.8531s/iter; left time: 1367.4527s
	iters: 700, epoch: 8 | loss: 0.2262588
	speed: 0.8369s/iter; left time: 1257.9076s
Epoch: 8 cost time: 631.8885591030121
Epoch: 8, Steps: 734 | Train Loss: 0.2227934 Vali Loss: 0.3533800 Test Loss: 0.4223765
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2086549
	speed: 1.7241s/iter; left time: 2360.3153s
	iters: 200, epoch: 9 | loss: 0.2088909
	speed: 0.8791s/iter; left time: 1115.6293s
	iters: 300, epoch: 9 | loss: 0.2260290
	speed: 0.8284s/iter; left time: 968.3693s
	iters: 400, epoch: 9 | loss: 0.2387450
	speed: 0.9021s/iter; left time: 964.3931s
	iters: 500, epoch: 9 | loss: 0.2317772
	speed: 0.8107s/iter; left time: 785.5504s
	iters: 600, epoch: 9 | loss: 0.2050280
	speed: 0.8552s/iter; left time: 743.2018s
	iters: 700, epoch: 9 | loss: 0.2316567
	speed: 0.8135s/iter; left time: 625.5745s
Epoch: 9 cost time: 620.1844356060028
Epoch: 9, Steps: 734 | Train Loss: 0.2226390 Vali Loss: 0.3531975 Test Loss: 0.4224041
Validation loss decreased (0.353212 --> 0.353198).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2288767
	speed: 1.7870s/iter; left time: 1134.7257s
	iters: 200, epoch: 10 | loss: 0.2246861
	speed: 0.8794s/iter; left time: 470.4668s
	iters: 300, epoch: 10 | loss: 0.2146941
	speed: 0.8850s/iter; left time: 384.9601s
	iters: 400, epoch: 10 | loss: 0.2242000
	speed: 0.8614s/iter; left time: 288.5684s
	iters: 500, epoch: 10 | loss: 0.2303797
	speed: 0.8536s/iter; left time: 200.5989s
	iters: 600, epoch: 10 | loss: 0.2032043
	speed: 0.7985s/iter; left time: 107.7929s
	iters: 700, epoch: 10 | loss: 0.2197284
	speed: 0.8226s/iter; left time: 28.7914s
Epoch: 10 cost time: 628.4174377918243
Epoch: 10, Steps: 734 | Train Loss: 0.2225302 Vali Loss: 0.3534143 Test Loss: 0.4223461
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_192_DNGRevLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4222712516784668, mae:0.28901031613349915
