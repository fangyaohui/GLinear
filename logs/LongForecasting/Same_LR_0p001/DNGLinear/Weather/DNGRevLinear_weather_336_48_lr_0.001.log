Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='weather_336_48', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=48, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_48_DNGRevLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5223
test 10492
	iters: 100, epoch: 1 | loss: 0.2513297
	speed: 0.0366s/iter; left time: 830.7995s
	iters: 200, epoch: 1 | loss: 0.1902245
	speed: 0.0306s/iter; left time: 690.9804s
	iters: 300, epoch: 1 | loss: 0.2024709
	speed: 0.0305s/iter; left time: 685.6454s
	iters: 400, epoch: 1 | loss: 0.2279376
	speed: 0.0268s/iter; left time: 600.2936s
	iters: 500, epoch: 1 | loss: 0.1426806
	speed: 0.0307s/iter; left time: 685.2338s
	iters: 600, epoch: 1 | loss: 3.2760408
	speed: 0.0295s/iter; left time: 654.6845s
	iters: 700, epoch: 1 | loss: 0.2631561
	speed: 0.0297s/iter; left time: 656.5883s
	iters: 800, epoch: 1 | loss: 0.2081058
	speed: 0.0309s/iter; left time: 679.8626s
	iters: 900, epoch: 1 | loss: 0.1202421
	speed: 0.0312s/iter; left time: 683.8183s
	iters: 1000, epoch: 1 | loss: 0.1666184
	speed: 0.0300s/iter; left time: 655.3600s
	iters: 1100, epoch: 1 | loss: 0.2145385
	speed: 0.0299s/iter; left time: 649.6759s
	iters: 1200, epoch: 1 | loss: 0.2302872
	speed: 0.0294s/iter; left time: 635.2420s
	iters: 1300, epoch: 1 | loss: 0.2113739
	speed: 0.0297s/iter; left time: 638.6105s
	iters: 1400, epoch: 1 | loss: 0.2014146
	speed: 0.0296s/iter; left time: 634.6139s
	iters: 1500, epoch: 1 | loss: 0.2336145
	speed: 0.0298s/iter; left time: 635.0661s
	iters: 1600, epoch: 1 | loss: 3.0495238
	speed: 0.0301s/iter; left time: 638.9421s
	iters: 1700, epoch: 1 | loss: 0.1793613
	speed: 0.0323s/iter; left time: 682.3331s
	iters: 1800, epoch: 1 | loss: 0.2178741
	speed: 0.0303s/iter; left time: 636.9656s
	iters: 1900, epoch: 1 | loss: 0.1176015
	speed: 0.0301s/iter; left time: 629.1391s
	iters: 2000, epoch: 1 | loss: 0.3046618
	speed: 0.0301s/iter; left time: 627.3875s
	iters: 2100, epoch: 1 | loss: 0.2328904
	speed: 0.0303s/iter; left time: 628.2732s
	iters: 2200, epoch: 1 | loss: 0.1473531
	speed: 0.0300s/iter; left time: 617.8236s
Epoch: 1 cost time: 69.36214661598206
Epoch: 1, Steps: 2281 | Train Loss: 0.3639700 Vali Loss: 0.3165815 Test Loss: 0.1225907
Validation loss decreased (inf --> 0.316581).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4067227
	speed: 0.1589s/iter; left time: 3246.0935s
	iters: 200, epoch: 2 | loss: 0.2448682
	speed: 0.0302s/iter; left time: 613.5064s
	iters: 300, epoch: 2 | loss: 0.2830914
	speed: 0.0305s/iter; left time: 617.2609s
	iters: 400, epoch: 2 | loss: 0.3001895
	speed: 0.0303s/iter; left time: 610.7203s
	iters: 500, epoch: 2 | loss: 0.1841711
	speed: 0.0297s/iter; left time: 594.7585s
	iters: 600, epoch: 2 | loss: 0.2572505
	speed: 0.0298s/iter; left time: 594.4731s
	iters: 700, epoch: 2 | loss: 0.2705962
	speed: 0.0302s/iter; left time: 599.3050s
	iters: 800, epoch: 2 | loss: 0.1162507
	speed: 0.0297s/iter; left time: 586.6898s
	iters: 900, epoch: 2 | loss: 0.1994367
	speed: 0.0298s/iter; left time: 584.4776s
	iters: 1000, epoch: 2 | loss: 0.3091960
	speed: 0.0301s/iter; left time: 587.7790s
	iters: 1100, epoch: 2 | loss: 0.3145252
	speed: 0.0299s/iter; left time: 580.2379s
	iters: 1200, epoch: 2 | loss: 0.2606719
	speed: 0.0299s/iter; left time: 577.6391s
	iters: 1300, epoch: 2 | loss: 0.1912406
	speed: 0.0302s/iter; left time: 581.1821s
	iters: 1400, epoch: 2 | loss: 0.1478732
	speed: 0.0306s/iter; left time: 584.7927s
	iters: 1500, epoch: 2 | loss: 0.2764753
	speed: 0.0301s/iter; left time: 573.1273s
	iters: 1600, epoch: 2 | loss: 0.3249636
	speed: 0.0303s/iter; left time: 573.9461s
	iters: 1700, epoch: 2 | loss: 0.2599374
	speed: 0.0280s/iter; left time: 527.6218s
	iters: 1800, epoch: 2 | loss: 0.2409709
	speed: 0.0295s/iter; left time: 552.2080s
	iters: 1900, epoch: 2 | loss: 0.2418390
	speed: 0.0299s/iter; left time: 556.2406s
	iters: 2000, epoch: 2 | loss: 0.3076599
	speed: 0.0299s/iter; left time: 553.8957s
	iters: 2100, epoch: 2 | loss: 0.3392825
	speed: 0.0302s/iter; left time: 556.2613s
	iters: 2200, epoch: 2 | loss: 0.2114109
	speed: 0.0301s/iter; left time: 551.7248s
Epoch: 2 cost time: 69.04262852668762
Epoch: 2, Steps: 2281 | Train Loss: 0.3495988 Vali Loss: 0.3127712 Test Loss: 0.1190745
Validation loss decreased (0.316581 --> 0.312771).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2198463
	speed: 0.1638s/iter; left time: 2973.2767s
	iters: 200, epoch: 3 | loss: 0.1206088
	speed: 0.0311s/iter; left time: 562.1891s
	iters: 300, epoch: 3 | loss: 0.1877438
	speed: 0.0304s/iter; left time: 545.8991s
	iters: 400, epoch: 3 | loss: 0.2890057
	speed: 0.0304s/iter; left time: 542.1084s
	iters: 500, epoch: 3 | loss: 0.4105534
	speed: 0.0301s/iter; left time: 533.4009s
	iters: 600, epoch: 3 | loss: 0.1344365
	speed: 0.0300s/iter; left time: 528.9215s
	iters: 700, epoch: 3 | loss: 0.3619111
	speed: 0.0301s/iter; left time: 528.9402s
	iters: 800, epoch: 3 | loss: 0.3593736
	speed: 0.0311s/iter; left time: 542.4862s
	iters: 900, epoch: 3 | loss: 0.4667047
	speed: 0.0301s/iter; left time: 522.8740s
	iters: 1000, epoch: 3 | loss: 0.1509132
	speed: 0.0301s/iter; left time: 519.3896s
	iters: 1100, epoch: 3 | loss: 0.2020274
	speed: 0.0297s/iter; left time: 508.6508s
	iters: 1200, epoch: 3 | loss: 0.3106705
	speed: 0.0297s/iter; left time: 506.4195s
	iters: 1300, epoch: 3 | loss: 0.2795903
	speed: 0.0300s/iter; left time: 508.3187s
	iters: 1400, epoch: 3 | loss: 0.2138583
	speed: 0.0302s/iter; left time: 509.0559s
	iters: 1500, epoch: 3 | loss: 0.1870216
	speed: 0.0297s/iter; left time: 497.8295s
	iters: 1600, epoch: 3 | loss: 0.1824561
	speed: 0.0322s/iter; left time: 535.7451s
	iters: 1700, epoch: 3 | loss: 0.1317369
	speed: 0.0312s/iter; left time: 515.7296s
	iters: 1800, epoch: 3 | loss: 0.2467811
	speed: 0.0311s/iter; left time: 511.0563s
	iters: 1900, epoch: 3 | loss: 0.2407335
	speed: 0.0305s/iter; left time: 498.4857s
	iters: 2000, epoch: 3 | loss: 0.1258398
	speed: 0.0315s/iter; left time: 511.7789s
	iters: 2100, epoch: 3 | loss: 0.2007312
	speed: 0.0305s/iter; left time: 492.7256s
	iters: 2200, epoch: 3 | loss: 0.2297799
	speed: 0.0309s/iter; left time: 495.5655s
Epoch: 3 cost time: 70.63340139389038
Epoch: 3, Steps: 2281 | Train Loss: 0.3249809 Vali Loss: 0.3152943 Test Loss: 0.1174990
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1089715
	speed: 0.1615s/iter; left time: 2562.2257s
	iters: 200, epoch: 4 | loss: 3.7575498
	speed: 0.0299s/iter; left time: 471.4526s
	iters: 300, epoch: 4 | loss: 0.4539295
	speed: 0.0307s/iter; left time: 481.6359s
	iters: 400, epoch: 4 | loss: 0.4769940
	speed: 0.0305s/iter; left time: 474.0846s
	iters: 500, epoch: 4 | loss: 0.7987735
	speed: 0.0300s/iter; left time: 464.6987s
	iters: 600, epoch: 4 | loss: 0.2059944
	speed: 0.0300s/iter; left time: 460.3387s
	iters: 700, epoch: 4 | loss: 0.1454005
	speed: 0.0300s/iter; left time: 457.3884s
	iters: 800, epoch: 4 | loss: 0.1610549
	speed: 0.0300s/iter; left time: 455.6486s
	iters: 900, epoch: 4 | loss: 0.2020285
	speed: 0.0300s/iter; left time: 452.0136s
	iters: 1000, epoch: 4 | loss: 0.2609518
	speed: 0.0293s/iter; left time: 438.9569s
	iters: 1100, epoch: 4 | loss: 0.1771890
	speed: 0.0299s/iter; left time: 443.9634s
	iters: 1200, epoch: 4 | loss: 0.4887485
	speed: 0.0300s/iter; left time: 443.1313s
	iters: 1300, epoch: 4 | loss: 0.1454352
	speed: 0.0301s/iter; left time: 440.8132s
	iters: 1400, epoch: 4 | loss: 0.1635065
	speed: 0.0306s/iter; left time: 446.4190s
	iters: 1500, epoch: 4 | loss: 0.2454413
	speed: 0.0303s/iter; left time: 438.4864s
	iters: 1600, epoch: 4 | loss: 0.2204564
	speed: 0.0301s/iter; left time: 432.4545s
	iters: 1700, epoch: 4 | loss: 0.3783723
	speed: 0.0301s/iter; left time: 428.9085s
	iters: 1800, epoch: 4 | loss: 0.3285932
	speed: 0.0295s/iter; left time: 418.2667s
	iters: 1900, epoch: 4 | loss: 0.1468218
	speed: 0.0296s/iter; left time: 416.4381s
	iters: 2000, epoch: 4 | loss: 0.3370196
	speed: 0.0298s/iter; left time: 416.9336s
	iters: 2100, epoch: 4 | loss: 0.2024529
	speed: 0.0284s/iter; left time: 393.3177s
	iters: 2200, epoch: 4 | loss: 0.1233835
	speed: 0.0301s/iter; left time: 414.6912s
Epoch: 4 cost time: 69.06709623336792
Epoch: 4, Steps: 2281 | Train Loss: 0.3180608 Vali Loss: 0.3189557 Test Loss: 0.1173853
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2681965
	speed: 0.1576s/iter; left time: 2140.6580s
	iters: 200, epoch: 5 | loss: 0.2160547
	speed: 0.0299s/iter; left time: 403.8900s
	iters: 300, epoch: 5 | loss: 0.1853130
	speed: 0.0302s/iter; left time: 403.7692s
	iters: 400, epoch: 5 | loss: 0.3563835
	speed: 0.0304s/iter; left time: 403.5159s
	iters: 500, epoch: 5 | loss: 0.1816212
	speed: 0.0306s/iter; left time: 402.8736s
	iters: 600, epoch: 5 | loss: 0.2216496
	speed: 0.0301s/iter; left time: 394.2846s
	iters: 700, epoch: 5 | loss: 0.2236878
	speed: 0.0298s/iter; left time: 387.6063s
	iters: 800, epoch: 5 | loss: 0.1749823
	speed: 0.0300s/iter; left time: 386.6098s
	iters: 900, epoch: 5 | loss: 0.1822866
	speed: 0.0299s/iter; left time: 382.5657s
	iters: 1000, epoch: 5 | loss: 0.1075221
	speed: 0.0298s/iter; left time: 378.5978s
	iters: 1100, epoch: 5 | loss: 0.6904835
	speed: 0.0295s/iter; left time: 371.9223s
	iters: 1200, epoch: 5 | loss: 2.9720814
	speed: 0.0301s/iter; left time: 375.3267s
	iters: 1300, epoch: 5 | loss: 0.3585856
	speed: 0.0300s/iter; left time: 371.9041s
	iters: 1400, epoch: 5 | loss: 0.1140611
	speed: 0.0300s/iter; left time: 368.7656s
	iters: 1500, epoch: 5 | loss: 0.2205072
	speed: 0.0300s/iter; left time: 365.6941s
	iters: 1600, epoch: 5 | loss: 0.7281048
	speed: 0.0302s/iter; left time: 364.4941s
	iters: 1700, epoch: 5 | loss: 0.3608756
	speed: 0.0303s/iter; left time: 363.3529s
	iters: 1800, epoch: 5 | loss: 0.1930672
	speed: 0.0302s/iter; left time: 358.4619s
	iters: 1900, epoch: 5 | loss: 3.1416073
	speed: 0.0302s/iter; left time: 355.4755s
	iters: 2000, epoch: 5 | loss: 0.2197452
	speed: 0.0300s/iter; left time: 351.0467s
	iters: 2100, epoch: 5 | loss: 0.1718146
	speed: 0.0299s/iter; left time: 346.1156s
	iters: 2200, epoch: 5 | loss: 0.1648632
	speed: 0.0303s/iter; left time: 347.5096s
Epoch: 5 cost time: 69.25910353660583
Epoch: 5, Steps: 2281 | Train Loss: 0.3125554 Vali Loss: 0.3160530 Test Loss: 0.1174425
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_48_DNGRevLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10492
mse:0.11911464482545853, mae:0.17762801051139832
