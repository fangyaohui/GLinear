Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_192_DNGRevLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.3872973
	speed: 0.0371s/iter; left time: 838.3035s
	iters: 200, epoch: 1 | loss: 0.2688397
	speed: 0.0310s/iter; left time: 698.4036s
	iters: 300, epoch: 1 | loss: 0.3370554
	speed: 0.0310s/iter; left time: 695.5666s
	iters: 400, epoch: 1 | loss: 0.4424857
	speed: 0.0310s/iter; left time: 692.0856s
	iters: 500, epoch: 1 | loss: 0.2868367
	speed: 0.0316s/iter; left time: 703.0726s
	iters: 600, epoch: 1 | loss: 0.4189256
	speed: 0.0307s/iter; left time: 678.7203s
	iters: 700, epoch: 1 | loss: 0.3595173
	speed: 0.0307s/iter; left time: 675.1135s
	iters: 800, epoch: 1 | loss: 0.3278602
	speed: 0.0302s/iter; left time: 661.1581s
	iters: 900, epoch: 1 | loss: 0.3194774
	speed: 0.0302s/iter; left time: 659.6851s
	iters: 1000, epoch: 1 | loss: 0.3098142
	speed: 0.0295s/iter; left time: 640.5383s
	iters: 1100, epoch: 1 | loss: 0.4780131
	speed: 0.0305s/iter; left time: 658.8904s
	iters: 1200, epoch: 1 | loss: 0.4750484
	speed: 0.0297s/iter; left time: 638.7879s
	iters: 1300, epoch: 1 | loss: 0.3353579
	speed: 0.0301s/iter; left time: 644.5394s
	iters: 1400, epoch: 1 | loss: 0.3870438
	speed: 0.0305s/iter; left time: 650.7660s
	iters: 1500, epoch: 1 | loss: 0.8027325
	speed: 0.0305s/iter; left time: 647.8391s
	iters: 1600, epoch: 1 | loss: 1.3269277
	speed: 0.0304s/iter; left time: 642.3026s
	iters: 1700, epoch: 1 | loss: 0.3171202
	speed: 0.0299s/iter; left time: 629.4916s
	iters: 1800, epoch: 1 | loss: 1.2390944
	speed: 0.0296s/iter; left time: 620.0836s
	iters: 1900, epoch: 1 | loss: 0.4487629
	speed: 0.0303s/iter; left time: 629.9551s
	iters: 2000, epoch: 1 | loss: 0.3296254
	speed: 0.0299s/iter; left time: 620.1053s
	iters: 2100, epoch: 1 | loss: 0.4154190
	speed: 0.0302s/iter; left time: 622.8182s
	iters: 2200, epoch: 1 | loss: 0.3058823
	speed: 0.0316s/iter; left time: 648.7524s
Epoch: 1 cost time: 69.96679759025574
Epoch: 1, Steps: 2272 | Train Loss: 0.4634259 Vali Loss: 0.4359562 Test Loss: 0.2036142
Validation loss decreased (inf --> 0.435956).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3943970
	speed: 0.1770s/iter; left time: 3600.8482s
	iters: 200, epoch: 2 | loss: 0.3292200
	speed: 0.0322s/iter; left time: 651.9692s
	iters: 300, epoch: 2 | loss: 0.2800885
	speed: 0.0337s/iter; left time: 679.6379s
	iters: 400, epoch: 2 | loss: 0.3729923
	speed: 0.0320s/iter; left time: 642.0546s
	iters: 500, epoch: 2 | loss: 0.2549351
	speed: 0.0312s/iter; left time: 622.6562s
	iters: 600, epoch: 2 | loss: 0.2759707
	speed: 0.0315s/iter; left time: 624.4857s
	iters: 700, epoch: 2 | loss: 0.4186509
	speed: 0.0387s/iter; left time: 763.8327s
	iters: 800, epoch: 2 | loss: 0.3194912
	speed: 0.0402s/iter; left time: 789.5276s
	iters: 900, epoch: 2 | loss: 0.4765255
	speed: 0.0332s/iter; left time: 649.7372s
	iters: 1000, epoch: 2 | loss: 0.3337527
	speed: 0.0319s/iter; left time: 619.7699s
	iters: 1100, epoch: 2 | loss: 0.3382869
	speed: 0.0327s/iter; left time: 632.3748s
	iters: 1200, epoch: 2 | loss: 0.2649454
	speed: 0.0320s/iter; left time: 616.0243s
	iters: 1300, epoch: 2 | loss: 0.4671466
	speed: 0.0317s/iter; left time: 607.2876s
	iters: 1400, epoch: 2 | loss: 0.4178930
	speed: 0.0312s/iter; left time: 593.8665s
	iters: 1500, epoch: 2 | loss: 1.2113633
	speed: 0.0318s/iter; left time: 602.4908s
	iters: 1600, epoch: 2 | loss: 0.7179056
	speed: 0.0343s/iter; left time: 645.8213s
	iters: 1700, epoch: 2 | loss: 0.3854930
	speed: 0.0322s/iter; left time: 604.5838s
	iters: 1800, epoch: 2 | loss: 0.3660397
	speed: 0.0330s/iter; left time: 614.7448s
	iters: 1900, epoch: 2 | loss: 0.4210988
	speed: 0.0323s/iter; left time: 598.8382s
	iters: 2000, epoch: 2 | loss: 0.3060553
	speed: 0.0314s/iter; left time: 579.2909s
	iters: 2100, epoch: 2 | loss: 0.4007387
	speed: 0.0308s/iter; left time: 565.0263s
	iters: 2200, epoch: 2 | loss: 0.3313220
	speed: 0.0318s/iter; left time: 580.5144s
Epoch: 2 cost time: 75.42958664894104
Epoch: 2, Steps: 2272 | Train Loss: 0.4504407 Vali Loss: 0.4365399 Test Loss: 0.1953890
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2990126
	speed: 0.1730s/iter; left time: 3127.4035s
	iters: 200, epoch: 3 | loss: 0.4668883
	speed: 0.0324s/iter; left time: 581.7011s
	iters: 300, epoch: 3 | loss: 0.4444621
	speed: 0.0335s/iter; left time: 598.5261s
	iters: 400, epoch: 3 | loss: 0.4049532
	speed: 0.0357s/iter; left time: 633.7858s
	iters: 500, epoch: 3 | loss: 0.5196289
	speed: 0.0369s/iter; left time: 652.6142s
	iters: 600, epoch: 3 | loss: 0.2754392
	speed: 0.0335s/iter; left time: 589.5639s
	iters: 700, epoch: 3 | loss: 0.4107409
	speed: 0.0394s/iter; left time: 689.2918s
	iters: 800, epoch: 3 | loss: 0.4512224
	speed: 0.0393s/iter; left time: 682.2024s
	iters: 900, epoch: 3 | loss: 0.3015572
	speed: 0.0356s/iter; left time: 614.5808s
	iters: 1000, epoch: 3 | loss: 0.3568487
	speed: 0.0376s/iter; left time: 645.7674s
	iters: 1100, epoch: 3 | loss: 0.2640343
	speed: 0.0304s/iter; left time: 519.6012s
	iters: 1200, epoch: 3 | loss: 0.2964007
	speed: 0.0312s/iter; left time: 529.4145s
	iters: 1300, epoch: 3 | loss: 0.2569559
	speed: 0.0309s/iter; left time: 521.6511s
	iters: 1400, epoch: 3 | loss: 0.2877514
	speed: 0.0318s/iter; left time: 532.7241s
	iters: 1500, epoch: 3 | loss: 0.2802514
	speed: 0.0319s/iter; left time: 532.0981s
	iters: 1600, epoch: 3 | loss: 0.3748705
	speed: 0.0316s/iter; left time: 523.5360s
	iters: 1700, epoch: 3 | loss: 0.2465115
	speed: 0.0327s/iter; left time: 538.8776s
	iters: 1800, epoch: 3 | loss: 0.2778811
	speed: 0.0342s/iter; left time: 559.9785s
	iters: 1900, epoch: 3 | loss: 0.4337588
	speed: 0.0325s/iter; left time: 528.4561s
	iters: 2000, epoch: 3 | loss: 0.2525464
	speed: 0.0337s/iter; left time: 544.3571s
	iters: 2100, epoch: 3 | loss: 0.2784199
	speed: 0.0321s/iter; left time: 515.7238s
	iters: 2200, epoch: 3 | loss: 0.4399932
	speed: 0.0319s/iter; left time: 509.7825s
Epoch: 3 cost time: 77.4450933933258
Epoch: 3, Steps: 2272 | Train Loss: 0.4304451 Vali Loss: 0.4359431 Test Loss: 0.2003930
Validation loss decreased (0.435956 --> 0.435943).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5018069
	speed: 0.1789s/iter; left time: 2826.7875s
	iters: 200, epoch: 4 | loss: 1.3977040
	speed: 0.0320s/iter; left time: 501.9562s
	iters: 300, epoch: 4 | loss: 0.2887098
	speed: 0.0342s/iter; left time: 534.1083s
	iters: 400, epoch: 4 | loss: 0.4784389
	speed: 0.0346s/iter; left time: 535.8314s
	iters: 500, epoch: 4 | loss: 0.2828769
	speed: 0.0320s/iter; left time: 492.1940s
	iters: 600, epoch: 4 | loss: 0.3100941
	speed: 0.0325s/iter; left time: 498.1340s
	iters: 700, epoch: 4 | loss: 0.4115985
	speed: 0.0341s/iter; left time: 519.0885s
	iters: 800, epoch: 4 | loss: 0.2099614
	speed: 0.0360s/iter; left time: 544.5126s
	iters: 900, epoch: 4 | loss: 0.2689499
	speed: 0.0346s/iter; left time: 518.9830s
	iters: 1000, epoch: 4 | loss: 0.3445645
	speed: 0.0314s/iter; left time: 467.2763s
	iters: 1100, epoch: 4 | loss: 0.5806177
	speed: 0.0327s/iter; left time: 484.2278s
	iters: 1200, epoch: 4 | loss: 0.3610899
	speed: 0.0347s/iter; left time: 510.0012s
	iters: 1300, epoch: 4 | loss: 0.4087026
	speed: 0.0329s/iter; left time: 480.2814s
	iters: 1400, epoch: 4 | loss: 0.3697402
	speed: 0.0323s/iter; left time: 467.9538s
	iters: 1500, epoch: 4 | loss: 0.2719454
	speed: 0.0323s/iter; left time: 465.4874s
	iters: 1600, epoch: 4 | loss: 0.2823437
	speed: 0.0352s/iter; left time: 503.6281s
	iters: 1700, epoch: 4 | loss: 0.3858791
	speed: 0.0357s/iter; left time: 506.7069s
	iters: 1800, epoch: 4 | loss: 0.3212170
	speed: 0.0327s/iter; left time: 461.5715s
	iters: 1900, epoch: 4 | loss: 0.5719370
	speed: 0.0317s/iter; left time: 444.3348s
	iters: 2000, epoch: 4 | loss: 0.2115875
	speed: 0.0356s/iter; left time: 495.0522s
	iters: 2100, epoch: 4 | loss: 0.3564370
	speed: 0.0319s/iter; left time: 440.7849s
	iters: 2200, epoch: 4 | loss: 1.3273270
	speed: 0.0331s/iter; left time: 453.3345s
Epoch: 4 cost time: 76.81640934944153
Epoch: 4, Steps: 2272 | Train Loss: 0.4218036 Vali Loss: 0.4326066 Test Loss: 0.1931157
Validation loss decreased (0.435943 --> 0.432607).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.3091059
	speed: 0.1815s/iter; left time: 2456.4839s
	iters: 200, epoch: 5 | loss: 1.2828419
	speed: 0.0331s/iter; left time: 444.2051s
	iters: 300, epoch: 5 | loss: 0.2942849
	speed: 0.0328s/iter; left time: 437.0045s
	iters: 400, epoch: 5 | loss: 0.3574204
	speed: 0.0318s/iter; left time: 420.7042s
	iters: 500, epoch: 5 | loss: 0.3490603
	speed: 0.0316s/iter; left time: 414.9140s
	iters: 600, epoch: 5 | loss: 0.3418984
	speed: 0.0346s/iter; left time: 451.1054s
	iters: 700, epoch: 5 | loss: 0.2848352
	speed: 0.0331s/iter; left time: 427.6616s
	iters: 800, epoch: 5 | loss: 0.5060681
	speed: 0.0331s/iter; left time: 425.1352s
	iters: 900, epoch: 5 | loss: 0.2245176
	speed: 0.0319s/iter; left time: 406.6987s
	iters: 1000, epoch: 5 | loss: 0.2609447
	speed: 0.0383s/iter; left time: 483.9121s
	iters: 1100, epoch: 5 | loss: 0.2958175
	speed: 0.0338s/iter; left time: 423.1896s
	iters: 1200, epoch: 5 | loss: 0.2484373
	speed: 0.0318s/iter; left time: 395.7423s
	iters: 1300, epoch: 5 | loss: 0.2814421
	speed: 0.0324s/iter; left time: 399.0432s
	iters: 1400, epoch: 5 | loss: 0.5491923
	speed: 0.0314s/iter; left time: 383.8302s
	iters: 1500, epoch: 5 | loss: 1.2187426
	speed: 0.0341s/iter; left time: 413.9051s
	iters: 1600, epoch: 5 | loss: 0.3457059
	speed: 0.0312s/iter; left time: 374.9937s
	iters: 1700, epoch: 5 | loss: 0.3224787
	speed: 0.0309s/iter; left time: 369.0271s
	iters: 1800, epoch: 5 | loss: 0.2188701
	speed: 0.0331s/iter; left time: 391.0992s
	iters: 1900, epoch: 5 | loss: 0.2509368
	speed: 0.0346s/iter; left time: 405.7635s
	iters: 2000, epoch: 5 | loss: 0.3445492
	speed: 0.0320s/iter; left time: 372.6344s
	iters: 2100, epoch: 5 | loss: 0.3795933
	speed: 0.0308s/iter; left time: 355.6847s
	iters: 2200, epoch: 5 | loss: 0.3366817
	speed: 0.0301s/iter; left time: 344.6246s
Epoch: 5 cost time: 75.2598295211792
Epoch: 5, Steps: 2272 | Train Loss: 0.4173666 Vali Loss: 0.4356221 Test Loss: 0.1943789
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3482786
	speed: 0.1746s/iter; left time: 1966.6021s
	iters: 200, epoch: 6 | loss: 0.2959725
	speed: 0.0308s/iter; left time: 343.3232s
	iters: 300, epoch: 6 | loss: 0.2635649
	speed: 0.0317s/iter; left time: 350.4698s
	iters: 400, epoch: 6 | loss: 0.3638754
	speed: 0.0337s/iter; left time: 369.6870s
	iters: 500, epoch: 6 | loss: 0.3892220
	speed: 0.0327s/iter; left time: 355.5953s
	iters: 600, epoch: 6 | loss: 0.3648200
	speed: 0.0319s/iter; left time: 343.7906s
	iters: 700, epoch: 6 | loss: 0.2548077
	speed: 0.0312s/iter; left time: 332.6849s
	iters: 800, epoch: 6 | loss: 1.2452326
	speed: 0.0310s/iter; left time: 327.1717s
	iters: 900, epoch: 6 | loss: 0.2201931
	speed: 0.0302s/iter; left time: 316.1507s
	iters: 1000, epoch: 6 | loss: 0.3096857
	speed: 0.0307s/iter; left time: 317.9468s
	iters: 1100, epoch: 6 | loss: 0.3108156
	speed: 0.0298s/iter; left time: 305.6067s
	iters: 1200, epoch: 6 | loss: 0.4997086
	speed: 0.0302s/iter; left time: 307.0865s
	iters: 1300, epoch: 6 | loss: 0.4323264
	speed: 0.0304s/iter; left time: 306.0840s
	iters: 1400, epoch: 6 | loss: 0.2534651
	speed: 0.0297s/iter; left time: 295.3799s
	iters: 1500, epoch: 6 | loss: 0.5081031
	speed: 0.0396s/iter; left time: 390.1920s
	iters: 1600, epoch: 6 | loss: 0.4763185
	speed: 0.0341s/iter; left time: 332.9969s
	iters: 1700, epoch: 6 | loss: 1.3458400
	speed: 0.0314s/iter; left time: 303.1443s
	iters: 1800, epoch: 6 | loss: 0.4177520
	speed: 0.0314s/iter; left time: 299.9604s
	iters: 1900, epoch: 6 | loss: 0.4662979
	speed: 0.0316s/iter; left time: 298.6409s
	iters: 2000, epoch: 6 | loss: 0.3562594
	speed: 0.0314s/iter; left time: 293.4835s
	iters: 2100, epoch: 6 | loss: 0.2670845
	speed: 0.0327s/iter; left time: 302.3731s
	iters: 2200, epoch: 6 | loss: 1.4204429
	speed: 0.0305s/iter; left time: 279.1365s
Epoch: 6 cost time: 72.57237315177917
Epoch: 6, Steps: 2272 | Train Loss: 0.4150745 Vali Loss: 0.4363898 Test Loss: 0.1940203
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3937873
	speed: 0.1729s/iter; left time: 1554.4452s
	iters: 200, epoch: 7 | loss: 0.3269687
	speed: 0.0351s/iter; left time: 311.6429s
	iters: 300, epoch: 7 | loss: 0.2861368
	speed: 0.0319s/iter; left time: 279.9451s
	iters: 400, epoch: 7 | loss: 1.3173534
	speed: 0.0319s/iter; left time: 276.9793s
	iters: 500, epoch: 7 | loss: 0.3309740
	speed: 0.0314s/iter; left time: 269.9785s
	iters: 600, epoch: 7 | loss: 0.5413318
	speed: 0.0328s/iter; left time: 278.0535s
	iters: 700, epoch: 7 | loss: 0.4115473
	speed: 0.0319s/iter; left time: 267.3006s
	iters: 800, epoch: 7 | loss: 0.2507231
	speed: 0.0332s/iter; left time: 275.3673s
	iters: 900, epoch: 7 | loss: 0.2969211
	speed: 0.0309s/iter; left time: 253.1631s
	iters: 1000, epoch: 7 | loss: 0.5113808
	speed: 0.0327s/iter; left time: 264.3673s
	iters: 1100, epoch: 7 | loss: 0.5099801
	speed: 0.0316s/iter; left time: 252.7026s
	iters: 1200, epoch: 7 | loss: 1.3437715
	speed: 0.0348s/iter; left time: 274.5039s
	iters: 1300, epoch: 7 | loss: 0.6327357
	speed: 0.0329s/iter; left time: 256.4758s
	iters: 1400, epoch: 7 | loss: 0.2300469
	speed: 0.0343s/iter; left time: 263.5413s
	iters: 1500, epoch: 7 | loss: 0.2839352
	speed: 0.0345s/iter; left time: 261.5733s
	iters: 1600, epoch: 7 | loss: 0.3234150
	speed: 0.0344s/iter; left time: 257.8830s
	iters: 1700, epoch: 7 | loss: 1.2664682
	speed: 0.0334s/iter; left time: 246.6408s
	iters: 1800, epoch: 7 | loss: 0.2122983
	speed: 0.0315s/iter; left time: 229.2503s
	iters: 1900, epoch: 7 | loss: 0.3465498
	speed: 0.0331s/iter; left time: 238.1095s
	iters: 2000, epoch: 7 | loss: 1.1524420
	speed: 0.0340s/iter; left time: 241.1361s
	iters: 2100, epoch: 7 | loss: 0.3736829
	speed: 0.0353s/iter; left time: 246.4732s
	iters: 2200, epoch: 7 | loss: 0.2772344
	speed: 0.0356s/iter; left time: 245.5215s
Epoch: 7 cost time: 76.61337542533875
Epoch: 7, Steps: 2272 | Train Loss: 0.4139085 Vali Loss: 0.4342155 Test Loss: 0.1933707
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_192_DNGRevLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.19315031170845032, mae:0.25847986340522766
