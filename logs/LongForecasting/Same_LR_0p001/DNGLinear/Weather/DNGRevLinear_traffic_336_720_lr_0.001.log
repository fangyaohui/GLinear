Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_DNGRevLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.3185698
	speed: 1.0398s/iter; left time: 7185.9120s
	iters: 200, epoch: 1 | loss: 0.2840993
	speed: 1.0155s/iter; left time: 6916.2412s
	iters: 300, epoch: 1 | loss: 0.2822980
	speed: 0.9998s/iter; left time: 6709.7684s
	iters: 400, epoch: 1 | loss: 0.2749615
	speed: 1.0058s/iter; left time: 6649.4235s
	iters: 500, epoch: 1 | loss: 0.2912429
	speed: 0.9760s/iter; left time: 6354.9807s
	iters: 600, epoch: 1 | loss: 0.2966910
	speed: 0.9780s/iter; left time: 6269.6623s
	iters: 700, epoch: 1 | loss: 0.2840494
	speed: 0.9474s/iter; left time: 5978.7492s
Epoch: 1 cost time: 697.9811482429504
Epoch: 1, Steps: 701 | Train Loss: 0.3000265 Vali Loss: 0.4239244 Test Loss: 0.4871568
Validation loss decreased (inf --> 0.423924).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2669905
	speed: 1.9881s/iter; left time: 12346.1275s
	iters: 200, epoch: 2 | loss: 0.2789880
	speed: 1.0051s/iter; left time: 6141.3667s
	iters: 300, epoch: 2 | loss: 0.2527958
	speed: 1.0154s/iter; left time: 6102.3609s
	iters: 400, epoch: 2 | loss: 0.2709156
	speed: 1.0306s/iter; left time: 6091.0417s
	iters: 500, epoch: 2 | loss: 0.2756924
	speed: 1.0135s/iter; left time: 5888.2011s
	iters: 600, epoch: 2 | loss: 0.2509518
	speed: 0.9852s/iter; left time: 5625.3519s
	iters: 700, epoch: 2 | loss: 0.2445442
	speed: 0.9728s/iter; left time: 5457.6700s
Epoch: 2 cost time: 705.7003600597382
Epoch: 2, Steps: 701 | Train Loss: 0.2686260 Vali Loss: 0.4224222 Test Loss: 0.4844248
Validation loss decreased (0.423924 --> 0.422422).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2517571
	speed: 1.9899s/iter; left time: 10962.5560s
	iters: 200, epoch: 3 | loss: 0.2566003
	speed: 1.0154s/iter; left time: 5492.3289s
	iters: 300, epoch: 3 | loss: 0.2352280
	speed: 1.0135s/iter; left time: 5380.6680s
	iters: 400, epoch: 3 | loss: 0.2385222
	speed: 0.9634s/iter; left time: 5018.4249s
	iters: 500, epoch: 3 | loss: 0.2634991
	speed: 0.9911s/iter; left time: 5063.5041s
	iters: 600, epoch: 3 | loss: 0.2670678
	speed: 0.9628s/iter; left time: 4822.6724s
	iters: 700, epoch: 3 | loss: 0.2519230
	speed: 0.9543s/iter; left time: 4684.6338s
Epoch: 3 cost time: 694.3199744224548
Epoch: 3, Steps: 701 | Train Loss: 0.2582746 Vali Loss: 0.4192726 Test Loss: 0.4782466
Validation loss decreased (0.422422 --> 0.419273).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2509168
	speed: 1.9493s/iter; left time: 9372.4432s
	iters: 200, epoch: 4 | loss: 0.2393529
	speed: 0.9752s/iter; left time: 4591.2467s
	iters: 300, epoch: 4 | loss: 0.2617550
	speed: 0.9427s/iter; left time: 4344.0245s
	iters: 400, epoch: 4 | loss: 0.2686079
	speed: 0.9549s/iter; left time: 4304.5882s
	iters: 500, epoch: 4 | loss: 0.2644836
	speed: 0.9531s/iter; left time: 4201.4333s
	iters: 600, epoch: 4 | loss: 0.2474215
	speed: 0.9539s/iter; left time: 4109.5172s
	iters: 700, epoch: 4 | loss: 0.2440486
	speed: 0.9746s/iter; left time: 4100.9359s
Epoch: 4 cost time: 675.4362118244171
Epoch: 4, Steps: 701 | Train Loss: 0.2536908 Vali Loss: 0.4170672 Test Loss: 0.4770899
Validation loss decreased (0.419273 --> 0.417067).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2452074
	speed: 1.9744s/iter; left time: 8108.8996s
	iters: 200, epoch: 5 | loss: 0.2564048
	speed: 1.0050s/iter; left time: 4027.0966s
	iters: 300, epoch: 5 | loss: 0.2429544
	speed: 0.9575s/iter; left time: 3740.9861s
	iters: 400, epoch: 5 | loss: 0.2307677
	speed: 0.9316s/iter; left time: 3546.4402s
	iters: 500, epoch: 5 | loss: 0.2407726
	speed: 0.9339s/iter; left time: 3462.0057s
	iters: 600, epoch: 5 | loss: 0.2561629
	speed: 0.9622s/iter; left time: 3470.5767s
	iters: 700, epoch: 5 | loss: 0.2619684
	speed: 0.9740s/iter; left time: 3415.8915s
Epoch: 5 cost time: 677.750150680542
Epoch: 5, Steps: 701 | Train Loss: 0.2513804 Vali Loss: 0.4153891 Test Loss: 0.4755845
Validation loss decreased (0.417067 --> 0.415389).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2625529
	speed: 1.9825s/iter; left time: 6752.3335s
	iters: 200, epoch: 6 | loss: 0.2994949
	speed: 1.0065s/iter; left time: 3327.4612s
	iters: 300, epoch: 6 | loss: 0.2508629
	speed: 0.9748s/iter; left time: 3125.1293s
	iters: 400, epoch: 6 | loss: 0.2562454
	speed: 1.0185s/iter; left time: 3163.4860s
	iters: 500, epoch: 6 | loss: 0.2370448
	speed: 0.9978s/iter; left time: 2999.2613s
	iters: 600, epoch: 6 | loss: 0.2682930
	speed: 0.9639s/iter; left time: 2801.0110s
	iters: 700, epoch: 6 | loss: 0.2549508
	speed: 1.0031s/iter; left time: 2814.6289s
Epoch: 6 cost time: 698.3788232803345
Epoch: 6, Steps: 701 | Train Loss: 0.2501863 Vali Loss: 0.4153717 Test Loss: 0.4754967
Validation loss decreased (0.415389 --> 0.415372).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2350588
	speed: 1.9236s/iter; left time: 5203.4534s
	iters: 200, epoch: 7 | loss: 0.2608007
	speed: 0.9565s/iter; left time: 2491.6241s
	iters: 300, epoch: 7 | loss: 0.2533923
	speed: 0.9560s/iter; left time: 2394.8522s
	iters: 400, epoch: 7 | loss: 0.2347070
	speed: 0.9513s/iter; left time: 2287.8893s
	iters: 500, epoch: 7 | loss: 0.2534790
	speed: 0.9549s/iter; left time: 2200.9817s
	iters: 600, epoch: 7 | loss: 0.2599029
	speed: 0.9564s/iter; left time: 2108.8280s
	iters: 700, epoch: 7 | loss: 0.2581376
	speed: 0.9538s/iter; left time: 2007.7105s
Epoch: 7 cost time: 672.3645558357239
Epoch: 7, Steps: 701 | Train Loss: 0.2495381 Vali Loss: 0.4151202 Test Loss: 0.4757238
Validation loss decreased (0.415372 --> 0.415120).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2311212
	speed: 1.9279s/iter; left time: 3863.5248s
	iters: 200, epoch: 8 | loss: 0.2561775
	speed: 0.9601s/iter; left time: 1828.0126s
	iters: 300, epoch: 8 | loss: 0.2400122
	speed: 0.9393s/iter; left time: 1694.4153s
	iters: 400, epoch: 8 | loss: 0.2460842
	speed: 0.9589s/iter; left time: 1633.9803s
	iters: 500, epoch: 8 | loss: 0.2562555
	speed: 0.9720s/iter; left time: 1559.0765s
	iters: 600, epoch: 8 | loss: 0.2509428
	speed: 0.9553s/iter; left time: 1436.7589s
	iters: 700, epoch: 8 | loss: 0.2518677
	speed: 0.9459s/iter; left time: 1328.1129s
Epoch: 8 cost time: 673.4936151504517
Epoch: 8, Steps: 701 | Train Loss: 0.2492052 Vali Loss: 0.4149714 Test Loss: 0.4752854
Validation loss decreased (0.415120 --> 0.414971).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2467459
	speed: 1.9214s/iter; left time: 2503.6152s
	iters: 200, epoch: 9 | loss: 0.2659713
	speed: 0.9840s/iter; left time: 1183.7265s
	iters: 300, epoch: 9 | loss: 0.2498528
	speed: 0.9729s/iter; left time: 1073.1180s
	iters: 400, epoch: 9 | loss: 0.2487621
	speed: 0.9637s/iter; left time: 966.6172s
	iters: 500, epoch: 9 | loss: 0.2558596
	speed: 0.9348s/iter; left time: 844.0880s
	iters: 600, epoch: 9 | loss: 0.2461422
	speed: 0.9495s/iter; left time: 762.4527s
	iters: 700, epoch: 9 | loss: 0.2604091
	speed: 0.9557s/iter; left time: 671.8414s
Epoch: 9 cost time: 676.8259165287018
Epoch: 9, Steps: 701 | Train Loss: 0.2490024 Vali Loss: 0.4145774 Test Loss: 0.4751624
Validation loss decreased (0.414971 --> 0.414577).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2538311
	speed: 1.9734s/iter; left time: 1187.9753s
	iters: 200, epoch: 10 | loss: 0.2451344
	speed: 0.9944s/iter; left time: 499.2110s
	iters: 300, epoch: 10 | loss: 0.2265625
	speed: 0.9537s/iter; left time: 383.3862s
	iters: 400, epoch: 10 | loss: 0.2477832
	speed: 0.9655s/iter; left time: 291.5805s
	iters: 500, epoch: 10 | loss: 0.2427882
	speed: 0.9488s/iter; left time: 191.6624s
	iters: 600, epoch: 10 | loss: 0.2657908
	speed: 0.9574s/iter; left time: 97.6510s
	iters: 700, epoch: 10 | loss: 0.2516665
	speed: 0.9400s/iter; left time: 1.8800s
Epoch: 10 cost time: 681.3852736949921
Epoch: 10, Steps: 701 | Train Loss: 0.2489496 Vali Loss: 0.4148806 Test Loss: 0.4752549
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_720_DNGRevLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.47511544823646545, mae:0.3152819871902466
