Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='ETTh1_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_12_DNGRevLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8293
val 2869
test 2869
	iters: 100, epoch: 1 | loss: 0.3192107
	speed: 0.0242s/iter; left time: 247.8568s
	iters: 200, epoch: 1 | loss: 0.2181802
	speed: 0.0168s/iter; left time: 170.9203s
	iters: 300, epoch: 1 | loss: 0.2247527
	speed: 0.0169s/iter; left time: 169.9138s
	iters: 400, epoch: 1 | loss: 0.2003822
	speed: 0.0182s/iter; left time: 181.3097s
	iters: 500, epoch: 1 | loss: 0.4184382
	speed: 0.0173s/iter; left time: 170.8371s
	iters: 600, epoch: 1 | loss: 0.2054516
	speed: 0.0171s/iter; left time: 166.8696s
	iters: 700, epoch: 1 | loss: 0.1823669
	speed: 0.0176s/iter; left time: 169.7284s
	iters: 800, epoch: 1 | loss: 0.1903042
	speed: 0.0183s/iter; left time: 174.5448s
	iters: 900, epoch: 1 | loss: 0.1927464
	speed: 0.0171s/iter; left time: 161.6130s
	iters: 1000, epoch: 1 | loss: 0.2817223
	speed: 0.0167s/iter; left time: 156.2530s
Epoch: 1 cost time: 18.7463481426239
Epoch: 1, Steps: 1036 | Train Loss: 0.2337665 Vali Loss: 0.3490500 Test Loss: 0.3050092
Validation loss decreased (inf --> 0.349050).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2271492
	speed: 0.0830s/iter; left time: 765.8157s
	iters: 200, epoch: 2 | loss: 0.1979443
	speed: 0.0164s/iter; left time: 149.4557s
	iters: 300, epoch: 2 | loss: 0.3036541
	speed: 0.0159s/iter; left time: 143.4119s
	iters: 400, epoch: 2 | loss: 0.1930312
	speed: 0.0165s/iter; left time: 147.0892s
	iters: 500, epoch: 2 | loss: 0.1926491
	speed: 0.0165s/iter; left time: 145.4654s
	iters: 600, epoch: 2 | loss: 0.2453314
	speed: 0.0159s/iter; left time: 138.8356s
	iters: 700, epoch: 2 | loss: 0.1865431
	speed: 0.0163s/iter; left time: 140.3631s
	iters: 800, epoch: 2 | loss: 0.1695278
	speed: 0.0162s/iter; left time: 137.7329s
	iters: 900, epoch: 2 | loss: 0.2913150
	speed: 0.0164s/iter; left time: 138.0266s
	iters: 1000, epoch: 2 | loss: 0.2017440
	speed: 0.0171s/iter; left time: 142.2992s
Epoch: 2 cost time: 17.64796733856201
Epoch: 2, Steps: 1036 | Train Loss: 0.2122555 Vali Loss: 0.3428504 Test Loss: 0.2912598
Validation loss decreased (0.349050 --> 0.342850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1825265
	speed: 0.0832s/iter; left time: 681.5059s
	iters: 200, epoch: 3 | loss: 0.1605049
	speed: 0.0160s/iter; left time: 129.6212s
	iters: 300, epoch: 3 | loss: 0.2039308
	speed: 0.0163s/iter; left time: 130.4599s
	iters: 400, epoch: 3 | loss: 0.2317555
	speed: 0.0167s/iter; left time: 132.0210s
	iters: 500, epoch: 3 | loss: 0.1918524
	speed: 0.0165s/iter; left time: 128.2563s
	iters: 600, epoch: 3 | loss: 0.1041265
	speed: 0.0165s/iter; left time: 126.9795s
	iters: 700, epoch: 3 | loss: 0.2033689
	speed: 0.0171s/iter; left time: 129.5154s
	iters: 800, epoch: 3 | loss: 0.1006905
	speed: 0.0169s/iter; left time: 126.2036s
	iters: 900, epoch: 3 | loss: 0.1535254
	speed: 0.0168s/iter; left time: 123.8434s
	iters: 1000, epoch: 3 | loss: 0.1663463
	speed: 0.0162s/iter; left time: 118.0378s
Epoch: 3 cost time: 17.841318607330322
Epoch: 3, Steps: 1036 | Train Loss: 0.1910206 Vali Loss: 0.3574879 Test Loss: 0.2883745
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1563762
	speed: 0.0831s/iter; left time: 594.2591s
	iters: 200, epoch: 4 | loss: 0.2286664
	speed: 0.0167s/iter; left time: 117.4681s
	iters: 300, epoch: 4 | loss: 0.1465383
	speed: 0.0171s/iter; left time: 118.6553s
	iters: 400, epoch: 4 | loss: 0.1505323
	speed: 0.0163s/iter; left time: 111.3841s
	iters: 500, epoch: 4 | loss: 0.2182031
	speed: 0.0160s/iter; left time: 107.7751s
	iters: 600, epoch: 4 | loss: 0.3919242
	speed: 0.0156s/iter; left time: 104.0024s
	iters: 700, epoch: 4 | loss: 0.1471354
	speed: 0.0165s/iter; left time: 108.1474s
	iters: 800, epoch: 4 | loss: 0.2065678
	speed: 0.0169s/iter; left time: 108.9037s
	iters: 900, epoch: 4 | loss: 0.1818122
	speed: 0.0163s/iter; left time: 103.5648s
	iters: 1000, epoch: 4 | loss: 0.1992381
	speed: 0.0164s/iter; left time: 102.7149s
Epoch: 4 cost time: 17.7778537273407
Epoch: 4, Steps: 1036 | Train Loss: 0.1782085 Vali Loss: 0.3400545 Test Loss: 0.2883325
Validation loss decreased (0.342850 --> 0.340054).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1145416
	speed: 0.0838s/iter; left time: 512.7475s
	iters: 200, epoch: 5 | loss: 0.1298538
	speed: 0.0172s/iter; left time: 103.2082s
	iters: 300, epoch: 5 | loss: 0.2266779
	speed: 0.0166s/iter; left time: 98.3661s
	iters: 400, epoch: 5 | loss: 0.1606355
	speed: 0.0163s/iter; left time: 94.7521s
	iters: 500, epoch: 5 | loss: 0.2485062
	speed: 0.0162s/iter; left time: 92.5320s
	iters: 600, epoch: 5 | loss: 0.2266353
	speed: 0.0160s/iter; left time: 89.5997s
	iters: 700, epoch: 5 | loss: 0.1032328
	speed: 0.0169s/iter; left time: 93.1164s
	iters: 800, epoch: 5 | loss: 0.2248771
	speed: 0.0173s/iter; left time: 93.9386s
	iters: 900, epoch: 5 | loss: 0.2057110
	speed: 0.0196s/iter; left time: 104.3095s
	iters: 1000, epoch: 5 | loss: 0.1971817
	speed: 0.0156s/iter; left time: 81.3997s
Epoch: 5 cost time: 18.145636081695557
Epoch: 5, Steps: 1036 | Train Loss: 0.1705679 Vali Loss: 0.3399930 Test Loss: 0.2827386
Validation loss decreased (0.340054 --> 0.339993).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1279873
	speed: 0.0831s/iter; left time: 422.2106s
	iters: 200, epoch: 6 | loss: 0.2435513
	speed: 0.0163s/iter; left time: 81.3399s
	iters: 300, epoch: 6 | loss: 0.1137981
	speed: 0.0157s/iter; left time: 76.8724s
	iters: 400, epoch: 6 | loss: 0.2253785
	speed: 0.0153s/iter; left time: 72.9145s
	iters: 500, epoch: 6 | loss: 0.1567087
	speed: 0.0163s/iter; left time: 76.4631s
	iters: 600, epoch: 6 | loss: 0.1705280
	speed: 0.0170s/iter; left time: 78.0859s
	iters: 700, epoch: 6 | loss: 0.1100588
	speed: 0.0167s/iter; left time: 74.7102s
	iters: 800, epoch: 6 | loss: 0.1163222
	speed: 0.0165s/iter; left time: 72.4937s
	iters: 900, epoch: 6 | loss: 0.1850432
	speed: 0.0166s/iter; left time: 71.1157s
	iters: 1000, epoch: 6 | loss: 0.1329084
	speed: 0.0171s/iter; left time: 71.5258s
Epoch: 6 cost time: 17.803224325180054
Epoch: 6, Steps: 1036 | Train Loss: 0.1665264 Vali Loss: 0.3413467 Test Loss: 0.2843079
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2394924
	speed: 0.0833s/iter; left time: 336.8235s
	iters: 200, epoch: 7 | loss: 0.3519971
	speed: 0.0159s/iter; left time: 62.7473s
	iters: 300, epoch: 7 | loss: 0.1398442
	speed: 0.0164s/iter; left time: 63.1163s
	iters: 400, epoch: 7 | loss: 0.3047255
	speed: 0.0163s/iter; left time: 60.9768s
	iters: 500, epoch: 7 | loss: 0.2588601
	speed: 0.0166s/iter; left time: 60.5202s
	iters: 600, epoch: 7 | loss: 0.1924898
	speed: 0.0170s/iter; left time: 60.1259s
	iters: 700, epoch: 7 | loss: 0.1238248
	speed: 0.0154s/iter; left time: 53.0400s
	iters: 800, epoch: 7 | loss: 0.1784745
	speed: 0.0168s/iter; left time: 56.2391s
	iters: 900, epoch: 7 | loss: 0.1698164
	speed: 0.0174s/iter; left time: 56.5390s
	iters: 1000, epoch: 7 | loss: 0.1264019
	speed: 0.0156s/iter; left time: 49.2064s
Epoch: 7 cost time: 17.696751356124878
Epoch: 7, Steps: 1036 | Train Loss: 0.1641642 Vali Loss: 0.3421687 Test Loss: 0.2830406
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1440576
	speed: 0.0825s/iter; left time: 248.3184s
	iters: 200, epoch: 8 | loss: 0.1719733
	speed: 0.0170s/iter; left time: 49.4345s
	iters: 300, epoch: 8 | loss: 0.1787671
	speed: 0.0166s/iter; left time: 46.7149s
	iters: 400, epoch: 8 | loss: 0.1306313
	speed: 0.0165s/iter; left time: 44.7868s
	iters: 500, epoch: 8 | loss: 0.1158545
	speed: 0.0168s/iter; left time: 43.9564s
	iters: 600, epoch: 8 | loss: 0.1778529
	speed: 0.0171s/iter; left time: 42.8780s
	iters: 700, epoch: 8 | loss: 0.1511109
	speed: 0.0207s/iter; left time: 49.9610s
	iters: 800, epoch: 8 | loss: 0.1503195
	speed: 0.0186s/iter; left time: 42.8889s
	iters: 900, epoch: 8 | loss: 0.1869513
	speed: 0.0171s/iter; left time: 37.7286s
	iters: 1000, epoch: 8 | loss: 0.1433632
	speed: 0.0165s/iter; left time: 34.6979s
Epoch: 8 cost time: 18.648674964904785
Epoch: 8, Steps: 1036 | Train Loss: 0.1631483 Vali Loss: 0.3411525 Test Loss: 0.2829304
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_12_DNGRevLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2869
mse:0.28284937143325806, mae:0.34158989787101746
