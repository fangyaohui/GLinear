Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='traffic_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_12_DNGRevLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11933
val 1745
test 3497
	iters: 100, epoch: 1 | loss: 0.2767290
	speed: 0.8497s/iter; left time: 6246.2645s
	iters: 200, epoch: 1 | loss: 0.1891748
	speed: 0.8440s/iter; left time: 6119.9339s
	iters: 300, epoch: 1 | loss: 0.1967666
	speed: 0.8271s/iter; left time: 5914.2515s
	iters: 400, epoch: 1 | loss: 0.2785722
	speed: 0.8438s/iter; left time: 5949.6769s
	iters: 500, epoch: 1 | loss: 0.2575523
	speed: 0.8342s/iter; left time: 5798.7954s
	iters: 600, epoch: 1 | loss: 0.1803961
	speed: 0.8432s/iter; left time: 5776.8193s
	iters: 700, epoch: 1 | loss: 0.1716385
	speed: 0.8465s/iter; left time: 5714.4031s
Epoch: 1 cost time: 627.3280007839203
Epoch: 1, Steps: 745 | Train Loss: 0.2355924 Vali Loss: 0.3170199 Test Loss: 0.3630615
Validation loss decreased (inf --> 0.317020).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2154951
	speed: 1.7995s/iter; left time: 11887.5977s
	iters: 200, epoch: 2 | loss: 0.2549801
	speed: 0.8388s/iter; left time: 5457.2830s
	iters: 300, epoch: 2 | loss: 0.2535820
	speed: 0.8298s/iter; left time: 5315.9611s
	iters: 400, epoch: 2 | loss: 0.1922920
	speed: 0.8417s/iter; left time: 5307.5990s
	iters: 500, epoch: 2 | loss: 0.2525249
	speed: 0.8313s/iter; left time: 5159.3512s
	iters: 600, epoch: 2 | loss: 0.1718571
	speed: 0.8150s/iter; left time: 4976.4337s
	iters: 700, epoch: 2 | loss: 0.2214832
	speed: 0.8348s/iter; left time: 5014.0270s
Epoch: 2 cost time: 619.9207184314728
Epoch: 2, Steps: 745 | Train Loss: 0.2044330 Vali Loss: 0.3195623 Test Loss: 0.3607663
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2049845
	speed: 1.7576s/iter; left time: 10301.0332s
	iters: 200, epoch: 3 | loss: 0.1965309
	speed: 0.8176s/iter; left time: 4710.1470s
	iters: 300, epoch: 3 | loss: 0.1701118
	speed: 0.8380s/iter; left time: 4743.6774s
	iters: 400, epoch: 3 | loss: 0.2042882
	speed: 0.8405s/iter; left time: 4673.7925s
	iters: 500, epoch: 3 | loss: 0.2281884
	speed: 0.8442s/iter; left time: 4610.4475s
	iters: 600, epoch: 3 | loss: 0.2144453
	speed: 0.8577s/iter; left time: 4598.1546s
	iters: 700, epoch: 3 | loss: 0.1784819
	speed: 0.8731s/iter; left time: 4593.5179s
Epoch: 3 cost time: 629.1496784687042
Epoch: 3, Steps: 745 | Train Loss: 0.1939390 Vali Loss: 0.3120604 Test Loss: 0.3495419
Validation loss decreased (0.317020 --> 0.312060).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1426094
	speed: 1.8669s/iter; left time: 9550.9045s
	iters: 200, epoch: 4 | loss: 0.2094768
	speed: 0.8419s/iter; left time: 4222.8398s
	iters: 300, epoch: 4 | loss: 0.2556286
	speed: 0.8311s/iter; left time: 4085.8516s
	iters: 400, epoch: 4 | loss: 0.1536689
	speed: 0.8460s/iter; left time: 4074.3698s
	iters: 500, epoch: 4 | loss: 0.1607486
	speed: 0.8256s/iter; left time: 3893.5533s
	iters: 600, epoch: 4 | loss: 0.2160637
	speed: 0.8464s/iter; left time: 3907.0656s
	iters: 700, epoch: 4 | loss: 0.2013928
	speed: 0.8163s/iter; left time: 3686.2764s
Epoch: 4 cost time: 626.1759192943573
Epoch: 4, Steps: 745 | Train Loss: 0.1890560 Vali Loss: 0.3101847 Test Loss: 0.3466322
Validation loss decreased (0.312060 --> 0.310185).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1941485
	speed: 1.8110s/iter; left time: 7915.6794s
	iters: 200, epoch: 5 | loss: 0.1310798
	speed: 0.8233s/iter; left time: 3516.4940s
	iters: 300, epoch: 5 | loss: 0.2381739
	speed: 0.7867s/iter; left time: 3281.2485s
	iters: 400, epoch: 5 | loss: 0.1322638
	speed: 0.7955s/iter; left time: 3238.6211s
	iters: 500, epoch: 5 | loss: 0.2253069
	speed: 0.7885s/iter; left time: 3131.1414s
	iters: 600, epoch: 5 | loss: 0.2076975
	speed: 0.7849s/iter; left time: 3038.3364s
	iters: 700, epoch: 5 | loss: 0.2118539
	speed: 0.7863s/iter; left time: 2964.9804s
Epoch: 5 cost time: 597.3845162391663
Epoch: 5, Steps: 745 | Train Loss: 0.1866526 Vali Loss: 0.3067099 Test Loss: 0.3416283
Validation loss decreased (0.310185 --> 0.306710).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2275089
	speed: 1.6944s/iter; left time: 6144.0690s
	iters: 200, epoch: 6 | loss: 0.1638876
	speed: 0.7885s/iter; left time: 2780.1047s
	iters: 300, epoch: 6 | loss: 0.2144818
	speed: 0.8104s/iter; left time: 2776.2745s
	iters: 400, epoch: 6 | loss: 0.1587538
	speed: 0.7855s/iter; left time: 2612.5595s
	iters: 500, epoch: 6 | loss: 0.2773689
	speed: 0.7851s/iter; left time: 2532.7862s
	iters: 600, epoch: 6 | loss: 0.1480648
	speed: 0.7856s/iter; left time: 2455.6794s
	iters: 700, epoch: 6 | loss: 0.1615138
	speed: 0.8070s/iter; left time: 2441.8876s
Epoch: 6 cost time: 590.9281687736511
Epoch: 6, Steps: 745 | Train Loss: 0.1852997 Vali Loss: 0.3065990 Test Loss: 0.3417246
Validation loss decreased (0.306710 --> 0.306599).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1845609
	speed: 1.6686s/iter; left time: 4807.2292s
	iters: 200, epoch: 7 | loss: 0.1534843
	speed: 0.7668s/iter; left time: 2132.4637s
	iters: 300, epoch: 7 | loss: 0.2185917
	speed: 0.7673s/iter; left time: 2057.2049s
	iters: 400, epoch: 7 | loss: 0.1844714
	speed: 0.7860s/iter; left time: 2028.7612s
	iters: 500, epoch: 7 | loss: 0.2543596
	speed: 0.7719s/iter; left time: 1915.0789s
	iters: 600, epoch: 7 | loss: 0.2343182
	speed: 0.7812s/iter; left time: 1859.9822s
	iters: 700, epoch: 7 | loss: 0.1580924
	speed: 0.7718s/iter; left time: 1760.4545s
Epoch: 7 cost time: 576.6708424091339
Epoch: 7, Steps: 745 | Train Loss: 0.1846462 Vali Loss: 0.3066711 Test Loss: 0.3413458
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1556232
	speed: 1.6900s/iter; left time: 3609.8753s
	iters: 200, epoch: 8 | loss: 0.1430772
	speed: 0.7684s/iter; left time: 1564.3676s
	iters: 300, epoch: 8 | loss: 0.1968022
	speed: 0.7813s/iter; left time: 1512.6415s
	iters: 400, epoch: 8 | loss: 0.1789146
	speed: 0.7789s/iter; left time: 1430.1127s
	iters: 500, epoch: 8 | loss: 0.1468915
	speed: 0.7660s/iter; left time: 1329.7845s
	iters: 600, epoch: 8 | loss: 0.1761836
	speed: 0.7630s/iter; left time: 1248.1949s
	iters: 700, epoch: 8 | loss: 0.1829836
	speed: 0.7697s/iter; left time: 1182.3328s
Epoch: 8 cost time: 578.1630563735962
Epoch: 8, Steps: 745 | Train Loss: 0.1843254 Vali Loss: 0.3061995 Test Loss: 0.3412200
Validation loss decreased (0.306599 --> 0.306199).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1940831
	speed: 1.6587s/iter; left time: 2307.2037s
	iters: 200, epoch: 9 | loss: 0.1967373
	speed: 0.8020s/iter; left time: 1035.4440s
	iters: 300, epoch: 9 | loss: 0.1782680
	speed: 0.8610s/iter; left time: 1025.4381s
	iters: 400, epoch: 9 | loss: 0.1247950
	speed: 0.7789s/iter; left time: 849.7820s
	iters: 500, epoch: 9 | loss: 0.1904836
	speed: 0.7946s/iter; left time: 787.4760s
	iters: 600, epoch: 9 | loss: 0.2666981
	speed: 0.7920s/iter; left time: 705.6773s
	iters: 700, epoch: 9 | loss: 0.1445804
	speed: 0.7781s/iter; left time: 615.4560s
Epoch: 9 cost time: 593.4129409790039
Epoch: 9, Steps: 745 | Train Loss: 0.1840984 Vali Loss: 0.3060814 Test Loss: 0.3408044
Validation loss decreased (0.306199 --> 0.306081).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1147201
	speed: 1.6584s/iter; left time: 1071.3020s
	iters: 200, epoch: 10 | loss: 0.1897143
	speed: 0.7652s/iter; left time: 417.8152s
	iters: 300, epoch: 10 | loss: 0.2397867
	speed: 0.7839s/iter; left time: 349.6188s
	iters: 400, epoch: 10 | loss: 0.1887618
	speed: 0.7672s/iter; left time: 265.4636s
	iters: 500, epoch: 10 | loss: 0.1722472
	speed: 0.7677s/iter; left time: 188.8429s
	iters: 600, epoch: 10 | loss: 0.1704920
	speed: 0.7690s/iter; left time: 112.2679s
	iters: 700, epoch: 10 | loss: 0.2065805
	speed: 0.7655s/iter; left time: 35.2115s
Epoch: 10 cost time: 573.5518963336945
Epoch: 10, Steps: 745 | Train Loss: 0.1839782 Vali Loss: 0.3059917 Test Loss: 0.3409013
Validation loss decreased (0.306081 --> 0.305992).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_12_DNGRevLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3497
mse:0.34117043018341064, mae:0.2498592883348465
