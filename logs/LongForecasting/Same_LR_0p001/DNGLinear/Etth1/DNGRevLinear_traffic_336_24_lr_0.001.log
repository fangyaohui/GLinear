Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DNGRevLinear', model_id='traffic_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_24_DNGRevLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11921
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.2273999
	speed: 0.8050s/iter; left time: 5917.2889s
	iters: 200, epoch: 1 | loss: 0.2498088
	speed: 0.7878s/iter; left time: 5712.2746s
	iters: 300, epoch: 1 | loss: 0.1875731
	speed: 0.7706s/iter; left time: 5510.2730s
	iters: 400, epoch: 1 | loss: 0.2068755
	speed: 0.7689s/iter; left time: 5421.4722s
	iters: 500, epoch: 1 | loss: 0.2851475
	speed: 0.7768s/iter; left time: 5399.6394s
	iters: 600, epoch: 1 | loss: 0.1952978
	speed: 0.7735s/iter; left time: 5299.5791s
	iters: 700, epoch: 1 | loss: 0.2239068
	speed: 0.7862s/iter; left time: 5307.8230s
Epoch: 1 cost time: 581.8839251995087
Epoch: 1, Steps: 745 | Train Loss: 0.2442191 Vali Loss: 0.3314598 Test Loss: 0.3793555
Validation loss decreased (inf --> 0.331460).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2134229
	speed: 1.6794s/iter; left time: 11094.1685s
	iters: 200, epoch: 2 | loss: 0.2105434
	speed: 0.7655s/iter; left time: 4980.4178s
	iters: 300, epoch: 2 | loss: 0.2338540
	speed: 0.7673s/iter; left time: 4915.1617s
	iters: 400, epoch: 2 | loss: 0.1892851
	speed: 0.7747s/iter; left time: 4885.1190s
	iters: 500, epoch: 2 | loss: 0.2333357
	speed: 0.7645s/iter; left time: 4744.7660s
	iters: 600, epoch: 2 | loss: 0.1959410
	speed: 0.7944s/iter; left time: 4850.8822s
	iters: 700, epoch: 2 | loss: 0.1894319
	speed: 0.7741s/iter; left time: 4649.2191s
Epoch: 2 cost time: 577.0703263282776
Epoch: 2, Steps: 745 | Train Loss: 0.2137000 Vali Loss: 0.3301556 Test Loss: 0.3731489
Validation loss decreased (0.331460 --> 0.330156).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2340033
	speed: 1.7212s/iter; left time: 10088.0789s
	iters: 200, epoch: 3 | loss: 0.1886445
	speed: 0.7711s/iter; left time: 4442.2386s
	iters: 300, epoch: 3 | loss: 0.1809724
	speed: 0.7974s/iter; left time: 4514.2210s
	iters: 400, epoch: 3 | loss: 0.1818963
	speed: 0.7838s/iter; left time: 4358.6942s
	iters: 500, epoch: 3 | loss: 0.2519172
	speed: 0.7766s/iter; left time: 4241.1158s
	iters: 600, epoch: 3 | loss: 0.2325085
	speed: 0.7572s/iter; left time: 4059.2873s
	iters: 700, epoch: 3 | loss: 0.2050754
	speed: 0.7646s/iter; left time: 4022.3532s
Epoch: 3 cost time: 576.237936258316
Epoch: 3, Steps: 745 | Train Loss: 0.2032797 Vali Loss: 0.3237049 Test Loss: 0.3629628
Validation loss decreased (0.330156 --> 0.323705).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1892849
	speed: 1.6678s/iter; left time: 8532.5181s
	iters: 200, epoch: 4 | loss: 0.2044074
	speed: 0.7623s/iter; left time: 3823.6717s
	iters: 300, epoch: 4 | loss: 0.1866993
	speed: 0.7696s/iter; left time: 3783.2612s
	iters: 400, epoch: 4 | loss: 0.2151279
	speed: 0.7933s/iter; left time: 3820.6895s
	iters: 500, epoch: 4 | loss: 0.1907264
	speed: 0.7714s/iter; left time: 3637.8346s
	iters: 600, epoch: 4 | loss: 0.2209508
	speed: 0.7998s/iter; left time: 3692.0788s
	iters: 700, epoch: 4 | loss: 0.1587505
	speed: 0.7780s/iter; left time: 3513.5880s
Epoch: 4 cost time: 579.5624167919159
Epoch: 4, Steps: 745 | Train Loss: 0.1985498 Vali Loss: 0.3212610 Test Loss: 0.3597137
Validation loss decreased (0.323705 --> 0.321261).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2114744
	speed: 1.6690s/iter; left time: 7295.1616s
	iters: 200, epoch: 5 | loss: 0.1840059
	speed: 0.7617s/iter; left time: 3253.2581s
	iters: 300, epoch: 5 | loss: 0.1925799
	speed: 0.7623s/iter; left time: 3179.6861s
	iters: 400, epoch: 5 | loss: 0.1751192
	speed: 0.7594s/iter; left time: 3091.4709s
	iters: 500, epoch: 5 | loss: 0.1824400
	speed: 0.7655s/iter; left time: 3039.8367s
	iters: 600, epoch: 5 | loss: 0.1906510
	speed: 0.7687s/iter; left time: 2975.7611s
	iters: 700, epoch: 5 | loss: 0.1737124
	speed: 0.7720s/iter; left time: 2911.1603s
Epoch: 5 cost time: 569.233069896698
Epoch: 5, Steps: 745 | Train Loss: 0.1962165 Vali Loss: 0.3200014 Test Loss: 0.3578214
Validation loss decreased (0.321261 --> 0.320001).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1677626
	speed: 1.6778s/iter; left time: 6083.8791s
	iters: 200, epoch: 6 | loss: 0.1481789
	speed: 0.7618s/iter; left time: 2686.2574s
	iters: 300, epoch: 6 | loss: 0.2435775
	speed: 0.7764s/iter; left time: 2659.7839s
	iters: 400, epoch: 6 | loss: 0.1584249
	speed: 0.7695s/iter; left time: 2559.3581s
	iters: 500, epoch: 6 | loss: 0.1930187
	speed: 0.7531s/iter; left time: 2429.4049s
	iters: 600, epoch: 6 | loss: 0.1810276
	speed: 0.7634s/iter; left time: 2386.3971s
	iters: 700, epoch: 6 | loss: 0.2374413
	speed: 0.7657s/iter; left time: 2316.8835s
Epoch: 6 cost time: 571.1850283145905
Epoch: 6, Steps: 745 | Train Loss: 0.1949126 Vali Loss: 0.3186823 Test Loss: 0.3567286
Validation loss decreased (0.320001 --> 0.318682).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1686781
	speed: 1.6806s/iter; left time: 4841.9237s
	iters: 200, epoch: 7 | loss: 0.1672044
	speed: 0.7700s/iter; left time: 2141.3103s
	iters: 300, epoch: 7 | loss: 0.1934612
	speed: 0.7869s/iter; left time: 2109.7200s
	iters: 400, epoch: 7 | loss: 0.2301064
	speed: 0.7839s/iter; left time: 2023.1405s
	iters: 500, epoch: 7 | loss: 0.2134819
	speed: 0.7672s/iter; left time: 1903.3685s
	iters: 600, epoch: 7 | loss: 0.1556256
	speed: 0.7650s/iter; left time: 1821.5529s
	iters: 700, epoch: 7 | loss: 0.1572897
	speed: 0.7686s/iter; left time: 1753.2199s
Epoch: 7 cost time: 576.7309710979462
Epoch: 7, Steps: 745 | Train Loss: 0.1942418 Vali Loss: 0.3183787 Test Loss: 0.3567708
Validation loss decreased (0.318682 --> 0.318379).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1767449
	speed: 1.7165s/iter; left time: 3666.3842s
	iters: 200, epoch: 8 | loss: 0.2041351
	speed: 0.7628s/iter; left time: 1553.0761s
	iters: 300, epoch: 8 | loss: 0.1721575
	speed: 0.8027s/iter; left time: 1554.0671s
	iters: 400, epoch: 8 | loss: 0.2283347
	speed: 0.7786s/iter; left time: 1429.5725s
	iters: 500, epoch: 8 | loss: 0.2209029
	speed: 0.7922s/iter; left time: 1375.2176s
	iters: 600, epoch: 8 | loss: 0.1750012
	speed: 0.7838s/iter; left time: 1282.2939s
	iters: 700, epoch: 8 | loss: 0.1905897
	speed: 0.7764s/iter; left time: 1192.4749s
Epoch: 8 cost time: 585.5190579891205
Epoch: 8, Steps: 745 | Train Loss: 0.1939301 Vali Loss: 0.3185911 Test Loss: 0.3563315
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3308343
	speed: 1.7739s/iter; left time: 2467.5164s
	iters: 200, epoch: 9 | loss: 0.2782544
	speed: 0.7703s/iter; left time: 994.3943s
	iters: 300, epoch: 9 | loss: 0.1870563
	speed: 0.7678s/iter; left time: 914.5056s
	iters: 400, epoch: 9 | loss: 0.1789033
	speed: 0.7703s/iter; left time: 840.3952s
	iters: 500, epoch: 9 | loss: 0.2272046
	speed: 0.7730s/iter; left time: 766.0703s
	iters: 600, epoch: 9 | loss: 0.1814429
	speed: 0.7691s/iter; left time: 685.2548s
	iters: 700, epoch: 9 | loss: 0.1839611
	speed: 0.7828s/iter; left time: 619.2068s
Epoch: 9 cost time: 584.3519761562347
Epoch: 9, Steps: 745 | Train Loss: 0.1937138 Vali Loss: 0.3184350 Test Loss: 0.3562255
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2660784
	speed: 1.6736s/iter; left time: 1081.1567s
	iters: 200, epoch: 10 | loss: 0.2396456
	speed: 0.7626s/iter; left time: 416.3684s
	iters: 300, epoch: 10 | loss: 0.2106781
	speed: 0.7693s/iter; left time: 343.1129s
	iters: 400, epoch: 10 | loss: 0.2795171
	speed: 0.7581s/iter; left time: 262.3024s
	iters: 500, epoch: 10 | loss: 0.1879392
	speed: 0.7731s/iter; left time: 190.1721s
	iters: 600, epoch: 10 | loss: 0.2087915
	speed: 0.7624s/iter; left time: 111.3077s
	iters: 700, epoch: 10 | loss: 0.1898035
	speed: 0.7535s/iter; left time: 34.6614s
Epoch: 10 cost time: 569.2889120578766
Epoch: 10, Steps: 745 | Train Loss: 0.1936180 Vali Loss: 0.3186842 Test Loss: 0.3560708
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_24_DNGRevLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.3569340705871582, mae:0.2584644556045532
