Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.3275051
	speed: 0.0366s/iter; left time: 261.9481s
	iters: 200, epoch: 1 | loss: 0.3070794
	speed: 0.0303s/iter; left time: 213.5912s
	iters: 300, epoch: 1 | loss: 0.2827295
	speed: 0.0299s/iter; left time: 208.1627s
	iters: 400, epoch: 1 | loss: 0.2950734
	speed: 0.0292s/iter; left time: 200.1969s
	iters: 500, epoch: 1 | loss: 0.2611603
	speed: 0.0300s/iter; left time: 202.4432s
	iters: 600, epoch: 1 | loss: 0.2911010
	speed: 0.0295s/iter; left time: 196.0473s
	iters: 700, epoch: 1 | loss: 0.2741749
	speed: 0.0295s/iter; left time: 193.4967s
Epoch: 1 cost time: 22.299512147903442
Epoch: 1, Steps: 725 | Train Loss: 0.3043351 Vali Loss: 0.3772349 Test Loss: 0.4563448
Validation loss decreased (inf --> 0.377235).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2859675
	speed: 0.1730s/iter; left time: 1111.7876s
	iters: 200, epoch: 2 | loss: 0.2844682
	speed: 0.0305s/iter; left time: 192.7591s
	iters: 300, epoch: 2 | loss: 0.2951765
	speed: 0.0302s/iter; left time: 188.3037s
	iters: 400, epoch: 2 | loss: 0.2863894
	speed: 0.0307s/iter; left time: 188.3702s
	iters: 500, epoch: 2 | loss: 0.2935151
	speed: 0.0302s/iter; left time: 181.9418s
	iters: 600, epoch: 2 | loss: 0.2642002
	speed: 0.0293s/iter; left time: 173.8910s
	iters: 700, epoch: 2 | loss: 0.2760407
	speed: 0.0306s/iter; left time: 178.5512s
Epoch: 2 cost time: 22.724066972732544
Epoch: 2, Steps: 725 | Train Loss: 0.2709212 Vali Loss: 0.3693155 Test Loss: 0.4460290
Validation loss decreased (0.377235 --> 0.369316).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2785371
	speed: 0.1738s/iter; left time: 990.9509s
	iters: 200, epoch: 3 | loss: 0.2681421
	speed: 0.0303s/iter; left time: 169.5467s
	iters: 300, epoch: 3 | loss: 0.2411941
	speed: 0.0295s/iter; left time: 162.5115s
	iters: 400, epoch: 3 | loss: 0.2576804
	speed: 0.0299s/iter; left time: 161.2233s
	iters: 500, epoch: 3 | loss: 0.2512751
	speed: 0.0300s/iter; left time: 158.9862s
	iters: 600, epoch: 3 | loss: 0.2501509
	speed: 0.0306s/iter; left time: 159.0860s
	iters: 700, epoch: 3 | loss: 0.2601590
	speed: 0.0298s/iter; left time: 152.2067s
Epoch: 3 cost time: 22.509002685546875
Epoch: 3, Steps: 725 | Train Loss: 0.2659843 Vali Loss: 0.3672893 Test Loss: 0.4439872
Validation loss decreased (0.369316 --> 0.367289).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2801978
	speed: 0.1747s/iter; left time: 869.3518s
	iters: 200, epoch: 4 | loss: 0.2797505
	speed: 0.0306s/iter; left time: 149.3165s
	iters: 300, epoch: 4 | loss: 0.2593613
	speed: 0.0301s/iter; left time: 143.8184s
	iters: 400, epoch: 4 | loss: 0.2582629
	speed: 0.0303s/iter; left time: 141.7269s
	iters: 500, epoch: 4 | loss: 0.2852980
	speed: 0.0299s/iter; left time: 136.9394s
	iters: 600, epoch: 4 | loss: 0.2739643
	speed: 0.0296s/iter; left time: 132.5638s
	iters: 700, epoch: 4 | loss: 0.2555889
	speed: 0.0306s/iter; left time: 133.6995s
Epoch: 4 cost time: 22.680362462997437
Epoch: 4, Steps: 725 | Train Loss: 0.2639763 Vali Loss: 0.3630677 Test Loss: 0.4391644
Validation loss decreased (0.367289 --> 0.363068).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2676281
	speed: 0.1708s/iter; left time: 726.0567s
	iters: 200, epoch: 5 | loss: 0.2933643
	speed: 0.0295s/iter; left time: 122.6306s
	iters: 300, epoch: 5 | loss: 0.2590282
	speed: 0.0304s/iter; left time: 123.2969s
	iters: 400, epoch: 5 | loss: 0.2655008
	speed: 0.0299s/iter; left time: 118.2069s
	iters: 500, epoch: 5 | loss: 0.2594581
	speed: 0.0301s/iter; left time: 115.8242s
	iters: 600, epoch: 5 | loss: 0.2538584
	speed: 0.0303s/iter; left time: 113.6377s
	iters: 700, epoch: 5 | loss: 0.2869780
	speed: 0.0302s/iter; left time: 110.0902s
Epoch: 5 cost time: 22.402428150177002
Epoch: 5, Steps: 725 | Train Loss: 0.2629609 Vali Loss: 0.3629990 Test Loss: 0.4386630
Validation loss decreased (0.363068 --> 0.362999).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2613987
	speed: 0.1731s/iter; left time: 610.2785s
	iters: 200, epoch: 6 | loss: 0.2761213
	speed: 0.0313s/iter; left time: 107.1137s
	iters: 300, epoch: 6 | loss: 0.2759083
	speed: 0.0298s/iter; left time: 99.1195s
	iters: 400, epoch: 6 | loss: 0.2676464
	speed: 0.0296s/iter; left time: 95.5669s
	iters: 500, epoch: 6 | loss: 0.2689229
	speed: 0.0305s/iter; left time: 95.4326s
	iters: 600, epoch: 6 | loss: 0.2511139
	speed: 0.0302s/iter; left time: 91.2355s
	iters: 700, epoch: 6 | loss: 0.2575580
	speed: 0.0300s/iter; left time: 87.7902s
Epoch: 6 cost time: 22.5555899143219
Epoch: 6, Steps: 725 | Train Loss: 0.2623481 Vali Loss: 0.3615808 Test Loss: 0.4377219
Validation loss decreased (0.362999 --> 0.361581).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2738013
	speed: 0.1756s/iter; left time: 491.9654s
	iters: 200, epoch: 7 | loss: 0.2448002
	speed: 0.0306s/iter; left time: 82.5168s
	iters: 300, epoch: 7 | loss: 0.2467052
	speed: 0.0305s/iter; left time: 79.2911s
	iters: 400, epoch: 7 | loss: 0.2577070
	speed: 0.0305s/iter; left time: 76.3722s
	iters: 500, epoch: 7 | loss: 0.2761320
	speed: 0.0303s/iter; left time: 72.8660s
	iters: 600, epoch: 7 | loss: 0.2595647
	speed: 0.0303s/iter; left time: 69.8313s
	iters: 700, epoch: 7 | loss: 0.2500036
	speed: 0.0304s/iter; left time: 67.0093s
Epoch: 7 cost time: 22.812130212783813
Epoch: 7, Steps: 725 | Train Loss: 0.2621005 Vali Loss: 0.3617122 Test Loss: 0.4375566
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2366765
	speed: 0.1723s/iter; left time: 357.7582s
	iters: 200, epoch: 8 | loss: 0.2503646
	speed: 0.0305s/iter; left time: 60.2522s
	iters: 300, epoch: 8 | loss: 0.2357817
	speed: 0.0298s/iter; left time: 55.9624s
	iters: 400, epoch: 8 | loss: 0.2813295
	speed: 0.0295s/iter; left time: 52.3135s
	iters: 500, epoch: 8 | loss: 0.2456665
	speed: 0.0301s/iter; left time: 50.5136s
	iters: 600, epoch: 8 | loss: 0.2734340
	speed: 0.0303s/iter; left time: 47.7076s
	iters: 700, epoch: 8 | loss: 0.2596005
	speed: 0.0301s/iter; left time: 44.4050s
Epoch: 8 cost time: 22.593129634857178
Epoch: 8, Steps: 725 | Train Loss: 0.2619467 Vali Loss: 0.3616589 Test Loss: 0.4373517
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2373476
	speed: 0.1741s/iter; left time: 235.1914s
	iters: 200, epoch: 9 | loss: 0.2886423
	speed: 0.0302s/iter; left time: 37.7960s
	iters: 300, epoch: 9 | loss: 0.2548281
	speed: 0.0302s/iter; left time: 34.7584s
	iters: 400, epoch: 9 | loss: 0.2421387
	speed: 0.0309s/iter; left time: 32.4672s
	iters: 500, epoch: 9 | loss: 0.2556196
	speed: 0.0303s/iter; left time: 28.7725s
	iters: 600, epoch: 9 | loss: 0.2826166
	speed: 0.0300s/iter; left time: 25.5380s
	iters: 700, epoch: 9 | loss: 0.2669888
	speed: 0.0308s/iter; left time: 23.1627s
Epoch: 9 cost time: 22.781885147094727
Epoch: 9, Steps: 725 | Train Loss: 0.2618530 Vali Loss: 0.3615652 Test Loss: 0.4372407
Validation loss decreased (0.361581 --> 0.361565).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2396747
	speed: 0.1748s/iter; left time: 109.4375s
	iters: 200, epoch: 10 | loss: 0.2359541
	speed: 0.0310s/iter; left time: 16.3033s
	iters: 300, epoch: 10 | loss: 0.2539172
	speed: 0.0301s/iter; left time: 12.8145s
	iters: 400, epoch: 10 | loss: 0.2592499
	speed: 0.0301s/iter; left time: 9.8197s
	iters: 500, epoch: 10 | loss: 0.2786056
	speed: 0.0299s/iter; left time: 6.7619s
	iters: 600, epoch: 10 | loss: 0.2496036
	speed: 0.0299s/iter; left time: 3.7686s
	iters: 700, epoch: 10 | loss: 0.2509600
	speed: 0.0294s/iter; left time: 0.7654s
Epoch: 10 cost time: 22.50735330581665
Epoch: 10, Steps: 725 | Train Loss: 0.2618228 Vali Loss: 0.3613110 Test Loss: 0.4372276
Validation loss decreased (0.361565 --> 0.361311).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4362032413482666, mae:0.296102374792099
