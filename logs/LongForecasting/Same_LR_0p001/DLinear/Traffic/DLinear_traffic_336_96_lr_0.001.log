Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.3002046
	speed: 0.0271s/iter; left time: 197.4960s
	iters: 200, epoch: 1 | loss: 0.2771395
	speed: 0.0213s/iter; left time: 153.3139s
	iters: 300, epoch: 1 | loss: 0.2334540
	speed: 0.0214s/iter; left time: 151.8308s
	iters: 400, epoch: 1 | loss: 0.2578619
	speed: 0.0211s/iter; left time: 147.8636s
	iters: 500, epoch: 1 | loss: 0.2588146
	speed: 0.0211s/iter; left time: 145.3203s
	iters: 600, epoch: 1 | loss: 0.2285038
	speed: 0.0209s/iter; left time: 141.8627s
	iters: 700, epoch: 1 | loss: 0.2603108
	speed: 0.0211s/iter; left time: 141.4117s
Epoch: 1 cost time: 16.322208642959595
Epoch: 1, Steps: 740 | Train Loss: 0.2867349 Vali Loss: 0.3503483 Test Loss: 0.4240475
Validation loss decreased (inf --> 0.350348).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2568892
	speed: 0.1273s/iter; left time: 835.3509s
	iters: 200, epoch: 2 | loss: 0.2448827
	speed: 0.0209s/iter; left time: 135.2758s
	iters: 300, epoch: 2 | loss: 0.2184775
	speed: 0.0211s/iter; left time: 134.3489s
	iters: 400, epoch: 2 | loss: 0.2627871
	speed: 0.0212s/iter; left time: 132.6586s
	iters: 500, epoch: 2 | loss: 0.2656925
	speed: 0.0213s/iter; left time: 131.1048s
	iters: 600, epoch: 2 | loss: 0.2455203
	speed: 0.0213s/iter; left time: 129.3168s
	iters: 700, epoch: 2 | loss: 0.2482980
	speed: 0.0210s/iter; left time: 125.3592s
Epoch: 2 cost time: 16.339777946472168
Epoch: 2, Steps: 740 | Train Loss: 0.2533035 Vali Loss: 0.3482714 Test Loss: 0.4210030
Validation loss decreased (0.350348 --> 0.348271).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2602042
	speed: 0.1303s/iter; left time: 758.4512s
	iters: 200, epoch: 3 | loss: 0.2596377
	speed: 0.0223s/iter; left time: 127.7552s
	iters: 300, epoch: 3 | loss: 0.2498300
	speed: 0.0211s/iter; left time: 118.8655s
	iters: 400, epoch: 3 | loss: 0.2517334
	speed: 0.0217s/iter; left time: 119.8975s
	iters: 500, epoch: 3 | loss: 0.2489353
	speed: 0.0209s/iter; left time: 113.2306s
	iters: 600, epoch: 3 | loss: 0.2746994
	speed: 0.0223s/iter; left time: 118.7146s
	iters: 700, epoch: 3 | loss: 0.2502574
	speed: 0.0218s/iter; left time: 113.9347s
Epoch: 3 cost time: 16.723090648651123
Epoch: 3, Steps: 740 | Train Loss: 0.2490059 Vali Loss: 0.3422213 Test Loss: 0.4140341
Validation loss decreased (0.348271 --> 0.342221).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2521935
	speed: 0.1265s/iter; left time: 642.5738s
	iters: 200, epoch: 4 | loss: 0.2696366
	speed: 0.0212s/iter; left time: 105.5106s
	iters: 300, epoch: 4 | loss: 0.2387653
	speed: 0.0209s/iter; left time: 101.9672s
	iters: 400, epoch: 4 | loss: 0.3039457
	speed: 0.0215s/iter; left time: 103.0138s
	iters: 500, epoch: 4 | loss: 0.2686649
	speed: 0.0210s/iter; left time: 98.1520s
	iters: 600, epoch: 4 | loss: 0.2327433
	speed: 0.0212s/iter; left time: 97.0686s
	iters: 700, epoch: 4 | loss: 0.2261174
	speed: 0.0213s/iter; left time: 95.4260s
Epoch: 4 cost time: 16.317232847213745
Epoch: 4, Steps: 740 | Train Loss: 0.2471087 Vali Loss: 0.3400731 Test Loss: 0.4120344
Validation loss decreased (0.342221 --> 0.340073).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2400748
	speed: 0.1264s/iter; left time: 548.7316s
	iters: 200, epoch: 5 | loss: 0.2433056
	speed: 0.0213s/iter; left time: 90.2638s
	iters: 300, epoch: 5 | loss: 0.2616052
	speed: 0.0212s/iter; left time: 87.7333s
	iters: 400, epoch: 5 | loss: 0.2579822
	speed: 0.0208s/iter; left time: 84.1954s
	iters: 500, epoch: 5 | loss: 0.2764921
	speed: 0.0216s/iter; left time: 84.9618s
	iters: 600, epoch: 5 | loss: 0.2566921
	speed: 0.0209s/iter; left time: 80.2170s
	iters: 700, epoch: 5 | loss: 0.2629253
	speed: 0.0214s/iter; left time: 80.0405s
Epoch: 5 cost time: 16.447869300842285
Epoch: 5, Steps: 740 | Train Loss: 0.2462055 Vali Loss: 0.3394575 Test Loss: 0.4108140
Validation loss decreased (0.340073 --> 0.339458).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2516004
	speed: 0.1286s/iter; left time: 462.9610s
	iters: 200, epoch: 6 | loss: 0.2529498
	speed: 0.0209s/iter; left time: 73.1078s
	iters: 300, epoch: 6 | loss: 0.2631719
	speed: 0.0210s/iter; left time: 71.2724s
	iters: 400, epoch: 6 | loss: 0.2462763
	speed: 0.0215s/iter; left time: 71.0134s
	iters: 500, epoch: 6 | loss: 0.2537082
	speed: 0.0222s/iter; left time: 71.1434s
	iters: 600, epoch: 6 | loss: 0.2376908
	speed: 0.0233s/iter; left time: 72.3803s
	iters: 700, epoch: 6 | loss: 0.2949440
	speed: 0.0266s/iter; left time: 79.7483s
Epoch: 6 cost time: 17.311609983444214
Epoch: 6, Steps: 740 | Train Loss: 0.2456908 Vali Loss: 0.3396547 Test Loss: 0.4104295
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2354724
	speed: 0.1274s/iter; left time: 364.4857s
	iters: 200, epoch: 7 | loss: 0.2620993
	speed: 0.0222s/iter; left time: 61.4291s
	iters: 300, epoch: 7 | loss: 0.2351330
	speed: 0.0205s/iter; left time: 54.6531s
	iters: 400, epoch: 7 | loss: 0.2629133
	speed: 0.0210s/iter; left time: 53.7710s
	iters: 500, epoch: 7 | loss: 0.2339305
	speed: 0.0214s/iter; left time: 52.5517s
	iters: 600, epoch: 7 | loss: 0.2438703
	speed: 0.0206s/iter; left time: 48.5384s
	iters: 700, epoch: 7 | loss: 0.2652257
	speed: 0.0217s/iter; left time: 48.9695s
Epoch: 7 cost time: 16.48754858970642
Epoch: 7, Steps: 740 | Train Loss: 0.2453890 Vali Loss: 0.3388271 Test Loss: 0.4101730
Validation loss decreased (0.339458 --> 0.338827).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2689683
	speed: 0.1272s/iter; left time: 269.7634s
	iters: 200, epoch: 8 | loss: 0.2593260
	speed: 0.0213s/iter; left time: 43.0920s
	iters: 300, epoch: 8 | loss: 0.2337672
	speed: 0.0218s/iter; left time: 41.8693s
	iters: 400, epoch: 8 | loss: 0.2608774
	speed: 0.0208s/iter; left time: 37.8170s
	iters: 500, epoch: 8 | loss: 0.2591615
	speed: 0.0214s/iter; left time: 36.7676s
	iters: 600, epoch: 8 | loss: 0.2348851
	speed: 0.0213s/iter; left time: 34.6014s
	iters: 700, epoch: 8 | loss: 0.2618884
	speed: 0.0211s/iter; left time: 32.0811s
Epoch: 8 cost time: 16.504677057266235
Epoch: 8, Steps: 740 | Train Loss: 0.2452414 Vali Loss: 0.3388589 Test Loss: 0.4099816
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2637447
	speed: 0.1271s/iter; left time: 175.5343s
	iters: 200, epoch: 9 | loss: 0.2255711
	speed: 0.0236s/iter; left time: 30.2038s
	iters: 300, epoch: 9 | loss: 0.2419754
	speed: 0.0263s/iter; left time: 31.1175s
	iters: 400, epoch: 9 | loss: 0.2664483
	speed: 0.0254s/iter; left time: 27.4264s
	iters: 500, epoch: 9 | loss: 0.2454014
	speed: 0.0269s/iter; left time: 26.3497s
	iters: 600, epoch: 9 | loss: 0.2425528
	speed: 0.0247s/iter; left time: 21.7815s
	iters: 700, epoch: 9 | loss: 0.2248692
	speed: 0.0247s/iter; left time: 19.2949s
Epoch: 9 cost time: 18.964617252349854
Epoch: 9, Steps: 740 | Train Loss: 0.2451696 Vali Loss: 0.3391395 Test Loss: 0.4099367
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2133803
	speed: 0.1268s/iter; left time: 81.2661s
	iters: 200, epoch: 10 | loss: 0.2235423
	speed: 0.0222s/iter; left time: 12.0141s
	iters: 300, epoch: 10 | loss: 0.2502459
	speed: 0.0212s/iter; left time: 9.3510s
	iters: 400, epoch: 10 | loss: 0.2445925
	speed: 0.0258s/iter; left time: 8.8002s
	iters: 500, epoch: 10 | loss: 0.2730326
	speed: 0.0255s/iter; left time: 6.1493s
	iters: 600, epoch: 10 | loss: 0.2391530
	speed: 0.0235s/iter; left time: 3.3069s
	iters: 700, epoch: 10 | loss: 0.2550168
	speed: 0.0260s/iter; left time: 1.0646s
Epoch: 10 cost time: 18.052979469299316
Epoch: 10, Steps: 740 | Train Loss: 0.2450997 Vali Loss: 0.3391447 Test Loss: 0.4099526
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4104497730731964, mae:0.2828654944896698
