Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_48', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=48, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_48_DLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1709
test 3461
	iters: 100, epoch: 1 | loss: 0.3077770
	speed: 0.0243s/iter; left time: 178.3022s
	iters: 200, epoch: 1 | loss: 0.2926187
	speed: 0.0192s/iter; left time: 138.5584s
	iters: 300, epoch: 1 | loss: 0.2264301
	speed: 0.0193s/iter; left time: 137.8598s
	iters: 400, epoch: 1 | loss: 0.2531044
	speed: 0.0199s/iter; left time: 139.9522s
	iters: 500, epoch: 1 | loss: 0.2987322
	speed: 0.0194s/iter; left time: 134.4614s
	iters: 600, epoch: 1 | loss: 0.2162766
	speed: 0.0232s/iter; left time: 158.1659s
	iters: 700, epoch: 1 | loss: 0.2089897
	speed: 0.0206s/iter; left time: 138.5877s
Epoch: 1 cost time: 15.475114583969116
Epoch: 1, Steps: 743 | Train Loss: 0.2791168 Vali Loss: 0.3412098 Test Loss: 0.4058781
Validation loss decreased (inf --> 0.341210).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2314482
	speed: 0.1140s/iter; left time: 751.0285s
	iters: 200, epoch: 2 | loss: 0.2574917
	speed: 0.0203s/iter; left time: 131.7954s
	iters: 300, epoch: 2 | loss: 0.1859361
	speed: 0.0194s/iter; left time: 123.6215s
	iters: 400, epoch: 2 | loss: 0.2044523
	speed: 0.0198s/iter; left time: 124.4328s
	iters: 500, epoch: 2 | loss: 0.2358391
	speed: 0.0202s/iter; left time: 124.7914s
	iters: 600, epoch: 2 | loss: 0.1997191
	speed: 0.0205s/iter; left time: 125.0946s
	iters: 700, epoch: 2 | loss: 0.2266122
	speed: 0.0186s/iter; left time: 111.1642s
Epoch: 2 cost time: 15.36643671989441
Epoch: 2, Steps: 743 | Train Loss: 0.2467610 Vali Loss: 0.3395015 Test Loss: 0.4023208
Validation loss decreased (0.341210 --> 0.339502).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2732562
	speed: 0.1130s/iter; left time: 660.3078s
	iters: 200, epoch: 3 | loss: 0.2458715
	speed: 0.0193s/iter; left time: 110.7746s
	iters: 300, epoch: 3 | loss: 0.2296506
	speed: 0.0197s/iter; left time: 111.4768s
	iters: 400, epoch: 3 | loss: 0.2553826
	speed: 0.0192s/iter; left time: 106.2919s
	iters: 500, epoch: 3 | loss: 0.2191121
	speed: 0.0195s/iter; left time: 106.0732s
	iters: 600, epoch: 3 | loss: 0.2413522
	speed: 0.0194s/iter; left time: 103.9019s
	iters: 700, epoch: 3 | loss: 0.2640462
	speed: 0.0200s/iter; left time: 104.7345s
Epoch: 3 cost time: 15.236018657684326
Epoch: 3, Steps: 743 | Train Loss: 0.2424503 Vali Loss: 0.3368409 Test Loss: 0.3978706
Validation loss decreased (0.339502 --> 0.336841).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2333117
	speed: 0.1120s/iter; left time: 571.5094s
	iters: 200, epoch: 4 | loss: 0.2264560
	speed: 0.0193s/iter; left time: 96.5848s
	iters: 300, epoch: 4 | loss: 0.2875344
	speed: 0.0204s/iter; left time: 99.7940s
	iters: 400, epoch: 4 | loss: 0.2274006
	speed: 0.0200s/iter; left time: 96.2391s
	iters: 500, epoch: 4 | loss: 0.2148778
	speed: 0.0193s/iter; left time: 90.8928s
	iters: 600, epoch: 4 | loss: 0.2470725
	speed: 0.0199s/iter; left time: 91.5849s
	iters: 700, epoch: 4 | loss: 0.2141492
	speed: 0.0194s/iter; left time: 87.3470s
Epoch: 4 cost time: 15.272071123123169
Epoch: 4, Steps: 743 | Train Loss: 0.2406190 Vali Loss: 0.3329616 Test Loss: 0.3946463
Validation loss decreased (0.336841 --> 0.332962).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2576591
	speed: 0.1140s/iter; left time: 497.0663s
	iters: 200, epoch: 5 | loss: 0.2305670
	speed: 0.0199s/iter; left time: 84.7824s
	iters: 300, epoch: 5 | loss: 0.2197098
	speed: 0.0201s/iter; left time: 83.4840s
	iters: 400, epoch: 5 | loss: 0.2401052
	speed: 0.0195s/iter; left time: 79.3460s
	iters: 500, epoch: 5 | loss: 0.2444751
	speed: 0.0206s/iter; left time: 81.5360s
	iters: 600, epoch: 5 | loss: 0.2867877
	speed: 0.0194s/iter; left time: 74.9880s
	iters: 700, epoch: 5 | loss: 0.2539589
	speed: 0.0205s/iter; left time: 77.0645s
Epoch: 5 cost time: 15.470671653747559
Epoch: 5, Steps: 743 | Train Loss: 0.2396633 Vali Loss: 0.3322917 Test Loss: 0.3942343
Validation loss decreased (0.332962 --> 0.332292).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1911781
	speed: 0.1136s/iter; left time: 410.6527s
	iters: 200, epoch: 6 | loss: 0.2772446
	speed: 0.0200s/iter; left time: 70.1711s
	iters: 300, epoch: 6 | loss: 0.2729888
	speed: 0.0192s/iter; left time: 65.7467s
	iters: 400, epoch: 6 | loss: 0.3010585
	speed: 0.0201s/iter; left time: 66.5421s
	iters: 500, epoch: 6 | loss: 0.2763545
	speed: 0.0191s/iter; left time: 61.5131s
	iters: 600, epoch: 6 | loss: 0.2716016
	speed: 0.0211s/iter; left time: 65.7293s
	iters: 700, epoch: 6 | loss: 0.2189661
	speed: 0.0194s/iter; left time: 58.4553s
Epoch: 6 cost time: 15.389573812484741
Epoch: 6, Steps: 743 | Train Loss: 0.2392048 Vali Loss: 0.3313999 Test Loss: 0.3931777
Validation loss decreased (0.332292 --> 0.331400).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2158945
	speed: 0.1149s/iter; left time: 330.1970s
	iters: 200, epoch: 7 | loss: 0.2000159
	speed: 0.0199s/iter; left time: 55.2496s
	iters: 300, epoch: 7 | loss: 0.2315895
	speed: 0.0200s/iter; left time: 53.5903s
	iters: 400, epoch: 7 | loss: 0.3018010
	speed: 0.0191s/iter; left time: 49.1346s
	iters: 500, epoch: 7 | loss: 0.2027035
	speed: 0.0204s/iter; left time: 50.4305s
	iters: 600, epoch: 7 | loss: 0.2294218
	speed: 0.0197s/iter; left time: 46.7256s
	iters: 700, epoch: 7 | loss: 0.2666507
	speed: 0.0199s/iter; left time: 45.2898s
Epoch: 7 cost time: 15.443530321121216
Epoch: 7, Steps: 743 | Train Loss: 0.2389367 Vali Loss: 0.3311643 Test Loss: 0.3925679
Validation loss decreased (0.331400 --> 0.331164).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2399724
	speed: 0.1143s/iter; left time: 243.4441s
	iters: 200, epoch: 8 | loss: 0.2277507
	speed: 0.0198s/iter; left time: 40.2162s
	iters: 300, epoch: 8 | loss: 0.2522199
	speed: 0.0193s/iter; left time: 37.1918s
	iters: 400, epoch: 8 | loss: 0.2393558
	speed: 0.0196s/iter; left time: 35.8426s
	iters: 500, epoch: 8 | loss: 0.1970360
	speed: 0.0199s/iter; left time: 34.3802s
	iters: 600, epoch: 8 | loss: 0.2039283
	speed: 0.0198s/iter; left time: 32.3302s
	iters: 700, epoch: 8 | loss: 0.2294631
	speed: 0.0209s/iter; left time: 31.9503s
Epoch: 8 cost time: 15.433869361877441
Epoch: 8, Steps: 743 | Train Loss: 0.2388030 Vali Loss: 0.3317141 Test Loss: 0.3928305
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2371543
	speed: 0.1135s/iter; left time: 157.4422s
	iters: 200, epoch: 9 | loss: 0.2978990
	speed: 0.0209s/iter; left time: 26.9000s
	iters: 300, epoch: 9 | loss: 0.2935453
	speed: 0.0196s/iter; left time: 23.3159s
	iters: 400, epoch: 9 | loss: 0.2854488
	speed: 0.0205s/iter; left time: 22.2847s
	iters: 500, epoch: 9 | loss: 0.2450187
	speed: 0.0189s/iter; left time: 18.6981s
	iters: 600, epoch: 9 | loss: 0.2329704
	speed: 0.0200s/iter; left time: 17.7117s
	iters: 700, epoch: 9 | loss: 0.2718989
	speed: 0.0210s/iter; left time: 16.4958s
Epoch: 9 cost time: 15.522850036621094
Epoch: 9, Steps: 743 | Train Loss: 0.2386867 Vali Loss: 0.3311755 Test Loss: 0.3925954
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2137869
	speed: 0.1165s/iter; left time: 75.0218s
	iters: 200, epoch: 10 | loss: 0.2588806
	speed: 0.0197s/iter; left time: 10.7115s
	iters: 300, epoch: 10 | loss: 0.2179006
	speed: 0.0201s/iter; left time: 8.9355s
	iters: 400, epoch: 10 | loss: 0.2662461
	speed: 0.0204s/iter; left time: 7.0077s
	iters: 500, epoch: 10 | loss: 0.2375665
	speed: 0.0205s/iter; left time: 4.9959s
	iters: 600, epoch: 10 | loss: 0.2225382
	speed: 0.0206s/iter; left time: 2.9660s
	iters: 700, epoch: 10 | loss: 0.2439416
	speed: 0.0207s/iter; left time: 0.9100s
Epoch: 10 cost time: 15.843629837036133
Epoch: 10, Steps: 743 | Train Loss: 0.2387170 Vali Loss: 0.3313189 Test Loss: 0.3925613
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_48_DLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3461
mse:0.3932335376739502, mae:0.2759956121444702
