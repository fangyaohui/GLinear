Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='ETTh1_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_12_DLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8293
val 2869
test 2869
	iters: 100, epoch: 1 | loss: 0.3223287
	speed: 0.0100s/iter; left time: 102.1975s
	iters: 200, epoch: 1 | loss: 0.2454183
	speed: 0.0049s/iter; left time: 50.2064s
	iters: 300, epoch: 1 | loss: 0.2186572
	speed: 0.0050s/iter; left time: 50.6921s
	iters: 400, epoch: 1 | loss: 0.2659963
	speed: 0.0051s/iter; left time: 50.3542s
	iters: 500, epoch: 1 | loss: 0.3773432
	speed: 0.0047s/iter; left time: 46.5697s
	iters: 600, epoch: 1 | loss: 0.2332796
	speed: 0.0047s/iter; left time: 45.4121s
	iters: 700, epoch: 1 | loss: 0.2310019
	speed: 0.0046s/iter; left time: 44.3203s
	iters: 800, epoch: 1 | loss: 0.3138404
	speed: 0.0048s/iter; left time: 45.9869s
	iters: 900, epoch: 1 | loss: 0.3061589
	speed: 0.0049s/iter; left time: 46.2654s
	iters: 1000, epoch: 1 | loss: 0.2979117
	speed: 0.0046s/iter; left time: 43.4709s
Epoch: 1 cost time: 5.569161415100098
Epoch: 1, Steps: 1036 | Train Loss: 0.2653915 Vali Loss: 0.3800334 Test Loss: 0.3283302
Validation loss decreased (inf --> 0.380033).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1926086
	speed: 0.0443s/iter; left time: 408.2067s
	iters: 200, epoch: 2 | loss: 0.2743868
	speed: 0.0045s/iter; left time: 41.1652s
	iters: 300, epoch: 2 | loss: 0.1846508
	speed: 0.0045s/iter; left time: 40.6705s
	iters: 400, epoch: 2 | loss: 0.2225420
	speed: 0.0046s/iter; left time: 41.0880s
	iters: 500, epoch: 2 | loss: 0.2605241
	speed: 0.0051s/iter; left time: 45.0467s
	iters: 600, epoch: 2 | loss: 0.3046109
	speed: 0.0050s/iter; left time: 43.9505s
	iters: 700, epoch: 2 | loss: 0.2490554
	speed: 0.0050s/iter; left time: 43.3871s
	iters: 800, epoch: 2 | loss: 0.2224789
	speed: 0.0051s/iter; left time: 43.2760s
	iters: 900, epoch: 2 | loss: 0.3412667
	speed: 0.0047s/iter; left time: 39.6733s
	iters: 1000, epoch: 2 | loss: 0.2456640
	speed: 0.0047s/iter; left time: 39.0040s
Epoch: 2 cost time: 5.50470495223999
Epoch: 2, Steps: 1036 | Train Loss: 0.2435744 Vali Loss: 0.3419232 Test Loss: 0.3127486
Validation loss decreased (0.380033 --> 0.341923).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2009900
	speed: 0.0446s/iter; left time: 365.3714s
	iters: 200, epoch: 3 | loss: 0.2502887
	speed: 0.0047s/iter; left time: 37.7551s
	iters: 300, epoch: 3 | loss: 0.2443670
	speed: 0.0045s/iter; left time: 36.3219s
	iters: 400, epoch: 3 | loss: 0.1504979
	speed: 0.0045s/iter; left time: 35.1171s
	iters: 500, epoch: 3 | loss: 0.2207687
	speed: 0.0045s/iter; left time: 34.8030s
	iters: 600, epoch: 3 | loss: 0.3389946
	speed: 0.0047s/iter; left time: 36.1866s
	iters: 700, epoch: 3 | loss: 0.2427114
	speed: 0.0049s/iter; left time: 37.5597s
	iters: 800, epoch: 3 | loss: 0.1369968
	speed: 0.0045s/iter; left time: 34.0234s
	iters: 900, epoch: 3 | loss: 0.2769144
	speed: 0.0048s/iter; left time: 35.3493s
	iters: 1000, epoch: 3 | loss: 0.2605791
	speed: 0.0050s/iter; left time: 36.7539s
Epoch: 3 cost time: 5.374931812286377
Epoch: 3, Steps: 1036 | Train Loss: 0.2322395 Vali Loss: 0.3488882 Test Loss: 0.3055799
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1960326
	speed: 0.0447s/iter; left time: 319.6360s
	iters: 200, epoch: 4 | loss: 0.1138015
	speed: 0.0044s/iter; left time: 30.9576s
	iters: 300, epoch: 4 | loss: 0.2301109
	speed: 0.0045s/iter; left time: 31.3547s
	iters: 400, epoch: 4 | loss: 0.1691996
	speed: 0.0045s/iter; left time: 31.1507s
	iters: 500, epoch: 4 | loss: 0.2872036
	speed: 0.0046s/iter; left time: 30.8731s
	iters: 600, epoch: 4 | loss: 0.2917447
	speed: 0.0048s/iter; left time: 32.0977s
	iters: 700, epoch: 4 | loss: 0.1526071
	speed: 0.0045s/iter; left time: 29.8014s
	iters: 800, epoch: 4 | loss: 0.1845259
	speed: 0.0054s/iter; left time: 34.6660s
	iters: 900, epoch: 4 | loss: 0.2512646
	speed: 0.0058s/iter; left time: 36.7899s
	iters: 1000, epoch: 4 | loss: 0.2798033
	speed: 0.0048s/iter; left time: 29.9190s
Epoch: 4 cost time: 5.517815351486206
Epoch: 4, Steps: 1036 | Train Loss: 0.2269993 Vali Loss: 0.3286419 Test Loss: 0.3022994
Validation loss decreased (0.341923 --> 0.328642).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1711151
	speed: 0.0467s/iter; left time: 285.4015s
	iters: 200, epoch: 5 | loss: 0.1013196
	speed: 0.0044s/iter; left time: 26.6733s
	iters: 300, epoch: 5 | loss: 0.2577649
	speed: 0.0046s/iter; left time: 27.1182s
	iters: 400, epoch: 5 | loss: 0.1091507
	speed: 0.0043s/iter; left time: 25.2680s
	iters: 500, epoch: 5 | loss: 0.2454014
	speed: 0.0048s/iter; left time: 27.5464s
	iters: 600, epoch: 5 | loss: 0.2073656
	speed: 0.0044s/iter; left time: 24.7033s
	iters: 700, epoch: 5 | loss: 0.1462001
	speed: 0.0044s/iter; left time: 24.1585s
	iters: 800, epoch: 5 | loss: 0.2900405
	speed: 0.0044s/iter; left time: 24.0186s
	iters: 900, epoch: 5 | loss: 0.2490487
	speed: 0.0051s/iter; left time: 26.9634s
	iters: 1000, epoch: 5 | loss: 0.2579849
	speed: 0.0050s/iter; left time: 26.1516s
Epoch: 5 cost time: 5.428597688674927
Epoch: 5, Steps: 1036 | Train Loss: 0.2245436 Vali Loss: 0.3295694 Test Loss: 0.3002307
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2091312
	speed: 0.0467s/iter; left time: 237.0484s
	iters: 200, epoch: 6 | loss: 0.2107160
	speed: 0.0046s/iter; left time: 22.8785s
	iters: 300, epoch: 6 | loss: 0.2294555
	speed: 0.0047s/iter; left time: 22.7212s
	iters: 400, epoch: 6 | loss: 0.2499499
	speed: 0.0046s/iter; left time: 22.1690s
	iters: 500, epoch: 6 | loss: 0.1723735
	speed: 0.0045s/iter; left time: 20.9279s
	iters: 600, epoch: 6 | loss: 0.1805010
	speed: 0.0045s/iter; left time: 20.7665s
	iters: 700, epoch: 6 | loss: 0.3779268
	speed: 0.0045s/iter; left time: 20.3260s
	iters: 800, epoch: 6 | loss: 0.2440677
	speed: 0.0045s/iter; left time: 19.6010s
	iters: 900, epoch: 6 | loss: 0.1346799
	speed: 0.0047s/iter; left time: 20.1524s
	iters: 1000, epoch: 6 | loss: 0.2426414
	speed: 0.0045s/iter; left time: 18.9387s
Epoch: 6 cost time: 5.381712913513184
Epoch: 6, Steps: 1036 | Train Loss: 0.2227807 Vali Loss: 0.3308607 Test Loss: 0.2995488
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2017711
	speed: 0.0457s/iter; left time: 184.8766s
	iters: 200, epoch: 7 | loss: 0.2125233
	speed: 0.0045s/iter; left time: 17.5608s
	iters: 300, epoch: 7 | loss: 0.2240313
	speed: 0.0046s/iter; left time: 17.7577s
	iters: 400, epoch: 7 | loss: 0.2835261
	speed: 0.0049s/iter; left time: 18.1953s
	iters: 500, epoch: 7 | loss: 0.2386082
	speed: 0.0046s/iter; left time: 16.7676s
	iters: 600, epoch: 7 | loss: 0.3322610
	speed: 0.0048s/iter; left time: 17.1639s
	iters: 700, epoch: 7 | loss: 0.1638990
	speed: 0.0046s/iter; left time: 15.9552s
	iters: 800, epoch: 7 | loss: 0.3135241
	speed: 0.0051s/iter; left time: 16.9264s
	iters: 900, epoch: 7 | loss: 0.1715533
	speed: 0.0058s/iter; left time: 18.7523s
	iters: 1000, epoch: 7 | loss: 0.3702026
	speed: 0.0050s/iter; left time: 15.6974s
Epoch: 7 cost time: 5.588254451751709
Epoch: 7, Steps: 1036 | Train Loss: 0.2218923 Vali Loss: 0.3265658 Test Loss: 0.2985498
Validation loss decreased (0.328642 --> 0.326566).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1690652
	speed: 0.0471s/iter; left time: 141.6742s
	iters: 200, epoch: 8 | loss: 0.1421996
	speed: 0.0046s/iter; left time: 13.3276s
	iters: 300, epoch: 8 | loss: 0.1637582
	speed: 0.0048s/iter; left time: 13.3865s
	iters: 400, epoch: 8 | loss: 0.2279859
	speed: 0.0046s/iter; left time: 12.4928s
	iters: 500, epoch: 8 | loss: 0.3088805
	speed: 0.0048s/iter; left time: 12.4977s
	iters: 600, epoch: 8 | loss: 0.1884475
	speed: 0.0043s/iter; left time: 10.7534s
	iters: 700, epoch: 8 | loss: 0.2125258
	speed: 0.0047s/iter; left time: 11.4214s
	iters: 800, epoch: 8 | loss: 0.1566062
	speed: 0.0050s/iter; left time: 11.6007s
	iters: 900, epoch: 8 | loss: 0.1887883
	speed: 0.0054s/iter; left time: 11.9296s
	iters: 1000, epoch: 8 | loss: 0.1870500
	speed: 0.0054s/iter; left time: 11.3310s
Epoch: 8 cost time: 5.590230464935303
Epoch: 8, Steps: 1036 | Train Loss: 0.2214323 Vali Loss: 0.3250245 Test Loss: 0.2975441
Validation loss decreased (0.326566 --> 0.325024).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1686755
	speed: 0.0466s/iter; left time: 91.9271s
	iters: 200, epoch: 9 | loss: 0.2481937
	speed: 0.0045s/iter; left time: 8.3532s
	iters: 300, epoch: 9 | loss: 0.2376340
	speed: 0.0045s/iter; left time: 7.9877s
	iters: 400, epoch: 9 | loss: 0.2860136
	speed: 0.0048s/iter; left time: 8.0484s
	iters: 500, epoch: 9 | loss: 0.3468743
	speed: 0.0047s/iter; left time: 7.4016s
	iters: 600, epoch: 9 | loss: 0.2455209
	speed: 0.0046s/iter; left time: 6.8480s
	iters: 700, epoch: 9 | loss: 0.1611856
	speed: 0.0049s/iter; left time: 6.7696s
	iters: 800, epoch: 9 | loss: 0.3594242
	speed: 0.0046s/iter; left time: 5.7922s
	iters: 900, epoch: 9 | loss: 0.3300729
	speed: 0.0049s/iter; left time: 5.7760s
	iters: 1000, epoch: 9 | loss: 0.1995665
	speed: 0.0046s/iter; left time: 4.8968s
Epoch: 9 cost time: 5.410750150680542
Epoch: 9, Steps: 1036 | Train Loss: 0.2211891 Vali Loss: 0.3270191 Test Loss: 0.2973866
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1807011
	speed: 0.0470s/iter; left time: 44.0543s
	iters: 200, epoch: 10 | loss: 0.2588880
	speed: 0.0047s/iter; left time: 3.9458s
	iters: 300, epoch: 10 | loss: 0.2637727
	speed: 0.0048s/iter; left time: 3.5227s
	iters: 400, epoch: 10 | loss: 0.1562105
	speed: 0.0046s/iter; left time: 2.9277s
	iters: 500, epoch: 10 | loss: 0.3890580
	speed: 0.0047s/iter; left time: 2.5012s
	iters: 600, epoch: 10 | loss: 0.2738278
	speed: 0.0046s/iter; left time: 2.0121s
	iters: 700, epoch: 10 | loss: 0.2690167
	speed: 0.0046s/iter; left time: 1.5511s
	iters: 800, epoch: 10 | loss: 0.2858474
	speed: 0.0049s/iter; left time: 1.1630s
	iters: 900, epoch: 10 | loss: 0.1457790
	speed: 0.0046s/iter; left time: 0.6247s
	iters: 1000, epoch: 10 | loss: 0.1783204
	speed: 0.0050s/iter; left time: 0.1840s
Epoch: 10 cost time: 5.464038848876953
Epoch: 10, Steps: 1036 | Train Loss: 0.2210852 Vali Loss: 0.3262384 Test Loss: 0.2973580
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : ETTh1_336_12_DLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2869
mse:0.2976519465446472, mae:0.3494313359260559
