Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='ETTh1_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_96_DLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3636404
	speed: 0.0093s/iter; left time: 94.0634s
	iters: 200, epoch: 1 | loss: 0.3953573
	speed: 0.0044s/iter; left time: 44.0342s
	iters: 300, epoch: 1 | loss: 0.4876898
	speed: 0.0044s/iter; left time: 44.1184s
	iters: 400, epoch: 1 | loss: 0.3780393
	speed: 0.0045s/iter; left time: 44.0797s
	iters: 500, epoch: 1 | loss: 0.4128656
	speed: 0.0045s/iter; left time: 43.9476s
	iters: 600, epoch: 1 | loss: 0.3228551
	speed: 0.0041s/iter; left time: 39.4300s
	iters: 700, epoch: 1 | loss: 0.5646135
	speed: 0.0046s/iter; left time: 43.5266s
	iters: 800, epoch: 1 | loss: 0.2609954
	speed: 0.0044s/iter; left time: 41.9787s
	iters: 900, epoch: 1 | loss: 0.4602923
	speed: 0.0046s/iter; left time: 42.7407s
	iters: 1000, epoch: 1 | loss: 0.4078477
	speed: 0.0052s/iter; left time: 47.7054s
Epoch: 1 cost time: 5.213257074356079
Epoch: 1, Steps: 1026 | Train Loss: 0.3749563 Vali Loss: 0.6882805 Test Loss: 0.3982359
Validation loss decreased (inf --> 0.688280).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2707565
	speed: 0.0440s/iter; left time: 401.5645s
	iters: 200, epoch: 2 | loss: 0.2642731
	speed: 0.0044s/iter; left time: 40.1170s
	iters: 300, epoch: 2 | loss: 0.2633704
	speed: 0.0045s/iter; left time: 40.4685s
	iters: 400, epoch: 2 | loss: 0.4411795
	speed: 0.0044s/iter; left time: 39.0358s
	iters: 500, epoch: 2 | loss: 0.3470772
	speed: 0.0045s/iter; left time: 39.5119s
	iters: 600, epoch: 2 | loss: 0.4661739
	speed: 0.0046s/iter; left time: 39.4168s
	iters: 700, epoch: 2 | loss: 0.3572148
	speed: 0.0046s/iter; left time: 39.2793s
	iters: 800, epoch: 2 | loss: 0.3234991
	speed: 0.0048s/iter; left time: 40.8688s
	iters: 900, epoch: 2 | loss: 0.4513856
	speed: 0.0045s/iter; left time: 37.5764s
	iters: 1000, epoch: 2 | loss: 0.3295848
	speed: 0.0047s/iter; left time: 38.6653s
Epoch: 2 cost time: 5.205437898635864
Epoch: 2, Steps: 1026 | Train Loss: 0.3585042 Vali Loss: 0.6786525 Test Loss: 0.3974839
Validation loss decreased (0.688280 --> 0.678652).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.7917461
	speed: 0.0442s/iter; left time: 358.3836s
	iters: 200, epoch: 3 | loss: 0.3084968
	speed: 0.0045s/iter; left time: 36.1017s
	iters: 300, epoch: 3 | loss: 0.2992977
	speed: 0.0045s/iter; left time: 35.7395s
	iters: 400, epoch: 3 | loss: 0.5318811
	speed: 0.0045s/iter; left time: 35.0819s
	iters: 500, epoch: 3 | loss: 0.2717510
	speed: 0.0045s/iter; left time: 34.8313s
	iters: 600, epoch: 3 | loss: 0.2718226
	speed: 0.0048s/iter; left time: 36.3484s
	iters: 700, epoch: 3 | loss: 0.4007344
	speed: 0.0046s/iter; left time: 34.5617s
	iters: 800, epoch: 3 | loss: 0.3529861
	speed: 0.0046s/iter; left time: 33.9400s
	iters: 900, epoch: 3 | loss: 0.3006292
	speed: 0.0051s/iter; left time: 37.0891s
	iters: 1000, epoch: 3 | loss: 0.3463087
	speed: 0.0045s/iter; left time: 32.1848s
Epoch: 3 cost time: 5.2792534828186035
Epoch: 3, Steps: 1026 | Train Loss: 0.3446147 Vali Loss: 0.6909700 Test Loss: 0.3836854
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3383705
	speed: 0.0435s/iter; left time: 308.1304s
	iters: 200, epoch: 4 | loss: 0.3622909
	speed: 0.0045s/iter; left time: 31.3556s
	iters: 300, epoch: 4 | loss: 0.2848527
	speed: 0.0044s/iter; left time: 30.4644s
	iters: 400, epoch: 4 | loss: 0.3382193
	speed: 0.0046s/iter; left time: 31.2606s
	iters: 500, epoch: 4 | loss: 0.3481011
	speed: 0.0047s/iter; left time: 31.6562s
	iters: 600, epoch: 4 | loss: 0.3186617
	speed: 0.0042s/iter; left time: 27.3701s
	iters: 700, epoch: 4 | loss: 0.3425079
	speed: 0.0043s/iter; left time: 27.6594s
	iters: 800, epoch: 4 | loss: 0.4750400
	speed: 0.0042s/iter; left time: 26.5922s
	iters: 900, epoch: 4 | loss: 0.2609240
	speed: 0.0041s/iter; left time: 26.0249s
	iters: 1000, epoch: 4 | loss: 0.2552244
	speed: 0.0043s/iter; left time: 26.7290s
Epoch: 4 cost time: 5.060668230056763
Epoch: 4, Steps: 1026 | Train Loss: 0.3379242 Vali Loss: 0.6565350 Test Loss: 0.3741910
Validation loss decreased (0.678652 --> 0.656535).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2802160
	speed: 0.0435s/iter; left time: 263.7107s
	iters: 200, epoch: 5 | loss: 0.3926631
	speed: 0.0044s/iter; left time: 25.9162s
	iters: 300, epoch: 5 | loss: 0.3447618
	speed: 0.0044s/iter; left time: 25.6543s
	iters: 400, epoch: 5 | loss: 0.3509169
	speed: 0.0044s/iter; left time: 25.1736s
	iters: 500, epoch: 5 | loss: 0.2727999
	speed: 0.0046s/iter; left time: 26.0753s
	iters: 600, epoch: 5 | loss: 0.3067166
	speed: 0.0044s/iter; left time: 24.3791s
	iters: 700, epoch: 5 | loss: 0.3426780
	speed: 0.0044s/iter; left time: 24.0414s
	iters: 800, epoch: 5 | loss: 0.2801172
	speed: 0.0045s/iter; left time: 24.2069s
	iters: 900, epoch: 5 | loss: 0.3027228
	speed: 0.0050s/iter; left time: 26.0808s
	iters: 1000, epoch: 5 | loss: 0.3011414
	speed: 0.0045s/iter; left time: 23.0239s
Epoch: 5 cost time: 5.148956537246704
Epoch: 5, Steps: 1026 | Train Loss: 0.3344868 Vali Loss: 0.6603462 Test Loss: 0.3738799
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3815515
	speed: 0.0456s/iter; left time: 229.6069s
	iters: 200, epoch: 6 | loss: 0.3305544
	speed: 0.0043s/iter; left time: 21.1960s
	iters: 300, epoch: 6 | loss: 0.3349662
	speed: 0.0043s/iter; left time: 20.7382s
	iters: 400, epoch: 6 | loss: 0.3161418
	speed: 0.0043s/iter; left time: 20.5492s
	iters: 500, epoch: 6 | loss: 0.3082092
	speed: 0.0044s/iter; left time: 20.2699s
	iters: 600, epoch: 6 | loss: 0.2829917
	speed: 0.0044s/iter; left time: 19.7776s
	iters: 700, epoch: 6 | loss: 0.4656032
	speed: 0.0043s/iter; left time: 19.1879s
	iters: 800, epoch: 6 | loss: 0.4017905
	speed: 0.0045s/iter; left time: 19.3079s
	iters: 900, epoch: 6 | loss: 0.3736085
	speed: 0.0046s/iter; left time: 19.4074s
	iters: 1000, epoch: 6 | loss: 0.2996873
	speed: 0.0044s/iter; left time: 18.2722s
Epoch: 6 cost time: 5.104295253753662
Epoch: 6, Steps: 1026 | Train Loss: 0.3325663 Vali Loss: 0.6609107 Test Loss: 0.3717394
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2746379
	speed: 0.0436s/iter; left time: 174.8075s
	iters: 200, epoch: 7 | loss: 0.3231825
	speed: 0.0049s/iter; left time: 19.2368s
	iters: 300, epoch: 7 | loss: 0.2848707
	speed: 0.0050s/iter; left time: 18.8525s
	iters: 400, epoch: 7 | loss: 0.3133473
	speed: 0.0046s/iter; left time: 17.1831s
	iters: 500, epoch: 7 | loss: 0.3226118
	speed: 0.0047s/iter; left time: 16.9142s
	iters: 600, epoch: 7 | loss: 0.2821712
	speed: 0.0046s/iter; left time: 16.2172s
	iters: 700, epoch: 7 | loss: 0.3118635
	speed: 0.0048s/iter; left time: 16.3537s
	iters: 800, epoch: 7 | loss: 0.3741562
	speed: 0.0047s/iter; left time: 15.6279s
	iters: 900, epoch: 7 | loss: 0.2770436
	speed: 0.0049s/iter; left time: 15.6921s
	iters: 1000, epoch: 7 | loss: 0.3996866
	speed: 0.0047s/iter; left time: 14.4849s
Epoch: 7 cost time: 5.433952808380127
Epoch: 7, Steps: 1026 | Train Loss: 0.3314453 Vali Loss: 0.6564564 Test Loss: 0.3707832
Validation loss decreased (0.656535 --> 0.656456).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2905374
	speed: 0.0430s/iter; left time: 127.9766s
	iters: 200, epoch: 8 | loss: 0.2916824
	speed: 0.0048s/iter; left time: 13.7373s
	iters: 300, epoch: 8 | loss: 0.3133335
	speed: 0.0048s/iter; left time: 13.3579s
	iters: 400, epoch: 8 | loss: 0.2679219
	speed: 0.0048s/iter; left time: 12.7435s
	iters: 500, epoch: 8 | loss: 0.4439623
	speed: 0.0048s/iter; left time: 12.4139s
	iters: 600, epoch: 8 | loss: 0.2853180
	speed: 0.0045s/iter; left time: 11.1641s
	iters: 700, epoch: 8 | loss: 0.2716663
	speed: 0.0044s/iter; left time: 10.3489s
	iters: 800, epoch: 8 | loss: 0.3226384
	speed: 0.0044s/iter; left time: 9.9762s
	iters: 900, epoch: 8 | loss: 0.2953995
	speed: 0.0044s/iter; left time: 9.5437s
	iters: 1000, epoch: 8 | loss: 0.2417505
	speed: 0.0045s/iter; left time: 9.2526s
Epoch: 8 cost time: 5.261368751525879
Epoch: 8, Steps: 1026 | Train Loss: 0.3309114 Vali Loss: 0.6547599 Test Loss: 0.3705607
Validation loss decreased (0.656456 --> 0.654760).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3350050
	speed: 0.0432s/iter; left time: 84.2870s
	iters: 200, epoch: 9 | loss: 0.2753140
	speed: 0.0045s/iter; left time: 8.3480s
	iters: 300, epoch: 9 | loss: 0.3308442
	speed: 0.0044s/iter; left time: 7.6655s
	iters: 400, epoch: 9 | loss: 0.3201022
	speed: 0.0042s/iter; left time: 6.9763s
	iters: 500, epoch: 9 | loss: 0.3192647
	speed: 0.0044s/iter; left time: 6.7583s
	iters: 600, epoch: 9 | loss: 0.3257300
	speed: 0.0044s/iter; left time: 6.3793s
	iters: 700, epoch: 9 | loss: 0.2495063
	speed: 0.0044s/iter; left time: 5.9575s
	iters: 800, epoch: 9 | loss: 0.2621262
	speed: 0.0044s/iter; left time: 5.5746s
	iters: 900, epoch: 9 | loss: 0.3735950
	speed: 0.0046s/iter; left time: 5.3582s
	iters: 1000, epoch: 9 | loss: 0.3844137
	speed: 0.0045s/iter; left time: 4.7779s
Epoch: 9 cost time: 5.11636209487915
Epoch: 9, Steps: 1026 | Train Loss: 0.3306095 Vali Loss: 0.6551015 Test Loss: 0.3704602
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2592484
	speed: 0.0439s/iter; left time: 40.6914s
	iters: 200, epoch: 10 | loss: 0.3026218
	speed: 0.0045s/iter; left time: 3.7113s
	iters: 300, epoch: 10 | loss: 0.2808956
	speed: 0.0045s/iter; left time: 3.2628s
	iters: 400, epoch: 10 | loss: 0.2921147
	speed: 0.0043s/iter; left time: 2.7188s
	iters: 500, epoch: 10 | loss: 0.3125991
	speed: 0.0045s/iter; left time: 2.3748s
	iters: 600, epoch: 10 | loss: 0.3368589
	speed: 0.0043s/iter; left time: 1.8567s
	iters: 700, epoch: 10 | loss: 0.3308260
	speed: 0.0044s/iter; left time: 1.4329s
	iters: 800, epoch: 10 | loss: 0.3105490
	speed: 0.0043s/iter; left time: 0.9837s
	iters: 900, epoch: 10 | loss: 0.2764762
	speed: 0.0041s/iter; left time: 0.5235s
	iters: 1000, epoch: 10 | loss: 0.3191661
	speed: 0.0041s/iter; left time: 0.1109s
Epoch: 10 cost time: 5.020514488220215
Epoch: 10, Steps: 1026 | Train Loss: 0.3304385 Vali Loss: 0.6523652 Test Loss: 0.3708223
Validation loss decreased (0.654760 --> 0.652365).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : ETTh1_336_96_DLinear_ETTh1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.37052786350250244, mae:0.3918864130973816
