Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 1.0099601
	speed: 0.0107s/iter; left time: 238.9620s
	iters: 200, epoch: 1 | loss: 0.6175230
	speed: 0.0054s/iter; left time: 119.2547s
	iters: 300, epoch: 1 | loss: 0.5595600
	speed: 0.0055s/iter; left time: 121.6387s
	iters: 400, epoch: 1 | loss: 0.6001911
	speed: 0.0055s/iter; left time: 119.9258s
	iters: 500, epoch: 1 | loss: 0.5262965
	speed: 0.0056s/iter; left time: 122.8336s
	iters: 600, epoch: 1 | loss: 0.5741083
	speed: 0.0055s/iter; left time: 119.9807s
	iters: 700, epoch: 1 | loss: 0.5623198
	speed: 0.0057s/iter; left time: 122.8950s
	iters: 800, epoch: 1 | loss: 0.4725835
	speed: 0.0056s/iter; left time: 120.1364s
	iters: 900, epoch: 1 | loss: 0.4521853
	speed: 0.0055s/iter; left time: 117.1612s
	iters: 1000, epoch: 1 | loss: 0.4351138
	speed: 0.0055s/iter; left time: 117.3939s
	iters: 1100, epoch: 1 | loss: 0.5533389
	speed: 0.0054s/iter; left time: 114.0787s
	iters: 1200, epoch: 1 | loss: 0.4322768
	speed: 0.0057s/iter; left time: 121.2836s
	iters: 1300, epoch: 1 | loss: 0.6750253
	speed: 0.0059s/iter; left time: 123.5503s
	iters: 1400, epoch: 1 | loss: 0.4999076
	speed: 0.0056s/iter; left time: 117.7021s
	iters: 1500, epoch: 1 | loss: 0.8339781
	speed: 0.0057s/iter; left time: 118.7225s
	iters: 1600, epoch: 1 | loss: 0.4605738
	speed: 0.0055s/iter; left time: 114.8475s
	iters: 1700, epoch: 1 | loss: 0.8706231
	speed: 0.0055s/iter; left time: 114.5192s
	iters: 1800, epoch: 1 | loss: 0.8243064
	speed: 0.0056s/iter; left time: 114.8875s
	iters: 1900, epoch: 1 | loss: 0.6113538
	speed: 0.0060s/iter; left time: 123.4517s
	iters: 2000, epoch: 1 | loss: 0.4719389
	speed: 0.0061s/iter; left time: 124.1561s
	iters: 2100, epoch: 1 | loss: 0.7478178
	speed: 0.0058s/iter; left time: 117.4911s
	iters: 2200, epoch: 1 | loss: 0.6187021
	speed: 0.0056s/iter; left time: 113.5269s
Epoch: 1 cost time: 13.172590494155884
Epoch: 1, Steps: 2239 | Train Loss: 0.6208499 Vali Loss: 0.6297420 Test Loss: 0.3301831
Validation loss decreased (inf --> 0.629742).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5565972
	speed: 0.0738s/iter; left time: 1479.8428s
	iters: 200, epoch: 2 | loss: 0.5001708
	speed: 0.0057s/iter; left time: 112.7677s
	iters: 300, epoch: 2 | loss: 0.5040619
	speed: 0.0057s/iter; left time: 112.2412s
	iters: 400, epoch: 2 | loss: 0.4603165
	speed: 0.0058s/iter; left time: 113.7099s
	iters: 500, epoch: 2 | loss: 0.5939075
	speed: 0.0057s/iter; left time: 112.0768s
	iters: 600, epoch: 2 | loss: 0.5744038
	speed: 0.0058s/iter; left time: 113.6467s
	iters: 700, epoch: 2 | loss: 0.4706065
	speed: 0.0056s/iter; left time: 109.8029s
	iters: 800, epoch: 2 | loss: 0.7364320
	speed: 0.0063s/iter; left time: 121.7003s
	iters: 900, epoch: 2 | loss: 0.5749165
	speed: 0.0060s/iter; left time: 116.2335s
	iters: 1000, epoch: 2 | loss: 0.7172738
	speed: 0.0060s/iter; left time: 115.8577s
	iters: 1100, epoch: 2 | loss: 0.8191829
	speed: 0.0067s/iter; left time: 127.9715s
	iters: 1200, epoch: 2 | loss: 0.5339099
	speed: 0.0063s/iter; left time: 119.5726s
	iters: 1300, epoch: 2 | loss: 0.6187561
	speed: 0.0058s/iter; left time: 108.5054s
	iters: 1400, epoch: 2 | loss: 0.6733612
	speed: 0.0058s/iter; left time: 108.9662s
	iters: 1500, epoch: 2 | loss: 0.9175475
	speed: 0.0057s/iter; left time: 106.2405s
	iters: 1600, epoch: 2 | loss: 0.5526732
	speed: 0.0056s/iter; left time: 104.8066s
	iters: 1700, epoch: 2 | loss: 0.5690846
	speed: 0.0058s/iter; left time: 107.0951s
	iters: 1800, epoch: 2 | loss: 0.5301617
	speed: 0.0057s/iter; left time: 104.4855s
	iters: 1900, epoch: 2 | loss: 0.7775930
	speed: 0.0058s/iter; left time: 104.9792s
	iters: 2000, epoch: 2 | loss: 0.6698131
	speed: 0.0056s/iter; left time: 102.1530s
	iters: 2100, epoch: 2 | loss: 0.7445398
	speed: 0.0057s/iter; left time: 102.6546s
	iters: 2200, epoch: 2 | loss: 0.7133099
	speed: 0.0059s/iter; left time: 106.7820s
Epoch: 2 cost time: 13.677934408187866
Epoch: 2, Steps: 2239 | Train Loss: 0.6161117 Vali Loss: 0.6297804 Test Loss: 0.3273315
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4432385
	speed: 0.0754s/iter; left time: 1342.7636s
	iters: 200, epoch: 3 | loss: 1.0394568
	speed: 0.0060s/iter; left time: 107.0892s
	iters: 300, epoch: 3 | loss: 0.5491681
	speed: 0.0059s/iter; left time: 104.7450s
	iters: 400, epoch: 3 | loss: 0.5421815
	speed: 0.0056s/iter; left time: 97.9684s
	iters: 500, epoch: 3 | loss: 0.8767909
	speed: 0.0056s/iter; left time: 96.7400s
	iters: 600, epoch: 3 | loss: 1.0534931
	speed: 0.0056s/iter; left time: 96.9577s
	iters: 700, epoch: 3 | loss: 0.6159419
	speed: 0.0056s/iter; left time: 96.4731s
	iters: 800, epoch: 3 | loss: 0.7761652
	speed: 0.0057s/iter; left time: 96.9708s
	iters: 900, epoch: 3 | loss: 0.9626564
	speed: 0.0057s/iter; left time: 97.4919s
	iters: 1000, epoch: 3 | loss: 0.4222044
	speed: 0.0058s/iter; left time: 98.2478s
	iters: 1100, epoch: 3 | loss: 0.5743819
	speed: 0.0055s/iter; left time: 92.7314s
	iters: 1200, epoch: 3 | loss: 0.6037633
	speed: 0.0058s/iter; left time: 96.6543s
	iters: 1300, epoch: 3 | loss: 0.4917002
	speed: 0.0060s/iter; left time: 99.1039s
	iters: 1400, epoch: 3 | loss: 0.3444428
	speed: 0.0057s/iter; left time: 93.7063s
	iters: 1500, epoch: 3 | loss: 0.7568781
	speed: 0.0057s/iter; left time: 94.3404s
	iters: 1600, epoch: 3 | loss: 0.9426055
	speed: 0.0057s/iter; left time: 92.9554s
	iters: 1700, epoch: 3 | loss: 0.8159549
	speed: 0.0058s/iter; left time: 94.0774s
	iters: 1800, epoch: 3 | loss: 0.4324053
	speed: 0.0059s/iter; left time: 94.4420s
	iters: 1900, epoch: 3 | loss: 0.5339153
	speed: 0.0057s/iter; left time: 91.7119s
	iters: 2000, epoch: 3 | loss: 0.5614979
	speed: 0.0058s/iter; left time: 91.7342s
	iters: 2100, epoch: 3 | loss: 0.4438017
	speed: 0.0057s/iter; left time: 89.8594s
	iters: 2200, epoch: 3 | loss: 0.5930153
	speed: 0.0058s/iter; left time: 91.0569s
Epoch: 3 cost time: 13.56948447227478
Epoch: 3, Steps: 2239 | Train Loss: 0.6075376 Vali Loss: 0.6319646 Test Loss: 0.3295132
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.1509358
	speed: 0.0789s/iter; left time: 1229.4973s
	iters: 200, epoch: 4 | loss: 0.7981529
	speed: 0.0057s/iter; left time: 87.6199s
	iters: 300, epoch: 4 | loss: 0.5320066
	speed: 0.0057s/iter; left time: 87.2678s
	iters: 400, epoch: 4 | loss: 0.6046640
	speed: 0.0058s/iter; left time: 88.1731s
	iters: 500, epoch: 4 | loss: 0.4691012
	speed: 0.0057s/iter; left time: 85.7868s
	iters: 600, epoch: 4 | loss: 0.4430906
	speed: 0.0057s/iter; left time: 85.4685s
	iters: 700, epoch: 4 | loss: 0.4728519
	speed: 0.0057s/iter; left time: 85.9928s
	iters: 800, epoch: 4 | loss: 0.4716684
	speed: 0.0061s/iter; left time: 90.0034s
	iters: 900, epoch: 4 | loss: 0.5264701
	speed: 0.0059s/iter; left time: 87.0726s
	iters: 1000, epoch: 4 | loss: 0.6673018
	speed: 0.0060s/iter; left time: 87.8401s
	iters: 1100, epoch: 4 | loss: 0.4431695
	speed: 0.0062s/iter; left time: 90.0359s
	iters: 1200, epoch: 4 | loss: 0.4666209
	speed: 0.0064s/iter; left time: 92.3004s
	iters: 1300, epoch: 4 | loss: 0.5374711
	speed: 0.0057s/iter; left time: 81.9784s
	iters: 1400, epoch: 4 | loss: 0.7177666
	speed: 0.0059s/iter; left time: 83.9483s
	iters: 1500, epoch: 4 | loss: 0.5935104
	speed: 0.0059s/iter; left time: 83.8720s
	iters: 1600, epoch: 4 | loss: 0.4281144
	speed: 0.0059s/iter; left time: 83.5339s
	iters: 1700, epoch: 4 | loss: 0.4623679
	speed: 0.0057s/iter; left time: 79.9317s
	iters: 1800, epoch: 4 | loss: 0.6734013
	speed: 0.0057s/iter; left time: 78.8961s
	iters: 1900, epoch: 4 | loss: 0.5097007
	speed: 0.0056s/iter; left time: 77.8114s
	iters: 2000, epoch: 4 | loss: 0.5427291
	speed: 0.0056s/iter; left time: 76.4365s
	iters: 2100, epoch: 4 | loss: 0.4498969
	speed: 0.0056s/iter; left time: 76.5911s
	iters: 2200, epoch: 4 | loss: 0.5650077
	speed: 0.0059s/iter; left time: 79.9405s
Epoch: 4 cost time: 13.660588026046753
Epoch: 4, Steps: 2239 | Train Loss: 0.6035001 Vali Loss: 0.6202205 Test Loss: 0.3276358
Validation loss decreased (0.629742 --> 0.620220).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.8042339
	speed: 0.0818s/iter; left time: 1090.3444s
	iters: 200, epoch: 5 | loss: 0.5579098
	speed: 0.0056s/iter; left time: 74.3013s
	iters: 300, epoch: 5 | loss: 0.4746761
	speed: 0.0059s/iter; left time: 77.5254s
	iters: 400, epoch: 5 | loss: 0.7720566
	speed: 0.0059s/iter; left time: 76.5655s
	iters: 500, epoch: 5 | loss: 0.5014257
	speed: 0.0058s/iter; left time: 75.0307s
	iters: 600, epoch: 5 | loss: 0.7123166
	speed: 0.0059s/iter; left time: 75.4283s
	iters: 700, epoch: 5 | loss: 0.7925355
	speed: 0.0058s/iter; left time: 74.4684s
	iters: 800, epoch: 5 | loss: 0.5319162
	speed: 0.0058s/iter; left time: 73.3078s
	iters: 900, epoch: 5 | loss: 0.7071118
	speed: 0.0058s/iter; left time: 72.2098s
	iters: 1000, epoch: 5 | loss: 0.5636189
	speed: 0.0059s/iter; left time: 73.7387s
	iters: 1100, epoch: 5 | loss: 1.1829104
	speed: 0.0061s/iter; left time: 75.0524s
	iters: 1200, epoch: 5 | loss: 0.5028132
	speed: 0.0060s/iter; left time: 73.1292s
	iters: 1300, epoch: 5 | loss: 0.8403365
	speed: 0.0059s/iter; left time: 71.2127s
	iters: 1400, epoch: 5 | loss: 0.7961661
	speed: 0.0059s/iter; left time: 70.9610s
	iters: 1500, epoch: 5 | loss: 0.5150428
	speed: 0.0058s/iter; left time: 68.8078s
	iters: 1600, epoch: 5 | loss: 1.0492010
	speed: 0.0058s/iter; left time: 68.7237s
	iters: 1700, epoch: 5 | loss: 0.5062194
	speed: 0.0060s/iter; left time: 70.9062s
	iters: 1800, epoch: 5 | loss: 0.6933109
	speed: 0.0057s/iter; left time: 66.2649s
	iters: 1900, epoch: 5 | loss: 0.4740606
	speed: 0.0059s/iter; left time: 68.0786s
	iters: 2000, epoch: 5 | loss: 0.7620253
	speed: 0.0059s/iter; left time: 67.5081s
	iters: 2100, epoch: 5 | loss: 0.3987319
	speed: 0.0059s/iter; left time: 66.7040s
	iters: 2200, epoch: 5 | loss: 0.5154596
	speed: 0.0056s/iter; left time: 63.3246s
Epoch: 5 cost time: 13.956690311431885
Epoch: 5, Steps: 2239 | Train Loss: 0.6009872 Vali Loss: 0.6219345 Test Loss: 0.3256814
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4524077
	speed: 0.0799s/iter; left time: 886.6648s
	iters: 200, epoch: 6 | loss: 0.5707615
	speed: 0.0058s/iter; left time: 63.2500s
	iters: 300, epoch: 6 | loss: 0.5416592
	speed: 0.0058s/iter; left time: 63.6053s
	iters: 400, epoch: 6 | loss: 0.4468122
	speed: 0.0058s/iter; left time: 62.2851s
	iters: 500, epoch: 6 | loss: 0.4823639
	speed: 0.0059s/iter; left time: 63.3117s
	iters: 600, epoch: 6 | loss: 0.5191660
	speed: 0.0059s/iter; left time: 62.3976s
	iters: 700, epoch: 6 | loss: 1.0274802
	speed: 0.0058s/iter; left time: 61.0368s
	iters: 800, epoch: 6 | loss: 0.6011503
	speed: 0.0058s/iter; left time: 60.2180s
	iters: 900, epoch: 6 | loss: 0.5885704
	speed: 0.0057s/iter; left time: 58.4784s
	iters: 1000, epoch: 6 | loss: 0.5474585
	speed: 0.0056s/iter; left time: 56.7191s
	iters: 1100, epoch: 6 | loss: 0.7038794
	speed: 0.0058s/iter; left time: 58.6354s
	iters: 1200, epoch: 6 | loss: 0.4775045
	speed: 0.0057s/iter; left time: 57.0501s
	iters: 1300, epoch: 6 | loss: 0.7109560
	speed: 0.0056s/iter; left time: 55.7730s
	iters: 1400, epoch: 6 | loss: 0.8495331
	speed: 0.0059s/iter; left time: 57.3425s
	iters: 1500, epoch: 6 | loss: 0.7797338
	speed: 0.0057s/iter; left time: 55.0498s
	iters: 1600, epoch: 6 | loss: 0.4883750
	speed: 0.0058s/iter; left time: 55.2029s
	iters: 1700, epoch: 6 | loss: 0.4677552
	speed: 0.0059s/iter; left time: 55.7077s
	iters: 1800, epoch: 6 | loss: 0.4552404
	speed: 0.0060s/iter; left time: 56.7936s
	iters: 1900, epoch: 6 | loss: 0.5873636
	speed: 0.0060s/iter; left time: 55.4655s
	iters: 2000, epoch: 6 | loss: 0.7145410
	speed: 0.0057s/iter; left time: 52.3258s
	iters: 2100, epoch: 6 | loss: 0.8977512
	speed: 0.0059s/iter; left time: 53.8974s
	iters: 2200, epoch: 6 | loss: 0.5119337
	speed: 0.0059s/iter; left time: 52.8806s
Epoch: 6 cost time: 13.754866600036621
Epoch: 6, Steps: 2239 | Train Loss: 0.5997538 Vali Loss: 0.6219968 Test Loss: 0.3245996
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4685992
	speed: 0.0803s/iter; left time: 710.8622s
	iters: 200, epoch: 7 | loss: 0.5518355
	speed: 0.0059s/iter; left time: 51.3759s
	iters: 300, epoch: 7 | loss: 0.5596967
	speed: 0.0057s/iter; left time: 49.3272s
	iters: 400, epoch: 7 | loss: 0.5949925
	speed: 0.0058s/iter; left time: 49.8151s
	iters: 500, epoch: 7 | loss: 0.4624000
	speed: 0.0060s/iter; left time: 50.5997s
	iters: 600, epoch: 7 | loss: 0.4631024
	speed: 0.0057s/iter; left time: 47.5338s
	iters: 700, epoch: 7 | loss: 0.6659684
	speed: 0.0061s/iter; left time: 50.7061s
	iters: 800, epoch: 7 | loss: 0.4947259
	speed: 0.0060s/iter; left time: 48.8881s
	iters: 900, epoch: 7 | loss: 0.4834612
	speed: 0.0063s/iter; left time: 51.1479s
	iters: 1000, epoch: 7 | loss: 0.5827930
	speed: 0.0058s/iter; left time: 46.5094s
	iters: 1100, epoch: 7 | loss: 0.3987013
	speed: 0.0072s/iter; left time: 56.7583s
	iters: 1200, epoch: 7 | loss: 0.4963340
	speed: 0.0061s/iter; left time: 47.2506s
	iters: 1300, epoch: 7 | loss: 0.4509434
	speed: 0.0061s/iter; left time: 46.5975s
	iters: 1400, epoch: 7 | loss: 0.5758064
	speed: 0.0060s/iter; left time: 45.0159s
	iters: 1500, epoch: 7 | loss: 0.4106854
	speed: 0.0060s/iter; left time: 45.0645s
	iters: 1600, epoch: 7 | loss: 0.4522363
	speed: 0.0060s/iter; left time: 43.7790s
	iters: 1700, epoch: 7 | loss: 0.5959303
	speed: 0.0060s/iter; left time: 43.8840s
	iters: 1800, epoch: 7 | loss: 0.7022142
	speed: 0.0058s/iter; left time: 41.8563s
	iters: 1900, epoch: 7 | loss: 0.4617359
	speed: 0.0058s/iter; left time: 40.7564s
	iters: 2000, epoch: 7 | loss: 0.7845641
	speed: 0.0058s/iter; left time: 40.0596s
	iters: 2100, epoch: 7 | loss: 0.8492762
	speed: 0.0061s/iter; left time: 41.9092s
	iters: 2200, epoch: 7 | loss: 0.8024003
	speed: 0.0062s/iter; left time: 41.8596s
Epoch: 7 cost time: 14.228625297546387
Epoch: 7, Steps: 2239 | Train Loss: 0.5992210 Vali Loss: 0.6226808 Test Loss: 0.3230191
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32754233479499817, mae:0.3667038381099701
