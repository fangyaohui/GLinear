Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.3999685
	speed: 0.0303s/iter; left time: 219.1514s
	iters: 200, epoch: 1 | loss: 0.3093691
	speed: 0.0233s/iter; left time: 166.0446s
	iters: 300, epoch: 1 | loss: 0.3111932
	speed: 0.0234s/iter; left time: 164.7354s
	iters: 400, epoch: 1 | loss: 0.3156482
	speed: 0.0249s/iter; left time: 173.1492s
	iters: 500, epoch: 1 | loss: 0.2617712
	speed: 0.0227s/iter; left time: 155.3545s
	iters: 600, epoch: 1 | loss: 0.2656581
	speed: 0.0233s/iter; left time: 156.8534s
	iters: 700, epoch: 1 | loss: 0.3026100
	speed: 0.0229s/iter; left time: 151.8960s
Epoch: 1 cost time: 17.906197786331177
Epoch: 1, Steps: 734 | Train Loss: 0.3337437 Vali Loss: 0.3587100 Test Loss: 0.4467175
Validation loss decreased (inf --> 0.358710).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2606735
	speed: 0.1388s/iter; left time: 902.9823s
	iters: 200, epoch: 2 | loss: 0.2624839
	speed: 0.0228s/iter; left time: 146.3659s
	iters: 300, epoch: 2 | loss: 0.2607741
	speed: 0.0232s/iter; left time: 146.5562s
	iters: 400, epoch: 2 | loss: 0.2655689
	speed: 0.0228s/iter; left time: 141.6120s
	iters: 500, epoch: 2 | loss: 0.2782441
	speed: 0.0231s/iter; left time: 140.8482s
	iters: 600, epoch: 2 | loss: 0.2579174
	speed: 0.0234s/iter; left time: 140.3226s
	iters: 700, epoch: 2 | loss: 0.2495326
	speed: 0.0229s/iter; left time: 135.1798s
Epoch: 2 cost time: 17.612311363220215
Epoch: 2, Steps: 734 | Train Loss: 0.2649279 Vali Loss: 0.3538830 Test Loss: 0.4408305
Validation loss decreased (0.358710 --> 0.353883).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2135571
	speed: 0.1452s/iter; left time: 838.2022s
	iters: 200, epoch: 3 | loss: 0.2569446
	speed: 0.0241s/iter; left time: 136.6174s
	iters: 300, epoch: 3 | loss: 0.2678132
	speed: 0.0243s/iter; left time: 135.2799s
	iters: 400, epoch: 3 | loss: 0.2500554
	speed: 0.0240s/iter; left time: 131.2630s
	iters: 500, epoch: 3 | loss: 0.2826216
	speed: 0.0245s/iter; left time: 131.7011s
	iters: 600, epoch: 3 | loss: 0.2207400
	speed: 0.0244s/iter; left time: 128.8401s
	iters: 700, epoch: 3 | loss: 0.2486144
	speed: 0.0253s/iter; left time: 131.0761s
Epoch: 3 cost time: 18.77960729598999
Epoch: 3, Steps: 734 | Train Loss: 0.2586264 Vali Loss: 0.3450926 Test Loss: 0.4288928
Validation loss decreased (0.353883 --> 0.345093).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2736517
	speed: 0.1419s/iter; left time: 715.0680s
	iters: 200, epoch: 4 | loss: 0.2634328
	speed: 0.0249s/iter; left time: 122.9309s
	iters: 300, epoch: 4 | loss: 0.2331252
	speed: 0.0244s/iter; left time: 118.0490s
	iters: 400, epoch: 4 | loss: 0.2557814
	speed: 0.0240s/iter; left time: 113.6725s
	iters: 500, epoch: 4 | loss: 0.2985961
	speed: 0.0250s/iter; left time: 115.7951s
	iters: 600, epoch: 4 | loss: 0.2544895
	speed: 0.0243s/iter; left time: 110.2055s
	iters: 700, epoch: 4 | loss: 0.2624332
	speed: 0.0244s/iter; left time: 108.0918s
Epoch: 4 cost time: 18.587371587753296
Epoch: 4, Steps: 734 | Train Loss: 0.2564196 Vali Loss: 0.3435924 Test Loss: 0.4270325
Validation loss decreased (0.345093 --> 0.343592).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2738693
	speed: 0.1428s/iter; left time: 614.9056s
	iters: 200, epoch: 5 | loss: 0.2476857
	speed: 0.0242s/iter; left time: 101.6686s
	iters: 300, epoch: 5 | loss: 0.2508852
	speed: 0.0236s/iter; left time: 96.9631s
	iters: 400, epoch: 5 | loss: 0.2596788
	speed: 0.0242s/iter; left time: 97.0812s
	iters: 500, epoch: 5 | loss: 0.2478057
	speed: 0.0245s/iter; left time: 95.5022s
	iters: 600, epoch: 5 | loss: 0.2707911
	speed: 0.0239s/iter; left time: 91.0127s
	iters: 700, epoch: 5 | loss: 0.2786801
	speed: 0.0246s/iter; left time: 91.1143s
Epoch: 5 cost time: 18.438634634017944
Epoch: 5, Steps: 734 | Train Loss: 0.2552261 Vali Loss: 0.3431295 Test Loss: 0.4266731
Validation loss decreased (0.343592 --> 0.343129).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2456785
	speed: 0.1411s/iter; left time: 503.9161s
	iters: 200, epoch: 6 | loss: 0.2279371
	speed: 0.0238s/iter; left time: 82.5007s
	iters: 300, epoch: 6 | loss: 0.2738928
	speed: 0.0239s/iter; left time: 80.6898s
	iters: 400, epoch: 6 | loss: 0.2457837
	speed: 0.0238s/iter; left time: 77.9411s
	iters: 500, epoch: 6 | loss: 0.2783854
	speed: 0.0242s/iter; left time: 76.7905s
	iters: 600, epoch: 6 | loss: 0.2503175
	speed: 0.0234s/iter; left time: 72.0061s
	iters: 700, epoch: 6 | loss: 0.2582676
	speed: 0.0237s/iter; left time: 70.4260s
Epoch: 6 cost time: 18.130066633224487
Epoch: 6, Steps: 734 | Train Loss: 0.2546733 Vali Loss: 0.3422675 Test Loss: 0.4255352
Validation loss decreased (0.343129 --> 0.342268).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2475146
	speed: 0.1407s/iter; left time: 399.1399s
	iters: 200, epoch: 7 | loss: 0.2508262
	speed: 0.0239s/iter; left time: 65.4145s
	iters: 300, epoch: 7 | loss: 0.2353767
	speed: 0.0229s/iter; left time: 60.4815s
	iters: 400, epoch: 7 | loss: 0.2536594
	speed: 0.0236s/iter; left time: 59.8501s
	iters: 500, epoch: 7 | loss: 0.2220570
	speed: 0.0229s/iter; left time: 55.7088s
	iters: 600, epoch: 7 | loss: 0.2641533
	speed: 0.0231s/iter; left time: 53.9660s
	iters: 700, epoch: 7 | loss: 0.2772507
	speed: 0.0232s/iter; left time: 52.0076s
Epoch: 7 cost time: 17.714850187301636
Epoch: 7, Steps: 734 | Train Loss: 0.2543407 Vali Loss: 0.3417047 Test Loss: 0.4252577
Validation loss decreased (0.342268 --> 0.341705).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2637852
	speed: 0.1428s/iter; left time: 300.2855s
	iters: 200, epoch: 8 | loss: 0.2609036
	speed: 0.0233s/iter; left time: 46.6938s
	iters: 300, epoch: 8 | loss: 0.2510515
	speed: 0.0241s/iter; left time: 45.7688s
	iters: 400, epoch: 8 | loss: 0.2444968
	speed: 0.0247s/iter; left time: 44.5025s
	iters: 500, epoch: 8 | loss: 0.2348209
	speed: 0.0248s/iter; left time: 42.1726s
	iters: 600, epoch: 8 | loss: 0.2431977
	speed: 0.0236s/iter; left time: 37.8503s
	iters: 700, epoch: 8 | loss: 0.2490056
	speed: 0.0241s/iter; left time: 36.1633s
Epoch: 8 cost time: 18.465851306915283
Epoch: 8, Steps: 734 | Train Loss: 0.2541782 Vali Loss: 0.3415879 Test Loss: 0.4249386
Validation loss decreased (0.341705 --> 0.341588).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2566157
	speed: 0.1440s/iter; left time: 197.0936s
	iters: 200, epoch: 9 | loss: 0.2416668
	speed: 0.0233s/iter; left time: 29.6037s
	iters: 300, epoch: 9 | loss: 0.2625090
	speed: 0.0228s/iter; left time: 26.6905s
	iters: 400, epoch: 9 | loss: 0.2763076
	speed: 0.0246s/iter; left time: 26.2932s
	iters: 500, epoch: 9 | loss: 0.2801539
	speed: 0.0241s/iter; left time: 23.3380s
	iters: 600, epoch: 9 | loss: 0.2740472
	speed: 0.0243s/iter; left time: 21.1248s
	iters: 700, epoch: 9 | loss: 0.2678507
	speed: 0.0246s/iter; left time: 18.9062s
Epoch: 9 cost time: 18.31573224067688
Epoch: 9, Steps: 734 | Train Loss: 0.2540723 Vali Loss: 0.3416352 Test Loss: 0.4250226
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2547747
	speed: 0.1431s/iter; left time: 90.8726s
	iters: 200, epoch: 10 | loss: 0.2371485
	speed: 0.0239s/iter; left time: 12.7812s
	iters: 300, epoch: 10 | loss: 0.2311653
	speed: 0.0234s/iter; left time: 10.1887s
	iters: 400, epoch: 10 | loss: 0.2699688
	speed: 0.0247s/iter; left time: 8.2801s
	iters: 500, epoch: 10 | loss: 0.2422862
	speed: 0.0248s/iter; left time: 5.8396s
	iters: 600, epoch: 10 | loss: 0.2452057
	speed: 0.0246s/iter; left time: 3.3250s
	iters: 700, epoch: 10 | loss: 0.2386680
	speed: 0.0247s/iter; left time: 0.8661s
Epoch: 10 cost time: 18.524351119995117
Epoch: 10, Steps: 734 | Train Loss: 0.2540226 Vali Loss: 0.3409750 Test Loss: 0.4248863
Validation loss decreased (0.341588 --> 0.340975).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_192_NLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4245465099811554, mae:0.2872214913368225
