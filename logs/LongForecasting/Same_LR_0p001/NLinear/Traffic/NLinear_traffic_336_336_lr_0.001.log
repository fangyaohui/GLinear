Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.3641375
	speed: 0.0360s/iter; left time: 257.7590s
	iters: 200, epoch: 1 | loss: 0.3300175
	speed: 0.0283s/iter; left time: 199.6470s
	iters: 300, epoch: 1 | loss: 0.2853202
	speed: 0.0288s/iter; left time: 200.3436s
	iters: 400, epoch: 1 | loss: 0.2690930
	speed: 0.0291s/iter; left time: 199.2926s
	iters: 500, epoch: 1 | loss: 0.2740898
	speed: 0.0288s/iter; left time: 194.6218s
	iters: 600, epoch: 1 | loss: 0.2609043
	speed: 0.0288s/iter; left time: 191.3998s
	iters: 700, epoch: 1 | loss: 0.2676915
	speed: 0.0291s/iter; left time: 190.5824s
Epoch: 1 cost time: 21.73222517967224
Epoch: 1, Steps: 725 | Train Loss: 0.3362468 Vali Loss: 0.3741629 Test Loss: 0.4627164
Validation loss decreased (inf --> 0.374163).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2752735
	speed: 0.1694s/iter; left time: 1088.3310s
	iters: 200, epoch: 2 | loss: 0.2778204
	speed: 0.0284s/iter; left time: 179.9735s
	iters: 300, epoch: 2 | loss: 0.2816763
	speed: 0.0285s/iter; left time: 177.5992s
	iters: 400, epoch: 2 | loss: 0.2865161
	speed: 0.0286s/iter; left time: 175.5051s
	iters: 500, epoch: 2 | loss: 0.2738207
	speed: 0.0285s/iter; left time: 171.8203s
	iters: 600, epoch: 2 | loss: 0.3098249
	speed: 0.0304s/iter; left time: 180.1077s
	iters: 700, epoch: 2 | loss: 0.2912544
	speed: 0.0286s/iter; left time: 166.8715s
Epoch: 2 cost time: 21.730961322784424
Epoch: 2, Steps: 725 | Train Loss: 0.2760246 Vali Loss: 0.3650829 Test Loss: 0.4507647
Validation loss decreased (0.374163 --> 0.365083).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2848277
	speed: 0.1700s/iter; left time: 969.2909s
	iters: 200, epoch: 3 | loss: 0.2810695
	speed: 0.0291s/iter; left time: 162.7902s
	iters: 300, epoch: 3 | loss: 0.2559545
	speed: 0.0286s/iter; left time: 157.0834s
	iters: 400, epoch: 3 | loss: 0.2495453
	speed: 0.0295s/iter; left time: 159.1058s
	iters: 500, epoch: 3 | loss: 0.2642493
	speed: 0.0287s/iter; left time: 152.2987s
	iters: 600, epoch: 3 | loss: 0.3079865
	speed: 0.0288s/iter; left time: 149.7210s
	iters: 700, epoch: 3 | loss: 0.2891610
	speed: 0.0291s/iter; left time: 148.5931s
Epoch: 3 cost time: 21.646080493927002
Epoch: 3, Steps: 725 | Train Loss: 0.2699967 Vali Loss: 0.3583935 Test Loss: 0.4425085
Validation loss decreased (0.365083 --> 0.358394).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2384898
	speed: 0.1675s/iter; left time: 833.5737s
	iters: 200, epoch: 4 | loss: 0.2844068
	speed: 0.0282s/iter; left time: 137.4932s
	iters: 300, epoch: 4 | loss: 0.2657996
	speed: 0.0302s/iter; left time: 144.2060s
	iters: 400, epoch: 4 | loss: 0.2507614
	speed: 0.0288s/iter; left time: 134.4616s
	iters: 500, epoch: 4 | loss: 0.2982084
	speed: 0.0289s/iter; left time: 132.3211s
	iters: 600, epoch: 4 | loss: 0.2605663
	speed: 0.0290s/iter; left time: 129.8462s
	iters: 700, epoch: 4 | loss: 0.2669164
	speed: 0.0283s/iter; left time: 123.6859s
Epoch: 4 cost time: 21.68552303314209
Epoch: 4, Steps: 725 | Train Loss: 0.2677396 Vali Loss: 0.3576368 Test Loss: 0.4408168
Validation loss decreased (0.358394 --> 0.357637).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2872425
	speed: 0.1712s/iter; left time: 727.9552s
	iters: 200, epoch: 5 | loss: 0.2713282
	speed: 0.0288s/iter; left time: 119.5596s
	iters: 300, epoch: 5 | loss: 0.2749863
	speed: 0.0288s/iter; left time: 116.6410s
	iters: 400, epoch: 5 | loss: 0.2945961
	speed: 0.0289s/iter; left time: 114.3576s
	iters: 500, epoch: 5 | loss: 0.2742571
	speed: 0.0291s/iter; left time: 112.0233s
	iters: 600, epoch: 5 | loss: 0.2919775
	speed: 0.0291s/iter; left time: 109.0943s
	iters: 700, epoch: 5 | loss: 0.2413592
	speed: 0.0289s/iter; left time: 105.4312s
Epoch: 5 cost time: 21.70271944999695
Epoch: 5, Steps: 725 | Train Loss: 0.2666003 Vali Loss: 0.3561865 Test Loss: 0.4398331
Validation loss decreased (0.357637 --> 0.356186).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2409957
	speed: 0.1751s/iter; left time: 617.5007s
	iters: 200, epoch: 6 | loss: 0.2436406
	speed: 0.0293s/iter; left time: 100.3324s
	iters: 300, epoch: 6 | loss: 0.2731623
	speed: 0.0289s/iter; left time: 96.1213s
	iters: 400, epoch: 6 | loss: 0.2654109
	speed: 0.0292s/iter; left time: 94.2794s
	iters: 500, epoch: 6 | loss: 0.2724628
	speed: 0.0293s/iter; left time: 91.4777s
	iters: 600, epoch: 6 | loss: 0.2492399
	speed: 0.0288s/iter; left time: 87.2743s
	iters: 700, epoch: 6 | loss: 0.2509197
	speed: 0.0286s/iter; left time: 83.7527s
Epoch: 6 cost time: 21.80618906021118
Epoch: 6, Steps: 725 | Train Loss: 0.2659886 Vali Loss: 0.3559047 Test Loss: 0.4393153
Validation loss decreased (0.356186 --> 0.355905).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2427728
	speed: 0.1707s/iter; left time: 478.0245s
	iters: 200, epoch: 7 | loss: 0.2405479
	speed: 0.0292s/iter; left time: 78.7642s
	iters: 300, epoch: 7 | loss: 0.2561485
	speed: 0.0300s/iter; left time: 78.1228s
	iters: 400, epoch: 7 | loss: 0.2653014
	speed: 0.0289s/iter; left time: 72.3741s
	iters: 500, epoch: 7 | loss: 0.2813821
	speed: 0.0295s/iter; left time: 70.8441s
	iters: 600, epoch: 7 | loss: 0.2619193
	speed: 0.0295s/iter; left time: 67.9122s
	iters: 700, epoch: 7 | loss: 0.2650256
	speed: 0.0293s/iter; left time: 64.4372s
Epoch: 7 cost time: 22.061431646347046
Epoch: 7, Steps: 725 | Train Loss: 0.2656937 Vali Loss: 0.3550274 Test Loss: 0.4386814
Validation loss decreased (0.355905 --> 0.355027).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2723192
	speed: 0.1680s/iter; left time: 348.7713s
	iters: 200, epoch: 8 | loss: 0.2841128
	speed: 0.0289s/iter; left time: 57.0510s
	iters: 300, epoch: 8 | loss: 0.2446624
	speed: 0.0280s/iter; left time: 52.5833s
	iters: 400, epoch: 8 | loss: 0.2781473
	speed: 0.0313s/iter; left time: 55.6183s
	iters: 500, epoch: 8 | loss: 0.2622596
	speed: 0.0294s/iter; left time: 49.3168s
	iters: 600, epoch: 8 | loss: 0.2723102
	speed: 0.0287s/iter; left time: 45.2435s
	iters: 700, epoch: 8 | loss: 0.2552572
	speed: 0.0304s/iter; left time: 44.8446s
Epoch: 8 cost time: 21.917964935302734
Epoch: 8, Steps: 725 | Train Loss: 0.2654784 Vali Loss: 0.3550707 Test Loss: 0.4382044
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2510940
	speed: 0.1729s/iter; left time: 233.6404s
	iters: 200, epoch: 9 | loss: 0.2464403
	speed: 0.0300s/iter; left time: 37.5113s
	iters: 300, epoch: 9 | loss: 0.2782037
	speed: 0.0296s/iter; left time: 34.0252s
	iters: 400, epoch: 9 | loss: 0.2890012
	speed: 0.0315s/iter; left time: 33.0631s
	iters: 500, epoch: 9 | loss: 0.2657532
	speed: 0.0295s/iter; left time: 28.0481s
	iters: 600, epoch: 9 | loss: 0.2547421
	speed: 0.0295s/iter; left time: 25.1280s
	iters: 700, epoch: 9 | loss: 0.2908725
	speed: 0.0290s/iter; left time: 21.7625s
Epoch: 9 cost time: 22.32617974281311
Epoch: 9, Steps: 725 | Train Loss: 0.2653933 Vali Loss: 0.3554512 Test Loss: 0.4382300
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2505232
	speed: 0.1797s/iter; left time: 112.5209s
	iters: 200, epoch: 10 | loss: 0.2613479
	speed: 0.0288s/iter; left time: 15.1486s
	iters: 300, epoch: 10 | loss: 0.2637664
	speed: 0.0307s/iter; left time: 13.0708s
	iters: 400, epoch: 10 | loss: 0.2658168
	speed: 0.0315s/iter; left time: 10.2799s
	iters: 500, epoch: 10 | loss: 0.2589508
	speed: 0.0314s/iter; left time: 7.1017s
	iters: 600, epoch: 10 | loss: 0.2498818
	speed: 0.0286s/iter; left time: 3.6087s
	iters: 700, epoch: 10 | loss: 0.2497577
	speed: 0.0276s/iter; left time: 0.7172s
Epoch: 10 cost time: 22.096494436264038
Epoch: 10, Steps: 725 | Train Loss: 0.2653778 Vali Loss: 0.3554238 Test Loss: 0.4381408
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_336_NLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4375357925891876, mae:0.2942754924297333
