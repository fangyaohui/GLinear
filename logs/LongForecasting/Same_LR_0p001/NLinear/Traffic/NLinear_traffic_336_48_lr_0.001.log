Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_48', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=48, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_48_NLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1709
test 3461
	iters: 100, epoch: 1 | loss: 0.3384850
	speed: 0.0250s/iter; left time: 182.9853s
	iters: 200, epoch: 1 | loss: 0.2932176
	speed: 0.0188s/iter; left time: 135.6310s
	iters: 300, epoch: 1 | loss: 0.2691969
	speed: 0.0193s/iter; left time: 137.3342s
	iters: 400, epoch: 1 | loss: 0.2769337
	speed: 0.0190s/iter; left time: 133.5442s
	iters: 500, epoch: 1 | loss: 0.2605607
	speed: 0.0188s/iter; left time: 130.6429s
	iters: 600, epoch: 1 | loss: 0.2296533
	speed: 0.0188s/iter; left time: 128.5329s
	iters: 700, epoch: 1 | loss: 0.2230912
	speed: 0.0190s/iter; left time: 128.1337s
Epoch: 1 cost time: 14.745489597320557
Epoch: 1, Steps: 743 | Train Loss: 0.3172970 Vali Loss: 0.3507342 Test Loss: 0.4192741
Validation loss decreased (inf --> 0.350734).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2658181
	speed: 0.1142s/iter; left time: 752.1861s
	iters: 200, epoch: 2 | loss: 0.2809238
	speed: 0.0197s/iter; left time: 127.7490s
	iters: 300, epoch: 2 | loss: 0.2535316
	speed: 0.0195s/iter; left time: 124.5428s
	iters: 400, epoch: 2 | loss: 0.2815941
	speed: 0.0197s/iter; left time: 123.6368s
	iters: 500, epoch: 2 | loss: 0.2342945
	speed: 0.0194s/iter; left time: 119.7569s
	iters: 600, epoch: 2 | loss: 0.2375839
	speed: 0.0200s/iter; left time: 121.8572s
	iters: 700, epoch: 2 | loss: 0.2485731
	speed: 0.0193s/iter; left time: 115.7182s
Epoch: 2 cost time: 15.155166625976562
Epoch: 2, Steps: 743 | Train Loss: 0.2507046 Vali Loss: 0.3383291 Test Loss: 0.4029222
Validation loss decreased (0.350734 --> 0.338329).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2944041
	speed: 0.1141s/iter; left time: 667.0262s
	iters: 200, epoch: 3 | loss: 0.2069556
	speed: 0.0195s/iter; left time: 112.1021s
	iters: 300, epoch: 3 | loss: 0.2508653
	speed: 0.0193s/iter; left time: 108.9706s
	iters: 400, epoch: 3 | loss: 0.2002316
	speed: 0.0199s/iter; left time: 110.3234s
	iters: 500, epoch: 3 | loss: 0.2121075
	speed: 0.0198s/iter; left time: 107.5451s
	iters: 600, epoch: 3 | loss: 0.2660276
	speed: 0.0198s/iter; left time: 105.9761s
	iters: 700, epoch: 3 | loss: 0.2358847
	speed: 0.0189s/iter; left time: 99.3131s
Epoch: 3 cost time: 15.194182634353638
Epoch: 3, Steps: 743 | Train Loss: 0.2445912 Vali Loss: 0.3348731 Test Loss: 0.3990334
Validation loss decreased (0.338329 --> 0.334873).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2397407
	speed: 0.1136s/iter; left time: 579.7198s
	iters: 200, epoch: 4 | loss: 0.2327025
	speed: 0.0192s/iter; left time: 95.8407s
	iters: 300, epoch: 4 | loss: 0.2283566
	speed: 0.0199s/iter; left time: 97.3236s
	iters: 400, epoch: 4 | loss: 0.2765199
	speed: 0.0194s/iter; left time: 93.3241s
	iters: 500, epoch: 4 | loss: 0.2845303
	speed: 0.0190s/iter; left time: 89.1345s
	iters: 600, epoch: 4 | loss: 0.2165694
	speed: 0.0194s/iter; left time: 89.4919s
	iters: 700, epoch: 4 | loss: 0.2409608
	speed: 0.0196s/iter; left time: 88.0724s
Epoch: 4 cost time: 15.096479415893555
Epoch: 4, Steps: 743 | Train Loss: 0.2424964 Vali Loss: 0.3331127 Test Loss: 0.3973055
Validation loss decreased (0.334873 --> 0.333113).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2485534
	speed: 0.1150s/iter; left time: 501.4337s
	iters: 200, epoch: 5 | loss: 0.2910751
	speed: 0.0199s/iter; left time: 84.7386s
	iters: 300, epoch: 5 | loss: 0.2123703
	speed: 0.0190s/iter; left time: 78.9308s
	iters: 400, epoch: 5 | loss: 0.2413490
	speed: 0.0191s/iter; left time: 77.7173s
	iters: 500, epoch: 5 | loss: 0.2234960
	speed: 0.0206s/iter; left time: 81.4004s
	iters: 600, epoch: 5 | loss: 0.2554962
	speed: 0.0196s/iter; left time: 75.4932s
	iters: 700, epoch: 5 | loss: 0.2213255
	speed: 0.0198s/iter; left time: 74.3308s
Epoch: 5 cost time: 15.282739400863647
Epoch: 5, Steps: 743 | Train Loss: 0.2414274 Vali Loss: 0.3314916 Test Loss: 0.3947817
Validation loss decreased (0.333113 --> 0.331492).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2236055
	speed: 0.1135s/iter; left time: 410.3168s
	iters: 200, epoch: 6 | loss: 0.2065496
	speed: 0.0193s/iter; left time: 67.7165s
	iters: 300, epoch: 6 | loss: 0.2328520
	speed: 0.0196s/iter; left time: 66.9919s
	iters: 400, epoch: 6 | loss: 0.2280620
	speed: 0.0191s/iter; left time: 63.1742s
	iters: 500, epoch: 6 | loss: 0.2133180
	speed: 0.0201s/iter; left time: 64.4931s
	iters: 600, epoch: 6 | loss: 0.2216985
	speed: 0.0199s/iter; left time: 62.1014s
	iters: 700, epoch: 6 | loss: 0.2283688
	speed: 0.0194s/iter; left time: 58.5726s
Epoch: 6 cost time: 15.210110664367676
Epoch: 6, Steps: 743 | Train Loss: 0.2409069 Vali Loss: 0.3309836 Test Loss: 0.3942454
Validation loss decreased (0.331492 --> 0.330984).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2602544
	speed: 0.1133s/iter; left time: 325.4762s
	iters: 200, epoch: 7 | loss: 0.2145820
	speed: 0.0192s/iter; left time: 53.1479s
	iters: 300, epoch: 7 | loss: 0.2178186
	speed: 0.0188s/iter; left time: 50.1289s
	iters: 400, epoch: 7 | loss: 0.2180143
	speed: 0.0193s/iter; left time: 49.5531s
	iters: 500, epoch: 7 | loss: 0.2385077
	speed: 0.0194s/iter; left time: 48.0614s
	iters: 600, epoch: 7 | loss: 0.2426380
	speed: 0.0196s/iter; left time: 46.4158s
	iters: 700, epoch: 7 | loss: 0.1896906
	speed: 0.0191s/iter; left time: 43.4311s
Epoch: 7 cost time: 14.99692678451538
Epoch: 7, Steps: 743 | Train Loss: 0.2406011 Vali Loss: 0.3307059 Test Loss: 0.3938639
Validation loss decreased (0.330984 --> 0.330706).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1959710
	speed: 0.1139s/iter; left time: 242.6696s
	iters: 200, epoch: 8 | loss: 0.2450351
	speed: 0.0197s/iter; left time: 39.9159s
	iters: 300, epoch: 8 | loss: 0.2309541
	speed: 0.0205s/iter; left time: 39.5297s
	iters: 400, epoch: 8 | loss: 0.2814982
	speed: 0.0197s/iter; left time: 36.0016s
	iters: 500, epoch: 8 | loss: 0.2375109
	speed: 0.0197s/iter; left time: 34.0216s
	iters: 600, epoch: 8 | loss: 0.2695346
	speed: 0.0200s/iter; left time: 32.6768s
	iters: 700, epoch: 8 | loss: 0.2270972
	speed: 0.0199s/iter; left time: 30.4267s
Epoch: 8 cost time: 15.397988319396973
Epoch: 8, Steps: 743 | Train Loss: 0.2404162 Vali Loss: 0.3300627 Test Loss: 0.3938433
Validation loss decreased (0.330706 --> 0.330063).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2504722
	speed: 0.1104s/iter; left time: 153.1803s
	iters: 200, epoch: 9 | loss: 0.2032234
	speed: 0.0193s/iter; left time: 24.8506s
	iters: 300, epoch: 9 | loss: 0.2255423
	speed: 0.0192s/iter; left time: 22.7471s
	iters: 400, epoch: 9 | loss: 0.1942918
	speed: 0.0207s/iter; left time: 22.5177s
	iters: 500, epoch: 9 | loss: 0.2508743
	speed: 0.0210s/iter; left time: 20.6876s
	iters: 600, epoch: 9 | loss: 0.2324642
	speed: 0.0208s/iter; left time: 18.4746s
	iters: 700, epoch: 9 | loss: 0.2445541
	speed: 0.0204s/iter; left time: 16.0456s
Epoch: 9 cost time: 15.522388458251953
Epoch: 9, Steps: 743 | Train Loss: 0.2403203 Vali Loss: 0.3304451 Test Loss: 0.3936326
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2326258
	speed: 0.1112s/iter; left time: 71.6230s
	iters: 200, epoch: 10 | loss: 0.2320216
	speed: 0.0189s/iter; left time: 10.2856s
	iters: 300, epoch: 10 | loss: 0.1982846
	speed: 0.0192s/iter; left time: 8.5125s
	iters: 400, epoch: 10 | loss: 0.2568495
	speed: 0.0210s/iter; left time: 7.2399s
	iters: 500, epoch: 10 | loss: 0.2111518
	speed: 0.0200s/iter; left time: 4.8906s
	iters: 600, epoch: 10 | loss: 0.2273854
	speed: 0.0218s/iter; left time: 3.1376s
	iters: 700, epoch: 10 | loss: 0.2360501
	speed: 0.0213s/iter; left time: 0.9366s
Epoch: 10 cost time: 15.597570896148682
Epoch: 10, Steps: 743 | Train Loss: 0.2402605 Vali Loss: 0.3304400 Test Loss: 0.3937135
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_48_NLinear_custom_ftM_sl336_ll48_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3461
mse:0.3944985568523407, mae:0.2768673896789551
