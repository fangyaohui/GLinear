Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.3798843
	speed: 0.0531s/iter; left time: 367.0923s
	iters: 200, epoch: 1 | loss: 0.3279780
	speed: 0.0458s/iter; left time: 312.1986s
	iters: 300, epoch: 1 | loss: 0.2968882
	speed: 0.0455s/iter; left time: 305.3185s
	iters: 400, epoch: 1 | loss: 0.3198361
	speed: 0.0452s/iter; left time: 299.1075s
	iters: 500, epoch: 1 | loss: 0.2993599
	speed: 0.0453s/iter; left time: 295.2214s
	iters: 600, epoch: 1 | loss: 0.3083491
	speed: 0.0449s/iter; left time: 287.9731s
	iters: 700, epoch: 1 | loss: 0.2789332
	speed: 0.0454s/iter; left time: 286.7816s
Epoch: 1 cost time: 32.703030824661255
Epoch: 1, Steps: 701 | Train Loss: 0.3573925 Vali Loss: 0.4182870 Test Loss: 0.4861690
Validation loss decreased (inf --> 0.418287).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3298440
	speed: 0.4014s/iter; left time: 2492.5789s
	iters: 200, epoch: 2 | loss: 0.2708322
	speed: 0.0464s/iter; left time: 283.3457s
	iters: 300, epoch: 2 | loss: 0.3029639
	speed: 0.0469s/iter; left time: 281.9445s
	iters: 400, epoch: 2 | loss: 0.2778485
	speed: 0.0472s/iter; left time: 279.0912s
	iters: 500, epoch: 2 | loss: 0.3351286
	speed: 0.0473s/iter; left time: 274.9882s
	iters: 600, epoch: 2 | loss: 0.2767749
	speed: 0.0474s/iter; left time: 270.8003s
	iters: 700, epoch: 2 | loss: 0.2960520
	speed: 0.0475s/iter; left time: 266.4041s
Epoch: 2 cost time: 33.778650999069214
Epoch: 2, Steps: 701 | Train Loss: 0.2967130 Vali Loss: 0.4126274 Test Loss: 0.4805374
Validation loss decreased (0.418287 --> 0.412627).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2825505
	speed: 0.3886s/iter; left time: 2140.6653s
	iters: 200, epoch: 3 | loss: 0.2924410
	speed: 0.0458s/iter; left time: 247.8272s
	iters: 300, epoch: 3 | loss: 0.2926880
	speed: 0.0470s/iter; left time: 249.5324s
	iters: 400, epoch: 3 | loss: 0.3160971
	speed: 0.0460s/iter; left time: 239.3817s
	iters: 500, epoch: 3 | loss: 0.3066280
	speed: 0.0459s/iter; left time: 234.6859s
	iters: 600, epoch: 3 | loss: 0.2615780
	speed: 0.0462s/iter; left time: 231.2282s
	iters: 700, epoch: 3 | loss: 0.2755674
	speed: 0.0453s/iter; left time: 222.3000s
Epoch: 3 cost time: 32.97880005836487
Epoch: 3, Steps: 701 | Train Loss: 0.2902934 Vali Loss: 0.4062780 Test Loss: 0.4729120
Validation loss decreased (0.412627 --> 0.406278).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2897044
	speed: 0.3799s/iter; left time: 1826.4886s
	iters: 200, epoch: 4 | loss: 0.2875583
	speed: 0.0449s/iter; left time: 211.3340s
	iters: 300, epoch: 4 | loss: 0.2786572
	speed: 0.0456s/iter; left time: 210.0976s
	iters: 400, epoch: 4 | loss: 0.2934925
	speed: 0.0454s/iter; left time: 204.6531s
	iters: 500, epoch: 4 | loss: 0.2885214
	speed: 0.0467s/iter; left time: 205.6891s
	iters: 600, epoch: 4 | loss: 0.2923686
	speed: 0.0464s/iter; left time: 199.9618s
	iters: 700, epoch: 4 | loss: 0.2986781
	speed: 0.0455s/iter; left time: 191.4305s
Epoch: 4 cost time: 32.82550001144409
Epoch: 4, Steps: 701 | Train Loss: 0.2877832 Vali Loss: 0.4035140 Test Loss: 0.4680522
Validation loss decreased (0.406278 --> 0.403514).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2848142
	speed: 0.3799s/iter; left time: 1560.3979s
	iters: 200, epoch: 5 | loss: 0.3013307
	speed: 0.0455s/iter; left time: 182.4090s
	iters: 300, epoch: 5 | loss: 0.2791346
	speed: 0.0466s/iter; left time: 182.0005s
	iters: 400, epoch: 5 | loss: 0.2992765
	speed: 0.0455s/iter; left time: 173.2860s
	iters: 500, epoch: 5 | loss: 0.2814072
	speed: 0.0460s/iter; left time: 170.5952s
	iters: 600, epoch: 5 | loss: 0.3121633
	speed: 0.0453s/iter; left time: 163.5508s
	iters: 700, epoch: 5 | loss: 0.2858608
	speed: 0.0455s/iter; left time: 159.6851s
Epoch: 5 cost time: 32.965980052948
Epoch: 5, Steps: 701 | Train Loss: 0.2865467 Vali Loss: 0.4020196 Test Loss: 0.4670074
Validation loss decreased (0.403514 --> 0.402020).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2979777
	speed: 0.3816s/iter; left time: 1299.7196s
	iters: 200, epoch: 6 | loss: 0.2898424
	speed: 0.0463s/iter; left time: 153.0928s
	iters: 300, epoch: 6 | loss: 0.2972332
	speed: 0.0464s/iter; left time: 148.8661s
	iters: 400, epoch: 6 | loss: 0.2913267
	speed: 0.0464s/iter; left time: 144.2633s
	iters: 500, epoch: 6 | loss: 0.3243130
	speed: 0.0479s/iter; left time: 143.9515s
	iters: 600, epoch: 6 | loss: 0.3206657
	speed: 0.0470s/iter; left time: 136.6786s
	iters: 700, epoch: 6 | loss: 0.3007808
	speed: 0.0458s/iter; left time: 128.5017s
Epoch: 6 cost time: 33.42670679092407
Epoch: 6, Steps: 701 | Train Loss: 0.2859234 Vali Loss: 0.4022840 Test Loss: 0.4668835
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2554888
	speed: 0.3839s/iter; left time: 1038.5389s
	iters: 200, epoch: 7 | loss: 0.2963970
	speed: 0.0472s/iter; left time: 123.0159s
	iters: 300, epoch: 7 | loss: 0.2801146
	speed: 0.0463s/iter; left time: 116.0988s
	iters: 400, epoch: 7 | loss: 0.2939321
	speed: 0.0463s/iter; left time: 111.4268s
	iters: 500, epoch: 7 | loss: 0.2768728
	speed: 0.0474s/iter; left time: 109.2550s
	iters: 600, epoch: 7 | loss: 0.2985072
	speed: 0.0460s/iter; left time: 101.3549s
	iters: 700, epoch: 7 | loss: 0.2740947
	speed: 0.0455s/iter; left time: 95.6856s
Epoch: 7 cost time: 33.20470213890076
Epoch: 7, Steps: 701 | Train Loss: 0.2855701 Vali Loss: 0.4013144 Test Loss: 0.4661934
Validation loss decreased (0.402020 --> 0.401314).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2863829
	speed: 0.3785s/iter; left time: 758.5937s
	iters: 200, epoch: 8 | loss: 0.2743666
	speed: 0.0463s/iter; left time: 88.1373s
	iters: 300, epoch: 8 | loss: 0.2939945
	speed: 0.0479s/iter; left time: 86.4404s
	iters: 400, epoch: 8 | loss: 0.2882288
	speed: 0.0473s/iter; left time: 80.6028s
	iters: 500, epoch: 8 | loss: 0.2820257
	speed: 0.0469s/iter; left time: 75.2981s
	iters: 600, epoch: 8 | loss: 0.2809864
	speed: 0.0476s/iter; left time: 71.6038s
	iters: 700, epoch: 8 | loss: 0.2832513
	speed: 0.0476s/iter; left time: 66.8202s
Epoch: 8 cost time: 33.70972800254822
Epoch: 8, Steps: 701 | Train Loss: 0.2853615 Vali Loss: 0.4014449 Test Loss: 0.4658361
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2833940
	speed: 0.3794s/iter; left time: 494.3798s
	iters: 200, epoch: 9 | loss: 0.2843259
	speed: 0.0469s/iter; left time: 56.4646s
	iters: 300, epoch: 9 | loss: 0.2931601
	speed: 0.0477s/iter; left time: 52.5625s
	iters: 400, epoch: 9 | loss: 0.2695598
	speed: 0.0470s/iter; left time: 47.0982s
	iters: 500, epoch: 9 | loss: 0.2771392
	speed: 0.0472s/iter; left time: 42.5789s
	iters: 600, epoch: 9 | loss: 0.2686097
	speed: 0.0470s/iter; left time: 37.7186s
	iters: 700, epoch: 9 | loss: 0.2934839
	speed: 0.0465s/iter; left time: 32.6922s
Epoch: 9 cost time: 33.5756196975708
Epoch: 9, Steps: 701 | Train Loss: 0.2852839 Vali Loss: 0.4009138 Test Loss: 0.4658372
Validation loss decreased (0.401314 --> 0.400914).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3105528
	speed: 0.3939s/iter; left time: 237.1120s
	iters: 200, epoch: 10 | loss: 0.2821406
	speed: 0.0453s/iter; left time: 22.7417s
	iters: 300, epoch: 10 | loss: 0.2979396
	speed: 0.0490s/iter; left time: 19.7119s
	iters: 400, epoch: 10 | loss: 0.2814114
	speed: 0.0481s/iter; left time: 14.5336s
	iters: 500, epoch: 10 | loss: 0.3169188
	speed: 0.0476s/iter; left time: 9.6153s
	iters: 600, epoch: 10 | loss: 0.2707647
	speed: 0.0468s/iter; left time: 4.7711s
	iters: 700, epoch: 10 | loss: 0.3063422
	speed: 0.0451s/iter; left time: 0.0903s
Epoch: 10 cost time: 33.59124183654785
Epoch: 10, Steps: 701 | Train Loss: 0.2852165 Vali Loss: 0.4009328 Test Loss: 0.4657139
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_720_NLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.46567678451538086, mae:0.3109274208545685
