Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3365443
	speed: 0.0093s/iter; left time: 211.8775s
	iters: 200, epoch: 1 | loss: 0.4372797
	speed: 0.0041s/iter; left time: 93.5024s
	iters: 300, epoch: 1 | loss: 0.5103850
	speed: 0.0044s/iter; left time: 98.9926s
	iters: 400, epoch: 1 | loss: 0.5915107
	speed: 0.0042s/iter; left time: 94.5785s
	iters: 500, epoch: 1 | loss: 0.4121437
	speed: 0.0046s/iter; left time: 102.0390s
	iters: 600, epoch: 1 | loss: 5.8678403
	speed: 0.0044s/iter; left time: 97.9373s
	iters: 700, epoch: 1 | loss: 0.2914881
	speed: 0.0045s/iter; left time: 98.7145s
	iters: 800, epoch: 1 | loss: 0.4245942
	speed: 0.0042s/iter; left time: 91.6450s
	iters: 900, epoch: 1 | loss: 0.4024439
	speed: 0.0042s/iter; left time: 90.8864s
	iters: 1000, epoch: 1 | loss: 0.2961072
	speed: 0.0041s/iter; left time: 90.2702s
	iters: 1100, epoch: 1 | loss: 0.4355591
	speed: 0.0043s/iter; left time: 93.5871s
	iters: 1200, epoch: 1 | loss: 0.3524003
	speed: 0.0040s/iter; left time: 87.0321s
	iters: 1300, epoch: 1 | loss: 0.3674436
	speed: 0.0042s/iter; left time: 90.7912s
	iters: 1400, epoch: 1 | loss: 0.6268091
	speed: 0.0042s/iter; left time: 88.9034s
	iters: 1500, epoch: 1 | loss: 0.3656944
	speed: 0.0040s/iter; left time: 84.9672s
	iters: 1600, epoch: 1 | loss: 0.5107396
	speed: 0.0041s/iter; left time: 87.0022s
	iters: 1700, epoch: 1 | loss: 2.5485404
	speed: 0.0042s/iter; left time: 88.8856s
	iters: 1800, epoch: 1 | loss: 0.4404300
	speed: 0.0046s/iter; left time: 96.6944s
	iters: 1900, epoch: 1 | loss: 0.1978884
	speed: 0.0046s/iter; left time: 96.2269s
	iters: 2000, epoch: 1 | loss: 1.1919771
	speed: 0.0043s/iter; left time: 89.0277s
	iters: 2100, epoch: 1 | loss: 0.3135731
	speed: 0.0044s/iter; left time: 91.1764s
	iters: 2200, epoch: 1 | loss: 0.2703891
	speed: 0.0044s/iter; left time: 89.8719s
Epoch: 1 cost time: 10.343578100204468
Epoch: 1, Steps: 2278 | Train Loss: 0.5458591 Vali Loss: 0.4440390 Test Loss: 0.1728088
Validation loss decreased (inf --> 0.444039).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3856555
	speed: 0.0613s/iter; left time: 1250.8139s
	iters: 200, epoch: 2 | loss: 0.3060095
	speed: 0.0043s/iter; left time: 88.2768s
	iters: 300, epoch: 2 | loss: 0.3173448
	speed: 0.0042s/iter; left time: 84.8771s
	iters: 400, epoch: 2 | loss: 0.6865832
	speed: 0.0045s/iter; left time: 90.8711s
	iters: 500, epoch: 2 | loss: 1.8562996
	speed: 0.0044s/iter; left time: 87.4922s
	iters: 600, epoch: 2 | loss: 0.7952654
	speed: 0.0043s/iter; left time: 86.3739s
	iters: 700, epoch: 2 | loss: 0.2889888
	speed: 0.0045s/iter; left time: 89.9988s
	iters: 800, epoch: 2 | loss: 0.6943167
	speed: 0.0043s/iter; left time: 85.2226s
	iters: 900, epoch: 2 | loss: 0.3623145
	speed: 0.0044s/iter; left time: 87.1444s
	iters: 1000, epoch: 2 | loss: 0.4880044
	speed: 0.0044s/iter; left time: 85.5177s
	iters: 1100, epoch: 2 | loss: 0.4332201
	speed: 0.0046s/iter; left time: 88.6836s
	iters: 1200, epoch: 2 | loss: 0.5502073
	speed: 0.0046s/iter; left time: 89.6750s
	iters: 1300, epoch: 2 | loss: 0.3024721
	speed: 0.0046s/iter; left time: 87.4220s
	iters: 1400, epoch: 2 | loss: 0.4276294
	speed: 0.0043s/iter; left time: 81.8138s
	iters: 1500, epoch: 2 | loss: 2.4222109
	speed: 0.0042s/iter; left time: 79.6472s
	iters: 1600, epoch: 2 | loss: 0.4122833
	speed: 0.0042s/iter; left time: 78.9801s
	iters: 1700, epoch: 2 | loss: 0.2780111
	speed: 0.0042s/iter; left time: 78.6861s
	iters: 1800, epoch: 2 | loss: 0.2133917
	speed: 0.0043s/iter; left time: 79.7798s
	iters: 1900, epoch: 2 | loss: 0.3180451
	speed: 0.0043s/iter; left time: 80.5807s
	iters: 2000, epoch: 2 | loss: 0.6661754
	speed: 0.0044s/iter; left time: 80.9968s
	iters: 2100, epoch: 2 | loss: 0.3260978
	speed: 0.0044s/iter; left time: 80.1507s
	iters: 2200, epoch: 2 | loss: 0.3641819
	speed: 0.0044s/iter; left time: 81.2209s
Epoch: 2 cost time: 10.581315994262695
Epoch: 2, Steps: 2278 | Train Loss: 0.5514634 Vali Loss: 0.4524328 Test Loss: 0.1879567
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2897162
	speed: 0.0595s/iter; left time: 1079.0901s
	iters: 200, epoch: 3 | loss: 0.4402065
	speed: 0.0042s/iter; left time: 75.8342s
	iters: 300, epoch: 3 | loss: 1.0689803
	speed: 0.0041s/iter; left time: 73.8370s
	iters: 400, epoch: 3 | loss: 0.2657124
	speed: 0.0045s/iter; left time: 80.3996s
	iters: 500, epoch: 3 | loss: 0.2866548
	speed: 0.0041s/iter; left time: 73.4195s
	iters: 600, epoch: 3 | loss: 0.2885391
	speed: 0.0043s/iter; left time: 75.8682s
	iters: 700, epoch: 3 | loss: 0.2226271
	speed: 0.0043s/iter; left time: 74.8197s
	iters: 800, epoch: 3 | loss: 0.5443315
	speed: 0.0043s/iter; left time: 75.5289s
	iters: 900, epoch: 3 | loss: 0.6148989
	speed: 0.0040s/iter; left time: 69.2474s
	iters: 1000, epoch: 3 | loss: 0.4411643
	speed: 0.0043s/iter; left time: 73.2416s
	iters: 1100, epoch: 3 | loss: 3.7435746
	speed: 0.0044s/iter; left time: 74.9128s
	iters: 1200, epoch: 3 | loss: 0.4548571
	speed: 0.0042s/iter; left time: 71.2654s
	iters: 1300, epoch: 3 | loss: 0.4590200
	speed: 0.0042s/iter; left time: 71.4418s
	iters: 1400, epoch: 3 | loss: 0.4766473
	speed: 0.0041s/iter; left time: 68.8469s
	iters: 1500, epoch: 3 | loss: 0.4168817
	speed: 0.0042s/iter; left time: 70.9542s
	iters: 1600, epoch: 3 | loss: 0.3032222
	speed: 0.0043s/iter; left time: 71.8650s
	iters: 1700, epoch: 3 | loss: 0.2387722
	speed: 0.0044s/iter; left time: 72.3211s
	iters: 1800, epoch: 3 | loss: 0.2679186
	speed: 0.0043s/iter; left time: 69.9633s
	iters: 1900, epoch: 3 | loss: 0.4939206
	speed: 0.0047s/iter; left time: 76.3067s
	iters: 2000, epoch: 3 | loss: 0.4670368
	speed: 0.0044s/iter; left time: 71.7006s
	iters: 2100, epoch: 3 | loss: 0.4550285
	speed: 0.0045s/iter; left time: 72.6533s
	iters: 2200, epoch: 3 | loss: 0.3118955
	speed: 0.0043s/iter; left time: 69.2943s
Epoch: 3 cost time: 10.419792652130127
Epoch: 3, Steps: 2278 | Train Loss: 0.4983459 Vali Loss: 0.4399794 Test Loss: 0.1716214
Validation loss decreased (0.444039 --> 0.439979).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5664177
	speed: 0.0622s/iter; left time: 986.0104s
	iters: 200, epoch: 4 | loss: 0.4866639
	speed: 0.0047s/iter; left time: 74.7313s
	iters: 300, epoch: 4 | loss: 0.6505818
	speed: 0.0046s/iter; left time: 72.7054s
	iters: 400, epoch: 4 | loss: 0.3974937
	speed: 0.0040s/iter; left time: 62.0579s
	iters: 500, epoch: 4 | loss: 0.5183234
	speed: 0.0043s/iter; left time: 66.0792s
	iters: 600, epoch: 4 | loss: 0.3251246
	speed: 0.0045s/iter; left time: 69.5893s
	iters: 700, epoch: 4 | loss: 0.3286669
	speed: 0.0043s/iter; left time: 65.7921s
	iters: 800, epoch: 4 | loss: 0.6635131
	speed: 0.0044s/iter; left time: 66.7758s
	iters: 900, epoch: 4 | loss: 0.3186916
	speed: 0.0044s/iter; left time: 65.7698s
	iters: 1000, epoch: 4 | loss: 0.5439633
	speed: 0.0045s/iter; left time: 67.3959s
	iters: 1100, epoch: 4 | loss: 0.2221025
	speed: 0.0047s/iter; left time: 69.4809s
	iters: 1200, epoch: 4 | loss: 0.2928352
	speed: 0.0046s/iter; left time: 67.8718s
	iters: 1300, epoch: 4 | loss: 0.2971472
	speed: 0.0046s/iter; left time: 67.3280s
	iters: 1400, epoch: 4 | loss: 0.3407763
	speed: 0.0044s/iter; left time: 64.4881s
	iters: 1500, epoch: 4 | loss: 0.2966277
	speed: 0.0044s/iter; left time: 63.0320s
	iters: 1600, epoch: 4 | loss: 0.2368756
	speed: 0.0045s/iter; left time: 65.2028s
	iters: 1700, epoch: 4 | loss: 0.2505155
	speed: 0.0044s/iter; left time: 62.2901s
	iters: 1800, epoch: 4 | loss: 0.4909128
	speed: 0.0044s/iter; left time: 62.8278s
	iters: 1900, epoch: 4 | loss: 0.2805305
	speed: 0.0045s/iter; left time: 63.7829s
	iters: 2000, epoch: 4 | loss: 0.4075392
	speed: 0.0044s/iter; left time: 61.6124s
	iters: 2100, epoch: 4 | loss: 0.5872416
	speed: 0.0044s/iter; left time: 61.0921s
	iters: 2200, epoch: 4 | loss: 0.5651822
	speed: 0.0044s/iter; left time: 60.5079s
Epoch: 4 cost time: 10.7554931640625
Epoch: 4, Steps: 2278 | Train Loss: 0.4767483 Vali Loss: 0.4413894 Test Loss: 0.1760737
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3204495
	speed: 0.0606s/iter; left time: 821.7212s
	iters: 200, epoch: 5 | loss: 0.5596670
	speed: 0.0044s/iter; left time: 58.6678s
	iters: 300, epoch: 5 | loss: 0.3371747
	speed: 0.0044s/iter; left time: 58.4206s
	iters: 400, epoch: 5 | loss: 2.2554076
	speed: 0.0042s/iter; left time: 55.8011s
	iters: 500, epoch: 5 | loss: 0.8261936
	speed: 0.0044s/iter; left time: 58.0119s
	iters: 600, epoch: 5 | loss: 0.3593596
	speed: 0.0043s/iter; left time: 56.3650s
	iters: 700, epoch: 5 | loss: 0.3892342
	speed: 0.0044s/iter; left time: 57.2848s
	iters: 800, epoch: 5 | loss: 0.2389576
	speed: 0.0042s/iter; left time: 53.8026s
	iters: 900, epoch: 5 | loss: 0.3121396
	speed: 0.0041s/iter; left time: 52.5621s
	iters: 1000, epoch: 5 | loss: 0.7811129
	speed: 0.0042s/iter; left time: 52.9409s
	iters: 1100, epoch: 5 | loss: 0.5719668
	speed: 0.0043s/iter; left time: 54.0549s
	iters: 1200, epoch: 5 | loss: 0.2767285
	speed: 0.0046s/iter; left time: 56.8005s
	iters: 1300, epoch: 5 | loss: 0.2754596
	speed: 0.0047s/iter; left time: 58.1951s
	iters: 1400, epoch: 5 | loss: 0.3228083
	speed: 0.0046s/iter; left time: 56.3076s
	iters: 1500, epoch: 5 | loss: 0.2855736
	speed: 0.0043s/iter; left time: 52.3584s
	iters: 1600, epoch: 5 | loss: 0.5828972
	speed: 0.0042s/iter; left time: 50.8174s
	iters: 1700, epoch: 5 | loss: 0.3726017
	speed: 0.0044s/iter; left time: 52.2352s
	iters: 1800, epoch: 5 | loss: 0.2314228
	speed: 0.0045s/iter; left time: 53.5978s
	iters: 1900, epoch: 5 | loss: 0.3935513
	speed: 0.0043s/iter; left time: 50.9518s
	iters: 2000, epoch: 5 | loss: 0.2410815
	speed: 0.0043s/iter; left time: 49.7298s
	iters: 2100, epoch: 5 | loss: 0.2296482
	speed: 0.0042s/iter; left time: 49.0420s
	iters: 2200, epoch: 5 | loss: 0.3220606
	speed: 0.0041s/iter; left time: 46.7537s
Epoch: 5 cost time: 10.438961505889893
Epoch: 5, Steps: 2278 | Train Loss: 0.4638671 Vali Loss: 0.4414602 Test Loss: 0.1780199
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2547300
	speed: 0.0590s/iter; left time: 665.7821s
	iters: 200, epoch: 6 | loss: 0.3615329
	speed: 0.0043s/iter; left time: 47.9999s
	iters: 300, epoch: 6 | loss: 0.3095460
	speed: 0.0045s/iter; left time: 50.4132s
	iters: 400, epoch: 6 | loss: 2.1585729
	speed: 0.0045s/iter; left time: 49.6594s
	iters: 500, epoch: 6 | loss: 0.2976303
	speed: 0.0043s/iter; left time: 46.6563s
	iters: 600, epoch: 6 | loss: 0.5262155
	speed: 0.0043s/iter; left time: 46.8509s
	iters: 700, epoch: 6 | loss: 0.4697768
	speed: 0.0044s/iter; left time: 46.5429s
	iters: 800, epoch: 6 | loss: 0.2877213
	speed: 0.0042s/iter; left time: 44.7902s
	iters: 900, epoch: 6 | loss: 0.3610864
	speed: 0.0042s/iter; left time: 44.3003s
	iters: 1000, epoch: 6 | loss: 0.2332744
	speed: 0.0042s/iter; left time: 43.9346s
	iters: 1100, epoch: 6 | loss: 0.2812842
	speed: 0.0042s/iter; left time: 43.7179s
	iters: 1200, epoch: 6 | loss: 0.4067927
	speed: 0.0043s/iter; left time: 44.0840s
	iters: 1300, epoch: 6 | loss: 0.3410066
	speed: 0.0044s/iter; left time: 43.9335s
	iters: 1400, epoch: 6 | loss: 0.4376596
	speed: 0.0044s/iter; left time: 43.8303s
	iters: 1500, epoch: 6 | loss: 0.2931529
	speed: 0.0043s/iter; left time: 42.7609s
	iters: 1600, epoch: 6 | loss: 0.3448380
	speed: 0.0042s/iter; left time: 41.4020s
	iters: 1700, epoch: 6 | loss: 0.2945088
	speed: 0.0044s/iter; left time: 42.2157s
	iters: 1800, epoch: 6 | loss: 0.3002506
	speed: 0.0045s/iter; left time: 42.9518s
	iters: 1900, epoch: 6 | loss: 0.3997288
	speed: 0.0042s/iter; left time: 39.3944s
	iters: 2000, epoch: 6 | loss: 0.2928711
	speed: 0.0041s/iter; left time: 38.9599s
	iters: 2100, epoch: 6 | loss: 0.3116276
	speed: 0.0044s/iter; left time: 41.0967s
	iters: 2200, epoch: 6 | loss: 0.2668815
	speed: 0.0042s/iter; left time: 38.4002s
Epoch: 6 cost time: 10.422389507293701
Epoch: 6, Steps: 2278 | Train Loss: 0.4631073 Vali Loss: 0.4378667 Test Loss: 0.1751116
Validation loss decreased (0.439979 --> 0.437867).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3490093
	speed: 0.0630s/iter; left time: 567.4149s
	iters: 200, epoch: 7 | loss: 0.5460420
	speed: 0.0044s/iter; left time: 39.4531s
	iters: 300, epoch: 7 | loss: 0.4075402
	speed: 0.0045s/iter; left time: 39.4625s
	iters: 400, epoch: 7 | loss: 0.4751174
	speed: 0.0044s/iter; left time: 38.5074s
	iters: 500, epoch: 7 | loss: 0.2384301
	speed: 0.0043s/iter; left time: 36.9425s
	iters: 600, epoch: 7 | loss: 0.3329534
	speed: 0.0043s/iter; left time: 36.5156s
	iters: 700, epoch: 7 | loss: 0.5039797
	speed: 0.0046s/iter; left time: 38.8967s
	iters: 800, epoch: 7 | loss: 0.4102083
	speed: 0.0043s/iter; left time: 35.6454s
	iters: 900, epoch: 7 | loss: 0.2825314
	speed: 0.0044s/iter; left time: 36.4632s
	iters: 1000, epoch: 7 | loss: 0.5264736
	speed: 0.0045s/iter; left time: 36.2054s
	iters: 1100, epoch: 7 | loss: 0.2995672
	speed: 0.0046s/iter; left time: 36.9301s
	iters: 1200, epoch: 7 | loss: 0.3912802
	speed: 0.0047s/iter; left time: 37.1428s
	iters: 1300, epoch: 7 | loss: 0.8972400
	speed: 0.0043s/iter; left time: 33.8833s
	iters: 1400, epoch: 7 | loss: 0.3226350
	speed: 0.0044s/iter; left time: 33.5672s
	iters: 1500, epoch: 7 | loss: 0.3113538
	speed: 0.0042s/iter; left time: 31.6357s
	iters: 1600, epoch: 7 | loss: 0.3211347
	speed: 0.0042s/iter; left time: 31.8043s
	iters: 1700, epoch: 7 | loss: 0.3015104
	speed: 0.0042s/iter; left time: 31.2629s
	iters: 1800, epoch: 7 | loss: 0.2600189
	speed: 0.0043s/iter; left time: 31.6869s
	iters: 1900, epoch: 7 | loss: 0.3425666
	speed: 0.0045s/iter; left time: 32.2932s
	iters: 2000, epoch: 7 | loss: 0.2692210
	speed: 0.0043s/iter; left time: 30.3966s
	iters: 2100, epoch: 7 | loss: 0.2635838
	speed: 0.0043s/iter; left time: 30.4515s
	iters: 2200, epoch: 7 | loss: 0.2509510
	speed: 0.0042s/iter; left time: 28.7400s
Epoch: 7 cost time: 10.588976383209229
Epoch: 7, Steps: 2278 | Train Loss: 0.4609926 Vali Loss: 0.4386781 Test Loss: 0.1729559
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.8110180
	speed: 0.0603s/iter; left time: 406.2700s
	iters: 200, epoch: 8 | loss: 0.2381454
	speed: 0.0040s/iter; left time: 26.6460s
	iters: 300, epoch: 8 | loss: 0.2794326
	speed: 0.0042s/iter; left time: 27.2097s
	iters: 400, epoch: 8 | loss: 0.3331862
	speed: 0.0042s/iter; left time: 27.2316s
	iters: 500, epoch: 8 | loss: 0.2841409
	speed: 0.0043s/iter; left time: 27.2529s
	iters: 600, epoch: 8 | loss: 0.5940420
	speed: 0.0043s/iter; left time: 26.6391s
	iters: 700, epoch: 8 | loss: 0.5511701
	speed: 0.0042s/iter; left time: 25.5501s
	iters: 800, epoch: 8 | loss: 0.2628356
	speed: 0.0043s/iter; left time: 25.7031s
	iters: 900, epoch: 8 | loss: 0.3168543
	speed: 0.0044s/iter; left time: 26.3174s
	iters: 1000, epoch: 8 | loss: 0.3666326
	speed: 0.0046s/iter; left time: 26.6261s
	iters: 1100, epoch: 8 | loss: 0.6590888
	speed: 0.0042s/iter; left time: 24.0602s
	iters: 1200, epoch: 8 | loss: 0.2886608
	speed: 0.0042s/iter; left time: 23.9083s
	iters: 1300, epoch: 8 | loss: 0.3107311
	speed: 0.0041s/iter; left time: 22.5180s
	iters: 1400, epoch: 8 | loss: 0.3350903
	speed: 0.0046s/iter; left time: 25.0879s
	iters: 1500, epoch: 8 | loss: 0.6743086
	speed: 0.0046s/iter; left time: 24.7166s
	iters: 1600, epoch: 8 | loss: 0.4387043
	speed: 0.0042s/iter; left time: 22.1208s
	iters: 1700, epoch: 8 | loss: 0.3665236
	speed: 0.0043s/iter; left time: 21.8958s
	iters: 1800, epoch: 8 | loss: 0.3747690
	speed: 0.0043s/iter; left time: 21.4350s
	iters: 1900, epoch: 8 | loss: 0.2210028
	speed: 0.0043s/iter; left time: 21.4650s
	iters: 2000, epoch: 8 | loss: 0.2781177
	speed: 0.0043s/iter; left time: 20.8366s
	iters: 2100, epoch: 8 | loss: 0.4645730
	speed: 0.0045s/iter; left time: 21.3221s
	iters: 2200, epoch: 8 | loss: 1.0524993
	speed: 0.0038s/iter; left time: 17.7962s
Epoch: 8 cost time: 10.394192457199097
Epoch: 8, Steps: 2278 | Train Loss: 0.4603959 Vali Loss: 0.4387186 Test Loss: 0.1756878
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.5781194
	speed: 0.0618s/iter; left time: 275.3655s
	iters: 200, epoch: 9 | loss: 0.2679884
	speed: 0.0043s/iter; left time: 18.7973s
	iters: 300, epoch: 9 | loss: 0.4787547
	speed: 0.0044s/iter; left time: 18.5181s
	iters: 400, epoch: 9 | loss: 0.4698538
	speed: 0.0044s/iter; left time: 18.3437s
	iters: 500, epoch: 9 | loss: 0.3987904
	speed: 0.0046s/iter; left time: 18.6479s
	iters: 600, epoch: 9 | loss: 0.6223748
	speed: 0.0043s/iter; left time: 16.9307s
	iters: 700, epoch: 9 | loss: 0.2625421
	speed: 0.0042s/iter; left time: 16.2973s
	iters: 800, epoch: 9 | loss: 0.3404615
	speed: 0.0042s/iter; left time: 15.7211s
	iters: 900, epoch: 9 | loss: 0.2681242
	speed: 0.0041s/iter; left time: 14.8310s
	iters: 1000, epoch: 9 | loss: 0.2746384
	speed: 0.0043s/iter; left time: 15.4016s
	iters: 1100, epoch: 9 | loss: 0.3504942
	speed: 0.0045s/iter; left time: 15.7007s
	iters: 1200, epoch: 9 | loss: 0.4172739
	speed: 0.0045s/iter; left time: 15.1200s
	iters: 1300, epoch: 9 | loss: 0.3454026
	speed: 0.0043s/iter; left time: 14.0594s
	iters: 1400, epoch: 9 | loss: 0.2228299
	speed: 0.0044s/iter; left time: 13.7471s
	iters: 1500, epoch: 9 | loss: 0.7359616
	speed: 0.0043s/iter; left time: 12.9979s
	iters: 1600, epoch: 9 | loss: 0.2283709
	speed: 0.0042s/iter; left time: 12.3534s
	iters: 1700, epoch: 9 | loss: 0.3370000
	speed: 0.0043s/iter; left time: 12.2901s
	iters: 1800, epoch: 9 | loss: 0.2591035
	speed: 0.0043s/iter; left time: 11.7277s
	iters: 1900, epoch: 9 | loss: 0.2148654
	speed: 0.0043s/iter; left time: 11.4549s
	iters: 2000, epoch: 9 | loss: 0.3697466
	speed: 0.0045s/iter; left time: 11.5573s
	iters: 2100, epoch: 9 | loss: 0.3323399
	speed: 0.0045s/iter; left time: 10.9974s
	iters: 2200, epoch: 9 | loss: 0.3726040
	speed: 0.0044s/iter; left time: 10.4562s
Epoch: 9 cost time: 10.555798530578613
Epoch: 9, Steps: 2278 | Train Loss: 0.4598104 Vali Loss: 0.4378442 Test Loss: 0.1760527
Validation loss decreased (0.437867 --> 0.437844).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4132408
	speed: 0.0607s/iter; left time: 132.3506s
	iters: 200, epoch: 10 | loss: 0.3150926
	speed: 0.0045s/iter; left time: 9.3294s
	iters: 300, epoch: 10 | loss: 0.3172350
	speed: 0.0044s/iter; left time: 8.6300s
	iters: 400, epoch: 10 | loss: 0.2652651
	speed: 0.0042s/iter; left time: 7.8864s
	iters: 500, epoch: 10 | loss: 0.4329022
	speed: 0.0044s/iter; left time: 7.7863s
	iters: 600, epoch: 10 | loss: 0.3394328
	speed: 0.0044s/iter; left time: 7.3695s
	iters: 700, epoch: 10 | loss: 0.2925963
	speed: 0.0044s/iter; left time: 6.8742s
	iters: 800, epoch: 10 | loss: 0.2932988
	speed: 0.0044s/iter; left time: 6.5752s
	iters: 900, epoch: 10 | loss: 0.4170038
	speed: 0.0044s/iter; left time: 6.0368s
	iters: 1000, epoch: 10 | loss: 0.3136619
	speed: 0.0044s/iter; left time: 5.6078s
	iters: 1100, epoch: 10 | loss: 0.3325519
	speed: 0.0042s/iter; left time: 4.9480s
	iters: 1200, epoch: 10 | loss: 0.5254188
	speed: 0.0045s/iter; left time: 4.8365s
	iters: 1300, epoch: 10 | loss: 0.5304964
	speed: 0.0044s/iter; left time: 4.3010s
	iters: 1400, epoch: 10 | loss: 0.2878892
	speed: 0.0043s/iter; left time: 3.7452s
	iters: 1500, epoch: 10 | loss: 0.5119567
	speed: 0.0043s/iter; left time: 3.3709s
	iters: 1600, epoch: 10 | loss: 0.3516690
	speed: 0.0043s/iter; left time: 2.9472s
	iters: 1700, epoch: 10 | loss: 0.2510970
	speed: 0.0040s/iter; left time: 2.3355s
	iters: 1800, epoch: 10 | loss: 0.3823121
	speed: 0.0042s/iter; left time: 1.9989s
	iters: 1900, epoch: 10 | loss: 0.4546014
	speed: 0.0043s/iter; left time: 1.6167s
	iters: 2000, epoch: 10 | loss: 0.6416125
	speed: 0.0043s/iter; left time: 1.1890s
	iters: 2100, epoch: 10 | loss: 0.3853257
	speed: 0.0044s/iter; left time: 0.7797s
	iters: 2200, epoch: 10 | loss: 0.3088305
	speed: 0.0044s/iter; left time: 0.3505s
Epoch: 10 cost time: 10.465788125991821
Epoch: 10, Steps: 2278 | Train Loss: 0.4594231 Vali Loss: 0.4384013 Test Loss: 0.1748013
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : weather_336_96_NLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17610326409339905, mae:0.2264421284198761
