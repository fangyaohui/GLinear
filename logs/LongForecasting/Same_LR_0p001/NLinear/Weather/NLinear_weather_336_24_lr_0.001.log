Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36528
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.7455518
	speed: 0.0091s/iter; left time: 207.4283s
	iters: 200, epoch: 1 | loss: 0.3091308
	speed: 0.0042s/iter; left time: 94.9409s
	iters: 300, epoch: 1 | loss: 1.0084683
	speed: 0.0043s/iter; left time: 97.4482s
	iters: 400, epoch: 1 | loss: 0.2445709
	speed: 0.0042s/iter; left time: 93.1136s
	iters: 500, epoch: 1 | loss: 0.2363650
	speed: 0.0040s/iter; left time: 88.4734s
	iters: 600, epoch: 1 | loss: 0.2833890
	speed: 0.0040s/iter; left time: 88.2039s
	iters: 700, epoch: 1 | loss: 0.2737278
	speed: 0.0042s/iter; left time: 92.9506s
	iters: 800, epoch: 1 | loss: 0.5354844
	speed: 0.0043s/iter; left time: 94.6914s
	iters: 900, epoch: 1 | loss: 0.1819921
	speed: 0.0044s/iter; left time: 96.1025s
	iters: 1000, epoch: 1 | loss: 0.1756510
	speed: 0.0042s/iter; left time: 92.6112s
	iters: 1100, epoch: 1 | loss: 0.2778604
	speed: 0.0044s/iter; left time: 94.5451s
	iters: 1200, epoch: 1 | loss: 0.4374273
	speed: 0.0043s/iter; left time: 93.3828s
	iters: 1300, epoch: 1 | loss: 0.2019441
	speed: 0.0042s/iter; left time: 90.9443s
	iters: 1400, epoch: 1 | loss: 0.2165232
	speed: 0.0042s/iter; left time: 90.0040s
	iters: 1500, epoch: 1 | loss: 0.3211973
	speed: 0.0041s/iter; left time: 88.4627s
	iters: 1600, epoch: 1 | loss: 0.2911075
	speed: 0.0042s/iter; left time: 89.5672s
	iters: 1700, epoch: 1 | loss: 6.8207364
	speed: 0.0041s/iter; left time: 86.6181s
	iters: 1800, epoch: 1 | loss: 0.1801198
	speed: 0.0046s/iter; left time: 97.0187s
	iters: 1900, epoch: 1 | loss: 0.1515342
	speed: 0.0042s/iter; left time: 88.8582s
	iters: 2000, epoch: 1 | loss: 0.2116874
	speed: 0.0045s/iter; left time: 93.3092s
	iters: 2100, epoch: 1 | loss: 0.2562593
	speed: 0.0043s/iter; left time: 89.0397s
	iters: 2200, epoch: 1 | loss: 0.2267517
	speed: 0.0040s/iter; left time: 83.0141s
Epoch: 1 cost time: 10.23369288444519
Epoch: 1, Steps: 2283 | Train Loss: 0.4133002 Vali Loss: 0.3204868 Test Loss: 0.1155482
Validation loss decreased (inf --> 0.320487).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 9.8734169
	speed: 0.0568s/iter; left time: 1161.7659s
	iters: 200, epoch: 2 | loss: 0.1917640
	speed: 0.0041s/iter; left time: 84.0425s
	iters: 300, epoch: 2 | loss: 0.4442973
	speed: 0.0041s/iter; left time: 83.9171s
	iters: 400, epoch: 2 | loss: 0.2709112
	speed: 0.0041s/iter; left time: 82.6640s
	iters: 500, epoch: 2 | loss: 0.1355735
	speed: 0.0042s/iter; left time: 83.8710s
	iters: 600, epoch: 2 | loss: 0.1656545
	speed: 0.0043s/iter; left time: 84.9435s
	iters: 700, epoch: 2 | loss: 0.1314697
	speed: 0.0044s/iter; left time: 86.4207s
	iters: 800, epoch: 2 | loss: 0.1786732
	speed: 0.0043s/iter; left time: 85.5484s
	iters: 900, epoch: 2 | loss: 0.1969928
	speed: 0.0042s/iter; left time: 82.8251s
	iters: 1000, epoch: 2 | loss: 0.2125893
	speed: 0.0045s/iter; left time: 87.9043s
	iters: 1100, epoch: 2 | loss: 0.2711506
	speed: 0.0044s/iter; left time: 85.4450s
	iters: 1200, epoch: 2 | loss: 0.1090928
	speed: 0.0044s/iter; left time: 85.6833s
	iters: 1300, epoch: 2 | loss: 0.2238317
	speed: 0.0042s/iter; left time: 80.2918s
	iters: 1400, epoch: 2 | loss: 0.2361808
	speed: 0.0044s/iter; left time: 83.5769s
	iters: 1500, epoch: 2 | loss: 0.1279770
	speed: 0.0044s/iter; left time: 83.4175s
	iters: 1600, epoch: 2 | loss: 0.1223442
	speed: 0.0042s/iter; left time: 79.7377s
	iters: 1700, epoch: 2 | loss: 0.1820282
	speed: 0.0044s/iter; left time: 82.6350s
	iters: 1800, epoch: 2 | loss: 0.1801283
	speed: 0.0044s/iter; left time: 82.8717s
	iters: 1900, epoch: 2 | loss: 0.2832566
	speed: 0.0044s/iter; left time: 82.0530s
	iters: 2000, epoch: 2 | loss: 0.2438777
	speed: 0.0044s/iter; left time: 81.7066s
	iters: 2100, epoch: 2 | loss: 0.3637072
	speed: 0.0042s/iter; left time: 76.5760s
	iters: 2200, epoch: 2 | loss: 0.1102995
	speed: 0.0042s/iter; left time: 77.2571s
Epoch: 2 cost time: 10.357505559921265
Epoch: 2, Steps: 2283 | Train Loss: 0.4424446 Vali Loss: 0.2918508 Test Loss: 0.1055215
Validation loss decreased (0.320487 --> 0.291851).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4546645
	speed: 0.0577s/iter; left time: 1047.9159s
	iters: 200, epoch: 3 | loss: 0.1311752
	speed: 0.0043s/iter; left time: 78.2472s
	iters: 300, epoch: 3 | loss: 0.3560984
	speed: 0.0043s/iter; left time: 77.4073s
	iters: 400, epoch: 3 | loss: 0.3344169
	speed: 0.0046s/iter; left time: 81.3625s
	iters: 500, epoch: 3 | loss: 0.1482642
	speed: 0.0043s/iter; left time: 76.3687s
	iters: 600, epoch: 3 | loss: 0.1718097
	speed: 0.0044s/iter; left time: 77.9401s
	iters: 700, epoch: 3 | loss: 0.2733178
	speed: 0.0045s/iter; left time: 79.7924s
	iters: 800, epoch: 3 | loss: 0.2537183
	speed: 0.0042s/iter; left time: 73.1024s
	iters: 900, epoch: 3 | loss: 0.1308129
	speed: 0.0044s/iter; left time: 76.3696s
	iters: 1000, epoch: 3 | loss: 0.2982512
	speed: 0.0043s/iter; left time: 73.9118s
	iters: 1100, epoch: 3 | loss: 0.1381237
	speed: 0.0048s/iter; left time: 81.6303s
	iters: 1200, epoch: 3 | loss: 0.2760792
	speed: 0.0042s/iter; left time: 72.0352s
	iters: 1300, epoch: 3 | loss: 0.2853048
	speed: 0.0043s/iter; left time: 72.6959s
	iters: 1400, epoch: 3 | loss: 0.2297488
	speed: 0.0043s/iter; left time: 72.7885s
	iters: 1500, epoch: 3 | loss: 0.4399143
	speed: 0.0044s/iter; left time: 72.9741s
	iters: 1600, epoch: 3 | loss: 0.2249405
	speed: 0.0043s/iter; left time: 70.8638s
	iters: 1700, epoch: 3 | loss: 0.1740532
	speed: 0.0044s/iter; left time: 72.2703s
	iters: 1800, epoch: 3 | loss: 0.2634423
	speed: 0.0047s/iter; left time: 77.9598s
	iters: 1900, epoch: 3 | loss: 0.1514420
	speed: 0.0044s/iter; left time: 71.8263s
	iters: 2000, epoch: 3 | loss: 0.1587182
	speed: 0.0044s/iter; left time: 71.2822s
	iters: 2100, epoch: 3 | loss: 0.2264948
	speed: 0.0046s/iter; left time: 74.0733s
	iters: 2200, epoch: 3 | loss: 0.1986876
	speed: 0.0042s/iter; left time: 68.0544s
Epoch: 3 cost time: 10.651654481887817
Epoch: 3, Steps: 2283 | Train Loss: 0.4031745 Vali Loss: 0.3086949 Test Loss: 0.1121280
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1921299
	speed: 0.0600s/iter; left time: 952.8429s
	iters: 200, epoch: 4 | loss: 0.1437795
	speed: 0.0042s/iter; left time: 65.8161s
	iters: 300, epoch: 4 | loss: 0.3167016
	speed: 0.0043s/iter; left time: 66.8741s
	iters: 400, epoch: 4 | loss: 0.1790167
	speed: 0.0043s/iter; left time: 67.0584s
	iters: 500, epoch: 4 | loss: 0.7564215
	speed: 0.0043s/iter; left time: 67.2331s
	iters: 600, epoch: 4 | loss: 0.2318429
	speed: 0.0044s/iter; left time: 67.0090s
	iters: 700, epoch: 4 | loss: 0.1154473
	speed: 0.0045s/iter; left time: 68.3284s
	iters: 800, epoch: 4 | loss: 0.2383889
	speed: 0.0043s/iter; left time: 64.9242s
	iters: 900, epoch: 4 | loss: 0.0792364
	speed: 0.0044s/iter; left time: 66.2117s
	iters: 1000, epoch: 4 | loss: 0.2307579
	speed: 0.0042s/iter; left time: 63.6028s
	iters: 1100, epoch: 4 | loss: 0.2572932
	speed: 0.0044s/iter; left time: 64.8096s
	iters: 1200, epoch: 4 | loss: 0.1485428
	speed: 0.0044s/iter; left time: 64.5582s
	iters: 1300, epoch: 4 | loss: 0.2157122
	speed: 0.0042s/iter; left time: 62.1743s
	iters: 1400, epoch: 4 | loss: 0.1174002
	speed: 0.0045s/iter; left time: 65.0625s
	iters: 1500, epoch: 4 | loss: 0.7474023
	speed: 0.0043s/iter; left time: 61.7938s
	iters: 1600, epoch: 4 | loss: 0.1081982
	speed: 0.0042s/iter; left time: 61.0797s
	iters: 1700, epoch: 4 | loss: 0.2792584
	speed: 0.0043s/iter; left time: 61.9136s
	iters: 1800, epoch: 4 | loss: 0.2119461
	speed: 0.0043s/iter; left time: 61.6234s
	iters: 1900, epoch: 4 | loss: 0.1171286
	speed: 0.0043s/iter; left time: 60.7485s
	iters: 2000, epoch: 4 | loss: 0.4379841
	speed: 0.0043s/iter; left time: 60.6673s
	iters: 2100, epoch: 4 | loss: 0.2933680
	speed: 0.0042s/iter; left time: 58.4193s
	iters: 2200, epoch: 4 | loss: 0.6828182
	speed: 0.0043s/iter; left time: 58.6305s
Epoch: 4 cost time: 10.436471939086914
Epoch: 4, Steps: 2283 | Train Loss: 0.3498992 Vali Loss: 0.2927770 Test Loss: 0.1040813
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1701839
	speed: 0.0585s/iter; left time: 794.9835s
	iters: 200, epoch: 5 | loss: 0.3583337
	speed: 0.0046s/iter; left time: 61.7369s
	iters: 300, epoch: 5 | loss: 0.1499137
	speed: 0.0041s/iter; left time: 54.2679s
	iters: 400, epoch: 5 | loss: 0.1854583
	speed: 0.0042s/iter; left time: 55.6543s
	iters: 500, epoch: 5 | loss: 0.3703156
	speed: 0.0043s/iter; left time: 56.8679s
	iters: 600, epoch: 5 | loss: 0.4056102
	speed: 0.0044s/iter; left time: 57.3287s
	iters: 700, epoch: 5 | loss: 0.1512011
	speed: 0.0043s/iter; left time: 55.5085s
	iters: 800, epoch: 5 | loss: 0.5379669
	speed: 0.0043s/iter; left time: 55.3062s
	iters: 900, epoch: 5 | loss: 0.2277109
	speed: 0.0043s/iter; left time: 55.4870s
	iters: 1000, epoch: 5 | loss: 0.1303542
	speed: 0.0044s/iter; left time: 56.2367s
	iters: 1100, epoch: 5 | loss: 0.3132812
	speed: 0.0047s/iter; left time: 59.5124s
	iters: 1200, epoch: 5 | loss: 0.0798585
	speed: 0.0044s/iter; left time: 55.5197s
	iters: 1300, epoch: 5 | loss: 0.1545932
	speed: 0.0043s/iter; left time: 53.9086s
	iters: 1400, epoch: 5 | loss: 0.1569724
	speed: 0.0043s/iter; left time: 52.9583s
	iters: 1500, epoch: 5 | loss: 0.1348194
	speed: 0.0043s/iter; left time: 52.1406s
	iters: 1600, epoch: 5 | loss: 0.2777376
	speed: 0.0043s/iter; left time: 51.9791s
	iters: 1700, epoch: 5 | loss: 0.1724826
	speed: 0.0042s/iter; left time: 50.7548s
	iters: 1800, epoch: 5 | loss: 0.3968192
	speed: 0.0043s/iter; left time: 50.9561s
	iters: 1900, epoch: 5 | loss: 0.2802361
	speed: 0.0044s/iter; left time: 52.3323s
	iters: 2000, epoch: 5 | loss: 0.3394321
	speed: 0.0041s/iter; left time: 48.5018s
	iters: 2100, epoch: 5 | loss: 0.1958569
	speed: 0.0042s/iter; left time: 48.6865s
	iters: 2200, epoch: 5 | loss: 0.7396836
	speed: 0.0043s/iter; left time: 49.0962s
Epoch: 5 cost time: 10.445959329605103
Epoch: 5, Steps: 2283 | Train Loss: 0.3372802 Vali Loss: 0.2926991 Test Loss: 0.1032433
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.10562875121831894, mae:0.1453014612197876
