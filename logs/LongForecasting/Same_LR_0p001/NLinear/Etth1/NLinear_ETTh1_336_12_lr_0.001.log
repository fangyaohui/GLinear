Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_12_NLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8293
val 2869
test 2869
	iters: 100, epoch: 1 | loss: 0.2303859
	speed: 0.0085s/iter; left time: 87.5251s
	iters: 200, epoch: 1 | loss: 0.1924346
	speed: 0.0038s/iter; left time: 38.5802s
	iters: 300, epoch: 1 | loss: 0.3202317
	speed: 0.0038s/iter; left time: 38.0755s
	iters: 400, epoch: 1 | loss: 0.2397854
	speed: 0.0039s/iter; left time: 38.9169s
	iters: 500, epoch: 1 | loss: 0.1918012
	speed: 0.0038s/iter; left time: 37.2831s
	iters: 600, epoch: 1 | loss: 0.3797034
	speed: 0.0037s/iter; left time: 36.4410s
	iters: 700, epoch: 1 | loss: 0.2206071
	speed: 0.0039s/iter; left time: 37.4137s
	iters: 800, epoch: 1 | loss: 0.2589044
	speed: 0.0038s/iter; left time: 36.7350s
	iters: 900, epoch: 1 | loss: 0.2613628
	speed: 0.0038s/iter; left time: 35.6455s
	iters: 1000, epoch: 1 | loss: 0.1867021
	speed: 0.0038s/iter; left time: 35.2989s
Epoch: 1 cost time: 4.47830867767334
Epoch: 1, Steps: 1036 | Train Loss: 0.2695098 Vali Loss: 0.3593157 Test Loss: 0.3074755
Validation loss decreased (inf --> 0.359316).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1741708
	speed: 0.0399s/iter; left time: 368.0242s
	iters: 200, epoch: 2 | loss: 0.3221385
	speed: 0.0034s/iter; left time: 31.2490s
	iters: 300, epoch: 2 | loss: 0.2524169
	speed: 0.0034s/iter; left time: 30.3959s
	iters: 400, epoch: 2 | loss: 0.3741603
	speed: 0.0037s/iter; left time: 32.6190s
	iters: 500, epoch: 2 | loss: 0.2749959
	speed: 0.0037s/iter; left time: 32.4262s
	iters: 600, epoch: 2 | loss: 0.2901956
	speed: 0.0038s/iter; left time: 33.4384s
	iters: 700, epoch: 2 | loss: 0.3632411
	speed: 0.0067s/iter; left time: 57.5292s
	iters: 800, epoch: 2 | loss: 0.2417649
	speed: 0.0042s/iter; left time: 35.4391s
	iters: 900, epoch: 2 | loss: 0.2825088
	speed: 0.0038s/iter; left time: 32.0265s
	iters: 1000, epoch: 2 | loss: 0.3568344
	speed: 0.0037s/iter; left time: 30.9685s
Epoch: 2 cost time: 4.650571584701538
Epoch: 2, Steps: 1036 | Train Loss: 0.2439918 Vali Loss: 0.3352039 Test Loss: 0.3241136
Validation loss decreased (0.359316 --> 0.335204).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3002703
	speed: 0.0408s/iter; left time: 334.5066s
	iters: 200, epoch: 3 | loss: 0.1235908
	speed: 0.0038s/iter; left time: 30.6665s
	iters: 300, epoch: 3 | loss: 0.1990001
	speed: 0.0038s/iter; left time: 30.0757s
	iters: 400, epoch: 3 | loss: 0.3572702
	speed: 0.0038s/iter; left time: 30.1694s
	iters: 500, epoch: 3 | loss: 0.2649340
	speed: 0.0038s/iter; left time: 29.8313s
	iters: 600, epoch: 3 | loss: 0.2025351
	speed: 0.0038s/iter; left time: 29.4952s
	iters: 700, epoch: 3 | loss: 0.2559019
	speed: 0.0039s/iter; left time: 29.5863s
	iters: 800, epoch: 3 | loss: 0.2028051
	speed: 0.0039s/iter; left time: 29.1764s
	iters: 900, epoch: 3 | loss: 0.2259296
	speed: 0.0046s/iter; left time: 33.7572s
	iters: 1000, epoch: 3 | loss: 0.2253018
	speed: 0.0038s/iter; left time: 27.7027s
Epoch: 3 cost time: 4.598965167999268
Epoch: 3, Steps: 1036 | Train Loss: 0.2332299 Vali Loss: 0.3528842 Test Loss: 0.2993353
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1324795
	speed: 0.0411s/iter; left time: 294.2000s
	iters: 200, epoch: 4 | loss: 0.2598888
	speed: 0.0038s/iter; left time: 26.9700s
	iters: 300, epoch: 4 | loss: 0.2158394
	speed: 0.0038s/iter; left time: 26.5882s
	iters: 400, epoch: 4 | loss: 0.1628502
	speed: 0.0039s/iter; left time: 26.3859s
	iters: 500, epoch: 4 | loss: 0.4039639
	speed: 0.0039s/iter; left time: 26.2093s
	iters: 600, epoch: 4 | loss: 0.2681627
	speed: 0.0039s/iter; left time: 25.9358s
	iters: 700, epoch: 4 | loss: 0.2615130
	speed: 0.0038s/iter; left time: 25.0728s
	iters: 800, epoch: 4 | loss: 0.1775098
	speed: 0.0040s/iter; left time: 25.9159s
	iters: 900, epoch: 4 | loss: 0.2577596
	speed: 0.0039s/iter; left time: 24.6886s
	iters: 1000, epoch: 4 | loss: 0.3245301
	speed: 0.0037s/iter; left time: 23.0731s
Epoch: 4 cost time: 4.52348256111145
Epoch: 4, Steps: 1036 | Train Loss: 0.2279184 Vali Loss: 0.3283058 Test Loss: 0.3067515
Validation loss decreased (0.335204 --> 0.328306).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1530023
	speed: 0.0423s/iter; left time: 258.6911s
	iters: 200, epoch: 5 | loss: 0.2496305
	speed: 0.0038s/iter; left time: 22.6414s
	iters: 300, epoch: 5 | loss: 0.1772051
	speed: 0.0038s/iter; left time: 22.6474s
	iters: 400, epoch: 5 | loss: 0.4615321
	speed: 0.0039s/iter; left time: 22.4352s
	iters: 500, epoch: 5 | loss: 0.2301306
	speed: 0.0038s/iter; left time: 21.7878s
	iters: 600, epoch: 5 | loss: 0.0987308
	speed: 0.0038s/iter; left time: 21.6225s
	iters: 700, epoch: 5 | loss: 0.3338770
	speed: 0.0037s/iter; left time: 20.6251s
	iters: 800, epoch: 5 | loss: 0.2021588
	speed: 0.0038s/iter; left time: 20.5395s
	iters: 900, epoch: 5 | loss: 0.2105150
	speed: 0.0038s/iter; left time: 20.2692s
	iters: 1000, epoch: 5 | loss: 0.2179838
	speed: 0.0038s/iter; left time: 20.0438s
Epoch: 5 cost time: 4.5098958015441895
Epoch: 5, Steps: 1036 | Train Loss: 0.2255621 Vali Loss: 0.3390690 Test Loss: 0.2966354
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1658931
	speed: 0.0422s/iter; left time: 214.4679s
	iters: 200, epoch: 6 | loss: 0.1964990
	speed: 0.0037s/iter; left time: 18.5332s
	iters: 300, epoch: 6 | loss: 0.2036092
	speed: 0.0038s/iter; left time: 18.3669s
	iters: 400, epoch: 6 | loss: 0.1506641
	speed: 0.0038s/iter; left time: 18.1782s
	iters: 500, epoch: 6 | loss: 0.1522947
	speed: 0.0038s/iter; left time: 17.7420s
	iters: 600, epoch: 6 | loss: 0.2112509
	speed: 0.0038s/iter; left time: 17.2574s
	iters: 700, epoch: 6 | loss: 0.1971742
	speed: 0.0038s/iter; left time: 17.0844s
	iters: 800, epoch: 6 | loss: 0.2888023
	speed: 0.0038s/iter; left time: 16.7983s
	iters: 900, epoch: 6 | loss: 0.1499790
	speed: 0.0042s/iter; left time: 17.8151s
	iters: 1000, epoch: 6 | loss: 0.1850932
	speed: 0.0038s/iter; left time: 15.9580s
Epoch: 6 cost time: 4.51642918586731
Epoch: 6, Steps: 1036 | Train Loss: 0.2242973 Vali Loss: 0.3305068 Test Loss: 0.3004850
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2107766
	speed: 0.0417s/iter; left time: 168.5720s
	iters: 200, epoch: 7 | loss: 0.1548345
	speed: 0.0038s/iter; left time: 14.9593s
	iters: 300, epoch: 7 | loss: 0.1962610
	speed: 0.0038s/iter; left time: 14.5122s
	iters: 400, epoch: 7 | loss: 0.2179609
	speed: 0.0037s/iter; left time: 14.0192s
	iters: 500, epoch: 7 | loss: 0.1516262
	speed: 0.0038s/iter; left time: 13.6832s
	iters: 600, epoch: 7 | loss: 0.2004091
	speed: 0.0038s/iter; left time: 13.4438s
	iters: 700, epoch: 7 | loss: 0.2184519
	speed: 0.0037s/iter; left time: 12.9166s
	iters: 800, epoch: 7 | loss: 0.2338656
	speed: 0.0037s/iter; left time: 12.5199s
	iters: 900, epoch: 7 | loss: 0.3555446
	speed: 0.0038s/iter; left time: 12.4502s
	iters: 1000, epoch: 7 | loss: 0.2246321
	speed: 0.0038s/iter; left time: 12.0523s
Epoch: 7 cost time: 4.507971286773682
Epoch: 7, Steps: 1036 | Train Loss: 0.2236064 Vali Loss: 0.3293422 Test Loss: 0.3001594
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_12_NLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2869
mse:0.3068946599960327, mae:0.3564489483833313
