Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_192_NLinear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4648793
	speed: 0.0100s/iter; left time: 100.3746s
	iters: 200, epoch: 1 | loss: 0.4822745
	speed: 0.0038s/iter; left time: 37.4916s
	iters: 300, epoch: 1 | loss: 0.5136769
	speed: 0.0038s/iter; left time: 37.0760s
	iters: 400, epoch: 1 | loss: 0.4177425
	speed: 0.0038s/iter; left time: 36.8039s
	iters: 500, epoch: 1 | loss: 0.3026123
	speed: 0.0038s/iter; left time: 36.8441s
	iters: 600, epoch: 1 | loss: 0.5324050
	speed: 0.0038s/iter; left time: 36.4995s
	iters: 700, epoch: 1 | loss: 0.4981992
	speed: 0.0040s/iter; left time: 37.5443s
	iters: 800, epoch: 1 | loss: 0.4590324
	speed: 0.0041s/iter; left time: 38.0837s
	iters: 900, epoch: 1 | loss: 0.4047756
	speed: 0.0046s/iter; left time: 42.7940s
	iters: 1000, epoch: 1 | loss: 0.4510950
	speed: 0.0042s/iter; left time: 38.3792s
Epoch: 1 cost time: 4.705502510070801
Epoch: 1, Steps: 1014 | Train Loss: 0.4418568 Vali Loss: 0.9855926 Test Loss: 0.4488960
Validation loss decreased (inf --> 0.985593).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4066654
	speed: 0.0390s/iter; left time: 351.7031s
	iters: 200, epoch: 2 | loss: 0.4137986
	speed: 0.0038s/iter; left time: 33.8028s
	iters: 300, epoch: 2 | loss: 0.4540804
	speed: 0.0038s/iter; left time: 33.4602s
	iters: 400, epoch: 2 | loss: 0.4743674
	speed: 0.0038s/iter; left time: 33.5186s
	iters: 500, epoch: 2 | loss: 0.2645555
	speed: 0.0039s/iter; left time: 33.6024s
	iters: 600, epoch: 2 | loss: 0.3379001
	speed: 0.0039s/iter; left time: 33.1832s
	iters: 700, epoch: 2 | loss: 0.3841101
	speed: 0.0039s/iter; left time: 33.1242s
	iters: 800, epoch: 2 | loss: 0.3228611
	speed: 0.0039s/iter; left time: 32.4144s
	iters: 900, epoch: 2 | loss: 0.4628008
	speed: 0.0039s/iter; left time: 32.1359s
	iters: 1000, epoch: 2 | loss: 0.3123307
	speed: 0.0038s/iter; left time: 31.1332s
Epoch: 2 cost time: 4.449077844619751
Epoch: 2, Steps: 1014 | Train Loss: 0.4175519 Vali Loss: 0.9750346 Test Loss: 0.4247640
Validation loss decreased (0.985593 --> 0.975035).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4405470
	speed: 0.0403s/iter; left time: 322.9105s
	iters: 200, epoch: 3 | loss: 0.4718866
	speed: 0.0038s/iter; left time: 30.0407s
	iters: 300, epoch: 3 | loss: 0.4068991
	speed: 0.0038s/iter; left time: 29.5004s
	iters: 400, epoch: 3 | loss: 0.4731173
	speed: 0.0039s/iter; left time: 29.8149s
	iters: 500, epoch: 3 | loss: 0.3277187
	speed: 0.0038s/iter; left time: 29.0141s
	iters: 600, epoch: 3 | loss: 0.4126985
	speed: 0.0038s/iter; left time: 28.7205s
	iters: 700, epoch: 3 | loss: 0.3932954
	speed: 0.0038s/iter; left time: 28.1795s
	iters: 800, epoch: 3 | loss: 0.5342153
	speed: 0.0038s/iter; left time: 27.6967s
	iters: 900, epoch: 3 | loss: 0.4553489
	speed: 0.0039s/iter; left time: 28.3821s
	iters: 1000, epoch: 3 | loss: 0.3197983
	speed: 0.0042s/iter; left time: 30.1868s
Epoch: 3 cost time: 4.441940069198608
Epoch: 3, Steps: 1014 | Train Loss: 0.4043300 Vali Loss: 0.9797378 Test Loss: 0.4186551
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4836450
	speed: 0.0405s/iter; left time: 283.2634s
	iters: 200, epoch: 4 | loss: 0.3709314
	speed: 0.0039s/iter; left time: 26.6245s
	iters: 300, epoch: 4 | loss: 0.3052048
	speed: 0.0039s/iter; left time: 26.2826s
	iters: 400, epoch: 4 | loss: 0.4362637
	speed: 0.0039s/iter; left time: 25.9213s
	iters: 500, epoch: 4 | loss: 0.4756144
	speed: 0.0039s/iter; left time: 25.5957s
	iters: 600, epoch: 4 | loss: 0.3950870
	speed: 0.0039s/iter; left time: 25.3600s
	iters: 700, epoch: 4 | loss: 0.3586852
	speed: 0.0039s/iter; left time: 24.8091s
	iters: 800, epoch: 4 | loss: 0.5037217
	speed: 0.0039s/iter; left time: 24.4355s
	iters: 900, epoch: 4 | loss: 0.3416717
	speed: 0.0039s/iter; left time: 24.0809s
	iters: 1000, epoch: 4 | loss: 0.3448585
	speed: 0.0038s/iter; left time: 23.4793s
Epoch: 4 cost time: 4.477242708206177
Epoch: 4, Steps: 1014 | Train Loss: 0.3982998 Vali Loss: 0.9243464 Test Loss: 0.4111247
Validation loss decreased (0.975035 --> 0.924346).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3708060
	speed: 0.0408s/iter; left time: 244.2556s
	iters: 200, epoch: 5 | loss: 0.4565863
	speed: 0.0040s/iter; left time: 23.4483s
	iters: 300, epoch: 5 | loss: 0.6248506
	speed: 0.0039s/iter; left time: 22.5212s
	iters: 400, epoch: 5 | loss: 0.4304862
	speed: 0.0039s/iter; left time: 22.0689s
	iters: 500, epoch: 5 | loss: 0.4004785
	speed: 0.0039s/iter; left time: 21.6726s
	iters: 600, epoch: 5 | loss: 0.3451706
	speed: 0.0039s/iter; left time: 21.2367s
	iters: 700, epoch: 5 | loss: 0.4810230
	speed: 0.0039s/iter; left time: 20.7955s
	iters: 800, epoch: 5 | loss: 0.3962348
	speed: 0.0039s/iter; left time: 20.4204s
	iters: 900, epoch: 5 | loss: 0.3181396
	speed: 0.0040s/iter; left time: 20.9386s
	iters: 1000, epoch: 5 | loss: 0.4004397
	speed: 0.0039s/iter; left time: 19.8371s
Epoch: 5 cost time: 4.549865245819092
Epoch: 5, Steps: 1014 | Train Loss: 0.3950359 Vali Loss: 0.9184867 Test Loss: 0.4091561
Validation loss decreased (0.924346 --> 0.918487).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4154919
	speed: 0.0406s/iter; left time: 201.6788s
	iters: 200, epoch: 6 | loss: 0.2830321
	speed: 0.0037s/iter; left time: 17.8483s
	iters: 300, epoch: 6 | loss: 0.2758016
	speed: 0.0037s/iter; left time: 17.6581s
	iters: 400, epoch: 6 | loss: 0.2774650
	speed: 0.0038s/iter; left time: 17.6184s
	iters: 500, epoch: 6 | loss: 0.5369796
	speed: 0.0037s/iter; left time: 16.9987s
	iters: 600, epoch: 6 | loss: 0.3340072
	speed: 0.0037s/iter; left time: 16.6496s
	iters: 700, epoch: 6 | loss: 0.4477740
	speed: 0.0038s/iter; left time: 16.5411s
	iters: 800, epoch: 6 | loss: 0.4409107
	speed: 0.0037s/iter; left time: 15.9905s
	iters: 900, epoch: 6 | loss: 0.4530025
	speed: 0.0039s/iter; left time: 16.2153s
	iters: 1000, epoch: 6 | loss: 0.4019298
	speed: 0.0037s/iter; left time: 15.2478s
Epoch: 6 cost time: 4.359189987182617
Epoch: 6, Steps: 1014 | Train Loss: 0.3933327 Vali Loss: 0.9197691 Test Loss: 0.4062255
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4790287
	speed: 0.0421s/iter; left time: 166.3973s
	iters: 200, epoch: 7 | loss: 0.3524849
	speed: 0.0038s/iter; left time: 14.7589s
	iters: 300, epoch: 7 | loss: 0.4419123
	speed: 0.0039s/iter; left time: 14.8070s
	iters: 400, epoch: 7 | loss: 0.5092813
	speed: 0.0037s/iter; left time: 13.5632s
	iters: 500, epoch: 7 | loss: 0.3417118
	speed: 0.0041s/iter; left time: 14.6613s
	iters: 600, epoch: 7 | loss: 0.3032404
	speed: 0.0040s/iter; left time: 13.9271s
	iters: 700, epoch: 7 | loss: 0.4841238
	speed: 0.0041s/iter; left time: 13.6480s
	iters: 800, epoch: 7 | loss: 0.3451028
	speed: 0.0039s/iter; left time: 12.8462s
	iters: 900, epoch: 7 | loss: 0.3406661
	speed: 0.0045s/iter; left time: 14.1338s
	iters: 1000, epoch: 7 | loss: 0.3981515
	speed: 0.0039s/iter; left time: 11.7802s
Epoch: 7 cost time: 4.601447343826294
Epoch: 7, Steps: 1014 | Train Loss: 0.3923510 Vali Loss: 0.9190305 Test Loss: 0.4065435
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4380463
	speed: 0.0410s/iter; left time: 120.5691s
	iters: 200, epoch: 8 | loss: 0.3254649
	speed: 0.0039s/iter; left time: 10.9841s
	iters: 300, epoch: 8 | loss: 0.4181196
	speed: 0.0039s/iter; left time: 10.7273s
	iters: 400, epoch: 8 | loss: 0.3994848
	speed: 0.0038s/iter; left time: 9.9879s
	iters: 500, epoch: 8 | loss: 0.2995396
	speed: 0.0041s/iter; left time: 10.5285s
	iters: 600, epoch: 8 | loss: 0.4154459
	speed: 0.0039s/iter; left time: 9.4513s
	iters: 700, epoch: 8 | loss: 0.5408597
	speed: 0.0039s/iter; left time: 9.0729s
	iters: 800, epoch: 8 | loss: 0.4470738
	speed: 0.0041s/iter; left time: 9.1164s
	iters: 900, epoch: 8 | loss: 0.2743162
	speed: 0.0038s/iter; left time: 8.1789s
	iters: 1000, epoch: 8 | loss: 0.3794459
	speed: 0.0038s/iter; left time: 7.7278s
Epoch: 8 cost time: 4.51918625831604
Epoch: 8, Steps: 1014 | Train Loss: 0.3918833 Vali Loss: 0.9191862 Test Loss: 0.4059241
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_192_NLinear_ETTh1_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:0.40889108180999756, mae:0.4157354235649109
