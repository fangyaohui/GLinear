Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='ETTh1_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_12_GRevagLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8293
val 2869
test 2869
	iters: 100, epoch: 1 | loss: 0.2871031
	speed: 0.0115s/iter; left time: 118.0769s
	iters: 200, epoch: 1 | loss: 0.2531568
	speed: 0.0054s/iter; left time: 54.5600s
	iters: 300, epoch: 1 | loss: 0.2801534
	speed: 0.0052s/iter; left time: 52.0852s
	iters: 400, epoch: 1 | loss: 0.3107679
	speed: 0.0054s/iter; left time: 53.4845s
	iters: 500, epoch: 1 | loss: 0.2002212
	speed: 0.0053s/iter; left time: 52.2623s
	iters: 600, epoch: 1 | loss: 0.3549918
	speed: 0.0052s/iter; left time: 50.5757s
	iters: 700, epoch: 1 | loss: 0.1891019
	speed: 0.0052s/iter; left time: 50.1900s
	iters: 800, epoch: 1 | loss: 0.2465408
	speed: 0.0051s/iter; left time: 49.1819s
	iters: 900, epoch: 1 | loss: 0.3153479
	speed: 0.0051s/iter; left time: 48.4218s
	iters: 1000, epoch: 1 | loss: 0.1843099
	speed: 0.0052s/iter; left time: 48.3990s
Epoch: 1 cost time: 6.120113849639893
Epoch: 1, Steps: 1036 | Train Loss: 0.2445552 Vali Loss: 0.3658973 Test Loss: 0.3123613
Validation loss decreased (inf --> 0.365897).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1664449
	speed: 0.0506s/iter; left time: 467.1879s
	iters: 200, epoch: 2 | loss: 0.2012193
	speed: 0.0054s/iter; left time: 49.2341s
	iters: 300, epoch: 2 | loss: 0.1215819
	speed: 0.0053s/iter; left time: 47.8028s
	iters: 400, epoch: 2 | loss: 0.2019170
	speed: 0.0054s/iter; left time: 47.8559s
	iters: 500, epoch: 2 | loss: 0.1903558
	speed: 0.0054s/iter; left time: 47.2911s
	iters: 600, epoch: 2 | loss: 0.2213193
	speed: 0.0054s/iter; left time: 47.2785s
	iters: 700, epoch: 2 | loss: 0.2090553
	speed: 0.0054s/iter; left time: 46.7779s
	iters: 800, epoch: 2 | loss: 0.1515669
	speed: 0.0055s/iter; left time: 46.5989s
	iters: 900, epoch: 2 | loss: 0.1351628
	speed: 0.0055s/iter; left time: 46.4823s
	iters: 1000, epoch: 2 | loss: 0.2211793
	speed: 0.0053s/iter; left time: 44.3386s
Epoch: 2 cost time: 6.278008699417114
Epoch: 2, Steps: 1036 | Train Loss: 0.2151049 Vali Loss: 0.3698549 Test Loss: 0.3022877
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1543147
	speed: 0.0502s/iter; left time: 411.0744s
	iters: 200, epoch: 3 | loss: 0.2516707
	speed: 0.0053s/iter; left time: 42.7493s
	iters: 300, epoch: 3 | loss: 0.1259129
	speed: 0.0053s/iter; left time: 41.9741s
	iters: 400, epoch: 3 | loss: 0.2342696
	speed: 0.0052s/iter; left time: 41.3585s
	iters: 500, epoch: 3 | loss: 0.1900922
	speed: 0.0054s/iter; left time: 41.9481s
	iters: 600, epoch: 3 | loss: 0.1987037
	speed: 0.0053s/iter; left time: 40.7539s
	iters: 700, epoch: 3 | loss: 0.1469256
	speed: 0.0051s/iter; left time: 39.0783s
	iters: 800, epoch: 3 | loss: 0.2344685
	speed: 0.0053s/iter; left time: 39.9004s
	iters: 900, epoch: 3 | loss: 0.2105768
	speed: 0.0054s/iter; left time: 39.9809s
	iters: 1000, epoch: 3 | loss: 0.1403808
	speed: 0.0053s/iter; left time: 38.6986s
Epoch: 3 cost time: 6.274372100830078
Epoch: 3, Steps: 1036 | Train Loss: 0.1894079 Vali Loss: 0.3567925 Test Loss: 0.2945853
Validation loss decreased (0.365897 --> 0.356793).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1434265
	speed: 0.0515s/iter; left time: 368.2399s
	iters: 200, epoch: 4 | loss: 0.2359297
	speed: 0.0055s/iter; left time: 39.1220s
	iters: 300, epoch: 4 | loss: 0.1539082
	speed: 0.0056s/iter; left time: 38.6160s
	iters: 400, epoch: 4 | loss: 0.2372930
	speed: 0.0055s/iter; left time: 37.5974s
	iters: 500, epoch: 4 | loss: 0.1599876
	speed: 0.0054s/iter; left time: 36.7053s
	iters: 600, epoch: 4 | loss: 0.1040121
	speed: 0.0055s/iter; left time: 36.4541s
	iters: 700, epoch: 4 | loss: 0.1246868
	speed: 0.0054s/iter; left time: 35.5865s
	iters: 800, epoch: 4 | loss: 0.1877988
	speed: 0.0056s/iter; left time: 35.9087s
	iters: 900, epoch: 4 | loss: 0.1559457
	speed: 0.0053s/iter; left time: 33.8022s
	iters: 1000, epoch: 4 | loss: 0.2506159
	speed: 0.0054s/iter; left time: 33.8468s
Epoch: 4 cost time: 6.379966497421265
Epoch: 4, Steps: 1036 | Train Loss: 0.1748803 Vali Loss: 0.3615863 Test Loss: 0.2896214
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1993421
	speed: 0.0507s/iter; left time: 310.0491s
	iters: 200, epoch: 5 | loss: 0.1617520
	speed: 0.0053s/iter; left time: 32.0440s
	iters: 300, epoch: 5 | loss: 0.1241934
	speed: 0.0053s/iter; left time: 31.5846s
	iters: 400, epoch: 5 | loss: 0.1257750
	speed: 0.0054s/iter; left time: 31.1806s
	iters: 500, epoch: 5 | loss: 0.2176413
	speed: 0.0055s/iter; left time: 31.2472s
	iters: 600, epoch: 5 | loss: 0.1537807
	speed: 0.0053s/iter; left time: 29.7107s
	iters: 700, epoch: 5 | loss: 0.1016337
	speed: 0.0053s/iter; left time: 29.3397s
	iters: 800, epoch: 5 | loss: 0.1184911
	speed: 0.0053s/iter; left time: 28.9036s
	iters: 900, epoch: 5 | loss: 0.0773131
	speed: 0.0053s/iter; left time: 28.0194s
	iters: 1000, epoch: 5 | loss: 0.1888665
	speed: 0.0053s/iter; left time: 27.6092s
Epoch: 5 cost time: 6.205270767211914
Epoch: 5, Steps: 1036 | Train Loss: 0.1664389 Vali Loss: 0.3513705 Test Loss: 0.2854992
Validation loss decreased (0.356793 --> 0.351370).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0937110
	speed: 0.0532s/iter; left time: 270.0740s
	iters: 200, epoch: 6 | loss: 0.2240807
	speed: 0.0054s/iter; left time: 27.1170s
	iters: 300, epoch: 6 | loss: 0.1346152
	speed: 0.0056s/iter; left time: 27.1324s
	iters: 400, epoch: 6 | loss: 0.2218854
	speed: 0.0054s/iter; left time: 25.9872s
	iters: 500, epoch: 6 | loss: 0.1841419
	speed: 0.0059s/iter; left time: 27.5768s
	iters: 600, epoch: 6 | loss: 0.0990928
	speed: 0.0055s/iter; left time: 25.0674s
	iters: 700, epoch: 6 | loss: 0.1401011
	speed: 0.0054s/iter; left time: 24.1398s
	iters: 800, epoch: 6 | loss: 0.1347673
	speed: 0.0055s/iter; left time: 24.2052s
	iters: 900, epoch: 6 | loss: 0.1386385
	speed: 0.0057s/iter; left time: 24.4689s
	iters: 1000, epoch: 6 | loss: 0.2160317
	speed: 0.0054s/iter; left time: 22.7330s
Epoch: 6 cost time: 6.51262092590332
Epoch: 6, Steps: 1036 | Train Loss: 0.1612650 Vali Loss: 0.3489759 Test Loss: 0.2857923
Validation loss decreased (0.351370 --> 0.348976).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2314128
	speed: 0.0506s/iter; left time: 204.5407s
	iters: 200, epoch: 7 | loss: 0.1914390
	speed: 0.0054s/iter; left time: 21.2639s
	iters: 300, epoch: 7 | loss: 0.1219707
	speed: 0.0054s/iter; left time: 20.6729s
	iters: 400, epoch: 7 | loss: 0.0862711
	speed: 0.0054s/iter; left time: 20.1871s
	iters: 500, epoch: 7 | loss: 0.1631353
	speed: 0.0054s/iter; left time: 19.7814s
	iters: 600, epoch: 7 | loss: 0.1113405
	speed: 0.0054s/iter; left time: 19.2598s
	iters: 700, epoch: 7 | loss: 0.2248341
	speed: 0.0054s/iter; left time: 18.7069s
	iters: 800, epoch: 7 | loss: 0.2407479
	speed: 0.0054s/iter; left time: 18.0399s
	iters: 900, epoch: 7 | loss: 0.1421540
	speed: 0.0054s/iter; left time: 17.5486s
	iters: 1000, epoch: 7 | loss: 0.2286662
	speed: 0.0054s/iter; left time: 16.9785s
Epoch: 7 cost time: 6.320173025131226
Epoch: 7, Steps: 1036 | Train Loss: 0.1585064 Vali Loss: 0.3488971 Test Loss: 0.2846659
Validation loss decreased (0.348976 --> 0.348897).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1328503
	speed: 0.0515s/iter; left time: 154.8755s
	iters: 200, epoch: 8 | loss: 0.1921588
	speed: 0.0053s/iter; left time: 15.4987s
	iters: 300, epoch: 8 | loss: 0.1054627
	speed: 0.0053s/iter; left time: 14.9257s
	iters: 400, epoch: 8 | loss: 0.1482652
	speed: 0.0054s/iter; left time: 14.5362s
	iters: 500, epoch: 8 | loss: 0.1461421
	speed: 0.0053s/iter; left time: 13.8175s
	iters: 600, epoch: 8 | loss: 0.2194425
	speed: 0.0053s/iter; left time: 13.3496s
	iters: 700, epoch: 8 | loss: 0.1034254
	speed: 0.0054s/iter; left time: 13.0055s
	iters: 800, epoch: 8 | loss: 0.1436897
	speed: 0.0053s/iter; left time: 12.3150s
	iters: 900, epoch: 8 | loss: 0.1671236
	speed: 0.0057s/iter; left time: 12.5087s
	iters: 1000, epoch: 8 | loss: 0.1574577
	speed: 0.0054s/iter; left time: 11.3251s
Epoch: 8 cost time: 6.268165111541748
Epoch: 8, Steps: 1036 | Train Loss: 0.1572221 Vali Loss: 0.3504688 Test Loss: 0.2850940
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1895860
	speed: 0.0512s/iter; left time: 101.0568s
	iters: 200, epoch: 9 | loss: 0.1053677
	speed: 0.0052s/iter; left time: 9.7173s
	iters: 300, epoch: 9 | loss: 0.0844821
	speed: 0.0051s/iter; left time: 9.1249s
	iters: 400, epoch: 9 | loss: 0.1893485
	speed: 0.0052s/iter; left time: 8.6992s
	iters: 500, epoch: 9 | loss: 0.2020539
	speed: 0.0058s/iter; left time: 9.0821s
	iters: 600, epoch: 9 | loss: 0.1712020
	speed: 0.0054s/iter; left time: 8.0268s
	iters: 700, epoch: 9 | loss: 0.1348589
	speed: 0.0054s/iter; left time: 7.4686s
	iters: 800, epoch: 9 | loss: 0.2383869
	speed: 0.0057s/iter; left time: 7.2004s
	iters: 900, epoch: 9 | loss: 0.1386096
	speed: 0.0060s/iter; left time: 7.0342s
	iters: 1000, epoch: 9 | loss: 0.1355689
	speed: 0.0056s/iter; left time: 5.9734s
Epoch: 9 cost time: 6.3892669677734375
Epoch: 9, Steps: 1036 | Train Loss: 0.1565293 Vali Loss: 0.3501539 Test Loss: 0.2837238
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1695809
	speed: 0.0504s/iter; left time: 47.1947s
	iters: 200, epoch: 10 | loss: 0.1099132
	speed: 0.0053s/iter; left time: 4.4695s
	iters: 300, epoch: 10 | loss: 0.1856366
	speed: 0.0054s/iter; left time: 4.0071s
	iters: 400, epoch: 10 | loss: 0.1390073
	speed: 0.0054s/iter; left time: 3.4354s
	iters: 500, epoch: 10 | loss: 0.1038353
	speed: 0.0054s/iter; left time: 2.8847s
	iters: 600, epoch: 10 | loss: 0.1586345
	speed: 0.0053s/iter; left time: 2.2987s
	iters: 700, epoch: 10 | loss: 0.1448974
	speed: 0.0055s/iter; left time: 1.8389s
	iters: 800, epoch: 10 | loss: 0.0672504
	speed: 0.0053s/iter; left time: 1.2667s
	iters: 900, epoch: 10 | loss: 0.1482217
	speed: 0.0056s/iter; left time: 0.7669s
	iters: 1000, epoch: 10 | loss: 0.1397566
	speed: 0.0053s/iter; left time: 0.1969s
Epoch: 10 cost time: 6.256942987442017
Epoch: 10, Steps: 1036 | Train Loss: 0.1561359 Vali Loss: 0.3501136 Test Loss: 0.2843950
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_12_GRevagLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2869
mse:0.2848484218120575, mae:0.34480127692222595
