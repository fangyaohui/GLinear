Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='traffic_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_24_GRevagLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11921
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.2707462
	speed: 0.0285s/iter; left time: 209.2792s
	iters: 200, epoch: 1 | loss: 0.1995712
	speed: 0.0202s/iter; left time: 146.7757s
	iters: 300, epoch: 1 | loss: 0.2425341
	speed: 0.0200s/iter; left time: 143.1490s
	iters: 400, epoch: 1 | loss: 0.2458771
	speed: 0.0200s/iter; left time: 140.8515s
	iters: 500, epoch: 1 | loss: 0.1987058
	speed: 0.0209s/iter; left time: 144.9335s
	iters: 600, epoch: 1 | loss: 0.2589728
	speed: 0.0208s/iter; left time: 142.8103s
	iters: 700, epoch: 1 | loss: 0.2167511
	speed: 0.0209s/iter; left time: 141.3524s
Epoch: 1 cost time: 16.152698755264282
Epoch: 1, Steps: 745 | Train Loss: 0.2418085 Vali Loss: 0.3166607 Test Loss: 0.3564069
Validation loss decreased (inf --> 0.316661).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2416292
	speed: 0.1190s/iter; left time: 786.0185s
	iters: 200, epoch: 2 | loss: 0.2259979
	speed: 0.0202s/iter; left time: 131.1913s
	iters: 300, epoch: 2 | loss: 0.2233279
	speed: 0.0208s/iter; left time: 133.1850s
	iters: 400, epoch: 2 | loss: 0.2639727
	speed: 0.0209s/iter; left time: 131.6472s
	iters: 500, epoch: 2 | loss: 0.2260191
	speed: 0.0208s/iter; left time: 128.9397s
	iters: 600, epoch: 2 | loss: 0.2046516
	speed: 0.0208s/iter; left time: 126.7148s
	iters: 700, epoch: 2 | loss: 0.1980914
	speed: 0.0203s/iter; left time: 122.0954s
Epoch: 2 cost time: 16.19188165664673
Epoch: 2, Steps: 745 | Train Loss: 0.2198448 Vali Loss: 0.3136689 Test Loss: 0.3483733
Validation loss decreased (0.316661 --> 0.313669).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1928873
	speed: 0.1210s/iter; left time: 709.3387s
	iters: 200, epoch: 3 | loss: 0.1939984
	speed: 0.0203s/iter; left time: 116.8941s
	iters: 300, epoch: 3 | loss: 0.2558592
	speed: 0.0205s/iter; left time: 116.1999s
	iters: 400, epoch: 3 | loss: 0.2319664
	speed: 0.0200s/iter; left time: 111.3241s
	iters: 500, epoch: 3 | loss: 0.2774215
	speed: 0.0206s/iter; left time: 112.5623s
	iters: 600, epoch: 3 | loss: 0.2188003
	speed: 0.0209s/iter; left time: 112.2077s
	iters: 700, epoch: 3 | loss: 0.1770918
	speed: 0.0213s/iter; left time: 112.2702s
Epoch: 3 cost time: 16.21448802947998
Epoch: 3, Steps: 745 | Train Loss: 0.2122800 Vali Loss: 0.3127831 Test Loss: 0.3459764
Validation loss decreased (0.313669 --> 0.312783).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2272379
	speed: 0.1220s/iter; left time: 624.0955s
	iters: 200, epoch: 4 | loss: 0.2041342
	speed: 0.0210s/iter; left time: 105.3578s
	iters: 300, epoch: 4 | loss: 0.2033535
	speed: 0.0215s/iter; left time: 105.7197s
	iters: 400, epoch: 4 | loss: 0.2258707
	speed: 0.0212s/iter; left time: 102.0762s
	iters: 500, epoch: 4 | loss: 0.2280885
	speed: 0.0209s/iter; left time: 98.5275s
	iters: 600, epoch: 4 | loss: 0.1935404
	speed: 0.0209s/iter; left time: 96.5379s
	iters: 700, epoch: 4 | loss: 0.2058800
	speed: 0.0211s/iter; left time: 95.0878s
Epoch: 4 cost time: 16.68240976333618
Epoch: 4, Steps: 745 | Train Loss: 0.2090987 Vali Loss: 0.3081352 Test Loss: 0.3400481
Validation loss decreased (0.312783 --> 0.308135).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1785663
	speed: 0.1224s/iter; left time: 534.9062s
	iters: 200, epoch: 5 | loss: 0.2095869
	speed: 0.0208s/iter; left time: 88.9488s
	iters: 300, epoch: 5 | loss: 0.1898209
	speed: 0.0200s/iter; left time: 83.5792s
	iters: 400, epoch: 5 | loss: 0.1676507
	speed: 0.0206s/iter; left time: 83.8832s
	iters: 500, epoch: 5 | loss: 0.1945157
	speed: 0.0200s/iter; left time: 79.4771s
	iters: 600, epoch: 5 | loss: 0.1728710
	speed: 0.0206s/iter; left time: 79.9116s
	iters: 700, epoch: 5 | loss: 0.1758625
	speed: 0.0203s/iter; left time: 76.5589s
Epoch: 5 cost time: 16.161028623580933
Epoch: 5, Steps: 745 | Train Loss: 0.2074341 Vali Loss: 0.3074070 Test Loss: 0.3390128
Validation loss decreased (0.308135 --> 0.307407).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1850757
	speed: 0.1215s/iter; left time: 440.4447s
	iters: 200, epoch: 6 | loss: 0.2423702
	speed: 0.0200s/iter; left time: 70.3543s
	iters: 300, epoch: 6 | loss: 0.2390128
	speed: 0.0199s/iter; left time: 68.2528s
	iters: 400, epoch: 6 | loss: 0.2058079
	speed: 0.0209s/iter; left time: 69.5611s
	iters: 500, epoch: 6 | loss: 0.1682151
	speed: 0.0202s/iter; left time: 65.0880s
	iters: 600, epoch: 6 | loss: 0.1911386
	speed: 0.0201s/iter; left time: 62.8381s
	iters: 700, epoch: 6 | loss: 0.2020889
	speed: 0.0205s/iter; left time: 62.1816s
Epoch: 6 cost time: 15.99947476387024
Epoch: 6, Steps: 745 | Train Loss: 0.2064722 Vali Loss: 0.3066372 Test Loss: 0.3378518
Validation loss decreased (0.307407 --> 0.306637).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2370779
	speed: 0.1202s/iter; left time: 346.1593s
	iters: 200, epoch: 7 | loss: 0.2082130
	speed: 0.0203s/iter; left time: 56.4245s
	iters: 300, epoch: 7 | loss: 0.2009746
	speed: 0.0207s/iter; left time: 55.4221s
	iters: 400, epoch: 7 | loss: 0.1827470
	speed: 0.0208s/iter; left time: 53.6141s
	iters: 500, epoch: 7 | loss: 0.1999933
	speed: 0.0211s/iter; left time: 52.4293s
	iters: 600, epoch: 7 | loss: 0.2725997
	speed: 0.0214s/iter; left time: 50.9597s
	iters: 700, epoch: 7 | loss: 0.2281589
	speed: 0.0220s/iter; left time: 50.1390s
Epoch: 7 cost time: 16.46885919570923
Epoch: 7, Steps: 745 | Train Loss: 0.2060095 Vali Loss: 0.3065657 Test Loss: 0.3370762
Validation loss decreased (0.306637 --> 0.306566).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1848163
	speed: 0.1229s/iter; left time: 262.4802s
	iters: 200, epoch: 8 | loss: 0.2068710
	speed: 0.0205s/iter; left time: 41.8382s
	iters: 300, epoch: 8 | loss: 0.1802211
	speed: 0.0200s/iter; left time: 38.6810s
	iters: 400, epoch: 8 | loss: 0.1990184
	speed: 0.0198s/iter; left time: 36.4286s
	iters: 500, epoch: 8 | loss: 0.1854466
	speed: 0.0202s/iter; left time: 35.1422s
	iters: 600, epoch: 8 | loss: 0.2099554
	speed: 0.0205s/iter; left time: 33.5153s
	iters: 700, epoch: 8 | loss: 0.2131324
	speed: 0.0203s/iter; left time: 31.1737s
Epoch: 8 cost time: 16.030893802642822
Epoch: 8, Steps: 745 | Train Loss: 0.2057288 Vali Loss: 0.3062923 Test Loss: 0.3367263
Validation loss decreased (0.306566 --> 0.306292).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1898638
	speed: 0.1232s/iter; left time: 171.4306s
	iters: 200, epoch: 9 | loss: 0.1627521
	speed: 0.0204s/iter; left time: 26.3967s
	iters: 300, epoch: 9 | loss: 0.2345404
	speed: 0.0209s/iter; left time: 24.8539s
	iters: 400, epoch: 9 | loss: 0.2493513
	speed: 0.0201s/iter; left time: 21.8899s
	iters: 500, epoch: 9 | loss: 0.2076574
	speed: 0.0214s/iter; left time: 21.2559s
	iters: 600, epoch: 9 | loss: 0.3264003
	speed: 0.0206s/iter; left time: 18.3360s
	iters: 700, epoch: 9 | loss: 0.1978852
	speed: 0.0204s/iter; left time: 16.1057s
Epoch: 9 cost time: 16.275641679763794
Epoch: 9, Steps: 745 | Train Loss: 0.2056064 Vali Loss: 0.3062741 Test Loss: 0.3367888
Validation loss decreased (0.306292 --> 0.306274).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1863868
	speed: 0.1235s/iter; left time: 79.7518s
	iters: 200, epoch: 10 | loss: 0.1902671
	speed: 0.0211s/iter; left time: 11.5307s
	iters: 300, epoch: 10 | loss: 0.1610510
	speed: 0.0206s/iter; left time: 9.1663s
	iters: 400, epoch: 10 | loss: 0.2169681
	speed: 0.0212s/iter; left time: 7.3494s
	iters: 500, epoch: 10 | loss: 0.2089795
	speed: 0.0212s/iter; left time: 5.2185s
	iters: 600, epoch: 10 | loss: 0.1629322
	speed: 0.0214s/iter; left time: 3.1240s
	iters: 700, epoch: 10 | loss: 0.2345440
	speed: 0.0212s/iter; left time: 0.9731s
Epoch: 10 cost time: 16.54927158355713
Epoch: 10, Steps: 745 | Train Loss: 0.2055174 Vali Loss: 0.3063123 Test Loss: 0.3367143
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_24_GRevagLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.336933970451355, mae:0.24710354208946228
