Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_336_GLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4373077
	speed: 0.0118s/iter; left time: 264.8224s
	iters: 200, epoch: 1 | loss: 0.6491770
	speed: 0.0055s/iter; left time: 122.5308s
	iters: 300, epoch: 1 | loss: 0.3548985
	speed: 0.0055s/iter; left time: 121.7132s
	iters: 400, epoch: 1 | loss: 0.4312974
	speed: 0.0053s/iter; left time: 117.7265s
	iters: 500, epoch: 1 | loss: 0.4919839
	speed: 0.0054s/iter; left time: 119.6500s
	iters: 600, epoch: 1 | loss: 0.3541629
	speed: 0.0053s/iter; left time: 117.1768s
	iters: 700, epoch: 1 | loss: 0.3902032
	speed: 0.0054s/iter; left time: 118.8659s
	iters: 800, epoch: 1 | loss: 0.4999161
	speed: 0.0053s/iter; left time: 114.6806s
	iters: 900, epoch: 1 | loss: 0.9379375
	speed: 0.0051s/iter; left time: 111.3692s
	iters: 1000, epoch: 1 | loss: 0.3303137
	speed: 0.0052s/iter; left time: 112.4701s
	iters: 1100, epoch: 1 | loss: 0.6613190
	speed: 0.0064s/iter; left time: 138.1484s
	iters: 1200, epoch: 1 | loss: 0.4730335
	speed: 0.0051s/iter; left time: 108.9859s
	iters: 1300, epoch: 1 | loss: 0.4903740
	speed: 0.0053s/iter; left time: 112.8576s
	iters: 1400, epoch: 1 | loss: 0.3985600
	speed: 0.0050s/iter; left time: 106.4546s
	iters: 1500, epoch: 1 | loss: 0.4701271
	speed: 0.0050s/iter; left time: 105.2801s
	iters: 1600, epoch: 1 | loss: 0.5706112
	speed: 0.0050s/iter; left time: 106.0399s
	iters: 1700, epoch: 1 | loss: 1.5028886
	speed: 0.0052s/iter; left time: 108.3475s
	iters: 1800, epoch: 1 | loss: 0.5528170
	speed: 0.0055s/iter; left time: 114.9453s
	iters: 1900, epoch: 1 | loss: 0.8972418
	speed: 0.0051s/iter; left time: 106.7561s
	iters: 2000, epoch: 1 | loss: 0.5733699
	speed: 0.0051s/iter; left time: 105.6822s
	iters: 2100, epoch: 1 | loss: 0.5416168
	speed: 0.0053s/iter; left time: 108.1053s
	iters: 2200, epoch: 1 | loss: 0.8950516
	speed: 0.0050s/iter; left time: 102.7875s
Epoch: 1 cost time: 12.696284294128418
Epoch: 1, Steps: 2263 | Train Loss: 0.5480836 Vali Loss: 0.5339360 Test Loss: 0.2555393
Validation loss decreased (inf --> 0.533936).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.0005074
	speed: 0.0693s/iter; left time: 1405.5324s
	iters: 200, epoch: 2 | loss: 0.3548253
	speed: 0.0051s/iter; left time: 102.7407s
	iters: 300, epoch: 2 | loss: 0.8965562
	speed: 0.0050s/iter; left time: 99.8688s
	iters: 400, epoch: 2 | loss: 0.3971681
	speed: 0.0050s/iter; left time: 99.5071s
	iters: 500, epoch: 2 | loss: 0.9961838
	speed: 0.0051s/iter; left time: 101.1980s
	iters: 600, epoch: 2 | loss: 0.3644883
	speed: 0.0054s/iter; left time: 107.3092s
	iters: 700, epoch: 2 | loss: 0.4860803
	speed: 0.0052s/iter; left time: 101.4356s
	iters: 800, epoch: 2 | loss: 0.4438344
	speed: 0.0051s/iter; left time: 98.9310s
	iters: 900, epoch: 2 | loss: 0.3481771
	speed: 0.0052s/iter; left time: 101.9819s
	iters: 1000, epoch: 2 | loss: 0.3470256
	speed: 0.0051s/iter; left time: 98.9392s
	iters: 1100, epoch: 2 | loss: 0.4063874
	speed: 0.0052s/iter; left time: 99.8780s
	iters: 1200, epoch: 2 | loss: 0.5657336
	speed: 0.0050s/iter; left time: 96.6605s
	iters: 1300, epoch: 2 | loss: 0.3988108
	speed: 0.0054s/iter; left time: 103.2687s
	iters: 1400, epoch: 2 | loss: 0.3612270
	speed: 0.0054s/iter; left time: 102.4824s
	iters: 1500, epoch: 2 | loss: 1.1156921
	speed: 0.0052s/iter; left time: 98.2200s
	iters: 1600, epoch: 2 | loss: 0.3885030
	speed: 0.0052s/iter; left time: 98.3823s
	iters: 1700, epoch: 2 | loss: 0.3984484
	speed: 0.0050s/iter; left time: 93.7027s
	iters: 1800, epoch: 2 | loss: 0.3993842
	speed: 0.0055s/iter; left time: 102.9219s
	iters: 1900, epoch: 2 | loss: 0.3799520
	speed: 0.0056s/iter; left time: 102.5972s
	iters: 2000, epoch: 2 | loss: 0.4113295
	speed: 0.0053s/iter; left time: 97.4051s
	iters: 2100, epoch: 2 | loss: 0.3209784
	speed: 0.0055s/iter; left time: 100.6200s
	iters: 2200, epoch: 2 | loss: 0.4909955
	speed: 0.0052s/iter; left time: 95.0062s
Epoch: 2 cost time: 12.542183637619019
Epoch: 2, Steps: 2263 | Train Loss: 0.5266232 Vali Loss: 0.5268376 Test Loss: 0.2547321
Validation loss decreased (0.533936 --> 0.526838).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5098464
	speed: 0.0696s/iter; left time: 1253.4163s
	iters: 200, epoch: 3 | loss: 0.5526399
	speed: 0.0056s/iter; left time: 99.3935s
	iters: 300, epoch: 3 | loss: 0.3380502
	speed: 0.0056s/iter; left time: 100.1704s
	iters: 400, epoch: 3 | loss: 0.3254235
	speed: 0.0054s/iter; left time: 95.5807s
	iters: 500, epoch: 3 | loss: 0.4384712
	speed: 0.0054s/iter; left time: 95.7876s
	iters: 600, epoch: 3 | loss: 0.4461096
	speed: 0.0052s/iter; left time: 90.7349s
	iters: 700, epoch: 3 | loss: 0.4904828
	speed: 0.0052s/iter; left time: 89.6938s
	iters: 800, epoch: 3 | loss: 0.4440354
	speed: 0.0052s/iter; left time: 90.0679s
	iters: 900, epoch: 3 | loss: 1.0207323
	speed: 0.0056s/iter; left time: 97.1919s
	iters: 1000, epoch: 3 | loss: 0.4378452
	speed: 0.0053s/iter; left time: 91.0372s
	iters: 1100, epoch: 3 | loss: 0.3184493
	speed: 0.0053s/iter; left time: 90.4574s
	iters: 1200, epoch: 3 | loss: 0.3646772
	speed: 0.0054s/iter; left time: 91.5600s
	iters: 1300, epoch: 3 | loss: 0.3517686
	speed: 0.0055s/iter; left time: 92.0695s
	iters: 1400, epoch: 3 | loss: 0.8696388
	speed: 0.0055s/iter; left time: 92.1710s
	iters: 1500, epoch: 3 | loss: 0.4047575
	speed: 0.0056s/iter; left time: 93.4598s
	iters: 1600, epoch: 3 | loss: 0.3952388
	speed: 0.0056s/iter; left time: 92.3625s
	iters: 1700, epoch: 3 | loss: 0.3687094
	speed: 0.0055s/iter; left time: 89.9243s
	iters: 1800, epoch: 3 | loss: 0.4435998
	speed: 0.0053s/iter; left time: 86.0168s
	iters: 1900, epoch: 3 | loss: 0.3819363
	speed: 0.0056s/iter; left time: 91.5580s
	iters: 2000, epoch: 3 | loss: 0.4699514
	speed: 0.0060s/iter; left time: 96.9871s
	iters: 2100, epoch: 3 | loss: 0.3102062
	speed: 0.0056s/iter; left time: 90.0927s
	iters: 2200, epoch: 3 | loss: 0.3899929
	speed: 0.0060s/iter; left time: 94.8595s
Epoch: 3 cost time: 13.119715929031372
Epoch: 3, Steps: 2263 | Train Loss: 0.5118683 Vali Loss: 0.5067673 Test Loss: 0.2525598
Validation loss decreased (0.526838 --> 0.506767).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3388824
	speed: 0.0716s/iter; left time: 1127.5735s
	iters: 200, epoch: 4 | loss: 1.3871769
	speed: 0.0054s/iter; left time: 84.0455s
	iters: 300, epoch: 4 | loss: 0.4054116
	speed: 0.0051s/iter; left time: 79.4556s
	iters: 400, epoch: 4 | loss: 0.4513393
	speed: 0.0053s/iter; left time: 81.0995s
	iters: 500, epoch: 4 | loss: 0.3523057
	speed: 0.0053s/iter; left time: 81.4800s
	iters: 600, epoch: 4 | loss: 1.1362412
	speed: 0.0054s/iter; left time: 82.1091s
	iters: 700, epoch: 4 | loss: 0.3617950
	speed: 0.0056s/iter; left time: 84.0940s
	iters: 800, epoch: 4 | loss: 0.4014450
	speed: 0.0054s/iter; left time: 81.7490s
	iters: 900, epoch: 4 | loss: 0.4307695
	speed: 0.0053s/iter; left time: 79.2658s
	iters: 1000, epoch: 4 | loss: 0.2830146
	speed: 0.0056s/iter; left time: 82.4264s
	iters: 1100, epoch: 4 | loss: 1.0813046
	speed: 0.0063s/iter; left time: 93.0449s
	iters: 1200, epoch: 4 | loss: 0.3903209
	speed: 0.0059s/iter; left time: 86.4525s
	iters: 1300, epoch: 4 | loss: 0.3487866
	speed: 0.0054s/iter; left time: 77.8739s
	iters: 1400, epoch: 4 | loss: 0.4845849
	speed: 0.0055s/iter; left time: 80.0696s
	iters: 1500, epoch: 4 | loss: 1.0784352
	speed: 0.0053s/iter; left time: 75.3933s
	iters: 1600, epoch: 4 | loss: 0.3826697
	speed: 0.0051s/iter; left time: 72.3762s
	iters: 1700, epoch: 4 | loss: 0.4819499
	speed: 0.0054s/iter; left time: 76.6453s
	iters: 1800, epoch: 4 | loss: 0.4008986
	speed: 0.0056s/iter; left time: 79.1754s
	iters: 1900, epoch: 4 | loss: 0.5081863
	speed: 0.0054s/iter; left time: 75.9552s
	iters: 2000, epoch: 4 | loss: 0.3253782
	speed: 0.0055s/iter; left time: 75.9241s
	iters: 2100, epoch: 4 | loss: 0.3797077
	speed: 0.0055s/iter; left time: 75.7777s
	iters: 2200, epoch: 4 | loss: 0.3844918
	speed: 0.0051s/iter; left time: 69.2382s
Epoch: 4 cost time: 13.033008098602295
Epoch: 4, Steps: 2263 | Train Loss: 0.5043510 Vali Loss: 0.5111066 Test Loss: 0.2538764
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5315230
	speed: 0.0699s/iter; left time: 942.6930s
	iters: 200, epoch: 5 | loss: 0.4904273
	speed: 0.0051s/iter; left time: 68.3905s
	iters: 300, epoch: 5 | loss: 0.3072931
	speed: 0.0053s/iter; left time: 70.5089s
	iters: 400, epoch: 5 | loss: 0.3997534
	speed: 0.0056s/iter; left time: 73.9553s
	iters: 500, epoch: 5 | loss: 0.5636427
	speed: 0.0055s/iter; left time: 71.3936s
	iters: 600, epoch: 5 | loss: 0.4971668
	speed: 0.0053s/iter; left time: 68.4501s
	iters: 700, epoch: 5 | loss: 0.4702459
	speed: 0.0053s/iter; left time: 68.0230s
	iters: 800, epoch: 5 | loss: 0.3246535
	speed: 0.0053s/iter; left time: 67.4670s
	iters: 900, epoch: 5 | loss: 0.9330014
	speed: 0.0055s/iter; left time: 69.8409s
	iters: 1000, epoch: 5 | loss: 0.5535389
	speed: 0.0054s/iter; left time: 67.3791s
	iters: 1100, epoch: 5 | loss: 0.3575678
	speed: 0.0054s/iter; left time: 67.2015s
	iters: 1200, epoch: 5 | loss: 0.3487787
	speed: 0.0053s/iter; left time: 65.3843s
	iters: 1300, epoch: 5 | loss: 0.9189903
	speed: 0.0053s/iter; left time: 65.3286s
	iters: 1400, epoch: 5 | loss: 0.2741577
	speed: 0.0049s/iter; left time: 60.2173s
	iters: 1500, epoch: 5 | loss: 0.5232429
	speed: 0.0052s/iter; left time: 62.7590s
	iters: 1600, epoch: 5 | loss: 0.2994941
	speed: 0.0052s/iter; left time: 61.7799s
	iters: 1700, epoch: 5 | loss: 0.4430186
	speed: 0.0050s/iter; left time: 59.2023s
	iters: 1800, epoch: 5 | loss: 0.4065419
	speed: 0.0051s/iter; left time: 60.2954s
	iters: 1900, epoch: 5 | loss: 0.4907553
	speed: 0.0051s/iter; left time: 59.5839s
	iters: 2000, epoch: 5 | loss: 0.4674209
	speed: 0.0052s/iter; left time: 59.8050s
	iters: 2100, epoch: 5 | loss: 0.4119792
	speed: 0.0050s/iter; left time: 57.0477s
	iters: 2200, epoch: 5 | loss: 1.0137064
	speed: 0.0049s/iter; left time: 55.4998s
Epoch: 5 cost time: 12.505908966064453
Epoch: 5, Steps: 2263 | Train Loss: 0.5000006 Vali Loss: 0.5082564 Test Loss: 0.2508906
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4626565
	speed: 0.0697s/iter; left time: 781.7813s
	iters: 200, epoch: 6 | loss: 0.5272523
	speed: 0.0052s/iter; left time: 57.3415s
	iters: 300, epoch: 6 | loss: 0.3234063
	speed: 0.0054s/iter; left time: 59.1700s
	iters: 400, epoch: 6 | loss: 0.9654563
	speed: 0.0055s/iter; left time: 59.7458s
	iters: 500, epoch: 6 | loss: 0.3655967
	speed: 0.0053s/iter; left time: 57.0937s
	iters: 600, epoch: 6 | loss: 0.5771269
	speed: 0.0051s/iter; left time: 55.1496s
	iters: 700, epoch: 6 | loss: 1.0939156
	speed: 0.0053s/iter; left time: 56.1377s
	iters: 800, epoch: 6 | loss: 0.4027583
	speed: 0.0051s/iter; left time: 53.2853s
	iters: 900, epoch: 6 | loss: 0.3902983
	speed: 0.0053s/iter; left time: 54.7385s
	iters: 1000, epoch: 6 | loss: 0.3634529
	speed: 0.0055s/iter; left time: 56.3380s
	iters: 1100, epoch: 6 | loss: 0.3460309
	speed: 0.0061s/iter; left time: 61.8299s
	iters: 1200, epoch: 6 | loss: 0.9139860
	speed: 0.0054s/iter; left time: 54.6197s
	iters: 1300, epoch: 6 | loss: 0.3444063
	speed: 0.0053s/iter; left time: 52.9618s
	iters: 1400, epoch: 6 | loss: 0.2886741
	speed: 0.0052s/iter; left time: 51.9474s
	iters: 1500, epoch: 6 | loss: 0.3912104
	speed: 0.0053s/iter; left time: 51.8389s
	iters: 1600, epoch: 6 | loss: 0.3247417
	speed: 0.0056s/iter; left time: 53.9277s
	iters: 1700, epoch: 6 | loss: 0.3114639
	speed: 0.0057s/iter; left time: 54.7037s
	iters: 1800, epoch: 6 | loss: 0.4497226
	speed: 0.0053s/iter; left time: 49.9886s
	iters: 1900, epoch: 6 | loss: 0.3660462
	speed: 0.0050s/iter; left time: 47.5246s
	iters: 2000, epoch: 6 | loss: 0.5153633
	speed: 0.0051s/iter; left time: 47.5025s
	iters: 2100, epoch: 6 | loss: 0.4269328
	speed: 0.0051s/iter; left time: 47.4069s
	iters: 2200, epoch: 6 | loss: 0.4915808
	speed: 0.0052s/iter; left time: 47.4007s
Epoch: 6 cost time: 12.77221941947937
Epoch: 6, Steps: 2263 | Train Loss: 0.4976245 Vali Loss: 0.5149416 Test Loss: 0.2494633
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_336_GLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.25261273980140686, mae:0.30502021312713623
