Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8371086
	speed: 0.0121s/iter; left time: 270.0283s
	iters: 200, epoch: 1 | loss: 0.7535411
	speed: 0.0055s/iter; left time: 120.9472s
	iters: 300, epoch: 1 | loss: 0.5494505
	speed: 0.0055s/iter; left time: 121.8146s
	iters: 400, epoch: 1 | loss: 0.6944185
	speed: 0.0057s/iter; left time: 125.6910s
	iters: 500, epoch: 1 | loss: 0.6448099
	speed: 0.0057s/iter; left time: 123.9367s
	iters: 600, epoch: 1 | loss: 0.6037025
	speed: 0.0055s/iter; left time: 120.0970s
	iters: 700, epoch: 1 | loss: 0.4579341
	speed: 0.0054s/iter; left time: 116.1905s
	iters: 800, epoch: 1 | loss: 0.5706046
	speed: 0.0054s/iter; left time: 115.6909s
	iters: 900, epoch: 1 | loss: 0.4272800
	speed: 0.0054s/iter; left time: 115.0127s
	iters: 1000, epoch: 1 | loss: 0.7335575
	speed: 0.0054s/iter; left time: 116.5190s
	iters: 1100, epoch: 1 | loss: 1.0394621
	speed: 0.0057s/iter; left time: 120.9897s
	iters: 1200, epoch: 1 | loss: 0.4661607
	speed: 0.0055s/iter; left time: 117.0083s
	iters: 1300, epoch: 1 | loss: 0.4332490
	speed: 0.0057s/iter; left time: 120.1658s
	iters: 1400, epoch: 1 | loss: 0.4911867
	speed: 0.0056s/iter; left time: 116.6358s
	iters: 1500, epoch: 1 | loss: 0.6677693
	speed: 0.0055s/iter; left time: 114.2159s
	iters: 1600, epoch: 1 | loss: 1.2263387
	speed: 0.0054s/iter; left time: 112.9264s
	iters: 1700, epoch: 1 | loss: 0.6533598
	speed: 0.0054s/iter; left time: 112.6735s
	iters: 1800, epoch: 1 | loss: 0.3979628
	speed: 0.0055s/iter; left time: 113.1889s
	iters: 1900, epoch: 1 | loss: 0.7071579
	speed: 0.0055s/iter; left time: 112.6934s
	iters: 2000, epoch: 1 | loss: 0.6942418
	speed: 0.0054s/iter; left time: 110.8318s
	iters: 2100, epoch: 1 | loss: 0.5648330
	speed: 0.0054s/iter; left time: 109.0605s
	iters: 2200, epoch: 1 | loss: 0.5236751
	speed: 0.0055s/iter; left time: 111.6370s
Epoch: 1 cost time: 13.052457332611084
Epoch: 1, Steps: 2239 | Train Loss: 0.6018252 Vali Loss: 0.6079115 Test Loss: 0.3266498
Validation loss decreased (inf --> 0.607911).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4432321
	speed: 0.0764s/iter; left time: 1530.9708s
	iters: 200, epoch: 2 | loss: 0.4695548
	speed: 0.0059s/iter; left time: 116.9730s
	iters: 300, epoch: 2 | loss: 0.7629368
	speed: 0.0060s/iter; left time: 119.1420s
	iters: 400, epoch: 2 | loss: 0.7509423
	speed: 0.0058s/iter; left time: 115.3933s
	iters: 500, epoch: 2 | loss: 0.4063468
	speed: 0.0056s/iter; left time: 110.7447s
	iters: 600, epoch: 2 | loss: 0.5145207
	speed: 0.0056s/iter; left time: 108.8322s
	iters: 700, epoch: 2 | loss: 0.4702456
	speed: 0.0056s/iter; left time: 109.7248s
	iters: 800, epoch: 2 | loss: 0.4046668
	speed: 0.0057s/iter; left time: 110.1021s
	iters: 900, epoch: 2 | loss: 0.5005578
	speed: 0.0057s/iter; left time: 109.0531s
	iters: 1000, epoch: 2 | loss: 0.5401456
	speed: 0.0057s/iter; left time: 109.0378s
	iters: 1100, epoch: 2 | loss: 0.4761703
	speed: 0.0061s/iter; left time: 115.8033s
	iters: 1200, epoch: 2 | loss: 0.4538096
	speed: 0.0060s/iter; left time: 114.3734s
	iters: 1300, epoch: 2 | loss: 0.5440054
	speed: 0.0056s/iter; left time: 105.0965s
	iters: 1400, epoch: 2 | loss: 0.5133168
	speed: 0.0055s/iter; left time: 102.5939s
	iters: 1500, epoch: 2 | loss: 0.4485675
	speed: 0.0054s/iter; left time: 101.0141s
	iters: 1600, epoch: 2 | loss: 0.5696573
	speed: 0.0053s/iter; left time: 98.8221s
	iters: 1700, epoch: 2 | loss: 0.4638931
	speed: 0.0054s/iter; left time: 99.0242s
	iters: 1800, epoch: 2 | loss: 0.6172785
	speed: 0.0053s/iter; left time: 98.0012s
	iters: 1900, epoch: 2 | loss: 0.6764488
	speed: 0.0053s/iter; left time: 97.3046s
	iters: 2000, epoch: 2 | loss: 0.4196217
	speed: 0.0057s/iter; left time: 104.0275s
	iters: 2100, epoch: 2 | loss: 0.4419026
	speed: 0.0056s/iter; left time: 101.2447s
	iters: 2200, epoch: 2 | loss: 1.0578994
	speed: 0.0057s/iter; left time: 102.4173s
Epoch: 2 cost time: 13.354676961898804
Epoch: 2, Steps: 2239 | Train Loss: 0.5838704 Vali Loss: 0.6130608 Test Loss: 0.3299913
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3978609
	speed: 0.0767s/iter; left time: 1366.1809s
	iters: 200, epoch: 3 | loss: 0.5078714
	speed: 0.0056s/iter; left time: 100.0365s
	iters: 300, epoch: 3 | loss: 0.4778313
	speed: 0.0057s/iter; left time: 101.2183s
	iters: 400, epoch: 3 | loss: 0.3791554
	speed: 0.0054s/iter; left time: 94.9560s
	iters: 500, epoch: 3 | loss: 0.7629494
	speed: 0.0053s/iter; left time: 93.0422s
	iters: 600, epoch: 3 | loss: 0.7119628
	speed: 0.0054s/iter; left time: 94.1797s
	iters: 700, epoch: 3 | loss: 0.7158706
	speed: 0.0055s/iter; left time: 94.9893s
	iters: 800, epoch: 3 | loss: 0.5132303
	speed: 0.0056s/iter; left time: 95.8575s
	iters: 900, epoch: 3 | loss: 0.4868241
	speed: 0.0058s/iter; left time: 99.4904s
	iters: 1000, epoch: 3 | loss: 0.5111328
	speed: 0.0057s/iter; left time: 95.6192s
	iters: 1100, epoch: 3 | loss: 0.9800078
	speed: 0.0062s/iter; left time: 104.0843s
	iters: 1200, epoch: 3 | loss: 0.7207367
	speed: 0.0060s/iter; left time: 101.0005s
	iters: 1300, epoch: 3 | loss: 0.5518161
	speed: 0.0058s/iter; left time: 96.2657s
	iters: 1400, epoch: 3 | loss: 0.3992814
	speed: 0.0056s/iter; left time: 92.0075s
	iters: 1500, epoch: 3 | loss: 0.5111363
	speed: 0.0055s/iter; left time: 90.8492s
	iters: 1600, epoch: 3 | loss: 0.3907498
	speed: 0.0053s/iter; left time: 86.8928s
	iters: 1700, epoch: 3 | loss: 0.4589849
	speed: 0.0055s/iter; left time: 89.4089s
	iters: 1800, epoch: 3 | loss: 0.4632605
	speed: 0.0056s/iter; left time: 90.1949s
	iters: 1900, epoch: 3 | loss: 0.4323818
	speed: 0.0055s/iter; left time: 88.6016s
	iters: 2000, epoch: 3 | loss: 0.4253373
	speed: 0.0057s/iter; left time: 91.2906s
	iters: 2100, epoch: 3 | loss: 0.5964894
	speed: 0.0055s/iter; left time: 86.6524s
	iters: 2200, epoch: 3 | loss: 0.4708472
	speed: 0.0063s/iter; left time: 98.4836s
Epoch: 3 cost time: 13.428485631942749
Epoch: 3, Steps: 2239 | Train Loss: 0.5705258 Vali Loss: 0.6026816 Test Loss: 0.3202000
Validation loss decreased (0.607911 --> 0.602682).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.7503442
	speed: 0.0789s/iter; left time: 1229.5222s
	iters: 200, epoch: 4 | loss: 0.5711710
	speed: 0.0059s/iter; left time: 90.8784s
	iters: 300, epoch: 4 | loss: 0.4828104
	speed: 0.0058s/iter; left time: 89.7161s
	iters: 400, epoch: 4 | loss: 0.4004089
	speed: 0.0056s/iter; left time: 86.2357s
	iters: 500, epoch: 4 | loss: 0.5490907
	speed: 0.0055s/iter; left time: 83.9004s
	iters: 600, epoch: 4 | loss: 0.7863002
	speed: 0.0057s/iter; left time: 85.2076s
	iters: 700, epoch: 4 | loss: 0.4508106
	speed: 0.0056s/iter; left time: 83.3797s
	iters: 800, epoch: 4 | loss: 0.4153905
	speed: 0.0057s/iter; left time: 85.4216s
	iters: 900, epoch: 4 | loss: 0.5948875
	speed: 0.0055s/iter; left time: 81.9378s
	iters: 1000, epoch: 4 | loss: 0.7945710
	speed: 0.0055s/iter; left time: 80.6032s
	iters: 1100, epoch: 4 | loss: 0.4510232
	speed: 0.0058s/iter; left time: 83.8938s
	iters: 1200, epoch: 4 | loss: 0.4899754
	speed: 0.0057s/iter; left time: 83.0951s
	iters: 1300, epoch: 4 | loss: 0.8588256
	speed: 0.0059s/iter; left time: 85.1861s
	iters: 1400, epoch: 4 | loss: 0.9802430
	speed: 0.0057s/iter; left time: 80.8074s
	iters: 1500, epoch: 4 | loss: 0.4502786
	speed: 0.0060s/iter; left time: 84.5519s
	iters: 1600, epoch: 4 | loss: 0.4722292
	speed: 0.0056s/iter; left time: 78.2045s
	iters: 1700, epoch: 4 | loss: 0.5461600
	speed: 0.0054s/iter; left time: 75.4251s
	iters: 1800, epoch: 4 | loss: 0.6397036
	speed: 0.0057s/iter; left time: 78.8180s
	iters: 1900, epoch: 4 | loss: 0.4776952
	speed: 0.0058s/iter; left time: 80.0519s
	iters: 2000, epoch: 4 | loss: 0.4222588
	speed: 0.0062s/iter; left time: 84.2245s
	iters: 2100, epoch: 4 | loss: 0.3881448
	speed: 0.0061s/iter; left time: 82.9139s
	iters: 2200, epoch: 4 | loss: 0.4799915
	speed: 0.0059s/iter; left time: 79.6547s
Epoch: 4 cost time: 13.770668745040894
Epoch: 4, Steps: 2239 | Train Loss: 0.5638421 Vali Loss: 0.6087887 Test Loss: 0.3201801
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.6081516
	speed: 0.0762s/iter; left time: 1015.9607s
	iters: 200, epoch: 5 | loss: 0.5024501
	speed: 0.0056s/iter; left time: 73.9374s
	iters: 300, epoch: 5 | loss: 0.6862761
	speed: 0.0060s/iter; left time: 79.1889s
	iters: 400, epoch: 5 | loss: 0.3437419
	speed: 0.0062s/iter; left time: 81.4298s
	iters: 500, epoch: 5 | loss: 0.4730310
	speed: 0.0059s/iter; left time: 76.1632s
	iters: 600, epoch: 5 | loss: 0.4171871
	speed: 0.0056s/iter; left time: 72.1934s
	iters: 700, epoch: 5 | loss: 0.6070638
	speed: 0.0055s/iter; left time: 69.6875s
	iters: 800, epoch: 5 | loss: 0.5771925
	speed: 0.0057s/iter; left time: 71.5207s
	iters: 900, epoch: 5 | loss: 0.5618632
	speed: 0.0055s/iter; left time: 69.0203s
	iters: 1000, epoch: 5 | loss: 0.7799140
	speed: 0.0057s/iter; left time: 70.9472s
	iters: 1100, epoch: 5 | loss: 0.4661911
	speed: 0.0057s/iter; left time: 70.7811s
	iters: 1200, epoch: 5 | loss: 0.5101273
	speed: 0.0061s/iter; left time: 75.0286s
	iters: 1300, epoch: 5 | loss: 0.7931812
	speed: 0.0055s/iter; left time: 67.0416s
	iters: 1400, epoch: 5 | loss: 0.4027745
	speed: 0.0061s/iter; left time: 73.4526s
	iters: 1500, epoch: 5 | loss: 0.6917185
	speed: 0.0058s/iter; left time: 69.0658s
	iters: 1600, epoch: 5 | loss: 0.5592877
	speed: 0.0057s/iter; left time: 67.0202s
	iters: 1700, epoch: 5 | loss: 0.5345311
	speed: 0.0057s/iter; left time: 67.2299s
	iters: 1800, epoch: 5 | loss: 0.3976825
	speed: 0.0058s/iter; left time: 67.4592s
	iters: 1900, epoch: 5 | loss: 0.4233675
	speed: 0.0056s/iter; left time: 64.3307s
	iters: 2000, epoch: 5 | loss: 0.6795061
	speed: 0.0057s/iter; left time: 65.2408s
	iters: 2100, epoch: 5 | loss: 0.4358929
	speed: 0.0058s/iter; left time: 65.4105s
	iters: 2200, epoch: 5 | loss: 0.4956795
	speed: 0.0065s/iter; left time: 72.6593s
Epoch: 5 cost time: 13.731550931930542
Epoch: 5, Steps: 2239 | Train Loss: 0.5599373 Vali Loss: 0.6137131 Test Loss: 0.3224509
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.5435776
	speed: 0.0778s/iter; left time: 862.9443s
	iters: 200, epoch: 6 | loss: 0.4783213
	speed: 0.0057s/iter; left time: 62.5837s
	iters: 300, epoch: 6 | loss: 0.4084564
	speed: 0.0057s/iter; left time: 62.5149s
	iters: 400, epoch: 6 | loss: 0.4959663
	speed: 0.0054s/iter; left time: 58.6964s
	iters: 500, epoch: 6 | loss: 0.5266191
	speed: 0.0055s/iter; left time: 58.9811s
	iters: 600, epoch: 6 | loss: 0.3813107
	speed: 0.0055s/iter; left time: 58.2284s
	iters: 700, epoch: 6 | loss: 0.5464306
	speed: 0.0056s/iter; left time: 58.3918s
	iters: 800, epoch: 6 | loss: 0.9726667
	speed: 0.0055s/iter; left time: 57.1508s
	iters: 900, epoch: 6 | loss: 0.5403891
	speed: 0.0055s/iter; left time: 56.5868s
	iters: 1000, epoch: 6 | loss: 0.5557591
	speed: 0.0055s/iter; left time: 56.4925s
	iters: 1100, epoch: 6 | loss: 0.6969590
	speed: 0.0057s/iter; left time: 57.2357s
	iters: 1200, epoch: 6 | loss: 0.4785267
	speed: 0.0055s/iter; left time: 55.3327s
	iters: 1300, epoch: 6 | loss: 0.4013184
	speed: 0.0054s/iter; left time: 53.9139s
	iters: 1400, epoch: 6 | loss: 0.7219161
	speed: 0.0058s/iter; left time: 56.3443s
	iters: 1500, epoch: 6 | loss: 0.7351767
	speed: 0.0058s/iter; left time: 56.5320s
	iters: 1600, epoch: 6 | loss: 0.5260153
	speed: 0.0055s/iter; left time: 52.4648s
	iters: 1700, epoch: 6 | loss: 0.4959692
	speed: 0.0056s/iter; left time: 53.2501s
	iters: 1800, epoch: 6 | loss: 0.8763058
	speed: 0.0056s/iter; left time: 52.6329s
	iters: 1900, epoch: 6 | loss: 0.4020056
	speed: 0.0055s/iter; left time: 51.2123s
	iters: 2000, epoch: 6 | loss: 0.5562458
	speed: 0.0054s/iter; left time: 49.9325s
	iters: 2100, epoch: 6 | loss: 0.3689761
	speed: 0.0059s/iter; left time: 53.2564s
	iters: 2200, epoch: 6 | loss: 0.5217297
	speed: 0.0060s/iter; left time: 53.6938s
Epoch: 6 cost time: 13.271923542022705
Epoch: 6, Steps: 2239 | Train Loss: 0.5576565 Vali Loss: 0.6057982 Test Loss: 0.3192467
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32013407349586487, mae:0.35003945231437683
