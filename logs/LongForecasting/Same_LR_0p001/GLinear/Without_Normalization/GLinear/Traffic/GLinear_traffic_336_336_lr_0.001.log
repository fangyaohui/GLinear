Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_GLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.3054865
	speed: 0.0389s/iter; left time: 278.2252s
	iters: 200, epoch: 1 | loss: 0.2960410
	speed: 0.0301s/iter; left time: 212.5619s
	iters: 300, epoch: 1 | loss: 0.2742372
	speed: 0.0288s/iter; left time: 200.4731s
	iters: 400, epoch: 1 | loss: 0.2857656
	speed: 0.0288s/iter; left time: 197.4066s
	iters: 500, epoch: 1 | loss: 0.2497380
	speed: 0.0290s/iter; left time: 195.5530s
	iters: 600, epoch: 1 | loss: 0.2789921
	speed: 0.0299s/iter; left time: 198.7037s
	iters: 700, epoch: 1 | loss: 0.2658670
	speed: 0.0293s/iter; left time: 192.0509s
Epoch: 1 cost time: 22.276923894882202
Epoch: 1, Steps: 725 | Train Loss: 0.2913201 Vali Loss: 0.3832162 Test Loss: 0.4540295
Validation loss decreased (inf --> 0.383216).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2767778
	speed: 0.1745s/iter; left time: 1121.5950s
	iters: 200, epoch: 2 | loss: 0.2690499
	speed: 0.0303s/iter; left time: 191.4963s
	iters: 300, epoch: 2 | loss: 0.2844569
	speed: 0.0301s/iter; left time: 187.3214s
	iters: 400, epoch: 2 | loss: 0.2754428
	speed: 0.0297s/iter; left time: 182.1779s
	iters: 500, epoch: 2 | loss: 0.2833591
	speed: 0.0295s/iter; left time: 177.7241s
	iters: 600, epoch: 2 | loss: 0.2518245
	speed: 0.0304s/iter; left time: 180.0357s
	iters: 700, epoch: 2 | loss: 0.2639017
	speed: 0.0303s/iter; left time: 176.3013s
Epoch: 2 cost time: 22.596580266952515
Epoch: 2, Steps: 725 | Train Loss: 0.2607436 Vali Loss: 0.3736177 Test Loss: 0.4400351
Validation loss decreased (0.383216 --> 0.373618).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2648085
	speed: 0.1745s/iter; left time: 994.5471s
	iters: 200, epoch: 3 | loss: 0.2543246
	speed: 0.0309s/iter; left time: 173.1355s
	iters: 300, epoch: 3 | loss: 0.2294285
	speed: 0.0301s/iter; left time: 165.6235s
	iters: 400, epoch: 3 | loss: 0.2485213
	speed: 0.0295s/iter; left time: 159.1879s
	iters: 500, epoch: 3 | loss: 0.2413252
	speed: 0.0295s/iter; left time: 156.3562s
	iters: 600, epoch: 3 | loss: 0.2381788
	speed: 0.0291s/iter; left time: 151.2888s
	iters: 700, epoch: 3 | loss: 0.2495211
	speed: 0.0299s/iter; left time: 152.5845s
Epoch: 3 cost time: 22.52161741256714
Epoch: 3, Steps: 725 | Train Loss: 0.2537257 Vali Loss: 0.3688172 Test Loss: 0.4336658
Validation loss decreased (0.373618 --> 0.368817).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2676759
	speed: 0.1763s/iter; left time: 877.1955s
	iters: 200, epoch: 4 | loss: 0.2691987
	speed: 0.0305s/iter; left time: 148.6582s
	iters: 300, epoch: 4 | loss: 0.2453111
	speed: 0.0307s/iter; left time: 146.4210s
	iters: 400, epoch: 4 | loss: 0.2437349
	speed: 0.0301s/iter; left time: 140.9473s
	iters: 500, epoch: 4 | loss: 0.2709449
	speed: 0.0307s/iter; left time: 140.3637s
	iters: 600, epoch: 4 | loss: 0.2613528
	speed: 0.0304s/iter; left time: 136.0565s
	iters: 700, epoch: 4 | loss: 0.2439587
	speed: 0.0302s/iter; left time: 132.0453s
Epoch: 4 cost time: 23.032957792282104
Epoch: 4, Steps: 725 | Train Loss: 0.2508781 Vali Loss: 0.3655629 Test Loss: 0.4287663
Validation loss decreased (0.368817 --> 0.365563).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2532454
	speed: 0.1834s/iter; left time: 779.8403s
	iters: 200, epoch: 5 | loss: 0.2818993
	speed: 0.0304s/iter; left time: 126.1631s
	iters: 300, epoch: 5 | loss: 0.2437496
	speed: 0.0296s/iter; left time: 120.0200s
	iters: 400, epoch: 5 | loss: 0.2496621
	speed: 0.0309s/iter; left time: 121.9619s
	iters: 500, epoch: 5 | loss: 0.2468499
	speed: 0.0303s/iter; left time: 116.7062s
	iters: 600, epoch: 5 | loss: 0.2414036
	speed: 0.0305s/iter; left time: 114.2219s
	iters: 700, epoch: 5 | loss: 0.2699032
	speed: 0.0305s/iter; left time: 111.2024s
Epoch: 5 cost time: 22.96111273765564
Epoch: 5, Steps: 725 | Train Loss: 0.2493879 Vali Loss: 0.3651939 Test Loss: 0.4283814
Validation loss decreased (0.365563 --> 0.365194).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2478424
	speed: 0.1796s/iter; left time: 633.2474s
	iters: 200, epoch: 6 | loss: 0.2626878
	speed: 0.0303s/iter; left time: 103.7316s
	iters: 300, epoch: 6 | loss: 0.2638594
	speed: 0.0306s/iter; left time: 101.7893s
	iters: 400, epoch: 6 | loss: 0.2532153
	speed: 0.0306s/iter; left time: 98.7860s
	iters: 500, epoch: 6 | loss: 0.2551140
	speed: 0.0300s/iter; left time: 93.9306s
	iters: 600, epoch: 6 | loss: 0.2377702
	speed: 0.0304s/iter; left time: 91.9360s
	iters: 700, epoch: 6 | loss: 0.2445395
	speed: 0.0301s/iter; left time: 88.0480s
Epoch: 6 cost time: 23.12138533592224
Epoch: 6, Steps: 725 | Train Loss: 0.2485682 Vali Loss: 0.3638216 Test Loss: 0.4270917
Validation loss decreased (0.365194 --> 0.363822).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2610580
	speed: 0.1798s/iter; left time: 503.6534s
	iters: 200, epoch: 7 | loss: 0.2298768
	speed: 0.0311s/iter; left time: 83.9034s
	iters: 300, epoch: 7 | loss: 0.2328766
	speed: 0.0306s/iter; left time: 79.5389s
	iters: 400, epoch: 7 | loss: 0.2444216
	speed: 0.0311s/iter; left time: 77.6718s
	iters: 500, epoch: 7 | loss: 0.2593338
	speed: 0.0309s/iter; left time: 74.1142s
	iters: 600, epoch: 7 | loss: 0.2463833
	speed: 0.0311s/iter; left time: 71.6493s
	iters: 700, epoch: 7 | loss: 0.2381810
	speed: 0.0315s/iter; left time: 69.4175s
Epoch: 7 cost time: 23.462385177612305
Epoch: 7, Steps: 725 | Train Loss: 0.2482006 Vali Loss: 0.3638310 Test Loss: 0.4267238
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2269841
	speed: 0.1786s/iter; left time: 370.7426s
	iters: 200, epoch: 8 | loss: 0.2383719
	speed: 0.0300s/iter; left time: 59.3345s
	iters: 300, epoch: 8 | loss: 0.2229450
	speed: 0.0300s/iter; left time: 56.1903s
	iters: 400, epoch: 8 | loss: 0.2683620
	speed: 0.0303s/iter; left time: 53.7975s
	iters: 500, epoch: 8 | loss: 0.2321641
	speed: 0.0298s/iter; left time: 49.9371s
	iters: 600, epoch: 8 | loss: 0.2598838
	speed: 0.0301s/iter; left time: 47.4480s
	iters: 700, epoch: 8 | loss: 0.2429963
	speed: 0.0304s/iter; left time: 44.9302s
Epoch: 8 cost time: 22.811980485916138
Epoch: 8, Steps: 725 | Train Loss: 0.2479929 Vali Loss: 0.3640001 Test Loss: 0.4269187
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2258721
	speed: 0.1835s/iter; left time: 247.8714s
	iters: 200, epoch: 9 | loss: 0.2726801
	speed: 0.0297s/iter; left time: 37.1801s
	iters: 300, epoch: 9 | loss: 0.2439822
	speed: 0.0303s/iter; left time: 34.8872s
	iters: 400, epoch: 9 | loss: 0.2298469
	speed: 0.0304s/iter; left time: 31.9397s
	iters: 500, epoch: 9 | loss: 0.2426765
	speed: 0.0297s/iter; left time: 28.1972s
	iters: 600, epoch: 9 | loss: 0.2673929
	speed: 0.0311s/iter; left time: 26.4390s
	iters: 700, epoch: 9 | loss: 0.2508467
	speed: 0.0307s/iter; left time: 23.0357s
Epoch: 9 cost time: 22.991093158721924
Epoch: 9, Steps: 725 | Train Loss: 0.2478636 Vali Loss: 0.3637618 Test Loss: 0.4265924
Validation loss decreased (0.363822 --> 0.363762).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2281183
	speed: 0.1805s/iter; left time: 113.0086s
	iters: 200, epoch: 10 | loss: 0.2208633
	speed: 0.0304s/iter; left time: 15.9911s
	iters: 300, epoch: 10 | loss: 0.2410127
	speed: 0.0305s/iter; left time: 12.9721s
	iters: 400, epoch: 10 | loss: 0.2448177
	speed: 0.0300s/iter; left time: 9.7707s
	iters: 500, epoch: 10 | loss: 0.2642118
	speed: 0.0296s/iter; left time: 6.6863s
	iters: 600, epoch: 10 | loss: 0.2358239
	speed: 0.0302s/iter; left time: 3.8110s
	iters: 700, epoch: 10 | loss: 0.2390437
	speed: 0.0315s/iter; left time: 0.8183s
Epoch: 10 cost time: 22.969650745391846
Epoch: 10, Steps: 725 | Train Loss: 0.2478160 Vali Loss: 0.3635010 Test Loss: 0.4265253
Validation loss decreased (0.363762 --> 0.363501).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_336_GLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.425660640001297, mae:0.2911156415939331
