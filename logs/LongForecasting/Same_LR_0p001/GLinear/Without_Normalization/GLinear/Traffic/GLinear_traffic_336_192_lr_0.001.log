Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_GLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.2729240
	speed: 0.0334s/iter; left time: 241.9026s
	iters: 200, epoch: 1 | loss: 0.2827216
	speed: 0.0259s/iter; left time: 185.0613s
	iters: 300, epoch: 1 | loss: 0.2586536
	speed: 0.0261s/iter; left time: 183.5883s
	iters: 400, epoch: 1 | loss: 0.2477512
	speed: 0.0250s/iter; left time: 173.5948s
	iters: 500, epoch: 1 | loss: 0.2580529
	speed: 0.0250s/iter; left time: 170.7277s
	iters: 600, epoch: 1 | loss: 0.2744873
	speed: 0.0253s/iter; left time: 170.7770s
	iters: 700, epoch: 1 | loss: 0.2738286
	speed: 0.0247s/iter; left time: 164.1567s
Epoch: 1 cost time: 19.472033262252808
Epoch: 1, Steps: 734 | Train Loss: 0.2785155 Vali Loss: 0.3626223 Test Loss: 0.4329449
Validation loss decreased (inf --> 0.362622).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2639376
	speed: 0.1456s/iter; left time: 947.3088s
	iters: 200, epoch: 2 | loss: 0.2565390
	speed: 0.0262s/iter; left time: 167.5856s
	iters: 300, epoch: 2 | loss: 0.2632926
	speed: 0.0248s/iter; left time: 156.6786s
	iters: 400, epoch: 2 | loss: 0.2357896
	speed: 0.0258s/iter; left time: 159.9552s
	iters: 500, epoch: 2 | loss: 0.2487986
	speed: 0.0245s/iter; left time: 149.8611s
	iters: 600, epoch: 2 | loss: 0.2453672
	speed: 0.0246s/iter; left time: 147.7751s
	iters: 700, epoch: 2 | loss: 0.2460386
	speed: 0.0253s/iter; left time: 149.3612s
Epoch: 2 cost time: 19.28555679321289
Epoch: 2, Steps: 734 | Train Loss: 0.2500285 Vali Loss: 0.3564914 Test Loss: 0.4226054
Validation loss decreased (0.362622 --> 0.356491).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2251123
	speed: 0.1483s/iter; left time: 855.9410s
	iters: 200, epoch: 3 | loss: 0.2522110
	speed: 0.0242s/iter; left time: 137.2593s
	iters: 300, epoch: 3 | loss: 0.2393222
	speed: 0.0251s/iter; left time: 140.1378s
	iters: 400, epoch: 3 | loss: 0.2580101
	speed: 0.0252s/iter; left time: 137.9957s
	iters: 500, epoch: 3 | loss: 0.2206119
	speed: 0.0253s/iter; left time: 136.0067s
	iters: 600, epoch: 3 | loss: 0.2261725
	speed: 0.0246s/iter; left time: 129.9048s
	iters: 700, epoch: 3 | loss: 0.2642204
	speed: 0.0257s/iter; left time: 132.8416s
Epoch: 3 cost time: 19.186241388320923
Epoch: 3, Steps: 734 | Train Loss: 0.2430208 Vali Loss: 0.3516797 Test Loss: 0.4170092
Validation loss decreased (0.356491 --> 0.351680).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2630123
	speed: 0.1455s/iter; left time: 733.4264s
	iters: 200, epoch: 4 | loss: 0.2598005
	speed: 0.0240s/iter; left time: 118.6940s
	iters: 300, epoch: 4 | loss: 0.2442551
	speed: 0.0241s/iter; left time: 116.5547s
	iters: 400, epoch: 4 | loss: 0.2374273
	speed: 0.0247s/iter; left time: 117.0895s
	iters: 500, epoch: 4 | loss: 0.2306132
	speed: 0.0247s/iter; left time: 114.5227s
	iters: 600, epoch: 4 | loss: 0.2422574
	speed: 0.0245s/iter; left time: 111.0648s
	iters: 700, epoch: 4 | loss: 0.2451961
	speed: 0.0246s/iter; left time: 109.2992s
Epoch: 4 cost time: 18.81726861000061
Epoch: 4, Steps: 734 | Train Loss: 0.2401320 Vali Loss: 0.3502412 Test Loss: 0.4150697
Validation loss decreased (0.351680 --> 0.350241).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2277444
	speed: 0.1509s/iter; left time: 649.4296s
	iters: 200, epoch: 5 | loss: 0.2514677
	speed: 0.0253s/iter; left time: 106.5020s
	iters: 300, epoch: 5 | loss: 0.2357572
	speed: 0.0253s/iter; left time: 103.9748s
	iters: 400, epoch: 5 | loss: 0.2214101
	speed: 0.0257s/iter; left time: 103.0437s
	iters: 500, epoch: 5 | loss: 0.2403179
	speed: 0.0253s/iter; left time: 98.7321s
	iters: 600, epoch: 5 | loss: 0.2319642
	speed: 0.0256s/iter; left time: 97.5305s
	iters: 700, epoch: 5 | loss: 0.2526481
	speed: 0.0258s/iter; left time: 95.5582s
Epoch: 5 cost time: 19.69446301460266
Epoch: 5, Steps: 734 | Train Loss: 0.2386886 Vali Loss: 0.3478808 Test Loss: 0.4120173
Validation loss decreased (0.350241 --> 0.347881).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2354104
	speed: 0.1563s/iter; left time: 558.2407s
	iters: 200, epoch: 6 | loss: 0.2383787
	speed: 0.0258s/iter; left time: 89.5623s
	iters: 300, epoch: 6 | loss: 0.2672454
	speed: 0.0260s/iter; left time: 87.6716s
	iters: 400, epoch: 6 | loss: 0.2344624
	speed: 0.0253s/iter; left time: 82.8968s
	iters: 500, epoch: 6 | loss: 0.2284843
	speed: 0.0254s/iter; left time: 80.5946s
	iters: 600, epoch: 6 | loss: 0.2320412
	speed: 0.0252s/iter; left time: 77.4122s
	iters: 700, epoch: 6 | loss: 0.2367045
	speed: 0.0251s/iter; left time: 74.6080s
Epoch: 6 cost time: 19.66106128692627
Epoch: 6, Steps: 734 | Train Loss: 0.2378824 Vali Loss: 0.3470801 Test Loss: 0.4112587
Validation loss decreased (0.347881 --> 0.347080).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2517730
	speed: 0.1561s/iter; left time: 442.9523s
	iters: 200, epoch: 7 | loss: 0.2202605
	speed: 0.0251s/iter; left time: 68.7851s
	iters: 300, epoch: 7 | loss: 0.2292639
	speed: 0.0248s/iter; left time: 65.4175s
	iters: 400, epoch: 7 | loss: 0.2440815
	speed: 0.0254s/iter; left time: 64.5195s
	iters: 500, epoch: 7 | loss: 0.2213124
	speed: 0.0255s/iter; left time: 62.2651s
	iters: 600, epoch: 7 | loss: 0.2121178
	speed: 0.0246s/iter; left time: 57.5695s
	iters: 700, epoch: 7 | loss: 0.2364802
	speed: 0.0252s/iter; left time: 56.3163s
Epoch: 7 cost time: 19.544106006622314
Epoch: 7, Steps: 734 | Train Loss: 0.2374612 Vali Loss: 0.3471850 Test Loss: 0.4111143
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2513036
	speed: 0.1582s/iter; left time: 332.6178s
	iters: 200, epoch: 8 | loss: 0.2151054
	speed: 0.0256s/iter; left time: 51.2540s
	iters: 300, epoch: 8 | loss: 0.2304195
	speed: 0.0247s/iter; left time: 47.0200s
	iters: 400, epoch: 8 | loss: 0.2447911
	speed: 0.0250s/iter; left time: 45.0277s
	iters: 500, epoch: 8 | loss: 0.2288314
	speed: 0.0259s/iter; left time: 44.0436s
	iters: 600, epoch: 8 | loss: 0.2381980
	speed: 0.0257s/iter; left time: 41.2254s
	iters: 700, epoch: 8 | loss: 0.2108761
	speed: 0.0268s/iter; left time: 40.2722s
Epoch: 8 cost time: 19.766261100769043
Epoch: 8, Steps: 734 | Train Loss: 0.2372844 Vali Loss: 0.3466925 Test Loss: 0.4104591
Validation loss decreased (0.347080 --> 0.346692).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2333525
	speed: 0.1536s/iter; left time: 210.2658s
	iters: 200, epoch: 9 | loss: 0.2279415
	speed: 0.0254s/iter; left time: 32.2407s
	iters: 300, epoch: 9 | loss: 0.2261657
	speed: 0.0249s/iter; left time: 29.1401s
	iters: 400, epoch: 9 | loss: 0.2567802
	speed: 0.0251s/iter; left time: 26.7875s
	iters: 500, epoch: 9 | loss: 0.2228493
	speed: 0.0254s/iter; left time: 24.5833s
	iters: 600, epoch: 9 | loss: 0.2693050
	speed: 0.0256s/iter; left time: 22.2558s
	iters: 700, epoch: 9 | loss: 0.2468428
	speed: 0.0246s/iter; left time: 18.9321s
Epoch: 9 cost time: 19.308926105499268
Epoch: 9, Steps: 734 | Train Loss: 0.2371819 Vali Loss: 0.3467337 Test Loss: 0.4107564
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2524627
	speed: 0.1553s/iter; left time: 98.5943s
	iters: 200, epoch: 10 | loss: 0.2087570
	speed: 0.0263s/iter; left time: 14.0686s
	iters: 300, epoch: 10 | loss: 0.2659436
	speed: 0.0261s/iter; left time: 11.3434s
	iters: 400, epoch: 10 | loss: 0.2368736
	speed: 0.0260s/iter; left time: 8.6943s
	iters: 500, epoch: 10 | loss: 0.2438784
	speed: 0.0258s/iter; left time: 6.0743s
	iters: 600, epoch: 10 | loss: 0.2309779
	speed: 0.0262s/iter; left time: 3.5314s
	iters: 700, epoch: 10 | loss: 0.2184722
	speed: 0.0252s/iter; left time: 0.8834s
Epoch: 10 cost time: 19.874223470687866
Epoch: 10, Steps: 734 | Train Loss: 0.2371231 Vali Loss: 0.3471133 Test Loss: 0.4106274
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_192_GLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4102359414100647, mae:0.28420594334602356
