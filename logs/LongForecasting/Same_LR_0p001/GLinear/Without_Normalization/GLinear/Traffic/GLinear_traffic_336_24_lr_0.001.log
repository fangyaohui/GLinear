Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='traffic_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_24_GLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11921
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.2722945
	speed: 0.0291s/iter; left time: 213.5672s
	iters: 200, epoch: 1 | loss: 0.1999584
	speed: 0.0223s/iter; left time: 161.8970s
	iters: 300, epoch: 1 | loss: 0.2423519
	speed: 0.0220s/iter; left time: 157.6112s
	iters: 400, epoch: 1 | loss: 0.2469455
	speed: 0.0221s/iter; left time: 156.0453s
	iters: 500, epoch: 1 | loss: 0.1992838
	speed: 0.0232s/iter; left time: 161.4796s
	iters: 600, epoch: 1 | loss: 0.2585954
	speed: 0.0240s/iter; left time: 164.4939s
	iters: 700, epoch: 1 | loss: 0.2147503
	speed: 0.0234s/iter; left time: 157.6665s
Epoch: 1 cost time: 17.765891075134277
Epoch: 1, Steps: 745 | Train Loss: 0.2421429 Vali Loss: 0.3194158 Test Loss: 0.3588962
Validation loss decreased (inf --> 0.319416).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2408816
	speed: 0.1291s/iter; left time: 853.1277s
	iters: 200, epoch: 2 | loss: 0.2257711
	speed: 0.0224s/iter; left time: 145.4563s
	iters: 300, epoch: 2 | loss: 0.2223226
	speed: 0.0223s/iter; left time: 142.7591s
	iters: 400, epoch: 2 | loss: 0.2650453
	speed: 0.0233s/iter; left time: 146.8710s
	iters: 500, epoch: 2 | loss: 0.2244747
	speed: 0.0220s/iter; left time: 136.6223s
	iters: 600, epoch: 2 | loss: 0.2014869
	speed: 0.0230s/iter; left time: 140.7346s
	iters: 700, epoch: 2 | loss: 0.1973609
	speed: 0.0230s/iter; left time: 138.0361s
Epoch: 2 cost time: 17.775066375732422
Epoch: 2, Steps: 745 | Train Loss: 0.2196433 Vali Loss: 0.3175993 Test Loss: 0.3525463
Validation loss decreased (0.319416 --> 0.317599).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1916805
	speed: 0.1352s/iter; left time: 792.5553s
	iters: 200, epoch: 3 | loss: 0.1944571
	speed: 0.0221s/iter; left time: 127.2260s
	iters: 300, epoch: 3 | loss: 0.2570648
	speed: 0.0216s/iter; left time: 122.5348s
	iters: 400, epoch: 3 | loss: 0.2314646
	speed: 0.0244s/iter; left time: 135.8579s
	iters: 500, epoch: 3 | loss: 0.2751766
	speed: 0.0253s/iter; left time: 138.0243s
	iters: 600, epoch: 3 | loss: 0.2198149
	speed: 0.0253s/iter; left time: 135.7609s
	iters: 700, epoch: 3 | loss: 0.1766399
	speed: 0.0241s/iter; left time: 126.7359s
Epoch: 3 cost time: 18.439785480499268
Epoch: 3, Steps: 745 | Train Loss: 0.2118960 Vali Loss: 0.3171855 Test Loss: 0.3500225
Validation loss decreased (0.317599 --> 0.317185).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2268175
	speed: 0.1292s/iter; left time: 660.9108s
	iters: 200, epoch: 4 | loss: 0.2050904
	speed: 0.0217s/iter; left time: 109.0839s
	iters: 300, epoch: 4 | loss: 0.2010469
	speed: 0.0212s/iter; left time: 104.3594s
	iters: 400, epoch: 4 | loss: 0.2249931
	speed: 0.0254s/iter; left time: 122.3702s
	iters: 500, epoch: 4 | loss: 0.2283259
	speed: 0.0251s/iter; left time: 118.5701s
	iters: 600, epoch: 4 | loss: 0.1932695
	speed: 0.0273s/iter; left time: 126.0342s
	iters: 700, epoch: 4 | loss: 0.2069416
	speed: 0.0272s/iter; left time: 122.9982s
Epoch: 4 cost time: 18.84206461906433
Epoch: 4, Steps: 745 | Train Loss: 0.2085910 Vali Loss: 0.3128268 Test Loss: 0.3445379
Validation loss decreased (0.317185 --> 0.312827).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1771111
	speed: 0.1318s/iter; left time: 575.9558s
	iters: 200, epoch: 5 | loss: 0.2078364
	speed: 0.0217s/iter; left time: 92.8733s
	iters: 300, epoch: 5 | loss: 0.1905422
	speed: 0.0214s/iter; left time: 89.0980s
	iters: 400, epoch: 5 | loss: 0.1672932
	speed: 0.0236s/iter; left time: 95.9258s
	iters: 500, epoch: 5 | loss: 0.1939356
	speed: 0.0262s/iter; left time: 103.9228s
	iters: 600, epoch: 5 | loss: 0.1718493
	speed: 0.0273s/iter; left time: 105.7058s
	iters: 700, epoch: 5 | loss: 0.1736658
	speed: 0.0259s/iter; left time: 97.6509s
Epoch: 5 cost time: 18.774643421173096
Epoch: 5, Steps: 745 | Train Loss: 0.2068140 Vali Loss: 0.3116758 Test Loss: 0.3428772
Validation loss decreased (0.312827 --> 0.311676).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1846212
	speed: 0.1317s/iter; left time: 477.7114s
	iters: 200, epoch: 6 | loss: 0.2426099
	speed: 0.0223s/iter; left time: 78.4846s
	iters: 300, epoch: 6 | loss: 0.2371839
	speed: 0.0258s/iter; left time: 88.2851s
	iters: 400, epoch: 6 | loss: 0.2048749
	speed: 0.0264s/iter; left time: 87.9453s
	iters: 500, epoch: 6 | loss: 0.1674015
	speed: 0.0275s/iter; left time: 88.7191s
	iters: 600, epoch: 6 | loss: 0.1906332
	speed: 0.0267s/iter; left time: 83.3264s
	iters: 700, epoch: 6 | loss: 0.2013943
	speed: 0.0271s/iter; left time: 82.0557s
Epoch: 6 cost time: 19.736851930618286
Epoch: 6, Steps: 745 | Train Loss: 0.2058120 Vali Loss: 0.3114767 Test Loss: 0.3423773
Validation loss decreased (0.311676 --> 0.311477).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2329535
	speed: 0.1332s/iter; left time: 383.8727s
	iters: 200, epoch: 7 | loss: 0.2088490
	speed: 0.0210s/iter; left time: 58.4135s
	iters: 300, epoch: 7 | loss: 0.2004523
	speed: 0.0224s/iter; left time: 60.1096s
	iters: 400, epoch: 7 | loss: 0.1829381
	speed: 0.0242s/iter; left time: 62.3379s
	iters: 500, epoch: 7 | loss: 0.1981836
	speed: 0.0282s/iter; left time: 69.8616s
	iters: 600, epoch: 7 | loss: 0.2704893
	speed: 0.0255s/iter; left time: 60.6327s
	iters: 700, epoch: 7 | loss: 0.2266701
	speed: 0.0253s/iter; left time: 57.7232s
Epoch: 7 cost time: 18.76908254623413
Epoch: 7, Steps: 745 | Train Loss: 0.2053272 Vali Loss: 0.3111732 Test Loss: 0.3414130
Validation loss decreased (0.311477 --> 0.311173).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1843854
	speed: 0.1306s/iter; left time: 278.9617s
	iters: 200, epoch: 8 | loss: 0.2060395
	speed: 0.0216s/iter; left time: 44.0556s
	iters: 300, epoch: 8 | loss: 0.1795338
	speed: 0.0230s/iter; left time: 44.5011s
	iters: 400, epoch: 8 | loss: 0.1993583
	speed: 0.0245s/iter; left time: 44.9676s
	iters: 500, epoch: 8 | loss: 0.1856419
	speed: 0.0258s/iter; left time: 44.8333s
	iters: 600, epoch: 8 | loss: 0.2089138
	speed: 0.0247s/iter; left time: 40.4254s
	iters: 700, epoch: 8 | loss: 0.2139084
	speed: 0.0238s/iter; left time: 36.5787s
Epoch: 8 cost time: 18.25447726249695
Epoch: 8, Steps: 745 | Train Loss: 0.2050332 Vali Loss: 0.3106767 Test Loss: 0.3408217
Validation loss decreased (0.311173 --> 0.310677).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1887293
	speed: 0.1436s/iter; left time: 199.6857s
	iters: 200, epoch: 9 | loss: 0.1617504
	speed: 0.0255s/iter; left time: 32.9604s
	iters: 300, epoch: 9 | loss: 0.2334184
	speed: 0.0274s/iter; left time: 32.6587s
	iters: 400, epoch: 9 | loss: 0.2490951
	speed: 0.0253s/iter; left time: 27.6012s
	iters: 500, epoch: 9 | loss: 0.2046061
	speed: 0.0242s/iter; left time: 23.9963s
	iters: 600, epoch: 9 | loss: 0.3241751
	speed: 0.0252s/iter; left time: 22.4837s
	iters: 700, epoch: 9 | loss: 0.1978924
	speed: 0.0249s/iter; left time: 19.6687s
Epoch: 9 cost time: 19.230072259902954
Epoch: 9, Steps: 745 | Train Loss: 0.2049098 Vali Loss: 0.3104371 Test Loss: 0.3406444
Validation loss decreased (0.310677 --> 0.310437).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1868051
	speed: 0.1290s/iter; left time: 83.3101s
	iters: 200, epoch: 10 | loss: 0.1895459
	speed: 0.0239s/iter; left time: 13.0592s
	iters: 300, epoch: 10 | loss: 0.1604937
	speed: 0.0241s/iter; left time: 10.7461s
	iters: 400, epoch: 10 | loss: 0.2165656
	speed: 0.0229s/iter; left time: 7.9281s
	iters: 500, epoch: 10 | loss: 0.2063405
	speed: 0.0236s/iter; left time: 5.8122s
	iters: 600, epoch: 10 | loss: 0.1615043
	speed: 0.0248s/iter; left time: 3.6220s
	iters: 700, epoch: 10 | loss: 0.2333045
	speed: 0.0249s/iter; left time: 1.1437s
Epoch: 10 cost time: 18.69357180595398
Epoch: 10, Steps: 745 | Train Loss: 0.2048178 Vali Loss: 0.3107442 Test Loss: 0.3408655
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_24_GLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.3407852053642273, mae:0.24905511736869812
