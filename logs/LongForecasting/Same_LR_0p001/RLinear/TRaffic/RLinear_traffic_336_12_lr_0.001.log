Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='traffic_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_12_RLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11933
val 1745
test 3497
	iters: 100, epoch: 1 | loss: 0.2979320
	speed: 0.5945s/iter; left time: 4370.0641s
	iters: 200, epoch: 1 | loss: 0.3155993
	speed: 0.5366s/iter; left time: 3891.1352s
	iters: 300, epoch: 1 | loss: 0.2933473
	speed: 0.5311s/iter; left time: 3797.9954s
	iters: 400, epoch: 1 | loss: 0.2306579
	speed: 0.5614s/iter; left time: 3958.2273s
	iters: 500, epoch: 1 | loss: 0.2033776
	speed: 0.5320s/iter; left time: 3698.1496s
	iters: 600, epoch: 1 | loss: 0.2531927
	speed: 0.5387s/iter; left time: 3690.7244s
	iters: 700, epoch: 1 | loss: 0.2419255
	speed: 0.5440s/iter; left time: 3672.2686s
Epoch: 1 cost time: 408.1309974193573
Epoch: 1, Steps: 745 | Train Loss: 0.3125605 Vali Loss: 0.3426725 Test Loss: 0.4101829
Validation loss decreased (inf --> 0.342673).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2916343
	speed: 1.1023s/iter; left time: 7281.6752s
	iters: 200, epoch: 2 | loss: 0.2639426
	speed: 0.5617s/iter; left time: 3654.6285s
	iters: 300, epoch: 2 | loss: 0.2584010
	speed: 0.5492s/iter; left time: 3518.0897s
	iters: 400, epoch: 2 | loss: 0.2268398
	speed: 0.5570s/iter; left time: 3512.6225s
	iters: 500, epoch: 2 | loss: 0.2861471
	speed: 0.5669s/iter; left time: 3517.9782s
	iters: 600, epoch: 2 | loss: 0.2132492
	speed: 0.5387s/iter; left time: 3289.4961s
	iters: 700, epoch: 2 | loss: 0.1928955
	speed: 0.5497s/iter; left time: 3301.7967s
Epoch: 2 cost time: 412.3792812824249
Epoch: 2, Steps: 745 | Train Loss: 0.2514129 Vali Loss: 0.3362983 Test Loss: 0.4005142
Validation loss decreased (0.342673 --> 0.336298).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1886124
	speed: 1.0914s/iter; left time: 6396.5692s
	iters: 200, epoch: 3 | loss: 0.2796687
	speed: 0.5528s/iter; left time: 3184.5984s
	iters: 300, epoch: 3 | loss: 0.2681992
	speed: 0.5473s/iter; left time: 3098.2791s
	iters: 400, epoch: 3 | loss: 0.2090197
	speed: 0.5489s/iter; left time: 3052.1956s
	iters: 500, epoch: 3 | loss: 0.1562855
	speed: 0.5562s/iter; left time: 3037.6365s
	iters: 600, epoch: 3 | loss: 0.2467553
	speed: 0.5568s/iter; left time: 2985.0570s
	iters: 700, epoch: 3 | loss: 0.2323899
	speed: 0.5388s/iter; left time: 2834.3639s
Epoch: 3 cost time: 410.1302754878998
Epoch: 3, Steps: 745 | Train Loss: 0.2380581 Vali Loss: 0.3244021 Test Loss: 0.3856649
Validation loss decreased (0.336298 --> 0.324402).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2602307
	speed: 1.0745s/iter; left time: 5497.0063s
	iters: 200, epoch: 4 | loss: 0.2327012
	speed: 0.5495s/iter; left time: 2756.1448s
	iters: 300, epoch: 4 | loss: 0.2462621
	speed: 0.5453s/iter; left time: 2680.9298s
	iters: 400, epoch: 4 | loss: 0.2068492
	speed: 0.5328s/iter; left time: 2566.0864s
	iters: 500, epoch: 4 | loss: 0.1925276
	speed: 0.5280s/iter; left time: 2490.2292s
	iters: 600, epoch: 4 | loss: 0.2554736
	speed: 0.5317s/iter; left time: 2454.2684s
	iters: 700, epoch: 4 | loss: 0.3152539
	speed: 0.5358s/iter; left time: 2419.5589s
Epoch: 4 cost time: 400.65876388549805
Epoch: 4, Steps: 745 | Train Loss: 0.2322200 Vali Loss: 0.3198640 Test Loss: 0.3807123
Validation loss decreased (0.324402 --> 0.319864).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1701611
	speed: 1.0791s/iter; left time: 4716.5603s
	iters: 200, epoch: 5 | loss: 0.2023323
	speed: 0.5287s/iter; left time: 2258.1440s
	iters: 300, epoch: 5 | loss: 0.1830115
	speed: 0.5410s/iter; left time: 2256.3036s
	iters: 400, epoch: 5 | loss: 0.2183468
	speed: 0.5787s/iter; left time: 2356.0414s
	iters: 500, epoch: 5 | loss: 0.3254051
	speed: 0.5586s/iter; left time: 2218.1602s
	iters: 600, epoch: 5 | loss: 0.1595964
	speed: 0.5298s/iter; left time: 2050.7758s
	iters: 700, epoch: 5 | loss: 0.1972749
	speed: 0.5438s/iter; left time: 2050.6701s
Epoch: 5 cost time: 405.8717646598816
Epoch: 5, Steps: 745 | Train Loss: 0.2289124 Vali Loss: 0.3181724 Test Loss: 0.3781314
Validation loss decreased (0.319864 --> 0.318172).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2268895
	speed: 1.1003s/iter; left time: 3989.6567s
	iters: 200, epoch: 6 | loss: 0.2749336
	speed: 0.5777s/iter; left time: 2037.0242s
	iters: 300, epoch: 6 | loss: 0.2055341
	speed: 0.5437s/iter; left time: 1862.7068s
	iters: 400, epoch: 6 | loss: 0.2616125
	speed: 0.5570s/iter; left time: 1852.4407s
	iters: 500, epoch: 6 | loss: 0.2827123
	speed: 0.5650s/iter; left time: 1822.6381s
	iters: 600, epoch: 6 | loss: 0.3007505
	speed: 0.5515s/iter; left time: 1723.9384s
	iters: 700, epoch: 6 | loss: 0.2790844
	speed: 0.5470s/iter; left time: 1655.2480s
Epoch: 6 cost time: 416.05263090133667
Epoch: 6, Steps: 745 | Train Loss: 0.2274093 Vali Loss: 0.3164493 Test Loss: 0.3770102
Validation loss decreased (0.318172 --> 0.316449).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2341348
	speed: 1.0746s/iter; left time: 3095.9804s
	iters: 200, epoch: 7 | loss: 0.2026126
	speed: 0.5314s/iter; left time: 1477.7386s
	iters: 300, epoch: 7 | loss: 0.1932833
	speed: 0.5313s/iter; left time: 1424.4242s
	iters: 400, epoch: 7 | loss: 0.2038067
	speed: 0.5325s/iter; left time: 1374.2927s
	iters: 500, epoch: 7 | loss: 0.2376369
	speed: 0.5335s/iter; left time: 1323.6113s
	iters: 600, epoch: 7 | loss: 0.1854915
	speed: 0.5367s/iter; left time: 1277.8150s
	iters: 700, epoch: 7 | loss: 0.1773721
	speed: 0.5330s/iter; left time: 1215.8453s
Epoch: 7 cost time: 397.84796237945557
Epoch: 7, Steps: 745 | Train Loss: 0.2265642 Vali Loss: 0.3163276 Test Loss: 0.3762832
Validation loss decreased (0.316449 --> 0.316328).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2346530
	speed: 1.0716s/iter; left time: 2289.0295s
	iters: 200, epoch: 8 | loss: 0.2032010
	speed: 0.5344s/iter; left time: 1087.9661s
	iters: 300, epoch: 8 | loss: 0.2268651
	speed: 0.5269s/iter; left time: 1020.1400s
	iters: 400, epoch: 8 | loss: 0.2935354
	speed: 0.5182s/iter; left time: 951.4143s
	iters: 500, epoch: 8 | loss: 0.1572899
	speed: 0.5176s/iter; left time: 898.5304s
	iters: 600, epoch: 8 | loss: 0.2295663
	speed: 0.5213s/iter; left time: 852.9161s
	iters: 700, epoch: 8 | loss: 0.2326378
	speed: 0.5328s/iter; left time: 818.4004s
Epoch: 8 cost time: 393.18511033058167
Epoch: 8, Steps: 745 | Train Loss: 0.2261076 Vali Loss: 0.3161087 Test Loss: 0.3761604
Validation loss decreased (0.316328 --> 0.316109).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2646149
	speed: 1.0686s/iter; left time: 1486.4554s
	iters: 200, epoch: 9 | loss: 0.2182556
	speed: 0.5313s/iter; left time: 685.9482s
	iters: 300, epoch: 9 | loss: 0.2489040
	speed: 0.5303s/iter; left time: 631.6037s
	iters: 400, epoch: 9 | loss: 0.2332872
	speed: 0.5385s/iter; left time: 587.5370s
	iters: 500, epoch: 9 | loss: 0.2383024
	speed: 0.5359s/iter; left time: 531.0577s
	iters: 600, epoch: 9 | loss: 0.2151133
	speed: 0.5302s/iter; left time: 472.3751s
	iters: 700, epoch: 9 | loss: 0.1981772
	speed: 0.5303s/iter; left time: 419.5050s
Epoch: 9 cost time: 397.76329040527344
Epoch: 9, Steps: 745 | Train Loss: 0.2258314 Vali Loss: 0.3157720 Test Loss: 0.3760191
Validation loss decreased (0.316109 --> 0.315772).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1784282
	speed: 1.0702s/iter; left time: 691.3219s
	iters: 200, epoch: 10 | loss: 0.2303817
	speed: 0.5337s/iter; left time: 291.4165s
	iters: 300, epoch: 10 | loss: 0.2890323
	speed: 0.5311s/iter; left time: 236.8739s
	iters: 400, epoch: 10 | loss: 0.2558605
	speed: 0.5322s/iter; left time: 184.1373s
	iters: 500, epoch: 10 | loss: 0.2150641
	speed: 0.5332s/iter; left time: 131.1648s
	iters: 600, epoch: 10 | loss: 0.1816933
	speed: 0.5319s/iter; left time: 77.6631s
	iters: 700, epoch: 10 | loss: 0.2523702
	speed: 0.5298s/iter; left time: 24.3701s
Epoch: 10 cost time: 397.1948013305664
Epoch: 10, Steps: 745 | Train Loss: 0.2257553 Vali Loss: 0.3160440 Test Loss: 0.3759762
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_12_RLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3497
mse:0.37624651193618774, mae:0.27443820238113403
