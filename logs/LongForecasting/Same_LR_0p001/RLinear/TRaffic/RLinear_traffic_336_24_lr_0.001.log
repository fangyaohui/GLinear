Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='traffic_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_24_RLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11921
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.3533788
	speed: 0.5445s/iter; left time: 4002.5297s
	iters: 200, epoch: 1 | loss: 0.3130973
	speed: 0.5397s/iter; left time: 3913.3001s
	iters: 300, epoch: 1 | loss: 0.2749548
	speed: 0.5543s/iter; left time: 3963.7349s
	iters: 400, epoch: 1 | loss: 0.2818910
	speed: 0.5364s/iter; left time: 3782.4030s
	iters: 500, epoch: 1 | loss: 0.2592545
	speed: 0.5403s/iter; left time: 3755.8984s
	iters: 600, epoch: 1 | loss: 0.2731965
	speed: 0.5355s/iter; left time: 3668.9273s
	iters: 700, epoch: 1 | loss: 0.2466588
	speed: 0.5588s/iter; left time: 3772.4300s
Epoch: 1 cost time: 405.71271109580994
Epoch: 1, Steps: 745 | Train Loss: 0.3163941 Vali Loss: 0.3484370 Test Loss: 0.4168711
Validation loss decreased (inf --> 0.348437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3196549
	speed: 1.1065s/iter; left time: 7309.4013s
	iters: 200, epoch: 2 | loss: 0.2175758
	speed: 0.5358s/iter; left time: 3486.1550s
	iters: 300, epoch: 2 | loss: 0.2435999
	speed: 0.5562s/iter; left time: 3563.1905s
	iters: 400, epoch: 2 | loss: 0.2430868
	speed: 0.5377s/iter; left time: 3390.7548s
	iters: 500, epoch: 2 | loss: 0.2423021
	speed: 0.5371s/iter; left time: 3333.3279s
	iters: 600, epoch: 2 | loss: 0.2425863
	speed: 0.5443s/iter; left time: 3323.4622s
	iters: 700, epoch: 2 | loss: 0.2758633
	speed: 0.5464s/iter; left time: 3281.8034s
Epoch: 2 cost time: 407.25800466537476
Epoch: 2, Steps: 745 | Train Loss: 0.2568133 Vali Loss: 0.3423771 Test Loss: 0.4063770
Validation loss decreased (0.348437 --> 0.342377).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1902025
	speed: 1.1191s/iter; left time: 6559.1661s
	iters: 200, epoch: 3 | loss: 0.2191296
	speed: 0.5361s/iter; left time: 3088.5090s
	iters: 300, epoch: 3 | loss: 0.2055267
	speed: 0.5553s/iter; left time: 3143.2796s
	iters: 400, epoch: 3 | loss: 0.2142868
	speed: 0.5777s/iter; left time: 3212.4909s
	iters: 500, epoch: 3 | loss: 0.2579474
	speed: 0.5575s/iter; left time: 3044.3614s
	iters: 600, epoch: 3 | loss: 0.2488162
	speed: 0.5680s/iter; left time: 3045.2492s
	iters: 700, epoch: 3 | loss: 0.2719085
	speed: 0.5435s/iter; left time: 2859.2800s
Epoch: 3 cost time: 415.8163483142853
Epoch: 3, Steps: 745 | Train Loss: 0.2437849 Vali Loss: 0.3314581 Test Loss: 0.3930962
Validation loss decreased (0.342377 --> 0.331458).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2010734
	speed: 1.1148s/iter; left time: 5703.3310s
	iters: 200, epoch: 4 | loss: 0.2182655
	speed: 0.5765s/iter; left time: 2891.8029s
	iters: 300, epoch: 4 | loss: 0.2529218
	speed: 0.5910s/iter; left time: 2905.3179s
	iters: 400, epoch: 4 | loss: 0.2682816
	speed: 0.6058s/iter; left time: 2917.3239s
	iters: 500, epoch: 4 | loss: 0.2806954
	speed: 0.5550s/iter; left time: 2617.5879s
	iters: 600, epoch: 4 | loss: 0.1991491
	speed: 0.5516s/iter; left time: 2546.3192s
	iters: 700, epoch: 4 | loss: 0.2063055
	speed: 0.5593s/iter; left time: 2525.8414s
Epoch: 4 cost time: 423.2558162212372
Epoch: 4, Steps: 745 | Train Loss: 0.2377042 Vali Loss: 0.3270261 Test Loss: 0.3880603
Validation loss decreased (0.331458 --> 0.327026).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3232796
	speed: 1.1167s/iter; left time: 4880.9722s
	iters: 200, epoch: 5 | loss: 0.2611890
	speed: 0.5458s/iter; left time: 2331.2947s
	iters: 300, epoch: 5 | loss: 0.2061806
	speed: 0.5389s/iter; left time: 2247.5823s
	iters: 400, epoch: 5 | loss: 0.2156730
	speed: 0.5374s/iter; left time: 2187.6469s
	iters: 500, epoch: 5 | loss: 0.2433027
	speed: 0.5810s/iter; left time: 2307.2744s
	iters: 600, epoch: 5 | loss: 0.2466664
	speed: 0.5645s/iter; left time: 2185.2609s
	iters: 700, epoch: 5 | loss: 0.2605280
	speed: 0.5556s/iter; left time: 2095.2436s
Epoch: 5 cost time: 415.0647988319397
Epoch: 5, Steps: 745 | Train Loss: 0.2346209 Vali Loss: 0.3244593 Test Loss: 0.3849927
Validation loss decreased (0.327026 --> 0.324459).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1957797
	speed: 1.0854s/iter; left time: 3935.5983s
	iters: 200, epoch: 6 | loss: 0.2162395
	speed: 0.5293s/iter; left time: 1866.2486s
	iters: 300, epoch: 6 | loss: 0.2250076
	speed: 0.5496s/iter; left time: 1882.9547s
	iters: 400, epoch: 6 | loss: 0.2015776
	speed: 0.5764s/iter; left time: 1917.0092s
	iters: 500, epoch: 6 | loss: 0.1911297
	speed: 0.5681s/iter; left time: 1832.8434s
	iters: 600, epoch: 6 | loss: 0.2212535
	speed: 0.5394s/iter; left time: 1686.1717s
	iters: 700, epoch: 6 | loss: 0.2057226
	speed: 0.5540s/iter; left time: 1676.2777s
Epoch: 6 cost time: 410.3580687046051
Epoch: 6, Steps: 745 | Train Loss: 0.2329990 Vali Loss: 0.3231938 Test Loss: 0.3839579
Validation loss decreased (0.324459 --> 0.323194).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2223213
	speed: 1.0777s/iter; left time: 3104.7632s
	iters: 200, epoch: 7 | loss: 0.2068718
	speed: 0.5525s/iter; left time: 1536.5378s
	iters: 300, epoch: 7 | loss: 0.2402852
	speed: 0.5412s/iter; left time: 1451.0730s
	iters: 400, epoch: 7 | loss: 0.2089060
	speed: 0.6385s/iter; left time: 1648.0183s
	iters: 500, epoch: 7 | loss: 0.2284306
	speed: 0.5781s/iter; left time: 1434.3589s
	iters: 600, epoch: 7 | loss: 0.3432293
	speed: 0.5326s/iter; left time: 1268.2199s
	iters: 700, epoch: 7 | loss: 0.2276090
	speed: 0.5314s/iter; left time: 1212.2190s
Epoch: 7 cost time: 416.96471881866455
Epoch: 7, Steps: 745 | Train Loss: 0.2321500 Vali Loss: 0.3229199 Test Loss: 0.3835756
Validation loss decreased (0.323194 --> 0.322920).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2468759
	speed: 1.1012s/iter; left time: 2352.1209s
	iters: 200, epoch: 8 | loss: 0.2865519
	speed: 0.5488s/iter; left time: 1117.3655s
	iters: 300, epoch: 8 | loss: 0.1999719
	speed: 0.5508s/iter; left time: 1066.3038s
	iters: 400, epoch: 8 | loss: 0.3288440
	speed: 0.5417s/iter; left time: 994.5242s
	iters: 500, epoch: 8 | loss: 0.2446660
	speed: 0.5383s/iter; left time: 934.5754s
	iters: 600, epoch: 8 | loss: 0.2612536
	speed: 0.5737s/iter; left time: 938.5043s
	iters: 700, epoch: 8 | loss: 0.2410520
	speed: 0.5416s/iter; left time: 831.8742s
Epoch: 8 cost time: 412.2509665489197
Epoch: 8, Steps: 745 | Train Loss: 0.2316844 Vali Loss: 0.3226261 Test Loss: 0.3833983
Validation loss decreased (0.322920 --> 0.322626).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2070300
	speed: 1.1410s/iter; left time: 1587.1423s
	iters: 200, epoch: 9 | loss: 0.2265692
	speed: 0.5529s/iter; left time: 713.8393s
	iters: 300, epoch: 9 | loss: 0.2478017
	speed: 0.5388s/iter; left time: 641.7573s
	iters: 400, epoch: 9 | loss: 0.1945575
	speed: 0.5887s/iter; left time: 642.2952s
	iters: 500, epoch: 9 | loss: 0.1846124
	speed: 0.5393s/iter; left time: 534.4385s
	iters: 600, epoch: 9 | loss: 0.2209384
	speed: 0.5541s/iter; left time: 493.6935s
	iters: 700, epoch: 9 | loss: 0.2207215
	speed: 0.5804s/iter; left time: 459.1139s
Epoch: 9 cost time: 417.97965002059937
Epoch: 9, Steps: 745 | Train Loss: 0.2314483 Vali Loss: 0.3225689 Test Loss: 0.3832088
Validation loss decreased (0.322626 --> 0.322569).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2257614
	speed: 1.1582s/iter; left time: 748.1880s
	iters: 200, epoch: 10 | loss: 0.2127152
	speed: 0.5610s/iter; left time: 306.2940s
	iters: 300, epoch: 10 | loss: 0.2213583
	speed: 0.5553s/iter; left time: 247.6493s
	iters: 400, epoch: 10 | loss: 0.2307028
	speed: 0.5475s/iter; left time: 189.4437s
	iters: 500, epoch: 10 | loss: 0.2157295
	speed: 0.5391s/iter; left time: 132.6155s
	iters: 600, epoch: 10 | loss: 0.2383588
	speed: 0.5416s/iter; left time: 79.0720s
	iters: 700, epoch: 10 | loss: 0.2306017
	speed: 0.5757s/iter; left time: 26.4827s
Epoch: 10 cost time: 416.3013188838959
Epoch: 10, Steps: 745 | Train Loss: 0.2312765 Vali Loss: 0.3226250 Test Loss: 0.3831747
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_24_RLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.3833736181259155, mae:0.27748459577560425
