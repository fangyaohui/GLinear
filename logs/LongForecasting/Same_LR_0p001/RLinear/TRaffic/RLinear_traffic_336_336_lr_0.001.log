Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_RLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.3893622
	speed: 0.6697s/iter; left time: 4788.6939s
	iters: 200, epoch: 1 | loss: 0.3660307
	speed: 0.6610s/iter; left time: 4660.4857s
	iters: 300, epoch: 1 | loss: 0.3146661
	speed: 0.6526s/iter; left time: 4536.2513s
	iters: 400, epoch: 1 | loss: 0.3384289
	speed: 0.6665s/iter; left time: 4566.4375s
	iters: 500, epoch: 1 | loss: 0.2988491
	speed: 0.6555s/iter; left time: 4425.0699s
	iters: 600, epoch: 1 | loss: 0.2925528
	speed: 0.6552s/iter; left time: 4358.0081s
	iters: 700, epoch: 1 | loss: 0.3092481
	speed: 0.6479s/iter; left time: 4244.4997s
Epoch: 1 cost time: 478.3831670284271
Epoch: 1, Steps: 725 | Train Loss: 0.3490048 Vali Loss: 0.3856997 Test Loss: 0.4790324
Validation loss decreased (inf --> 0.385700).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2650518
	speed: 1.2123s/iter; left time: 7789.9610s
	iters: 200, epoch: 2 | loss: 0.2934587
	speed: 0.6451s/iter; left time: 4081.0449s
	iters: 300, epoch: 2 | loss: 0.2889806
	speed: 0.6465s/iter; left time: 4025.3724s
	iters: 400, epoch: 2 | loss: 0.2890625
	speed: 0.6430s/iter; left time: 3939.1168s
	iters: 500, epoch: 2 | loss: 0.2858556
	speed: 0.6488s/iter; left time: 3909.8322s
	iters: 600, epoch: 2 | loss: 0.3005389
	speed: 0.6410s/iter; left time: 3798.7072s
	iters: 700, epoch: 2 | loss: 0.2915957
	speed: 0.6418s/iter; left time: 3738.8430s
Epoch: 2 cost time: 469.0344021320343
Epoch: 2, Steps: 725 | Train Loss: 0.2919321 Vali Loss: 0.3788192 Test Loss: 0.4697208
Validation loss decreased (0.385700 --> 0.378819).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2781045
	speed: 1.2011s/iter; left time: 6847.4803s
	iters: 200, epoch: 3 | loss: 0.2610180
	speed: 0.6541s/iter; left time: 3663.7181s
	iters: 300, epoch: 3 | loss: 0.2719555
	speed: 0.6424s/iter; left time: 3533.8088s
	iters: 400, epoch: 3 | loss: 0.2802686
	speed: 0.6422s/iter; left time: 3468.6453s
	iters: 500, epoch: 3 | loss: 0.2725466
	speed: 0.6512s/iter; left time: 3451.8819s
	iters: 600, epoch: 3 | loss: 0.2939600
	speed: 0.6520s/iter; left time: 3391.0942s
	iters: 700, epoch: 3 | loss: 0.3053084
	speed: 0.6306s/iter; left time: 3216.4860s
Epoch: 3 cost time: 469.65122723579407
Epoch: 3, Steps: 725 | Train Loss: 0.2784277 Vali Loss: 0.3680961 Test Loss: 0.4567800
Validation loss decreased (0.378819 --> 0.368096).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2533590
	speed: 1.1674s/iter; left time: 5809.1447s
	iters: 200, epoch: 4 | loss: 0.2612362
	speed: 0.6440s/iter; left time: 3140.0397s
	iters: 300, epoch: 4 | loss: 0.2610924
	speed: 0.6371s/iter; left time: 3043.0252s
	iters: 400, epoch: 4 | loss: 0.2712492
	speed: 0.6327s/iter; left time: 2958.3748s
	iters: 500, epoch: 4 | loss: 0.2582853
	speed: 0.6319s/iter; left time: 2891.4745s
	iters: 600, epoch: 4 | loss: 0.2777346
	speed: 0.6698s/iter; left time: 2998.0699s
	iters: 700, epoch: 4 | loss: 0.2914217
	speed: 0.6573s/iter; left time: 2876.5035s
Epoch: 4 cost time: 466.2363018989563
Epoch: 4, Steps: 725 | Train Loss: 0.2719836 Vali Loss: 0.3635302 Test Loss: 0.4512553
Validation loss decreased (0.368096 --> 0.363530).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2679213
	speed: 1.1702s/iter; left time: 4974.5191s
	iters: 200, epoch: 5 | loss: 0.3008269
	speed: 0.6295s/iter; left time: 2612.9380s
	iters: 300, epoch: 5 | loss: 0.2658193
	speed: 0.6347s/iter; left time: 2571.0785s
	iters: 400, epoch: 5 | loss: 0.2774914
	speed: 0.6630s/iter; left time: 2619.5432s
	iters: 500, epoch: 5 | loss: 0.2614494
	speed: 0.6564s/iter; left time: 2527.7657s
	iters: 600, epoch: 5 | loss: 0.2440342
	speed: 0.6479s/iter; left time: 2430.3204s
	iters: 700, epoch: 5 | loss: 0.2864830
	speed: 0.6610s/iter; left time: 2413.2694s
Epoch: 5 cost time: 469.33422923088074
Epoch: 5, Steps: 725 | Train Loss: 0.2687542 Vali Loss: 0.3609748 Test Loss: 0.4483120
Validation loss decreased (0.363530 --> 0.360975).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2937701
	speed: 1.2089s/iter; left time: 4262.6653s
	iters: 200, epoch: 6 | loss: 0.2597641
	speed: 0.6642s/iter; left time: 2275.4825s
	iters: 300, epoch: 6 | loss: 0.2570138
	speed: 0.6772s/iter; left time: 2252.5292s
	iters: 400, epoch: 6 | loss: 0.2504748
	speed: 0.6627s/iter; left time: 2137.7768s
	iters: 500, epoch: 6 | loss: 0.2791905
	speed: 0.6490s/iter; left time: 2028.7078s
	iters: 600, epoch: 6 | loss: 0.2619701
	speed: 0.6548s/iter; left time: 1981.4520s
	iters: 700, epoch: 6 | loss: 0.2507020
	speed: 0.6641s/iter; left time: 1943.1114s
Epoch: 6 cost time: 479.537855386734
Epoch: 6, Steps: 725 | Train Loss: 0.2670456 Vali Loss: 0.3602144 Test Loss: 0.4471028
Validation loss decreased (0.360975 --> 0.360214).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2707541
	speed: 1.2246s/iter; left time: 3430.2439s
	iters: 200, epoch: 7 | loss: 0.2670292
	speed: 0.6434s/iter; left time: 1737.8672s
	iters: 300, epoch: 7 | loss: 0.2709021
	speed: 0.6722s/iter; left time: 1748.3828s
	iters: 400, epoch: 7 | loss: 0.2446198
	speed: 0.6476s/iter; left time: 1619.5922s
	iters: 500, epoch: 7 | loss: 0.2843271
	speed: 0.6590s/iter; left time: 1582.2607s
	iters: 600, epoch: 7 | loss: 0.2692640
	speed: 0.6463s/iter; left time: 1487.1711s
	iters: 700, epoch: 7 | loss: 0.2682499
	speed: 0.6498s/iter; left time: 1430.2138s
Epoch: 7 cost time: 475.32507038116455
Epoch: 7, Steps: 725 | Train Loss: 0.2661276 Vali Loss: 0.3596092 Test Loss: 0.4465502
Validation loss decreased (0.360214 --> 0.359609).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2607189
	speed: 1.1804s/iter; left time: 2450.4990s
	iters: 200, epoch: 8 | loss: 0.2802886
	speed: 0.6607s/iter; left time: 1305.5746s
	iters: 300, epoch: 8 | loss: 0.2748992
	speed: 0.6582s/iter; left time: 1234.7382s
	iters: 400, epoch: 8 | loss: 0.2477227
	speed: 0.6350s/iter; left time: 1127.7788s
	iters: 500, epoch: 8 | loss: 0.2567405
	speed: 0.6494s/iter; left time: 1088.4347s
	iters: 600, epoch: 8 | loss: 0.2685975
	speed: 0.6477s/iter; left time: 1020.7878s
	iters: 700, epoch: 8 | loss: 0.2520521
	speed: 0.6463s/iter; left time: 953.9821s
Epoch: 8 cost time: 471.5819089412689
Epoch: 8, Steps: 725 | Train Loss: 0.2656085 Vali Loss: 0.3591932 Test Loss: 0.4463308
Validation loss decreased (0.359609 --> 0.359193).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2909450
	speed: 1.1976s/iter; left time: 1617.8932s
	iters: 200, epoch: 9 | loss: 0.2827207
	speed: 0.6539s/iter; left time: 818.0153s
	iters: 300, epoch: 9 | loss: 0.2921350
	speed: 0.6527s/iter; left time: 751.3065s
	iters: 400, epoch: 9 | loss: 0.2747819
	speed: 0.6302s/iter; left time: 662.3658s
	iters: 500, epoch: 9 | loss: 0.2604715
	speed: 0.6357s/iter; left time: 604.5497s
	iters: 600, epoch: 9 | loss: 0.2608370
	speed: 0.6617s/iter; left time: 563.1289s
	iters: 700, epoch: 9 | loss: 0.2825515
	speed: 0.6626s/iter; left time: 497.6417s
Epoch: 9 cost time: 470.7882807254791
Epoch: 9, Steps: 725 | Train Loss: 0.2654041 Vali Loss: 0.3592117 Test Loss: 0.4461743
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2679940
	speed: 1.1924s/iter; left time: 746.4609s
	iters: 200, epoch: 10 | loss: 0.2912369
	speed: 0.6612s/iter; left time: 347.7649s
	iters: 300, epoch: 10 | loss: 0.2843870
	speed: 0.6466s/iter; left time: 275.4612s
	iters: 400, epoch: 10 | loss: 0.2515401
	speed: 0.6536s/iter; left time: 213.0856s
	iters: 500, epoch: 10 | loss: 0.2832434
	speed: 0.6771s/iter; left time: 153.0287s
	iters: 600, epoch: 10 | loss: 0.2874876
	speed: 0.6517s/iter; left time: 82.1197s
	iters: 700, epoch: 10 | loss: 0.2615753
	speed: 0.6810s/iter; left time: 17.7065s
Epoch: 10 cost time: 479.18972873687744
Epoch: 10, Steps: 725 | Train Loss: 0.2652785 Vali Loss: 0.3591730 Test Loss: 0.4461381
Validation loss decreased (0.359193 --> 0.359173).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_336_RLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.44506967067718506, mae:0.30271831154823303
