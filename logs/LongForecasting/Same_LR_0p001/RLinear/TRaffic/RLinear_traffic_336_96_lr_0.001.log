Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_RLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.3868367
	speed: 0.6041s/iter; left time: 4410.8947s
	iters: 200, epoch: 1 | loss: 0.3264235
	speed: 0.6232s/iter; left time: 4487.3994s
	iters: 300, epoch: 1 | loss: 0.3008300
	speed: 0.6171s/iter; left time: 4382.1383s
	iters: 400, epoch: 1 | loss: 0.2872028
	speed: 0.6080s/iter; left time: 4256.3213s
	iters: 500, epoch: 1 | loss: 0.2922424
	speed: 0.5968s/iter; left time: 4118.2550s
	iters: 600, epoch: 1 | loss: 0.2775861
	speed: 0.5913s/iter; left time: 4021.3333s
	iters: 700, epoch: 1 | loss: 0.3054928
	speed: 0.6002s/iter; left time: 4021.9571s
Epoch: 1 cost time: 448.37314915657043
Epoch: 1, Steps: 740 | Train Loss: 0.3316535 Vali Loss: 0.3660083 Test Loss: 0.4518158
Validation loss decreased (inf --> 0.366008).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2891972
	speed: 1.2201s/iter; left time: 8004.8628s
	iters: 200, epoch: 2 | loss: 0.2942497
	speed: 0.6234s/iter; left time: 4027.9464s
	iters: 300, epoch: 2 | loss: 0.2984975
	speed: 0.6178s/iter; left time: 3929.6402s
	iters: 400, epoch: 2 | loss: 0.2545145
	speed: 0.6034s/iter; left time: 3777.7286s
	iters: 500, epoch: 2 | loss: 0.2548743
	speed: 0.6051s/iter; left time: 3727.8980s
	iters: 600, epoch: 2 | loss: 0.3053980
	speed: 0.6085s/iter; left time: 3687.8684s
	iters: 700, epoch: 2 | loss: 0.2769352
	speed: 0.6263s/iter; left time: 3733.1790s
Epoch: 2 cost time: 454.92394042015076
Epoch: 2, Steps: 740 | Train Loss: 0.2734442 Vali Loss: 0.3617078 Test Loss: 0.4431589
Validation loss decreased (0.366008 --> 0.361708).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2498392
	speed: 1.1995s/iter; left time: 6982.1502s
	iters: 200, epoch: 3 | loss: 0.2515678
	speed: 0.6052s/iter; left time: 3462.0912s
	iters: 300, epoch: 3 | loss: 0.2368715
	speed: 0.6103s/iter; left time: 3430.2846s
	iters: 400, epoch: 3 | loss: 0.2956558
	speed: 0.5979s/iter; left time: 3301.2751s
	iters: 500, epoch: 3 | loss: 0.2555150
	speed: 0.6146s/iter; left time: 3331.8289s
	iters: 600, epoch: 3 | loss: 0.2485670
	speed: 0.6053s/iter; left time: 3220.6541s
	iters: 700, epoch: 3 | loss: 0.3118243
	speed: 0.6089s/iter; left time: 3179.2036s
Epoch: 3 cost time: 449.0906684398651
Epoch: 3, Steps: 740 | Train Loss: 0.2600862 Vali Loss: 0.3503314 Test Loss: 0.4291711
Validation loss decreased (0.361708 --> 0.350331).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2710152
	speed: 1.1854s/iter; left time: 6023.0144s
	iters: 200, epoch: 4 | loss: 0.2568342
	speed: 0.6135s/iter; left time: 3055.8075s
	iters: 300, epoch: 4 | loss: 0.2431483
	speed: 0.6024s/iter; left time: 2940.4654s
	iters: 400, epoch: 4 | loss: 0.2314085
	speed: 0.5960s/iter; left time: 2849.4557s
	iters: 500, epoch: 4 | loss: 0.2342399
	speed: 0.5976s/iter; left time: 2797.5720s
	iters: 600, epoch: 4 | loss: 0.2605881
	speed: 0.6172s/iter; left time: 2827.5251s
	iters: 700, epoch: 4 | loss: 0.3151280
	speed: 0.6008s/iter; left time: 2692.1578s
Epoch: 4 cost time: 446.87232542037964
Epoch: 4, Steps: 740 | Train Loss: 0.2539400 Vali Loss: 0.3450724 Test Loss: 0.4235135
Validation loss decreased (0.350331 --> 0.345072).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2616374
	speed: 1.2102s/iter; left time: 5253.4497s
	iters: 200, epoch: 5 | loss: 0.2400876
	speed: 0.5950s/iter; left time: 2523.6005s
	iters: 300, epoch: 5 | loss: 0.2432790
	speed: 0.6175s/iter; left time: 2556.9955s
	iters: 400, epoch: 5 | loss: 0.2482201
	speed: 0.6117s/iter; left time: 2471.7701s
	iters: 500, epoch: 5 | loss: 0.2419517
	speed: 0.6123s/iter; left time: 2413.0828s
	iters: 600, epoch: 5 | loss: 0.2584773
	speed: 0.6118s/iter; left time: 2349.8232s
	iters: 700, epoch: 5 | loss: 0.2625865
	speed: 0.6145s/iter; left time: 2298.7734s
Epoch: 5 cost time: 453.4349911212921
Epoch: 5, Steps: 740 | Train Loss: 0.2507280 Vali Loss: 0.3427318 Test Loss: 0.4210604
Validation loss decreased (0.345072 --> 0.342732).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2568226
	speed: 1.2414s/iter; left time: 4470.3385s
	iters: 200, epoch: 6 | loss: 0.2519624
	speed: 0.5928s/iter; left time: 2075.3497s
	iters: 300, epoch: 6 | loss: 0.2516589
	speed: 0.6243s/iter; left time: 2123.3622s
	iters: 400, epoch: 6 | loss: 0.2419437
	speed: 0.6178s/iter; left time: 2039.2603s
	iters: 500, epoch: 6 | loss: 0.2737708
	speed: 0.6214s/iter; left time: 1989.1915s
	iters: 600, epoch: 6 | loss: 0.2787629
	speed: 0.6355s/iter; left time: 1970.8005s
	iters: 700, epoch: 6 | loss: 0.2357509
	speed: 0.6291s/iter; left time: 1887.8145s
Epoch: 6 cost time: 459.6763277053833
Epoch: 6, Steps: 740 | Train Loss: 0.2491069 Vali Loss: 0.3418441 Test Loss: 0.4200293
Validation loss decreased (0.342732 --> 0.341844).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2362109
	speed: 1.2385s/iter; left time: 3543.3060s
	iters: 200, epoch: 7 | loss: 0.2665490
	speed: 0.6157s/iter; left time: 1699.9284s
	iters: 300, epoch: 7 | loss: 0.2391887
	speed: 0.6228s/iter; left time: 1657.2993s
	iters: 400, epoch: 7 | loss: 0.2356121
	speed: 0.6155s/iter; left time: 1576.2146s
	iters: 500, epoch: 7 | loss: 0.2326583
	speed: 0.6122s/iter; left time: 1506.5818s
	iters: 600, epoch: 7 | loss: 0.2462951
	speed: 0.6275s/iter; left time: 1481.4461s
	iters: 700, epoch: 7 | loss: 0.2234897
	speed: 0.6168s/iter; left time: 1394.5619s
Epoch: 7 cost time: 458.9045522212982
Epoch: 7, Steps: 740 | Train Loss: 0.2482388 Vali Loss: 0.3406955 Test Loss: 0.4191840
Validation loss decreased (0.341844 --> 0.340695).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2677033
	speed: 1.1992s/iter; left time: 2543.4098s
	iters: 200, epoch: 8 | loss: 0.2672296
	speed: 0.5980s/iter; left time: 1208.5637s
	iters: 300, epoch: 8 | loss: 0.2570243
	speed: 0.6071s/iter; left time: 1166.1476s
	iters: 400, epoch: 8 | loss: 0.2152972
	speed: 0.6298s/iter; left time: 1146.9045s
	iters: 500, epoch: 8 | loss: 0.2777649
	speed: 0.6122s/iter; left time: 1053.5427s
	iters: 600, epoch: 8 | loss: 0.2119804
	speed: 0.6100s/iter; left time: 988.8668s
	iters: 700, epoch: 8 | loss: 0.2545490
	speed: 0.5996s/iter; left time: 912.0353s
Epoch: 8 cost time: 450.89780354499817
Epoch: 8, Steps: 740 | Train Loss: 0.2477628 Vali Loss: 0.3408458 Test Loss: 0.4189562
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2816197
	speed: 1.1995s/iter; left time: 1656.5231s
	iters: 200, epoch: 9 | loss: 0.2083402
	speed: 0.6026s/iter; left time: 771.9453s
	iters: 300, epoch: 9 | loss: 0.2319416
	speed: 0.6106s/iter; left time: 721.1480s
	iters: 400, epoch: 9 | loss: 0.2604543
	speed: 0.6082s/iter; left time: 657.4623s
	iters: 500, epoch: 9 | loss: 0.2234781
	speed: 0.6160s/iter; left time: 604.2769s
	iters: 600, epoch: 9 | loss: 0.2108623
	speed: 0.6029s/iter; left time: 531.1590s
	iters: 700, epoch: 9 | loss: 0.2565496
	speed: 0.6118s/iter; left time: 477.8081s
Epoch: 9 cost time: 450.02681827545166
Epoch: 9, Steps: 740 | Train Loss: 0.2474460 Vali Loss: 0.3410690 Test Loss: 0.4189141
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2245402
	speed: 1.2317s/iter; left time: 789.4917s
	iters: 200, epoch: 10 | loss: 0.2831804
	speed: 0.6031s/iter; left time: 326.2981s
	iters: 300, epoch: 10 | loss: 0.2276070
	speed: 0.6187s/iter; left time: 272.8661s
	iters: 400, epoch: 10 | loss: 0.2680678
	speed: 0.6226s/iter; left time: 212.3155s
	iters: 500, epoch: 10 | loss: 0.2651557
	speed: 0.6080s/iter; left time: 146.5311s
	iters: 600, epoch: 10 | loss: 0.2521931
	speed: 0.6040s/iter; left time: 85.1648s
	iters: 700, epoch: 10 | loss: 0.2355977
	speed: 0.6110s/iter; left time: 25.0523s
Epoch: 10 cost time: 453.3459470272064
Epoch: 10, Steps: 740 | Train Loss: 0.2473582 Vali Loss: 0.3411571 Test Loss: 0.4188395
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_336_96_RLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.41944533586502075, mae:0.2920832335948944
