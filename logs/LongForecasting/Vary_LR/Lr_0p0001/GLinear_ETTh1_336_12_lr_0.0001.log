Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='GLinear', model_id='ETTh1_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_12_GLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8293
val 2869
test 2869
	iters: 100, epoch: 1 | loss: 0.3865133
	speed: 0.0112s/iter; left time: 115.1442s
	iters: 200, epoch: 1 | loss: 0.3324949
	speed: 0.0048s/iter; left time: 49.2124s
	iters: 300, epoch: 1 | loss: 0.3326878
	speed: 0.0050s/iter; left time: 49.9291s
	iters: 400, epoch: 1 | loss: 0.3369353
	speed: 0.0045s/iter; left time: 44.6461s
	iters: 500, epoch: 1 | loss: 0.2459248
	speed: 0.0046s/iter; left time: 45.2315s
	iters: 600, epoch: 1 | loss: 0.3793485
	speed: 0.0047s/iter; left time: 45.9296s
	iters: 700, epoch: 1 | loss: 0.2498990
	speed: 0.0050s/iter; left time: 48.3059s
	iters: 800, epoch: 1 | loss: 0.2209809
	speed: 0.0049s/iter; left time: 46.4507s
	iters: 900, epoch: 1 | loss: 0.3302576
	speed: 0.0055s/iter; left time: 51.7488s
	iters: 1000, epoch: 1 | loss: 0.1868179
	speed: 0.0056s/iter; left time: 52.0667s
Epoch: 1 cost time: 5.822555780410767
Epoch: 1, Steps: 1036 | Train Loss: 0.2973027 Vali Loss: 0.3685954 Test Loss: 0.3388946
Validation loss decreased (inf --> 0.368595).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1713013
	speed: 0.0527s/iter; left time: 486.5417s
	iters: 200, epoch: 2 | loss: 0.2058508
	speed: 0.0045s/iter; left time: 41.1576s
	iters: 300, epoch: 2 | loss: 0.1234221
	speed: 0.0048s/iter; left time: 43.0002s
	iters: 400, epoch: 2 | loss: 0.2046210
	speed: 0.0047s/iter; left time: 41.8069s
	iters: 500, epoch: 2 | loss: 0.1830305
	speed: 0.0044s/iter; left time: 39.2505s
	iters: 600, epoch: 2 | loss: 0.3153626
	speed: 0.0047s/iter; left time: 41.0719s
	iters: 700, epoch: 2 | loss: 0.2516679
	speed: 0.0046s/iter; left time: 39.6144s
	iters: 800, epoch: 2 | loss: 0.1404447
	speed: 0.0044s/iter; left time: 37.9214s
	iters: 900, epoch: 2 | loss: 0.1824093
	speed: 0.0048s/iter; left time: 40.1146s
	iters: 1000, epoch: 2 | loss: 0.2148929
	speed: 0.0044s/iter; left time: 37.0080s
Epoch: 2 cost time: 5.598741054534912
Epoch: 2, Steps: 1036 | Train Loss: 0.2328821 Vali Loss: 0.3476345 Test Loss: 0.3200319
Validation loss decreased (0.368595 --> 0.347634).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1817524
	speed: 0.0510s/iter; left time: 417.7487s
	iters: 200, epoch: 3 | loss: 0.3185448
	speed: 0.0044s/iter; left time: 35.4172s
	iters: 300, epoch: 3 | loss: 0.1572794
	speed: 0.0045s/iter; left time: 35.8408s
	iters: 400, epoch: 3 | loss: 0.2389698
	speed: 0.0050s/iter; left time: 39.2156s
	iters: 500, epoch: 3 | loss: 0.2432957
	speed: 0.0045s/iter; left time: 35.4315s
	iters: 600, epoch: 3 | loss: 0.2435680
	speed: 0.0048s/iter; left time: 36.9414s
	iters: 700, epoch: 3 | loss: 0.1403456
	speed: 0.0049s/iter; left time: 36.9369s
	iters: 800, epoch: 3 | loss: 0.3697762
	speed: 0.0047s/iter; left time: 34.9831s
	iters: 900, epoch: 3 | loss: 0.2559255
	speed: 0.0048s/iter; left time: 35.7798s
	iters: 1000, epoch: 3 | loss: 0.1578190
	speed: 0.0047s/iter; left time: 34.2538s
Epoch: 3 cost time: 5.7185869216918945
Epoch: 3, Steps: 1036 | Train Loss: 0.2188117 Vali Loss: 0.3425891 Test Loss: 0.3135410
Validation loss decreased (0.347634 --> 0.342589).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1419792
	speed: 0.0520s/iter; left time: 371.5991s
	iters: 200, epoch: 4 | loss: 0.2871022
	speed: 0.0050s/iter; left time: 35.2620s
	iters: 300, epoch: 4 | loss: 0.1507666
	speed: 0.0049s/iter; left time: 34.1129s
	iters: 400, epoch: 4 | loss: 0.2761230
	speed: 0.0049s/iter; left time: 33.5689s
	iters: 500, epoch: 4 | loss: 0.1665172
	speed: 0.0046s/iter; left time: 30.8574s
	iters: 600, epoch: 4 | loss: 0.1375100
	speed: 0.0049s/iter; left time: 32.3706s
	iters: 700, epoch: 4 | loss: 0.1135142
	speed: 0.0046s/iter; left time: 30.2125s
	iters: 800, epoch: 4 | loss: 0.2235195
	speed: 0.0053s/iter; left time: 33.9276s
	iters: 900, epoch: 4 | loss: 0.1974614
	speed: 0.0050s/iter; left time: 32.0789s
	iters: 1000, epoch: 4 | loss: 0.2706388
	speed: 0.0050s/iter; left time: 31.0385s
Epoch: 4 cost time: 5.834027290344238
Epoch: 4, Steps: 1036 | Train Loss: 0.2134311 Vali Loss: 0.3414130 Test Loss: 0.3059082
Validation loss decreased (0.342589 --> 0.341413).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2266749
	speed: 0.0506s/iter; left time: 309.4530s
	iters: 200, epoch: 5 | loss: 0.1962468
	speed: 0.0046s/iter; left time: 27.4315s
	iters: 300, epoch: 5 | loss: 0.1636620
	speed: 0.0042s/iter; left time: 24.6217s
	iters: 400, epoch: 5 | loss: 0.1504922
	speed: 0.0041s/iter; left time: 23.9460s
	iters: 500, epoch: 5 | loss: 0.2851647
	speed: 0.0046s/iter; left time: 26.0716s
	iters: 600, epoch: 5 | loss: 0.1871359
	speed: 0.0049s/iter; left time: 27.5741s
	iters: 700, epoch: 5 | loss: 0.1832355
	speed: 0.0050s/iter; left time: 27.3203s
	iters: 800, epoch: 5 | loss: 0.1356597
	speed: 0.0045s/iter; left time: 24.5308s
	iters: 900, epoch: 5 | loss: 0.1194655
	speed: 0.0047s/iter; left time: 25.1288s
	iters: 1000, epoch: 5 | loss: 0.2269580
	speed: 0.0043s/iter; left time: 22.4897s
Epoch: 5 cost time: 5.438370704650879
Epoch: 5, Steps: 1036 | Train Loss: 0.2110905 Vali Loss: 0.3390178 Test Loss: 0.3053491
Validation loss decreased (0.341413 --> 0.339018).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1186615
	speed: 0.0505s/iter; left time: 256.8199s
	iters: 200, epoch: 6 | loss: 0.2712891
	speed: 0.0043s/iter; left time: 21.5261s
	iters: 300, epoch: 6 | loss: 0.1476149
	speed: 0.0048s/iter; left time: 23.5102s
	iters: 400, epoch: 6 | loss: 0.2798818
	speed: 0.0046s/iter; left time: 22.0925s
	iters: 500, epoch: 6 | loss: 0.3310630
	speed: 0.0046s/iter; left time: 21.3887s
	iters: 600, epoch: 6 | loss: 0.1216738
	speed: 0.0047s/iter; left time: 21.5081s
	iters: 700, epoch: 6 | loss: 0.1479474
	speed: 0.0041s/iter; left time: 18.3348s
	iters: 800, epoch: 6 | loss: 0.1783700
	speed: 0.0039s/iter; left time: 17.0895s
	iters: 900, epoch: 6 | loss: 0.1748610
	speed: 0.0042s/iter; left time: 18.1926s
	iters: 1000, epoch: 6 | loss: 0.2734121
	speed: 0.0049s/iter; left time: 20.5774s
Epoch: 6 cost time: 5.466767311096191
Epoch: 6, Steps: 1036 | Train Loss: 0.2098565 Vali Loss: 0.3407128 Test Loss: 0.3052145
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3776752
	speed: 0.0512s/iter; left time: 207.2386s
	iters: 200, epoch: 7 | loss: 0.3134666
	speed: 0.0045s/iter; left time: 17.7543s
	iters: 300, epoch: 7 | loss: 0.1765489
	speed: 0.0045s/iter; left time: 17.2138s
	iters: 400, epoch: 7 | loss: 0.1556677
	speed: 0.0047s/iter; left time: 17.6312s
	iters: 500, epoch: 7 | loss: 0.2268654
	speed: 0.0043s/iter; left time: 15.5183s
	iters: 600, epoch: 7 | loss: 0.1573007
	speed: 0.0048s/iter; left time: 16.8614s
	iters: 700, epoch: 7 | loss: 0.3252630
	speed: 0.0046s/iter; left time: 15.7067s
	iters: 800, epoch: 7 | loss: 0.3218799
	speed: 0.0044s/iter; left time: 14.8771s
	iters: 900, epoch: 7 | loss: 0.1528190
	speed: 0.0049s/iter; left time: 15.9953s
	iters: 1000, epoch: 7 | loss: 0.3125463
	speed: 0.0046s/iter; left time: 14.3325s
Epoch: 7 cost time: 5.5061094760894775
Epoch: 7, Steps: 1036 | Train Loss: 0.2092097 Vali Loss: 0.3409111 Test Loss: 0.3047936
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1928996
	speed: 0.0517s/iter; left time: 155.7087s
	iters: 200, epoch: 8 | loss: 0.2528533
	speed: 0.0044s/iter; left time: 12.8110s
	iters: 300, epoch: 8 | loss: 0.1864201
	speed: 0.0048s/iter; left time: 13.4689s
	iters: 400, epoch: 8 | loss: 0.2156241
	speed: 0.0050s/iter; left time: 13.6254s
	iters: 500, epoch: 8 | loss: 0.1975228
	speed: 0.0047s/iter; left time: 12.2730s
	iters: 600, epoch: 8 | loss: 0.2348875
	speed: 0.0048s/iter; left time: 12.1030s
	iters: 700, epoch: 8 | loss: 0.1437872
	speed: 0.0046s/iter; left time: 11.1408s
	iters: 800, epoch: 8 | loss: 0.2023416
	speed: 0.0045s/iter; left time: 10.3702s
	iters: 900, epoch: 8 | loss: 0.2366810
	speed: 0.0042s/iter; left time: 9.2671s
	iters: 1000, epoch: 8 | loss: 0.2032717
	speed: 0.0044s/iter; left time: 9.3227s
Epoch: 8 cost time: 5.5139288902282715
Epoch: 8, Steps: 1036 | Train Loss: 0.2090341 Vali Loss: 0.3397925 Test Loss: 0.3051201
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_12_GLinear_ETTh1_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2869
mse:0.30541449785232544, mae:0.35619327425956726
