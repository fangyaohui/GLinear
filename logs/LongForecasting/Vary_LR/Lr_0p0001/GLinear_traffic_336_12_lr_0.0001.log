Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='GLinear', model_id='traffic_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_12_GLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11933
val 1745
test 3497
	iters: 100, epoch: 1 | loss: 0.3812940
	speed: 0.0308s/iter; left time: 226.3253s
	iters: 200, epoch: 1 | loss: 0.4267674
	speed: 0.0269s/iter; left time: 195.0534s
	iters: 300, epoch: 1 | loss: 0.4163372
	speed: 0.0251s/iter; left time: 179.4060s
	iters: 400, epoch: 1 | loss: 0.2375869
	speed: 0.0261s/iter; left time: 184.2540s
	iters: 500, epoch: 1 | loss: 0.2995460
	speed: 0.0255s/iter; left time: 177.5165s
	iters: 600, epoch: 1 | loss: 0.2009104
	speed: 0.0273s/iter; left time: 187.3068s
	iters: 700, epoch: 1 | loss: 0.1828225
	speed: 0.0244s/iter; left time: 164.6392s
Epoch: 1 cost time: 19.710649728775024
Epoch: 1, Steps: 745 | Train Loss: 0.2996111 Vali Loss: 0.3261555 Test Loss: 0.3797241
Validation loss decreased (inf --> 0.326155).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3013622
	speed: 0.1272s/iter; left time: 840.0494s
	iters: 200, epoch: 2 | loss: 0.2921835
	speed: 0.0227s/iter; left time: 147.4588s
	iters: 300, epoch: 2 | loss: 0.2049350
	speed: 0.0240s/iter; left time: 153.5457s
	iters: 400, epoch: 2 | loss: 0.2404691
	speed: 0.0219s/iter; left time: 137.7972s
	iters: 500, epoch: 2 | loss: 0.2211495
	speed: 0.0236s/iter; left time: 146.5205s
	iters: 600, epoch: 2 | loss: 0.1846158
	speed: 0.0225s/iter; left time: 137.4025s
	iters: 700, epoch: 2 | loss: 0.2487148
	speed: 0.0229s/iter; left time: 137.5113s
Epoch: 2 cost time: 17.752853393554688
Epoch: 2, Steps: 745 | Train Loss: 0.2235542 Vali Loss: 0.3136538 Test Loss: 0.3583875
Validation loss decreased (0.326155 --> 0.313654).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1981274
	speed: 0.1306s/iter; left time: 765.6375s
	iters: 200, epoch: 3 | loss: 0.1781605
	speed: 0.0231s/iter; left time: 133.3671s
	iters: 300, epoch: 3 | loss: 0.1857731
	speed: 0.0236s/iter; left time: 133.6288s
	iters: 400, epoch: 3 | loss: 0.2392771
	speed: 0.0243s/iter; left time: 135.1666s
	iters: 500, epoch: 3 | loss: 0.2037911
	speed: 0.0236s/iter; left time: 128.9512s
	iters: 600, epoch: 3 | loss: 0.2230231
	speed: 0.0221s/iter; left time: 118.7020s
	iters: 700, epoch: 3 | loss: 0.3303700
	speed: 0.0232s/iter; left time: 122.2033s
Epoch: 3 cost time: 18.20794129371643
Epoch: 3, Steps: 745 | Train Loss: 0.2154576 Vali Loss: 0.3111658 Test Loss: 0.3530973
Validation loss decreased (0.313654 --> 0.311166).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2053550
	speed: 0.1293s/iter; left time: 661.3627s
	iters: 200, epoch: 4 | loss: 0.1813552
	speed: 0.0229s/iter; left time: 114.7591s
	iters: 300, epoch: 4 | loss: 0.2303777
	speed: 0.0246s/iter; left time: 120.8395s
	iters: 400, epoch: 4 | loss: 0.1702586
	speed: 0.0234s/iter; left time: 112.8335s
	iters: 500, epoch: 4 | loss: 0.2925006
	speed: 0.0223s/iter; left time: 105.0524s
	iters: 600, epoch: 4 | loss: 0.2860807
	speed: 0.0219s/iter; left time: 101.2450s
	iters: 700, epoch: 4 | loss: 0.2061161
	speed: 0.0233s/iter; left time: 105.0918s
Epoch: 4 cost time: 18.067874670028687
Epoch: 4, Steps: 745 | Train Loss: 0.2126575 Vali Loss: 0.3097036 Test Loss: 0.3500229
Validation loss decreased (0.311166 --> 0.309704).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1350564
	speed: 0.1296s/iter; left time: 566.5390s
	iters: 200, epoch: 5 | loss: 0.1980704
	speed: 0.0204s/iter; left time: 87.1173s
	iters: 300, epoch: 5 | loss: 0.1774051
	speed: 0.0219s/iter; left time: 91.4234s
	iters: 400, epoch: 5 | loss: 0.1813198
	speed: 0.0221s/iter; left time: 89.8345s
	iters: 500, epoch: 5 | loss: 0.1712656
	speed: 0.0215s/iter; left time: 85.2181s
	iters: 600, epoch: 5 | loss: 0.2136034
	speed: 0.0223s/iter; left time: 86.2956s
	iters: 700, epoch: 5 | loss: 0.1705244
	speed: 0.0235s/iter; left time: 88.5613s
Epoch: 5 cost time: 17.154159784317017
Epoch: 5, Steps: 745 | Train Loss: 0.2112741 Vali Loss: 0.3097475 Test Loss: 0.3497393
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3230875
	speed: 0.1319s/iter; left time: 478.2638s
	iters: 200, epoch: 6 | loss: 0.2310142
	speed: 0.0210s/iter; left time: 73.8801s
	iters: 300, epoch: 6 | loss: 0.1488469
	speed: 0.0218s/iter; left time: 74.7586s
	iters: 400, epoch: 6 | loss: 0.2207787
	speed: 0.0233s/iter; left time: 77.5144s
	iters: 500, epoch: 6 | loss: 0.2457911
	speed: 0.0223s/iter; left time: 71.9596s
	iters: 600, epoch: 6 | loss: 0.2373465
	speed: 0.0229s/iter; left time: 71.6304s
	iters: 700, epoch: 6 | loss: 0.2380436
	speed: 0.0223s/iter; left time: 67.4719s
Epoch: 6 cost time: 17.268299102783203
Epoch: 6, Steps: 745 | Train Loss: 0.2108012 Vali Loss: 0.3086174 Test Loss: 0.3485230
Validation loss decreased (0.309704 --> 0.308617).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1576150
	speed: 0.1310s/iter; left time: 377.5437s
	iters: 200, epoch: 7 | loss: 0.2225283
	speed: 0.0233s/iter; left time: 64.7923s
	iters: 300, epoch: 7 | loss: 0.1848413
	speed: 0.0243s/iter; left time: 65.1726s
	iters: 400, epoch: 7 | loss: 0.2655806
	speed: 0.0238s/iter; left time: 61.3423s
	iters: 500, epoch: 7 | loss: 0.2105144
	speed: 0.0235s/iter; left time: 58.3844s
	iters: 600, epoch: 7 | loss: 0.1949353
	speed: 0.0226s/iter; left time: 53.9225s
	iters: 700, epoch: 7 | loss: 0.1723965
	speed: 0.0234s/iter; left time: 53.3805s
Epoch: 7 cost time: 18.178302526474
Epoch: 7, Steps: 745 | Train Loss: 0.2104578 Vali Loss: 0.3084271 Test Loss: 0.3482568
Validation loss decreased (0.308617 --> 0.308427).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1525582
	speed: 0.1268s/iter; left time: 270.8303s
	iters: 200, epoch: 8 | loss: 0.2129899
	speed: 0.0208s/iter; left time: 42.3044s
	iters: 300, epoch: 8 | loss: 0.2245620
	speed: 0.0211s/iter; left time: 40.8538s
	iters: 400, epoch: 8 | loss: 0.1982112
	speed: 0.0225s/iter; left time: 41.2900s
	iters: 500, epoch: 8 | loss: 0.2273265
	speed: 0.0216s/iter; left time: 37.5570s
	iters: 600, epoch: 8 | loss: 0.2211306
	speed: 0.0214s/iter; left time: 34.9871s
	iters: 700, epoch: 8 | loss: 0.2059966
	speed: 0.0216s/iter; left time: 33.2472s
Epoch: 8 cost time: 16.818845510482788
Epoch: 8, Steps: 745 | Train Loss: 0.2103522 Vali Loss: 0.3083442 Test Loss: 0.3481191
Validation loss decreased (0.308427 --> 0.308344).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1773297
	speed: 0.1296s/iter; left time: 180.3147s
	iters: 200, epoch: 9 | loss: 0.1792230
	speed: 0.0220s/iter; left time: 28.4244s
	iters: 300, epoch: 9 | loss: 0.1846765
	speed: 0.0225s/iter; left time: 26.7710s
	iters: 400, epoch: 9 | loss: 0.1713787
	speed: 0.0251s/iter; left time: 27.4057s
	iters: 500, epoch: 9 | loss: 0.2145829
	speed: 0.0225s/iter; left time: 22.3406s
	iters: 600, epoch: 9 | loss: 0.2198192
	speed: 0.0208s/iter; left time: 18.5534s
	iters: 700, epoch: 9 | loss: 0.1886082
	speed: 0.0216s/iter; left time: 17.0689s
Epoch: 9 cost time: 17.507202625274658
Epoch: 9, Steps: 745 | Train Loss: 0.2102046 Vali Loss: 0.3085514 Test Loss: 0.3480262
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2076912
	speed: 0.1303s/iter; left time: 84.1506s
	iters: 200, epoch: 10 | loss: 0.2459127
	speed: 0.0214s/iter; left time: 11.6812s
	iters: 300, epoch: 10 | loss: 0.1898450
	speed: 0.0220s/iter; left time: 9.8223s
	iters: 400, epoch: 10 | loss: 0.2083402
	speed: 0.0226s/iter; left time: 7.8064s
	iters: 500, epoch: 10 | loss: 0.2205938
	speed: 0.0238s/iter; left time: 5.8523s
	iters: 600, epoch: 10 | loss: 0.2387212
	speed: 0.0226s/iter; left time: 3.3000s
	iters: 700, epoch: 10 | loss: 0.2580297
	speed: 0.0221s/iter; left time: 1.0174s
Epoch: 10 cost time: 17.517338514328003
Epoch: 10, Steps: 745 | Train Loss: 0.2101746 Vali Loss: 0.3085760 Test Loss: 0.3480111
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : traffic_336_12_GLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3497
mse:0.34834155440330505, mae:0.26015645265579224
