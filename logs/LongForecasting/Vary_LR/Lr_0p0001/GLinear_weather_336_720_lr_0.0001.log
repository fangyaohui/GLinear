Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='GLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8978338
	speed: 0.0120s/iter; left time: 268.0969s
	iters: 200, epoch: 1 | loss: 0.7511342
	speed: 0.0054s/iter; left time: 120.4090s
	iters: 300, epoch: 1 | loss: 0.5485817
	speed: 0.0058s/iter; left time: 127.2205s
	iters: 400, epoch: 1 | loss: 0.7011636
	speed: 0.0056s/iter; left time: 123.2523s
	iters: 500, epoch: 1 | loss: 0.6653634
	speed: 0.0054s/iter; left time: 118.5157s
	iters: 600, epoch: 1 | loss: 0.6028944
	speed: 0.0057s/iter; left time: 124.0935s
	iters: 700, epoch: 1 | loss: 0.4490707
	speed: 0.0055s/iter; left time: 118.3512s
	iters: 800, epoch: 1 | loss: 0.5683253
	speed: 0.0056s/iter; left time: 120.7568s
	iters: 900, epoch: 1 | loss: 0.4266464
	speed: 0.0057s/iter; left time: 122.0553s
	iters: 1000, epoch: 1 | loss: 0.7307079
	speed: 0.0054s/iter; left time: 116.4347s
	iters: 1100, epoch: 1 | loss: 1.0450388
	speed: 0.0062s/iter; left time: 132.0107s
	iters: 1200, epoch: 1 | loss: 0.4668555
	speed: 0.0057s/iter; left time: 121.6335s
	iters: 1300, epoch: 1 | loss: 0.4430693
	speed: 0.0057s/iter; left time: 120.6473s
	iters: 1400, epoch: 1 | loss: 0.5002941
	speed: 0.0058s/iter; left time: 120.9890s
	iters: 1500, epoch: 1 | loss: 0.6016241
	speed: 0.0056s/iter; left time: 116.6647s
	iters: 1600, epoch: 1 | loss: 1.2250156
	speed: 0.0057s/iter; left time: 118.2578s
	iters: 1700, epoch: 1 | loss: 0.6964672
	speed: 0.0057s/iter; left time: 117.0418s
	iters: 1800, epoch: 1 | loss: 0.3943252
	speed: 0.0057s/iter; left time: 116.7275s
	iters: 1900, epoch: 1 | loss: 0.7115526
	speed: 0.0055s/iter; left time: 111.9196s
	iters: 2000, epoch: 1 | loss: 0.6927924
	speed: 0.0056s/iter; left time: 113.8951s
	iters: 2100, epoch: 1 | loss: 0.5601575
	speed: 0.0058s/iter; left time: 117.2362s
	iters: 2200, epoch: 1 | loss: 0.5281523
	speed: 0.0058s/iter; left time: 117.3566s
Epoch: 1 cost time: 13.416016340255737
Epoch: 1, Steps: 2239 | Train Loss: 0.6136230 Vali Loss: 0.6248164 Test Loss: 0.3251584
Validation loss decreased (inf --> 0.624816).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4431743
	speed: 0.0745s/iter; left time: 1494.1487s
	iters: 200, epoch: 2 | loss: 0.4903415
	speed: 0.0055s/iter; left time: 110.5509s
	iters: 300, epoch: 2 | loss: 0.7767604
	speed: 0.0059s/iter; left time: 116.5580s
	iters: 400, epoch: 2 | loss: 0.6853247
	speed: 0.0057s/iter; left time: 112.1797s
	iters: 500, epoch: 2 | loss: 0.4108756
	speed: 0.0056s/iter; left time: 110.5375s
	iters: 600, epoch: 2 | loss: 0.5259558
	speed: 0.0056s/iter; left time: 110.3912s
	iters: 700, epoch: 2 | loss: 0.4843811
	speed: 0.0057s/iter; left time: 111.7596s
	iters: 800, epoch: 2 | loss: 0.4075644
	speed: 0.0059s/iter; left time: 114.9711s
	iters: 900, epoch: 2 | loss: 0.5163270
	speed: 0.0058s/iter; left time: 111.7565s
	iters: 1000, epoch: 2 | loss: 0.5507752
	speed: 0.0063s/iter; left time: 120.0876s
	iters: 1100, epoch: 2 | loss: 0.4894453
	speed: 0.0060s/iter; left time: 114.4379s
	iters: 1200, epoch: 2 | loss: 0.4614596
	speed: 0.0059s/iter; left time: 112.1018s
	iters: 1300, epoch: 2 | loss: 0.5505388
	speed: 0.0056s/iter; left time: 105.1460s
	iters: 1400, epoch: 2 | loss: 0.5179086
	speed: 0.0056s/iter; left time: 104.2865s
	iters: 1500, epoch: 2 | loss: 0.4504448
	speed: 0.0059s/iter; left time: 110.4993s
	iters: 1600, epoch: 2 | loss: 0.5870359
	speed: 0.0058s/iter; left time: 108.1765s
	iters: 1700, epoch: 2 | loss: 0.4794259
	speed: 0.0059s/iter; left time: 108.5085s
	iters: 1800, epoch: 2 | loss: 0.6181285
	speed: 0.0058s/iter; left time: 106.5173s
	iters: 1900, epoch: 2 | loss: 0.6795918
	speed: 0.0062s/iter; left time: 112.9226s
	iters: 2000, epoch: 2 | loss: 0.4357265
	speed: 0.0059s/iter; left time: 107.6145s
	iters: 2100, epoch: 2 | loss: 0.4698648
	speed: 0.0060s/iter; left time: 107.4303s
	iters: 2200, epoch: 2 | loss: 1.0560639
	speed: 0.0060s/iter; left time: 108.4286s
Epoch: 2 cost time: 13.79175329208374
Epoch: 2, Steps: 2239 | Train Loss: 0.5946397 Vali Loss: 0.6221055 Test Loss: 0.3236156
Validation loss decreased (0.624816 --> 0.622106).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4096483
	speed: 0.0757s/iter; left time: 1347.7714s
	iters: 200, epoch: 3 | loss: 0.5767095
	speed: 0.0057s/iter; left time: 101.5447s
	iters: 300, epoch: 3 | loss: 0.4969932
	speed: 0.0058s/iter; left time: 102.3520s
	iters: 400, epoch: 3 | loss: 0.3884596
	speed: 0.0057s/iter; left time: 99.0731s
	iters: 500, epoch: 3 | loss: 0.7666118
	speed: 0.0057s/iter; left time: 98.8876s
	iters: 600, epoch: 3 | loss: 0.7226682
	speed: 0.0059s/iter; left time: 102.8413s
	iters: 700, epoch: 3 | loss: 0.7455258
	speed: 0.0054s/iter; left time: 93.5251s
	iters: 800, epoch: 3 | loss: 0.5292610
	speed: 0.0055s/iter; left time: 94.7887s
	iters: 900, epoch: 3 | loss: 0.5233601
	speed: 0.0058s/iter; left time: 99.2818s
	iters: 1000, epoch: 3 | loss: 0.5307070
	speed: 0.0062s/iter; left time: 105.0847s
	iters: 1100, epoch: 3 | loss: 0.9831002
	speed: 0.0060s/iter; left time: 101.3161s
	iters: 1200, epoch: 3 | loss: 0.7513741
	speed: 0.0062s/iter; left time: 103.4247s
	iters: 1300, epoch: 3 | loss: 0.5740252
	speed: 0.0062s/iter; left time: 102.1773s
	iters: 1400, epoch: 3 | loss: 0.4048996
	speed: 0.0060s/iter; left time: 99.6399s
	iters: 1500, epoch: 3 | loss: 0.5149282
	speed: 0.0058s/iter; left time: 94.6400s
	iters: 1600, epoch: 3 | loss: 0.4016450
	speed: 0.0058s/iter; left time: 94.5492s
	iters: 1700, epoch: 3 | loss: 0.4645932
	speed: 0.0057s/iter; left time: 91.9482s
	iters: 1800, epoch: 3 | loss: 0.4730927
	speed: 0.0058s/iter; left time: 92.8456s
	iters: 1900, epoch: 3 | loss: 0.4483876
	speed: 0.0056s/iter; left time: 90.2536s
	iters: 2000, epoch: 3 | loss: 0.4345791
	speed: 0.0058s/iter; left time: 92.7068s
	iters: 2100, epoch: 3 | loss: 0.6183937
	speed: 0.0058s/iter; left time: 91.0077s
	iters: 2200, epoch: 3 | loss: 0.4794701
	speed: 0.0056s/iter; left time: 88.5518s
Epoch: 3 cost time: 13.646215200424194
Epoch: 3, Steps: 2239 | Train Loss: 0.5903853 Vali Loss: 0.6170381 Test Loss: 0.3228088
Validation loss decreased (0.622106 --> 0.617038).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7620486
	speed: 0.0765s/iter; left time: 1191.0924s
	iters: 200, epoch: 4 | loss: 0.5941284
	speed: 0.0061s/iter; left time: 94.1546s
	iters: 300, epoch: 4 | loss: 0.4976461
	speed: 0.0059s/iter; left time: 90.4230s
	iters: 400, epoch: 4 | loss: 0.4048725
	speed: 0.0060s/iter; left time: 91.5860s
	iters: 500, epoch: 4 | loss: 0.5641851
	speed: 0.0059s/iter; left time: 89.6356s
	iters: 600, epoch: 4 | loss: 0.8131207
	speed: 0.0059s/iter; left time: 89.1566s
	iters: 700, epoch: 4 | loss: 0.4716989
	speed: 0.0058s/iter; left time: 86.2815s
	iters: 800, epoch: 4 | loss: 0.4359975
	speed: 0.0060s/iter; left time: 89.2232s
	iters: 900, epoch: 4 | loss: 0.6239339
	speed: 0.0059s/iter; left time: 87.4026s
	iters: 1000, epoch: 4 | loss: 0.8229518
	speed: 0.0070s/iter; left time: 102.1809s
	iters: 1100, epoch: 4 | loss: 0.4954896
	speed: 0.0069s/iter; left time: 101.1003s
	iters: 1200, epoch: 4 | loss: 0.5189791
	speed: 0.0059s/iter; left time: 86.0289s
	iters: 1300, epoch: 4 | loss: 0.9144582
	speed: 0.0061s/iter; left time: 87.6804s
	iters: 1400, epoch: 4 | loss: 0.9883946
	speed: 0.0063s/iter; left time: 89.7868s
	iters: 1500, epoch: 4 | loss: 0.4637836
	speed: 0.0061s/iter; left time: 86.3094s
	iters: 1600, epoch: 4 | loss: 0.4872105
	speed: 0.0061s/iter; left time: 85.8937s
	iters: 1700, epoch: 4 | loss: 0.5753082
	speed: 0.0060s/iter; left time: 83.8333s
	iters: 1800, epoch: 4 | loss: 0.6559772
	speed: 0.0060s/iter; left time: 83.8489s
	iters: 1900, epoch: 4 | loss: 0.4936557
	speed: 0.0062s/iter; left time: 85.7191s
	iters: 2000, epoch: 4 | loss: 0.4367880
	speed: 0.0057s/iter; left time: 78.5127s
	iters: 2100, epoch: 4 | loss: 0.4265537
	speed: 0.0057s/iter; left time: 78.0319s
	iters: 2200, epoch: 4 | loss: 0.4928333
	speed: 0.0057s/iter; left time: 76.1341s
Epoch: 4 cost time: 14.233538150787354
Epoch: 4, Steps: 2239 | Train Loss: 0.5885433 Vali Loss: 0.6183007 Test Loss: 0.3214053
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6316926
	speed: 0.0759s/iter; left time: 1011.6314s
	iters: 200, epoch: 5 | loss: 0.5231012
	speed: 0.0057s/iter; left time: 75.6228s
	iters: 300, epoch: 5 | loss: 0.7124704
	speed: 0.0058s/iter; left time: 75.8931s
	iters: 400, epoch: 5 | loss: 0.3683273
	speed: 0.0060s/iter; left time: 78.0657s
	iters: 500, epoch: 5 | loss: 0.4964269
	speed: 0.0061s/iter; left time: 78.6932s
	iters: 600, epoch: 5 | loss: 0.4590295
	speed: 0.0058s/iter; left time: 74.1421s
	iters: 700, epoch: 5 | loss: 0.6239976
	speed: 0.0059s/iter; left time: 75.5653s
	iters: 800, epoch: 5 | loss: 0.5960212
	speed: 0.0058s/iter; left time: 73.1084s
	iters: 900, epoch: 5 | loss: 0.6025789
	speed: 0.0059s/iter; left time: 74.4049s
	iters: 1000, epoch: 5 | loss: 0.7866024
	speed: 0.0058s/iter; left time: 72.6694s
	iters: 1100, epoch: 5 | loss: 0.4773402
	speed: 0.0058s/iter; left time: 72.0601s
	iters: 1200, epoch: 5 | loss: 0.5413596
	speed: 0.0058s/iter; left time: 70.3522s
	iters: 1300, epoch: 5 | loss: 0.8580853
	speed: 0.0059s/iter; left time: 72.0164s
	iters: 1400, epoch: 5 | loss: 0.4126051
	speed: 0.0061s/iter; left time: 73.6926s
	iters: 1500, epoch: 5 | loss: 0.7127877
	speed: 0.0060s/iter; left time: 72.0064s
	iters: 1600, epoch: 5 | loss: 0.5808826
	speed: 0.0058s/iter; left time: 68.8601s
	iters: 1700, epoch: 5 | loss: 0.5714989
	speed: 0.0059s/iter; left time: 68.9636s
	iters: 1800, epoch: 5 | loss: 0.4091743
	speed: 0.0061s/iter; left time: 70.8062s
	iters: 1900, epoch: 5 | loss: 0.4431904
	speed: 0.0059s/iter; left time: 67.6328s
	iters: 2000, epoch: 5 | loss: 0.7153427
	speed: 0.0058s/iter; left time: 66.4402s
	iters: 2100, epoch: 5 | loss: 0.4507678
	speed: 0.0059s/iter; left time: 67.2871s
	iters: 2200, epoch: 5 | loss: 0.5265775
	speed: 0.0060s/iter; left time: 67.5399s
Epoch: 5 cost time: 13.862568378448486
Epoch: 5, Steps: 2239 | Train Loss: 0.5875616 Vali Loss: 0.6225301 Test Loss: 0.3232553
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5755752
	speed: 0.0742s/iter; left time: 823.2287s
	iters: 200, epoch: 6 | loss: 0.5206940
	speed: 0.0062s/iter; left time: 68.3357s
	iters: 300, epoch: 6 | loss: 0.4375563
	speed: 0.0061s/iter; left time: 66.6759s
	iters: 400, epoch: 6 | loss: 0.5193310
	speed: 0.0060s/iter; left time: 64.8983s
	iters: 500, epoch: 6 | loss: 0.5502651
	speed: 0.0061s/iter; left time: 65.2184s
	iters: 600, epoch: 6 | loss: 0.4087194
	speed: 0.0062s/iter; left time: 65.6115s
	iters: 700, epoch: 6 | loss: 0.5840693
	speed: 0.0057s/iter; left time: 59.7261s
	iters: 800, epoch: 6 | loss: 1.0098116
	speed: 0.0059s/iter; left time: 61.3545s
	iters: 900, epoch: 6 | loss: 0.5924960
	speed: 0.0063s/iter; left time: 64.8231s
	iters: 1000, epoch: 6 | loss: 0.5748203
	speed: 0.0067s/iter; left time: 68.2322s
	iters: 1100, epoch: 6 | loss: 0.7346252
	speed: 0.0059s/iter; left time: 59.4802s
	iters: 1200, epoch: 6 | loss: 0.5193263
	speed: 0.0058s/iter; left time: 58.4054s
	iters: 1300, epoch: 6 | loss: 0.4370320
	speed: 0.0061s/iter; left time: 60.6742s
	iters: 1400, epoch: 6 | loss: 0.7402915
	speed: 0.0061s/iter; left time: 59.3663s
	iters: 1500, epoch: 6 | loss: 0.7840104
	speed: 0.0059s/iter; left time: 57.5181s
	iters: 1600, epoch: 6 | loss: 0.5465775
	speed: 0.0058s/iter; left time: 55.3124s
	iters: 1700, epoch: 6 | loss: 0.5141825
	speed: 0.0060s/iter; left time: 56.7794s
	iters: 1800, epoch: 6 | loss: 0.9079537
	speed: 0.0061s/iter; left time: 56.8516s
	iters: 1900, epoch: 6 | loss: 0.4356208
	speed: 0.0070s/iter; left time: 64.7804s
	iters: 2000, epoch: 6 | loss: 0.5721387
	speed: 0.0059s/iter; left time: 54.0617s
	iters: 2100, epoch: 6 | loss: 0.3913178
	speed: 0.0063s/iter; left time: 57.7562s
	iters: 2200, epoch: 6 | loss: 0.5604687
	speed: 0.0061s/iter; left time: 54.4278s
Epoch: 6 cost time: 14.263408422470093
Epoch: 6, Steps: 2239 | Train Loss: 0.5870416 Vali Loss: 0.6194347 Test Loss: 0.3211591
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.322721004486084, mae:0.361042320728302
