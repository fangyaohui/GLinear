Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='GLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 1.9306836
	speed: 0.0109s/iter; left time: 242.2011s
	iters: 200, epoch: 1 | loss: 1.7333860
	speed: 0.0064s/iter; left time: 141.8817s
	iters: 300, epoch: 1 | loss: 0.8190764
	speed: 0.0076s/iter; left time: 168.3722s
	iters: 400, epoch: 1 | loss: 1.0488315
	speed: 0.0055s/iter; left time: 121.1580s
	iters: 500, epoch: 1 | loss: 0.7325912
	speed: 0.0055s/iter; left time: 120.0378s
	iters: 600, epoch: 1 | loss: 0.7729775
	speed: 0.0052s/iter; left time: 113.1129s
	iters: 700, epoch: 1 | loss: 0.5610515
	speed: 0.0054s/iter; left time: 117.2363s
	iters: 800, epoch: 1 | loss: 0.7361557
	speed: 0.0054s/iter; left time: 116.6629s
	iters: 900, epoch: 1 | loss: 0.5472549
	speed: 0.0055s/iter; left time: 118.8599s
	iters: 1000, epoch: 1 | loss: 0.7966496
	speed: 0.0060s/iter; left time: 128.1907s
	iters: 1100, epoch: 1 | loss: 1.0857409
	speed: 0.0056s/iter; left time: 118.3630s
	iters: 1200, epoch: 1 | loss: 0.5206339
	speed: 0.0065s/iter; left time: 138.7649s
	iters: 1300, epoch: 1 | loss: 0.5051509
	speed: 0.0057s/iter; left time: 119.4843s
	iters: 1400, epoch: 1 | loss: 0.5029835
	speed: 0.0055s/iter; left time: 115.1303s
	iters: 1500, epoch: 1 | loss: 0.6276664
	speed: 0.0057s/iter; left time: 118.4954s
	iters: 1600, epoch: 1 | loss: 1.2422163
	speed: 0.0054s/iter; left time: 113.1725s
	iters: 1700, epoch: 1 | loss: 0.7354511
	speed: 0.0058s/iter; left time: 120.8370s
	iters: 1800, epoch: 1 | loss: 0.4436412
	speed: 0.0055s/iter; left time: 114.1664s
	iters: 1900, epoch: 1 | loss: 0.7254316
	speed: 0.0055s/iter; left time: 113.2965s
	iters: 2000, epoch: 1 | loss: 0.6956668
	speed: 0.0055s/iter; left time: 112.4236s
	iters: 2100, epoch: 1 | loss: 0.5849967
	speed: 0.0057s/iter; left time: 115.0006s
	iters: 2200, epoch: 1 | loss: 0.5172850
	speed: 0.0056s/iter; left time: 113.1314s
Epoch: 1 cost time: 13.448413610458374
Epoch: 1, Steps: 2239 | Train Loss: 6.9656666 Vali Loss: 0.6154076 Test Loss: 0.3367203
Validation loss decreased (inf --> 0.615408).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.4453400
	speed: 0.0708s/iter; left time: 1420.3628s
	iters: 200, epoch: 2 | loss: 0.4820800
	speed: 0.0056s/iter; left time: 110.9305s
	iters: 300, epoch: 2 | loss: 0.7652970
	speed: 0.0055s/iter; left time: 108.8163s
	iters: 400, epoch: 2 | loss: 1.3672218
	speed: 0.0055s/iter; left time: 107.8823s
	iters: 500, epoch: 2 | loss: 0.4176831
	speed: 0.0055s/iter; left time: 108.8035s
	iters: 600, epoch: 2 | loss: 0.5371040
	speed: 0.0054s/iter; left time: 106.3526s
	iters: 700, epoch: 2 | loss: 0.4804024
	speed: 0.0055s/iter; left time: 107.8333s
	iters: 800, epoch: 2 | loss: 0.4236767
	speed: 0.0055s/iter; left time: 106.1670s
	iters: 900, epoch: 2 | loss: 0.4989957
	speed: 0.0056s/iter; left time: 108.0674s
	iters: 1000, epoch: 2 | loss: 0.5400518
	speed: 0.0054s/iter; left time: 102.7544s
	iters: 1100, epoch: 2 | loss: 0.4846314
	speed: 0.0057s/iter; left time: 108.6797s
	iters: 1200, epoch: 2 | loss: 0.4583316
	speed: 0.0057s/iter; left time: 107.2309s
	iters: 1300, epoch: 2 | loss: 0.5465004
	speed: 0.0054s/iter; left time: 102.5600s
	iters: 1400, epoch: 2 | loss: 0.5192109
	speed: 0.0059s/iter; left time: 110.0297s
	iters: 1500, epoch: 2 | loss: 0.4489132
	speed: 0.0059s/iter; left time: 110.0620s
	iters: 1600, epoch: 2 | loss: 0.5850546
	speed: 0.0055s/iter; left time: 102.5099s
	iters: 1700, epoch: 2 | loss: 0.4848192
	speed: 0.0055s/iter; left time: 102.3439s
	iters: 1800, epoch: 2 | loss: 0.6300006
	speed: 0.0055s/iter; left time: 100.7970s
	iters: 1900, epoch: 2 | loss: 0.6906167
	speed: 0.0056s/iter; left time: 102.5288s
	iters: 2000, epoch: 2 | loss: 0.4399035
	speed: 0.0058s/iter; left time: 104.4341s
	iters: 2100, epoch: 2 | loss: 0.4580355
	speed: 0.0057s/iter; left time: 102.7477s
	iters: 2200, epoch: 2 | loss: 1.1642274
	speed: 0.0056s/iter; left time: 99.7372s
Epoch: 2 cost time: 13.094764471054077
Epoch: 2, Steps: 2239 | Train Loss: 0.6039507 Vali Loss: 0.6932316 Test Loss: 0.3643642
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.4064685
	speed: 0.0726s/iter; left time: 1292.7166s
	iters: 200, epoch: 3 | loss: 1.0940078
	speed: 0.0056s/iter; left time: 98.7561s
	iters: 300, epoch: 3 | loss: 0.5181155
	speed: 0.0055s/iter; left time: 97.3545s
	iters: 400, epoch: 3 | loss: 0.3952256
	speed: 0.0056s/iter; left time: 98.5095s
	iters: 500, epoch: 3 | loss: 0.8566970
	speed: 0.0055s/iter; left time: 95.0954s
	iters: 600, epoch: 3 | loss: 0.7275090
	speed: 0.0055s/iter; left time: 95.6373s
	iters: 700, epoch: 3 | loss: 0.7518072
	speed: 0.0056s/iter; left time: 96.2164s
	iters: 800, epoch: 3 | loss: 0.5419991
	speed: 0.0057s/iter; left time: 96.7921s
	iters: 900, epoch: 3 | loss: 1.0095838
	speed: 0.0056s/iter; left time: 95.5452s
	iters: 1000, epoch: 3 | loss: 4513.1372070
	speed: 0.0056s/iter; left time: 95.5265s
	iters: 1100, epoch: 3 | loss: 33.0209045
	speed: 0.0058s/iter; left time: 97.6212s
	iters: 1200, epoch: 3 | loss: 34.0599670
	speed: 0.0060s/iter; left time: 100.3211s
	iters: 1300, epoch: 3 | loss: 9.7867393
	speed: 0.0057s/iter; left time: 95.1834s
	iters: 1400, epoch: 3 | loss: 13.7375870
	speed: 0.0055s/iter; left time: 91.1672s
	iters: 1500, epoch: 3 | loss: 9.5139265
	speed: 0.0059s/iter; left time: 96.6790s
	iters: 1600, epoch: 3 | loss: 69.2368088
	speed: 0.0066s/iter; left time: 107.3109s
	iters: 1700, epoch: 3 | loss: 11.0648603
	speed: 0.0057s/iter; left time: 91.8776s
	iters: 1800, epoch: 3 | loss: 8.3764362
	speed: 0.0056s/iter; left time: 90.7691s
	iters: 1900, epoch: 3 | loss: 12.2331896
	speed: 0.0057s/iter; left time: 90.5762s
	iters: 2000, epoch: 3 | loss: 8.1930723
	speed: 0.0056s/iter; left time: 89.4755s
	iters: 2100, epoch: 3 | loss: 23.4308739
	speed: 0.0057s/iter; left time: 90.6407s
	iters: 2200, epoch: 3 | loss: 5.2837014
	speed: 0.0060s/iter; left time: 93.8630s
Epoch: 3 cost time: 13.380303144454956
Epoch: 3, Steps: 2239 | Train Loss: 916.7002500 Vali Loss: 5.3461437 Test Loss: 3.4795992
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 4.3004928
	speed: 0.0721s/iter; left time: 1123.3738s
	iters: 200, epoch: 4 | loss: 2.5460601
	speed: 0.0056s/iter; left time: 87.2509s
	iters: 300, epoch: 4 | loss: 3.1146970
	speed: 0.0055s/iter; left time: 83.9821s
	iters: 400, epoch: 4 | loss: 2.8368411
	speed: 0.0057s/iter; left time: 86.5822s
	iters: 500, epoch: 4 | loss: 3.2837565
	speed: 0.0054s/iter; left time: 82.3486s
	iters: 600, epoch: 4 | loss: 4.5172215
	speed: 0.0056s/iter; left time: 84.4243s
	iters: 700, epoch: 4 | loss: 2.7285893
	speed: 0.0058s/iter; left time: 86.6020s
	iters: 800, epoch: 4 | loss: 3.4817934
	speed: 0.0054s/iter; left time: 80.7531s
	iters: 900, epoch: 4 | loss: 3.2394469
	speed: 0.0055s/iter; left time: 81.9675s
	iters: 1000, epoch: 4 | loss: 9.5754337
	speed: 0.0055s/iter; left time: 80.6361s
	iters: 1100, epoch: 4 | loss: 2.3599563
	speed: 0.0056s/iter; left time: 82.1792s
	iters: 1200, epoch: 4 | loss: 2.9000998
	speed: 0.0056s/iter; left time: 81.2481s
	iters: 1300, epoch: 4 | loss: 5.0270009
	speed: 0.0058s/iter; left time: 83.3310s
	iters: 1400, epoch: 4 | loss: 4.5113468
	speed: 0.0058s/iter; left time: 83.1178s
	iters: 1500, epoch: 4 | loss: 2.6788549
	speed: 0.0057s/iter; left time: 80.5673s
	iters: 1600, epoch: 4 | loss: 2.7357817
	speed: 0.0056s/iter; left time: 79.2156s
	iters: 1700, epoch: 4 | loss: 2.4515972
	speed: 0.0057s/iter; left time: 79.0068s
	iters: 1800, epoch: 4 | loss: 3.5899792
	speed: 0.0056s/iter; left time: 77.3391s
	iters: 1900, epoch: 4 | loss: 61.6792221
	speed: 0.0056s/iter; left time: 77.2796s
	iters: 2000, epoch: 4 | loss: 2.7822442
	speed: 0.0055s/iter; left time: 75.3151s
	iters: 2100, epoch: 4 | loss: 3.9313142
	speed: 0.0056s/iter; left time: 75.9112s
	iters: 2200, epoch: 4 | loss: 2.6899431
	speed: 0.0055s/iter; left time: 74.2088s
Epoch: 4 cost time: 13.131306171417236
Epoch: 4, Steps: 2239 | Train Loss: 7.3029437 Vali Loss: 2.3997080 Test Loss: 1.7279822
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.33662623167037964, mae:0.3749663829803467
