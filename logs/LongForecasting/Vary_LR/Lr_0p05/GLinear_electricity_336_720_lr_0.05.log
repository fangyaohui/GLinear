Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='GLinear', model_id='Electricity_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.6729311
	speed: 0.0261s/iter; left time: 280.8166s
	iters: 200, epoch: 1 | loss: 0.4074999
	speed: 0.0193s/iter; left time: 204.9536s
	iters: 300, epoch: 1 | loss: 0.3051630
	speed: 0.0196s/iter; left time: 206.2607s
	iters: 400, epoch: 1 | loss: 0.3320108
	speed: 0.0191s/iter; left time: 199.3532s
	iters: 500, epoch: 1 | loss: 0.3016620
	speed: 0.0194s/iter; left time: 200.7825s
	iters: 600, epoch: 1 | loss: 0.2666621
	speed: 0.0198s/iter; left time: 202.3612s
	iters: 700, epoch: 1 | loss: 0.2642621
	speed: 0.0190s/iter; left time: 192.6402s
	iters: 800, epoch: 1 | loss: 0.2853472
	speed: 0.0194s/iter; left time: 194.6437s
	iters: 900, epoch: 1 | loss: 0.2496777
	speed: 0.0199s/iter; left time: 198.3115s
	iters: 1000, epoch: 1 | loss: 0.2394883
	speed: 0.0191s/iter; left time: 187.7998s
Epoch: 1 cost time: 21.809060096740723
Epoch: 1, Steps: 1084 | Train Loss: 5.4755773 Vali Loss: 0.2201247 Test Loss: 0.2478163
Validation loss decreased (inf --> 0.220125).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.2656747
	speed: 0.1633s/iter; left time: 1577.0993s
	iters: 200, epoch: 2 | loss: 0.2297118
	speed: 0.0194s/iter; left time: 185.2264s
	iters: 300, epoch: 2 | loss: 0.2369822
	speed: 0.0197s/iter; left time: 185.9731s
	iters: 400, epoch: 2 | loss: 0.2674709
	speed: 0.0199s/iter; left time: 186.0678s
	iters: 500, epoch: 2 | loss: 0.2546423
	speed: 0.0193s/iter; left time: 178.6106s
	iters: 600, epoch: 2 | loss: 0.2591867
	speed: 0.0202s/iter; left time: 185.4177s
	iters: 700, epoch: 2 | loss: 0.2354216
	speed: 0.0197s/iter; left time: 178.4645s
	iters: 800, epoch: 2 | loss: 0.2362357
	speed: 0.0203s/iter; left time: 181.4287s
	iters: 900, epoch: 2 | loss: 0.2354541
	speed: 0.0205s/iter; left time: 181.6884s
	iters: 1000, epoch: 2 | loss: 0.2315823
	speed: 0.0208s/iter; left time: 181.8770s
Epoch: 2 cost time: 22.372079610824585
Epoch: 2, Steps: 1084 | Train Loss: 0.2422221 Vali Loss: 0.2125575 Test Loss: 0.2269636
Validation loss decreased (0.220125 --> 0.212558).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.2126182
	speed: 0.1721s/iter; left time: 1475.6115s
	iters: 200, epoch: 3 | loss: 0.2257788
	speed: 0.0194s/iter; left time: 164.1230s
	iters: 300, epoch: 3 | loss: 0.2001185
	speed: 0.0200s/iter; left time: 167.4701s
	iters: 400, epoch: 3 | loss: 0.2273559
	speed: 0.0204s/iter; left time: 168.7687s
	iters: 500, epoch: 3 | loss: 0.2470546
	speed: 0.0196s/iter; left time: 160.3602s
	iters: 600, epoch: 3 | loss: 0.1966308
	speed: 0.0197s/iter; left time: 159.3977s
	iters: 700, epoch: 3 | loss: 0.2073763
	speed: 0.0193s/iter; left time: 153.6685s
	iters: 800, epoch: 3 | loss: 0.2299122
	speed: 0.0197s/iter; left time: 155.3403s
	iters: 900, epoch: 3 | loss: 0.2409065
	speed: 0.0201s/iter; left time: 156.1817s
	iters: 1000, epoch: 3 | loss: 0.2600471
	speed: 0.0206s/iter; left time: 158.4311s
Epoch: 3 cost time: 22.20105242729187
Epoch: 3, Steps: 1084 | Train Loss: 0.2236742 Vali Loss: 0.1828504 Test Loss: 0.2149535
Validation loss decreased (0.212558 --> 0.182850).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.2013722
	speed: 0.1644s/iter; left time: 1231.1812s
	iters: 200, epoch: 4 | loss: 0.2107211
	speed: 0.0202s/iter; left time: 149.3319s
	iters: 300, epoch: 4 | loss: 0.2127901
	speed: 0.0206s/iter; left time: 150.0409s
	iters: 400, epoch: 4 | loss: 0.2292099
	speed: 0.0204s/iter; left time: 147.0039s
	iters: 500, epoch: 4 | loss: 0.1835697
	speed: 0.0193s/iter; left time: 136.7337s
	iters: 600, epoch: 4 | loss: 0.2034633
	speed: 0.0196s/iter; left time: 137.1948s
	iters: 700, epoch: 4 | loss: 0.2177599
	speed: 0.0193s/iter; left time: 133.0203s
	iters: 800, epoch: 4 | loss: 0.2176323
	speed: 0.0195s/iter; left time: 132.7130s
	iters: 900, epoch: 4 | loss: 0.2002402
	speed: 0.0203s/iter; left time: 135.9118s
	iters: 1000, epoch: 4 | loss: 0.1944902
	speed: 0.0212s/iter; left time: 139.8004s
Epoch: 4 cost time: 22.437446355819702
Epoch: 4, Steps: 1084 | Train Loss: 0.2183267 Vali Loss: 0.1793030 Test Loss: 0.2100809
Validation loss decreased (0.182850 --> 0.179303).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2086626
	speed: 0.1701s/iter; left time: 1089.7483s
	iters: 200, epoch: 5 | loss: 0.2339246
	speed: 0.0204s/iter; left time: 128.8766s
	iters: 300, epoch: 5 | loss: 0.2441589
	speed: 0.0188s/iter; left time: 116.4414s
	iters: 400, epoch: 5 | loss: 0.1998380
	speed: 0.0196s/iter; left time: 119.4068s
	iters: 500, epoch: 5 | loss: 0.2019437
	speed: 0.0189s/iter; left time: 113.4897s
	iters: 600, epoch: 5 | loss: 0.2047232
	speed: 0.0195s/iter; left time: 114.9568s
	iters: 700, epoch: 5 | loss: 0.2415122
	speed: 0.0198s/iter; left time: 114.7373s
	iters: 800, epoch: 5 | loss: 0.2167460
	speed: 0.0195s/iter; left time: 111.3119s
	iters: 900, epoch: 5 | loss: 0.2111767
	speed: 0.0190s/iter; left time: 106.6773s
	iters: 1000, epoch: 5 | loss: 0.2114227
	speed: 0.0197s/iter; left time: 108.4125s
Epoch: 5 cost time: 22.07696294784546
Epoch: 5, Steps: 1084 | Train Loss: 0.2155619 Vali Loss: 0.1770099 Test Loss: 0.2106163
Validation loss decreased (0.179303 --> 0.177010).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2218539
	speed: 0.1698s/iter; left time: 903.2784s
	iters: 200, epoch: 6 | loss: 0.1931852
	speed: 0.0200s/iter; left time: 104.5228s
	iters: 300, epoch: 6 | loss: 0.1835236
	speed: 0.0206s/iter; left time: 105.3105s
	iters: 400, epoch: 6 | loss: 0.1944013
	speed: 0.0201s/iter; left time: 101.0834s
	iters: 500, epoch: 6 | loss: 0.2109115
	speed: 0.0196s/iter; left time: 96.6945s
	iters: 600, epoch: 6 | loss: 0.2007423
	speed: 0.0194s/iter; left time: 93.7658s
	iters: 700, epoch: 6 | loss: 0.1953382
	speed: 0.0194s/iter; left time: 91.5950s
	iters: 800, epoch: 6 | loss: 0.1887206
	speed: 0.0194s/iter; left time: 89.7109s
	iters: 900, epoch: 6 | loss: 0.2262868
	speed: 0.0209s/iter; left time: 94.3450s
	iters: 1000, epoch: 6 | loss: 0.2081530
	speed: 0.0202s/iter; left time: 89.4898s
Epoch: 6 cost time: 22.513789653778076
Epoch: 6, Steps: 1084 | Train Loss: 0.2134104 Vali Loss: 0.1757540 Test Loss: 0.2084304
Validation loss decreased (0.177010 --> 0.175754).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2293610
	speed: 0.1695s/iter; left time: 718.0979s
	iters: 200, epoch: 7 | loss: 0.2328768
	speed: 0.0201s/iter; left time: 83.0422s
	iters: 300, epoch: 7 | loss: 0.2367980
	speed: 0.0207s/iter; left time: 83.5115s
	iters: 400, epoch: 7 | loss: 0.1875745
	speed: 0.0213s/iter; left time: 83.7289s
	iters: 500, epoch: 7 | loss: 0.2090062
	speed: 0.0208s/iter; left time: 79.7929s
	iters: 600, epoch: 7 | loss: 0.1839082
	speed: 0.0206s/iter; left time: 76.9203s
	iters: 700, epoch: 7 | loss: 0.2256313
	speed: 0.0201s/iter; left time: 73.0394s
	iters: 800, epoch: 7 | loss: 0.1898329
	speed: 0.0202s/iter; left time: 71.4589s
	iters: 900, epoch: 7 | loss: 0.1870137
	speed: 0.0201s/iter; left time: 69.2033s
	iters: 1000, epoch: 7 | loss: 0.2173363
	speed: 0.0213s/iter; left time: 71.1807s
Epoch: 7 cost time: 23.145994424819946
Epoch: 7, Steps: 1084 | Train Loss: 0.2119660 Vali Loss: 0.1759227 Test Loss: 0.2098072
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2164451
	speed: 0.1842s/iter; left time: 580.6912s
	iters: 200, epoch: 8 | loss: 0.2128095
	speed: 0.0189s/iter; left time: 57.6035s
	iters: 300, epoch: 8 | loss: 0.2060915
	speed: 0.0191s/iter; left time: 56.3674s
	iters: 400, epoch: 8 | loss: 0.1809644
	speed: 0.0196s/iter; left time: 55.8341s
	iters: 500, epoch: 8 | loss: 0.1946834
	speed: 0.0201s/iter; left time: 55.3878s
	iters: 600, epoch: 8 | loss: 0.2070719
	speed: 0.0200s/iter; left time: 53.0826s
	iters: 700, epoch: 8 | loss: 0.2070231
	speed: 0.0203s/iter; left time: 51.8886s
	iters: 800, epoch: 8 | loss: 0.2160482
	speed: 0.0202s/iter; left time: 49.6489s
	iters: 900, epoch: 8 | loss: 0.1854435
	speed: 0.0205s/iter; left time: 48.1829s
	iters: 1000, epoch: 8 | loss: 0.2159759
	speed: 0.0202s/iter; left time: 45.5318s
Epoch: 8 cost time: 22.701868295669556
Epoch: 8, Steps: 1084 | Train Loss: 0.2107932 Vali Loss: 0.1776083 Test Loss: 0.2061221
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.1966263
	speed: 0.1784s/iter; left time: 369.1532s
	iters: 200, epoch: 9 | loss: 0.2127213
	speed: 0.0200s/iter; left time: 39.3995s
	iters: 300, epoch: 9 | loss: 0.2623194
	speed: 0.0195s/iter; left time: 36.4362s
	iters: 400, epoch: 9 | loss: 0.2229903
	speed: 0.0194s/iter; left time: 34.2496s
	iters: 500, epoch: 9 | loss: 0.2223773
	speed: 0.0193s/iter; left time: 32.1466s
	iters: 600, epoch: 9 | loss: 0.2271703
	speed: 0.0208s/iter; left time: 32.6147s
	iters: 700, epoch: 9 | loss: 0.1651823
	speed: 0.0197s/iter; left time: 29.0095s
	iters: 800, epoch: 9 | loss: 0.2297868
	speed: 0.0194s/iter; left time: 26.5478s
	iters: 900, epoch: 9 | loss: 0.2072580
	speed: 0.0194s/iter; left time: 24.5560s
	iters: 1000, epoch: 9 | loss: 0.2116864
	speed: 0.0209s/iter; left time: 24.3777s
Epoch: 9 cost time: 22.239758491516113
Epoch: 9, Steps: 1084 | Train Loss: 0.2096932 Vali Loss: 0.1721072 Test Loss: 0.2058617
Validation loss decreased (0.175754 --> 0.172107).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2456540
	speed: 0.1652s/iter; left time: 162.7530s
	iters: 200, epoch: 10 | loss: 0.2064006
	speed: 0.0191s/iter; left time: 16.8866s
	iters: 300, epoch: 10 | loss: 0.1872608
	speed: 0.0196s/iter; left time: 15.4242s
	iters: 400, epoch: 10 | loss: 0.1779462
	speed: 0.0200s/iter; left time: 13.7329s
	iters: 500, epoch: 10 | loss: 0.1721100
	speed: 0.0200s/iter; left time: 11.7271s
	iters: 600, epoch: 10 | loss: 0.2298447
	speed: 0.0200s/iter; left time: 9.7053s
	iters: 700, epoch: 10 | loss: 0.2299927
	speed: 0.0195s/iter; left time: 7.5114s
	iters: 800, epoch: 10 | loss: 0.2624602
	speed: 0.0202s/iter; left time: 5.7681s
	iters: 900, epoch: 10 | loss: 0.1905384
	speed: 0.0189s/iter; left time: 3.4964s
	iters: 1000, epoch: 10 | loss: 0.1869431
	speed: 0.0214s/iter; left time: 1.8211s
Epoch: 10 cost time: 22.394259929656982
Epoch: 10, Steps: 1084 | Train Loss: 0.2088765 Vali Loss: 0.1714277 Test Loss: 0.2047450
Validation loss decreased (0.172107 --> 0.171428).  Saving model ...
Updating learning rate to 9.765625e-05
>>>>>>>testing : Electricity_336_720_GLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.20464813709259033, mae:0.30182355642318726
