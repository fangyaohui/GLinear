Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='GLinear', model_id='weather_336_12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=12, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_12_GLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36540
val 5259
test 10528
	iters: 100, epoch: 1 | loss: 7.1496530
	speed: 0.0112s/iter; left time: 254.2415s
	iters: 200, epoch: 1 | loss: 11.3665848
	speed: 0.0054s/iter; left time: 123.1521s
	iters: 300, epoch: 1 | loss: 0.3917586
	speed: 0.0051s/iter; left time: 114.1024s
	iters: 400, epoch: 1 | loss: 0.1655841
	speed: 0.0054s/iter; left time: 122.1349s
	iters: 500, epoch: 1 | loss: 0.1720459
	speed: 0.0057s/iter; left time: 127.4979s
	iters: 600, epoch: 1 | loss: 0.3399515
	speed: 0.0052s/iter; left time: 115.7708s
	iters: 700, epoch: 1 | loss: 0.2241905
	speed: 0.0053s/iter; left time: 118.0088s
	iters: 800, epoch: 1 | loss: 0.1508881
	speed: 0.0050s/iter; left time: 109.6536s
	iters: 900, epoch: 1 | loss: 0.2810496
	speed: 0.0057s/iter; left time: 125.5436s
	iters: 1000, epoch: 1 | loss: 0.2495156
	speed: 0.0055s/iter; left time: 120.0579s
	iters: 1100, epoch: 1 | loss: 0.1759719
	speed: 0.0054s/iter; left time: 117.1762s
	iters: 1200, epoch: 1 | loss: 1.2102842
	speed: 0.0072s/iter; left time: 154.7976s
	iters: 1300, epoch: 1 | loss: 0.1958870
	speed: 0.0055s/iter; left time: 118.8746s
	iters: 1400, epoch: 1 | loss: 0.2678967
	speed: 0.0054s/iter; left time: 114.7095s
	iters: 1500, epoch: 1 | loss: 0.1292782
	speed: 0.0053s/iter; left time: 113.0538s
	iters: 1600, epoch: 1 | loss: 0.4449178
	speed: 0.0056s/iter; left time: 119.3106s
	iters: 1700, epoch: 1 | loss: 0.8678974
	speed: 0.0056s/iter; left time: 118.1545s
	iters: 1800, epoch: 1 | loss: 0.2575714
	speed: 0.0051s/iter; left time: 108.1861s
	iters: 1900, epoch: 1 | loss: 0.1003582
	speed: 0.0056s/iter; left time: 118.1542s
	iters: 2000, epoch: 1 | loss: 0.2460799
	speed: 0.0052s/iter; left time: 109.1652s
	iters: 2100, epoch: 1 | loss: 0.5606233
	speed: 0.0055s/iter; left time: 113.2546s
	iters: 2200, epoch: 1 | loss: 1.7009327
	speed: 0.0056s/iter; left time: 114.7073s
Epoch: 1 cost time: 13.208778858184814
Epoch: 1, Steps: 2283 | Train Loss: 25.2572005 Vali Loss: 0.3646138 Test Loss: 0.4134648
Validation loss decreased (inf --> 0.364614).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.1459571
	speed: 0.0714s/iter; left time: 1460.1492s
	iters: 200, epoch: 2 | loss: 0.4679090
	speed: 0.0054s/iter; left time: 109.6003s
	iters: 300, epoch: 2 | loss: 0.7735201
	speed: 0.0057s/iter; left time: 116.3600s
	iters: 400, epoch: 2 | loss: 0.1562797
	speed: 0.0054s/iter; left time: 109.1764s
	iters: 500, epoch: 2 | loss: 0.1417443
	speed: 0.0052s/iter; left time: 105.0526s
	iters: 600, epoch: 2 | loss: 0.0888908
	speed: 0.0056s/iter; left time: 110.8422s
	iters: 700, epoch: 2 | loss: 0.1736947
	speed: 0.0053s/iter; left time: 105.2303s
	iters: 800, epoch: 2 | loss: 0.1744463
	speed: 0.0060s/iter; left time: 118.3546s
	iters: 900, epoch: 2 | loss: 0.1566964
	speed: 0.0057s/iter; left time: 112.9507s
	iters: 1000, epoch: 2 | loss: 0.2589849
	speed: 0.0061s/iter; left time: 119.2746s
	iters: 1100, epoch: 2 | loss: 0.3415751
	speed: 0.0063s/iter; left time: 121.9537s
	iters: 1200, epoch: 2 | loss: 0.2944835
	speed: 0.0059s/iter; left time: 114.9803s
	iters: 1300, epoch: 2 | loss: 620597.9375000
	speed: 0.0056s/iter; left time: 107.5535s
	iters: 1400, epoch: 2 | loss: 432.0466614
	speed: 0.0058s/iter; left time: 111.3092s
	iters: 1500, epoch: 2 | loss: 89.9528503
	speed: 0.0057s/iter; left time: 108.3797s
	iters: 1600, epoch: 2 | loss: 36.7294388
	speed: 0.0061s/iter; left time: 115.5711s
	iters: 1700, epoch: 2 | loss: 40.0201111
	speed: 0.0055s/iter; left time: 104.5280s
	iters: 1800, epoch: 2 | loss: 30.9481640
	speed: 0.0056s/iter; left time: 105.8509s
	iters: 1900, epoch: 2 | loss: 22.4962502
	speed: 0.0055s/iter; left time: 102.9775s
	iters: 2000, epoch: 2 | loss: 21.2353172
	speed: 0.0058s/iter; left time: 107.8787s
	iters: 2100, epoch: 2 | loss: 17.8492374
	speed: 0.0056s/iter; left time: 103.5738s
	iters: 2200, epoch: 2 | loss: 18.0828266
	speed: 0.0062s/iter; left time: 113.1799s
Epoch: 2 cost time: 13.888574838638306
Epoch: 2, Steps: 2283 | Train Loss: 6105.1665733 Vali Loss: 15.8558264 Test Loss: 7.9453835
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 8.5298557
	speed: 0.0737s/iter; left time: 1339.1576s
	iters: 200, epoch: 3 | loss: 16.5450077
	speed: 0.0056s/iter; left time: 101.2854s
	iters: 300, epoch: 3 | loss: 13.5123987
	speed: 0.0056s/iter; left time: 99.9068s
	iters: 400, epoch: 3 | loss: 9.9851561
	speed: 0.0054s/iter; left time: 96.2560s
	iters: 500, epoch: 3 | loss: 10.9669819
	speed: 0.0056s/iter; left time: 98.6319s
	iters: 600, epoch: 3 | loss: 9.0601959
	speed: 0.0055s/iter; left time: 98.0211s
	iters: 700, epoch: 3 | loss: 9.7191601
	speed: 0.0055s/iter; left time: 95.8941s
	iters: 800, epoch: 3 | loss: 9.9460039
	speed: 0.0054s/iter; left time: 94.1107s
	iters: 900, epoch: 3 | loss: 7.5202494
	speed: 0.0056s/iter; left time: 97.9879s
	iters: 1000, epoch: 3 | loss: 6.8114119
	speed: 0.0052s/iter; left time: 89.7349s
	iters: 1100, epoch: 3 | loss: 13.3341618
	speed: 0.0053s/iter; left time: 90.4589s
	iters: 1200, epoch: 3 | loss: 6.7569938
	speed: 0.0062s/iter; left time: 105.4473s
	iters: 1300, epoch: 3 | loss: 7.5032039
	speed: 0.0060s/iter; left time: 100.9751s
	iters: 1400, epoch: 3 | loss: 8.6696272
	speed: 0.0060s/iter; left time: 101.5801s
	iters: 1500, epoch: 3 | loss: 18.1212387
	speed: 0.0054s/iter; left time: 90.8017s
	iters: 1600, epoch: 3 | loss: 5.3418398
	speed: 0.0054s/iter; left time: 89.7180s
	iters: 1700, epoch: 3 | loss: 5.0329971
	speed: 0.0060s/iter; left time: 98.8953s
	iters: 1800, epoch: 3 | loss: 6.2002907
	speed: 0.0056s/iter; left time: 92.0796s
	iters: 1900, epoch: 3 | loss: 5.9433084
	speed: 0.0056s/iter; left time: 91.8662s
	iters: 2000, epoch: 3 | loss: 4.2969141
	speed: 0.0060s/iter; left time: 97.6796s
	iters: 2100, epoch: 3 | loss: 5.4110246
	speed: 0.0057s/iter; left time: 91.4715s
	iters: 2200, epoch: 3 | loss: 4.7361917
	speed: 0.0059s/iter; left time: 95.0897s
Epoch: 3 cost time: 13.546368598937988
Epoch: 3, Steps: 2283 | Train Loss: 10.0136007 Vali Loss: 5.9593849 Test Loss: 2.7841415
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 3.8772888
	speed: 0.0690s/iter; left time: 1095.4778s
	iters: 200, epoch: 4 | loss: 4.5316844
	speed: 0.0057s/iter; left time: 90.1870s
	iters: 300, epoch: 4 | loss: 3.9034314
	speed: 0.0059s/iter; left time: 91.7880s
	iters: 400, epoch: 4 | loss: 4.5756063
	speed: 0.0061s/iter; left time: 95.3115s
	iters: 500, epoch: 4 | loss: 4.6483898
	speed: 0.0054s/iter; left time: 82.9341s
	iters: 600, epoch: 4 | loss: 3.8487091
	speed: 0.0058s/iter; left time: 89.8730s
	iters: 700, epoch: 4 | loss: 2.5211339
	speed: 0.0053s/iter; left time: 81.6528s
	iters: 800, epoch: 4 | loss: 3.0193949
	speed: 0.0052s/iter; left time: 78.8014s
	iters: 900, epoch: 4 | loss: 2.9411705
	speed: 0.0057s/iter; left time: 86.4858s
	iters: 1000, epoch: 4 | loss: 3.4571738
	speed: 0.0064s/iter; left time: 95.8401s
	iters: 1100, epoch: 4 | loss: 4.0273705
	speed: 0.0064s/iter; left time: 95.6019s
	iters: 1200, epoch: 4 | loss: 3.1939929
	speed: 0.0065s/iter; left time: 95.5098s
	iters: 1300, epoch: 4 | loss: 2.7322860
	speed: 0.0061s/iter; left time: 90.2571s
	iters: 1400, epoch: 4 | loss: 3.2463002
	speed: 0.0057s/iter; left time: 82.8386s
	iters: 1500, epoch: 4 | loss: 3.5951302
	speed: 0.0055s/iter; left time: 80.1117s
	iters: 1600, epoch: 4 | loss: 3.2680473
	speed: 0.0062s/iter; left time: 88.6624s
	iters: 1700, epoch: 4 | loss: 2.7313426
	speed: 0.0059s/iter; left time: 84.6288s
	iters: 1800, epoch: 4 | loss: 7.6936283
	speed: 0.0057s/iter; left time: 80.8327s
	iters: 1900, epoch: 4 | loss: 2.3020637
	speed: 0.0057s/iter; left time: 80.1943s
	iters: 2000, epoch: 4 | loss: 2.6103077
	speed: 0.0062s/iter; left time: 86.2764s
	iters: 2100, epoch: 4 | loss: 2.2888494
	speed: 0.0056s/iter; left time: 77.7219s
	iters: 2200, epoch: 4 | loss: 2.6570268
	speed: 0.0056s/iter; left time: 77.1020s
Epoch: 4 cost time: 14.033387184143066
Epoch: 4, Steps: 2283 | Train Loss: 4.1270942 Vali Loss: 27.0544128 Test Loss: 15.9786196
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_12_GLinear_custom_ftM_sl336_ll48_pl12_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10528
mse:0.41346466541290283, mae:0.396493524312973
