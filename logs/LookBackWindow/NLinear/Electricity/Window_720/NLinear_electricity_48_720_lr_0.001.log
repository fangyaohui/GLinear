Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_48_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=48, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_48_720_NLinear_custom_ftM_sl48_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17645
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4397149
	speed: 0.0292s/iter; left time: 318.4327s
	iters: 200, epoch: 1 | loss: 0.4313332
	speed: 0.0206s/iter; left time: 222.3953s
	iters: 300, epoch: 1 | loss: 0.3640029
	speed: 0.0203s/iter; left time: 217.7597s
	iters: 400, epoch: 1 | loss: 0.3518909
	speed: 0.0216s/iter; left time: 229.2125s
	iters: 500, epoch: 1 | loss: 0.3184755
	speed: 0.0211s/iter; left time: 221.9558s
	iters: 600, epoch: 1 | loss: 0.3321502
	speed: 0.0209s/iter; left time: 217.3019s
	iters: 700, epoch: 1 | loss: 0.3260993
	speed: 0.0208s/iter; left time: 214.6409s
	iters: 800, epoch: 1 | loss: 0.3305304
	speed: 0.0221s/iter; left time: 225.5284s
	iters: 900, epoch: 1 | loss: 0.3107291
	speed: 0.0212s/iter; left time: 214.9156s
	iters: 1000, epoch: 1 | loss: 0.3185923
	speed: 0.0204s/iter; left time: 204.4214s
	iters: 1100, epoch: 1 | loss: 0.3211448
	speed: 0.0189s/iter; left time: 187.6696s
Epoch: 1 cost time: 23.837230682373047
Epoch: 1, Steps: 1102 | Train Loss: 0.3961971 Vali Loss: 0.2781197 Test Loss: 0.3090536
Validation loss decreased (inf --> 0.278120).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3216747
	speed: 0.1774s/iter; left time: 1741.7144s
	iters: 200, epoch: 2 | loss: 0.2827236
	speed: 0.0203s/iter; left time: 197.7799s
	iters: 300, epoch: 2 | loss: 0.3484867
	speed: 0.0207s/iter; left time: 198.9910s
	iters: 400, epoch: 2 | loss: 0.3350235
	speed: 0.0207s/iter; left time: 196.7618s
	iters: 500, epoch: 2 | loss: 0.3240030
	speed: 0.0205s/iter; left time: 193.4032s
	iters: 600, epoch: 2 | loss: 0.3109604
	speed: 0.0206s/iter; left time: 191.6359s
	iters: 700, epoch: 2 | loss: 0.3574029
	speed: 0.0202s/iter; left time: 186.1396s
	iters: 800, epoch: 2 | loss: 0.3303724
	speed: 0.0227s/iter; left time: 207.1860s
	iters: 900, epoch: 2 | loss: 0.3404776
	speed: 0.0204s/iter; left time: 183.5590s
	iters: 1000, epoch: 2 | loss: 0.2891268
	speed: 0.0211s/iter; left time: 188.4769s
	iters: 1100, epoch: 2 | loss: 0.3381290
	speed: 0.0209s/iter; left time: 184.0398s
Epoch: 2 cost time: 23.95364212989807
Epoch: 2, Steps: 1102 | Train Loss: 0.3215269 Vali Loss: 0.2714359 Test Loss: 0.3019481
Validation loss decreased (0.278120 --> 0.271436).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2994859
	speed: 0.1707s/iter; left time: 1487.6391s
	iters: 200, epoch: 3 | loss: 0.3282445
	speed: 0.0185s/iter; left time: 159.5909s
	iters: 300, epoch: 3 | loss: 0.3088566
	speed: 0.0180s/iter; left time: 153.0636s
	iters: 400, epoch: 3 | loss: 0.3146029
	speed: 0.0179s/iter; left time: 150.9535s
	iters: 500, epoch: 3 | loss: 0.3035635
	speed: 0.0177s/iter; left time: 147.2487s
	iters: 600, epoch: 3 | loss: 0.3219596
	speed: 0.0183s/iter; left time: 150.3562s
	iters: 700, epoch: 3 | loss: 0.2883855
	speed: 0.0185s/iter; left time: 149.8836s
	iters: 800, epoch: 3 | loss: 0.3640789
	speed: 0.0211s/iter; left time: 169.3480s
	iters: 900, epoch: 3 | loss: 0.3075884
	speed: 0.0185s/iter; left time: 146.1639s
	iters: 1000, epoch: 3 | loss: 0.3618118
	speed: 0.0195s/iter; left time: 152.7226s
	iters: 1100, epoch: 3 | loss: 0.3220654
	speed: 0.0181s/iter; left time: 139.3261s
Epoch: 3 cost time: 21.477907180786133
Epoch: 3, Steps: 1102 | Train Loss: 0.3177491 Vali Loss: 0.2696649 Test Loss: 0.3003390
Validation loss decreased (0.271436 --> 0.269665).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3105505
	speed: 0.2021s/iter; left time: 1539.1108s
	iters: 200, epoch: 4 | loss: 0.3017957
	speed: 0.0187s/iter; left time: 140.2937s
	iters: 300, epoch: 4 | loss: 0.2868825
	speed: 0.0198s/iter; left time: 147.0257s
	iters: 400, epoch: 4 | loss: 0.2920572
	speed: 0.0194s/iter; left time: 141.6559s
	iters: 500, epoch: 4 | loss: 0.2986363
	speed: 0.0207s/iter; left time: 149.1327s
	iters: 600, epoch: 4 | loss: 0.2905931
	speed: 0.0199s/iter; left time: 141.2815s
	iters: 700, epoch: 4 | loss: 0.3197606
	speed: 0.0207s/iter; left time: 145.2566s
	iters: 800, epoch: 4 | loss: 0.2790978
	speed: 0.0210s/iter; left time: 145.5162s
	iters: 900, epoch: 4 | loss: 0.2946755
	speed: 0.0199s/iter; left time: 135.5131s
	iters: 1000, epoch: 4 | loss: 0.3512862
	speed: 0.0205s/iter; left time: 137.5909s
	iters: 1100, epoch: 4 | loss: 0.3287489
	speed: 0.0200s/iter; left time: 132.3186s
Epoch: 4 cost time: 23.19045090675354
Epoch: 4, Steps: 1102 | Train Loss: 0.3167287 Vali Loss: 0.2691257 Test Loss: 0.2997071
Validation loss decreased (0.269665 --> 0.269126).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3299496
	speed: 0.1684s/iter; left time: 1096.9463s
	iters: 200, epoch: 5 | loss: 0.2883234
	speed: 0.0211s/iter; left time: 135.3429s
	iters: 300, epoch: 5 | loss: 0.3365172
	speed: 0.0192s/iter; left time: 121.2651s
	iters: 400, epoch: 5 | loss: 0.3156851
	speed: 0.0202s/iter; left time: 125.4640s
	iters: 500, epoch: 5 | loss: 0.3128666
	speed: 0.0207s/iter; left time: 126.7591s
	iters: 600, epoch: 5 | loss: 0.3135131
	speed: 0.0201s/iter; left time: 120.6875s
	iters: 700, epoch: 5 | loss: 0.3108502
	speed: 0.0196s/iter; left time: 115.6914s
	iters: 800, epoch: 5 | loss: 0.2731973
	speed: 0.0203s/iter; left time: 117.7694s
	iters: 900, epoch: 5 | loss: 0.2757792
	speed: 0.0198s/iter; left time: 112.9370s
	iters: 1000, epoch: 5 | loss: 0.3178053
	speed: 0.0193s/iter; left time: 108.2752s
	iters: 1100, epoch: 5 | loss: 0.3000304
	speed: 0.0202s/iter; left time: 111.5070s
Epoch: 5 cost time: 22.990607976913452
Epoch: 5, Steps: 1102 | Train Loss: 0.3163530 Vali Loss: 0.2688256 Test Loss: 0.2993701
Validation loss decreased (0.269126 --> 0.268826).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2961431
	speed: 0.1686s/iter; left time: 912.2921s
	iters: 200, epoch: 6 | loss: 0.3536158
	speed: 0.0197s/iter; left time: 104.4681s
	iters: 300, epoch: 6 | loss: 0.3200399
	speed: 0.0199s/iter; left time: 103.7457s
	iters: 400, epoch: 6 | loss: 0.2949383
	speed: 0.0195s/iter; left time: 99.7819s
	iters: 500, epoch: 6 | loss: 0.3579901
	speed: 0.0203s/iter; left time: 101.8685s
	iters: 600, epoch: 6 | loss: 0.2701544
	speed: 0.0200s/iter; left time: 98.2656s
	iters: 700, epoch: 6 | loss: 0.3025973
	speed: 0.0196s/iter; left time: 94.2394s
	iters: 800, epoch: 6 | loss: 0.3010186
	speed: 0.0190s/iter; left time: 89.7132s
	iters: 900, epoch: 6 | loss: 0.3357325
	speed: 0.0210s/iter; left time: 96.8919s
	iters: 1000, epoch: 6 | loss: 0.2909555
	speed: 0.0197s/iter; left time: 88.9651s
	iters: 1100, epoch: 6 | loss: 0.3413839
	speed: 0.0197s/iter; left time: 86.8154s
Epoch: 6 cost time: 22.75289535522461
Epoch: 6, Steps: 1102 | Train Loss: 0.3161150 Vali Loss: 0.2685640 Test Loss: 0.2991915
Validation loss decreased (0.268826 --> 0.268564).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2925468
	speed: 0.1698s/iter; left time: 731.6650s
	iters: 200, epoch: 7 | loss: 0.3110337
	speed: 0.0195s/iter; left time: 81.9034s
	iters: 300, epoch: 7 | loss: 0.3684249
	speed: 0.0195s/iter; left time: 80.1128s
	iters: 400, epoch: 7 | loss: 0.3319803
	speed: 0.0196s/iter; left time: 78.6793s
	iters: 500, epoch: 7 | loss: 0.3197538
	speed: 0.0192s/iter; left time: 75.2301s
	iters: 600, epoch: 7 | loss: 0.2629088
	speed: 0.0195s/iter; left time: 74.3738s
	iters: 700, epoch: 7 | loss: 0.3130061
	speed: 0.0209s/iter; left time: 77.4838s
	iters: 800, epoch: 7 | loss: 0.3249570
	speed: 0.0189s/iter; left time: 68.0843s
	iters: 900, epoch: 7 | loss: 0.2994128
	speed: 0.0203s/iter; left time: 71.1322s
	iters: 1000, epoch: 7 | loss: 0.3659846
	speed: 0.0191s/iter; left time: 65.2056s
	iters: 1100, epoch: 7 | loss: 0.3345201
	speed: 0.0204s/iter; left time: 67.4089s
Epoch: 7 cost time: 22.57997751235962
Epoch: 7, Steps: 1102 | Train Loss: 0.3160499 Vali Loss: 0.2685122 Test Loss: 0.2990903
Validation loss decreased (0.268564 --> 0.268512).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3001437
	speed: 0.1664s/iter; left time: 533.6066s
	iters: 200, epoch: 8 | loss: 0.3444618
	speed: 0.0196s/iter; left time: 61.0111s
	iters: 300, epoch: 8 | loss: 0.2904432
	speed: 0.0196s/iter; left time: 58.8249s
	iters: 400, epoch: 8 | loss: 0.3263815
	speed: 0.0189s/iter; left time: 54.9778s
	iters: 500, epoch: 8 | loss: 0.3022892
	speed: 0.0199s/iter; left time: 55.8529s
	iters: 600, epoch: 8 | loss: 0.3216358
	speed: 0.0195s/iter; left time: 52.8709s
	iters: 700, epoch: 8 | loss: 0.3146845
	speed: 0.0189s/iter; left time: 49.1805s
	iters: 800, epoch: 8 | loss: 0.3164998
	speed: 0.0188s/iter; left time: 47.1200s
	iters: 900, epoch: 8 | loss: 0.3160402
	speed: 0.0201s/iter; left time: 48.3760s
	iters: 1000, epoch: 8 | loss: 0.2858612
	speed: 0.0202s/iter; left time: 46.7061s
	iters: 1100, epoch: 8 | loss: 0.3294122
	speed: 0.0190s/iter; left time: 41.9130s
Epoch: 8 cost time: 22.439491987228394
Epoch: 8, Steps: 1102 | Train Loss: 0.3159528 Vali Loss: 0.2685393 Test Loss: 0.2990407
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3408574
	speed: 0.1695s/iter; left time: 356.7850s
	iters: 200, epoch: 9 | loss: 0.3173179
	speed: 0.0191s/iter; left time: 38.2640s
	iters: 300, epoch: 9 | loss: 0.3666348
	speed: 0.0200s/iter; left time: 38.0382s
	iters: 400, epoch: 9 | loss: 0.3429212
	speed: 0.0188s/iter; left time: 33.9635s
	iters: 500, epoch: 9 | loss: 0.3095818
	speed: 0.0190s/iter; left time: 32.4075s
	iters: 600, epoch: 9 | loss: 0.3138202
	speed: 0.0188s/iter; left time: 30.1021s
	iters: 700, epoch: 9 | loss: 0.2717324
	speed: 0.0183s/iter; left time: 27.5551s
	iters: 800, epoch: 9 | loss: 0.2508096
	speed: 0.0178s/iter; left time: 24.9963s
	iters: 900, epoch: 9 | loss: 0.3368972
	speed: 0.0182s/iter; left time: 23.7214s
	iters: 1000, epoch: 9 | loss: 0.3345909
	speed: 0.0194s/iter; left time: 23.4169s
	iters: 1100, epoch: 9 | loss: 0.3142607
	speed: 0.0187s/iter; left time: 20.6194s
Epoch: 9 cost time: 21.72909951210022
Epoch: 9, Steps: 1102 | Train Loss: 0.3159591 Vali Loss: 0.2684945 Test Loss: 0.2990258
Validation loss decreased (0.268512 --> 0.268494).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3547834
	speed: 0.1646s/iter; left time: 165.1103s
	iters: 200, epoch: 10 | loss: 0.3238386
	speed: 0.0202s/iter; left time: 18.2009s
	iters: 300, epoch: 10 | loss: 0.3087546
	speed: 0.0196s/iter; left time: 15.7619s
	iters: 400, epoch: 10 | loss: 0.3374768
	speed: 0.0216s/iter; left time: 15.1939s
	iters: 500, epoch: 10 | loss: 0.2978592
	speed: 0.0210s/iter; left time: 12.6496s
	iters: 600, epoch: 10 | loss: 0.3145380
	speed: 0.0203s/iter; left time: 10.1983s
	iters: 700, epoch: 10 | loss: 0.3052689
	speed: 0.0194s/iter; left time: 7.8341s
	iters: 800, epoch: 10 | loss: 0.3387737
	speed: 0.0202s/iter; left time: 6.1300s
	iters: 900, epoch: 10 | loss: 0.2924393
	speed: 0.0192s/iter; left time: 3.8960s
	iters: 1000, epoch: 10 | loss: 0.2953525
	speed: 0.0230s/iter; left time: 2.3709s
	iters: 1100, epoch: 10 | loss: 0.3375698
	speed: 0.0214s/iter; left time: 0.0641s
Epoch: 10 cost time: 23.51277208328247
Epoch: 10, Steps: 1102 | Train Loss: 0.3159194 Vali Loss: 0.2685922 Test Loss: 0.2990124
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_48_720_NLinear_custom_ftM_sl48_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.298962265253067, mae:0.35174182057380676
