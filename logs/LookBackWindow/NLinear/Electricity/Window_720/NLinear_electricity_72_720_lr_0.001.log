Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_72_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=72, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_72_720_NLinear_custom_ftM_sl72_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17621
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3962492
	speed: 0.0312s/iter; left time: 340.8336s
	iters: 200, epoch: 1 | loss: 0.3598890
	speed: 0.0199s/iter; left time: 215.6310s
	iters: 300, epoch: 1 | loss: 0.3032418
	speed: 0.0230s/iter; left time: 245.9109s
	iters: 400, epoch: 1 | loss: 0.2892097
	speed: 0.0204s/iter; left time: 216.8398s
	iters: 500, epoch: 1 | loss: 0.3065182
	speed: 0.0227s/iter; left time: 238.1273s
	iters: 600, epoch: 1 | loss: 0.2809672
	speed: 0.0213s/iter; left time: 221.4297s
	iters: 700, epoch: 1 | loss: 0.2707195
	speed: 0.0208s/iter; left time: 214.0520s
	iters: 800, epoch: 1 | loss: 0.3109093
	speed: 0.0226s/iter; left time: 230.3568s
	iters: 900, epoch: 1 | loss: 0.2740074
	speed: 0.0211s/iter; left time: 213.0124s
	iters: 1000, epoch: 1 | loss: 0.3391607
	speed: 0.0229s/iter; left time: 229.5429s
	iters: 1100, epoch: 1 | loss: 0.3066809
	speed: 0.0200s/iter; left time: 198.5463s
Epoch: 1 cost time: 24.720555782318115
Epoch: 1, Steps: 1101 | Train Loss: 0.3522592 Vali Loss: 0.2509294 Test Loss: 0.2811277
Validation loss decreased (inf --> 0.250929).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2970879
	speed: 0.2038s/iter; left time: 1999.5011s
	iters: 200, epoch: 2 | loss: 0.2674424
	speed: 0.0247s/iter; left time: 240.2295s
	iters: 300, epoch: 2 | loss: 0.2960570
	speed: 0.0232s/iter; left time: 223.2755s
	iters: 400, epoch: 2 | loss: 0.2563253
	speed: 0.0263s/iter; left time: 249.8602s
	iters: 500, epoch: 2 | loss: 0.2722323
	speed: 0.0283s/iter; left time: 266.3210s
	iters: 600, epoch: 2 | loss: 0.3130235
	speed: 0.0283s/iter; left time: 263.0221s
	iters: 700, epoch: 2 | loss: 0.2910163
	speed: 0.0269s/iter; left time: 247.3237s
	iters: 800, epoch: 2 | loss: 0.2670818
	speed: 0.0263s/iter; left time: 240.0239s
	iters: 900, epoch: 2 | loss: 0.3068557
	speed: 0.0259s/iter; left time: 233.2414s
	iters: 1000, epoch: 2 | loss: 0.2917713
	speed: 0.0266s/iter; left time: 237.4139s
	iters: 1100, epoch: 2 | loss: 0.2571210
	speed: 0.0273s/iter; left time: 240.4690s
Epoch: 2 cost time: 29.98485255241394
Epoch: 2, Steps: 1101 | Train Loss: 0.2930900 Vali Loss: 0.2453355 Test Loss: 0.2751170
Validation loss decreased (0.250929 --> 0.245335).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3145570
	speed: 0.1844s/iter; left time: 1606.3573s
	iters: 200, epoch: 3 | loss: 0.3214387
	speed: 0.0209s/iter; left time: 180.3424s
	iters: 300, epoch: 3 | loss: 0.2778983
	speed: 0.0215s/iter; left time: 183.1326s
	iters: 400, epoch: 3 | loss: 0.2535805
	speed: 0.0208s/iter; left time: 175.2238s
	iters: 500, epoch: 3 | loss: 0.3194618
	speed: 0.0215s/iter; left time: 178.3706s
	iters: 600, epoch: 3 | loss: 0.2850405
	speed: 0.0215s/iter; left time: 176.4846s
	iters: 700, epoch: 3 | loss: 0.2724224
	speed: 0.0210s/iter; left time: 170.6867s
	iters: 800, epoch: 3 | loss: 0.2644397
	speed: 0.0218s/iter; left time: 174.4350s
	iters: 900, epoch: 3 | loss: 0.2795831
	speed: 0.0209s/iter; left time: 165.4356s
	iters: 1000, epoch: 3 | loss: 0.3061573
	speed: 0.0213s/iter; left time: 166.0978s
	iters: 1100, epoch: 3 | loss: 0.2717394
	speed: 0.0213s/iter; left time: 164.4900s
Epoch: 3 cost time: 24.388882398605347
Epoch: 3, Steps: 1101 | Train Loss: 0.2898680 Vali Loss: 0.2441561 Test Loss: 0.2736968
Validation loss decreased (0.245335 --> 0.244156).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3347207
	speed: 0.1798s/iter; left time: 1367.6806s
	iters: 200, epoch: 4 | loss: 0.2709307
	speed: 0.0234s/iter; left time: 175.4409s
	iters: 300, epoch: 4 | loss: 0.2698393
	speed: 0.0249s/iter; left time: 184.7053s
	iters: 400, epoch: 4 | loss: 0.2736153
	speed: 0.0229s/iter; left time: 167.4671s
	iters: 500, epoch: 4 | loss: 0.3098911
	speed: 0.0226s/iter; left time: 162.7474s
	iters: 600, epoch: 4 | loss: 0.3008116
	speed: 0.0208s/iter; left time: 147.9656s
	iters: 700, epoch: 4 | loss: 0.2709368
	speed: 0.0217s/iter; left time: 152.2772s
	iters: 800, epoch: 4 | loss: 0.2900132
	speed: 0.0226s/iter; left time: 156.0302s
	iters: 900, epoch: 4 | loss: 0.3375609
	speed: 0.0222s/iter; left time: 150.8754s
	iters: 1000, epoch: 4 | loss: 0.3054229
	speed: 0.0234s/iter; left time: 156.7678s
	iters: 1100, epoch: 4 | loss: 0.2744680
	speed: 0.0227s/iter; left time: 149.8981s
Epoch: 4 cost time: 25.961649417877197
Epoch: 4, Steps: 1101 | Train Loss: 0.2888269 Vali Loss: 0.2434112 Test Loss: 0.2731655
Validation loss decreased (0.244156 --> 0.243411).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2662161
	speed: 0.1789s/iter; left time: 1163.9363s
	iters: 200, epoch: 5 | loss: 0.2987455
	speed: 0.0200s/iter; left time: 128.1699s
	iters: 300, epoch: 5 | loss: 0.2949124
	speed: 0.0213s/iter; left time: 134.0289s
	iters: 400, epoch: 5 | loss: 0.3107519
	speed: 0.0208s/iter; left time: 128.9399s
	iters: 500, epoch: 5 | loss: 0.3351608
	speed: 0.0218s/iter; left time: 133.2901s
	iters: 600, epoch: 5 | loss: 0.2881447
	speed: 0.0203s/iter; left time: 122.2232s
	iters: 700, epoch: 5 | loss: 0.2450155
	speed: 0.0219s/iter; left time: 129.2442s
	iters: 800, epoch: 5 | loss: 0.2774082
	speed: 0.0230s/iter; left time: 133.8139s
	iters: 900, epoch: 5 | loss: 0.3160179
	speed: 0.0210s/iter; left time: 119.6986s
	iters: 1000, epoch: 5 | loss: 0.2836978
	speed: 0.0229s/iter; left time: 128.4392s
	iters: 1100, epoch: 5 | loss: 0.2765425
	speed: 0.0219s/iter; left time: 120.3721s
Epoch: 5 cost time: 24.76413059234619
Epoch: 5, Steps: 1101 | Train Loss: 0.2883727 Vali Loss: 0.2431590 Test Loss: 0.2727790
Validation loss decreased (0.243411 --> 0.243159).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2840189
	speed: 0.1836s/iter; left time: 992.3871s
	iters: 200, epoch: 6 | loss: 0.3019337
	speed: 0.0216s/iter; left time: 114.5086s
	iters: 300, epoch: 6 | loss: 0.2760623
	speed: 0.0213s/iter; left time: 110.9583s
	iters: 400, epoch: 6 | loss: 0.2716050
	speed: 0.0208s/iter; left time: 106.0148s
	iters: 500, epoch: 6 | loss: 0.2790673
	speed: 0.0207s/iter; left time: 103.8021s
	iters: 600, epoch: 6 | loss: 0.2703294
	speed: 0.0217s/iter; left time: 106.6597s
	iters: 700, epoch: 6 | loss: 0.2624863
	speed: 0.0211s/iter; left time: 101.4519s
	iters: 800, epoch: 6 | loss: 0.2971384
	speed: 0.0202s/iter; left time: 95.2181s
	iters: 900, epoch: 6 | loss: 0.2849163
	speed: 0.0228s/iter; left time: 105.2035s
	iters: 1000, epoch: 6 | loss: 0.2609281
	speed: 0.0215s/iter; left time: 97.0824s
	iters: 1100, epoch: 6 | loss: 0.3411682
	speed: 0.0209s/iter; left time: 92.1368s
Epoch: 6 cost time: 24.366514444351196
Epoch: 6, Steps: 1101 | Train Loss: 0.2881700 Vali Loss: 0.2430474 Test Loss: 0.2726928
Validation loss decreased (0.243159 --> 0.243047).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2663398
	speed: 0.1767s/iter; left time: 760.8094s
	iters: 200, epoch: 7 | loss: 0.2585591
	speed: 0.0228s/iter; left time: 95.9284s
	iters: 300, epoch: 7 | loss: 0.2633475
	speed: 0.0210s/iter; left time: 86.3747s
	iters: 400, epoch: 7 | loss: 0.3029787
	speed: 0.0218s/iter; left time: 87.3282s
	iters: 500, epoch: 7 | loss: 0.2906412
	speed: 0.0221s/iter; left time: 86.4344s
	iters: 600, epoch: 7 | loss: 0.2870352
	speed: 0.0215s/iter; left time: 81.9111s
	iters: 700, epoch: 7 | loss: 0.2732828
	speed: 0.0216s/iter; left time: 79.9132s
	iters: 800, epoch: 7 | loss: 0.2964437
	speed: 0.0209s/iter; left time: 75.3226s
	iters: 900, epoch: 7 | loss: 0.2541535
	speed: 0.0214s/iter; left time: 74.9018s
	iters: 1000, epoch: 7 | loss: 0.2698154
	speed: 0.0211s/iter; left time: 71.9818s
	iters: 1100, epoch: 7 | loss: 0.2867338
	speed: 0.0211s/iter; left time: 69.6586s
Epoch: 7 cost time: 24.759650230407715
Epoch: 7, Steps: 1101 | Train Loss: 0.2880660 Vali Loss: 0.2429833 Test Loss: 0.2725938
Validation loss decreased (0.243047 --> 0.242983).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2646644
	speed: 0.1760s/iter; left time: 563.8944s
	iters: 200, epoch: 8 | loss: 0.3016115
	speed: 0.0208s/iter; left time: 64.5634s
	iters: 300, epoch: 8 | loss: 0.3479255
	speed: 0.0209s/iter; left time: 62.6425s
	iters: 400, epoch: 8 | loss: 0.3231851
	speed: 0.0224s/iter; left time: 65.1478s
	iters: 500, epoch: 8 | loss: 0.2700511
	speed: 0.0220s/iter; left time: 61.7115s
	iters: 600, epoch: 8 | loss: 0.2984431
	speed: 0.0209s/iter; left time: 56.3982s
	iters: 700, epoch: 8 | loss: 0.2972134
	speed: 0.0231s/iter; left time: 60.1514s
	iters: 800, epoch: 8 | loss: 0.2643825
	speed: 0.0222s/iter; left time: 55.5928s
	iters: 900, epoch: 8 | loss: 0.2917256
	speed: 0.0213s/iter; left time: 51.1991s
	iters: 1000, epoch: 8 | loss: 0.2581694
	speed: 0.0217s/iter; left time: 50.0021s
	iters: 1100, epoch: 8 | loss: 0.2632925
	speed: 0.0221s/iter; left time: 48.7695s
Epoch: 8 cost time: 24.79369568824768
Epoch: 8, Steps: 1101 | Train Loss: 0.2880004 Vali Loss: 0.2428817 Test Loss: 0.2725689
Validation loss decreased (0.242983 --> 0.242882).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2682840
	speed: 0.1856s/iter; left time: 390.2222s
	iters: 200, epoch: 9 | loss: 0.3012551
	speed: 0.0221s/iter; left time: 44.1847s
	iters: 300, epoch: 9 | loss: 0.2847017
	speed: 0.0215s/iter; left time: 40.9647s
	iters: 400, epoch: 9 | loss: 0.2620275
	speed: 0.0236s/iter; left time: 42.5192s
	iters: 500, epoch: 9 | loss: 0.2616946
	speed: 0.0225s/iter; left time: 38.3739s
	iters: 600, epoch: 9 | loss: 0.2901765
	speed: 0.0220s/iter; left time: 35.2967s
	iters: 700, epoch: 9 | loss: 0.2977220
	speed: 0.0222s/iter; left time: 33.3149s
	iters: 800, epoch: 9 | loss: 0.2822230
	speed: 0.0217s/iter; left time: 30.4990s
	iters: 900, epoch: 9 | loss: 0.2687565
	speed: 0.0209s/iter; left time: 27.2578s
	iters: 1000, epoch: 9 | loss: 0.2928792
	speed: 0.0229s/iter; left time: 27.5846s
	iters: 1100, epoch: 9 | loss: 0.2950279
	speed: 0.0208s/iter; left time: 22.9743s
Epoch: 9 cost time: 25.165459871292114
Epoch: 9, Steps: 1101 | Train Loss: 0.2879694 Vali Loss: 0.2429211 Test Loss: 0.2725220
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2604943
	speed: 0.1800s/iter; left time: 180.3999s
	iters: 200, epoch: 10 | loss: 0.2931119
	speed: 0.0237s/iter; left time: 21.3934s
	iters: 300, epoch: 10 | loss: 0.2411914
	speed: 0.0237s/iter; left time: 18.9969s
	iters: 400, epoch: 10 | loss: 0.2543242
	speed: 0.0228s/iter; left time: 16.0145s
	iters: 500, epoch: 10 | loss: 0.2610446
	speed: 0.0248s/iter; left time: 14.9545s
	iters: 600, epoch: 10 | loss: 0.3012266
	speed: 0.0236s/iter; left time: 11.8306s
	iters: 700, epoch: 10 | loss: 0.2730085
	speed: 0.0206s/iter; left time: 8.2816s
	iters: 800, epoch: 10 | loss: 0.3296775
	speed: 0.0215s/iter; left time: 6.4829s
	iters: 900, epoch: 10 | loss: 0.3069102
	speed: 0.0227s/iter; left time: 4.5773s
	iters: 1000, epoch: 10 | loss: 0.3040205
	speed: 0.0237s/iter; left time: 2.4182s
	iters: 1100, epoch: 10 | loss: 0.3201399
	speed: 0.0240s/iter; left time: 0.0481s
Epoch: 10 cost time: 26.349411010742188
Epoch: 10, Steps: 1101 | Train Loss: 0.2879539 Vali Loss: 0.2429328 Test Loss: 0.2725151
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_72_720_NLinear_custom_ftM_sl72_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2725105285644531, mae:0.33669513463974
