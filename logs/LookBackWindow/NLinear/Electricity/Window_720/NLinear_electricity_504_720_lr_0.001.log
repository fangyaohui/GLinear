Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_504_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_504_720_NLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17189
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2626043
	speed: 0.0329s/iter; left time: 350.5974s
	iters: 200, epoch: 1 | loss: 0.2824662
	speed: 0.0231s/iter; left time: 243.1478s
	iters: 300, epoch: 1 | loss: 0.2604661
	speed: 0.0230s/iter; left time: 239.6230s
	iters: 400, epoch: 1 | loss: 0.2353493
	speed: 0.0222s/iter; left time: 229.7223s
	iters: 500, epoch: 1 | loss: 0.2585113
	speed: 0.0232s/iter; left time: 237.1442s
	iters: 600, epoch: 1 | loss: 0.2356338
	speed: 0.0224s/iter; left time: 227.0049s
	iters: 700, epoch: 1 | loss: 0.2382626
	speed: 0.0229s/iter; left time: 229.4934s
	iters: 800, epoch: 1 | loss: 0.2297394
	speed: 0.0224s/iter; left time: 222.4233s
	iters: 900, epoch: 1 | loss: 0.2355201
	speed: 0.0234s/iter; left time: 230.1114s
	iters: 1000, epoch: 1 | loss: 0.2645310
	speed: 0.0244s/iter; left time: 237.5608s
Epoch: 1 cost time: 25.693635940551758
Epoch: 1, Steps: 1074 | Train Loss: 0.2561238 Vali Loss: 0.1864926 Test Loss: 0.2150842
Validation loss decreased (inf --> 0.186493).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2808135
	speed: 0.1994s/iter; left time: 1907.2334s
	iters: 200, epoch: 2 | loss: 0.2332947
	speed: 0.0230s/iter; left time: 218.0046s
	iters: 300, epoch: 2 | loss: 0.2156765
	speed: 0.0243s/iter; left time: 228.0227s
	iters: 400, epoch: 2 | loss: 0.2160936
	speed: 0.0231s/iter; left time: 214.0561s
	iters: 500, epoch: 2 | loss: 0.2471621
	speed: 0.0230s/iter; left time: 210.8659s
	iters: 600, epoch: 2 | loss: 0.2656271
	speed: 0.0234s/iter; left time: 212.1743s
	iters: 700, epoch: 2 | loss: 0.2393438
	speed: 0.0234s/iter; left time: 209.7212s
	iters: 800, epoch: 2 | loss: 0.2771346
	speed: 0.0225s/iter; left time: 199.2726s
	iters: 900, epoch: 2 | loss: 0.2082794
	speed: 0.0239s/iter; left time: 209.4634s
	iters: 1000, epoch: 2 | loss: 0.2482737
	speed: 0.0230s/iter; left time: 199.4484s
Epoch: 2 cost time: 25.906214952468872
Epoch: 2, Steps: 1074 | Train Loss: 0.2312860 Vali Loss: 0.1840278 Test Loss: 0.2137427
Validation loss decreased (0.186493 --> 0.184028).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2442953
	speed: 0.2090s/iter; left time: 1774.6438s
	iters: 200, epoch: 3 | loss: 0.2108667
	speed: 0.0266s/iter; left time: 223.3420s
	iters: 300, epoch: 3 | loss: 0.2612601
	speed: 0.0243s/iter; left time: 201.7062s
	iters: 400, epoch: 3 | loss: 0.2301281
	speed: 0.0248s/iter; left time: 202.8511s
	iters: 500, epoch: 3 | loss: 0.2218028
	speed: 0.0248s/iter; left time: 200.9992s
	iters: 600, epoch: 3 | loss: 0.2379261
	speed: 0.0247s/iter; left time: 197.5174s
	iters: 700, epoch: 3 | loss: 0.2442733
	speed: 0.0256s/iter; left time: 202.1834s
	iters: 800, epoch: 3 | loss: 0.2377057
	speed: 0.0260s/iter; left time: 202.2487s
	iters: 900, epoch: 3 | loss: 0.2636136
	speed: 0.0251s/iter; left time: 193.4217s
	iters: 1000, epoch: 3 | loss: 0.2386183
	speed: 0.0277s/iter; left time: 210.4276s
Epoch: 3 cost time: 28.63758635520935
Epoch: 3, Steps: 1074 | Train Loss: 0.2255480 Vali Loss: 0.1812847 Test Loss: 0.2108051
Validation loss decreased (0.184028 --> 0.181285).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2034822
	speed: 0.2102s/iter; left time: 1559.2291s
	iters: 200, epoch: 4 | loss: 0.2022780
	speed: 0.0244s/iter; left time: 178.5981s
	iters: 300, epoch: 4 | loss: 0.1898789
	speed: 0.0249s/iter; left time: 179.5929s
	iters: 400, epoch: 4 | loss: 0.2599622
	speed: 0.0250s/iter; left time: 177.8329s
	iters: 500, epoch: 4 | loss: 0.2103056
	speed: 0.0246s/iter; left time: 172.9458s
	iters: 600, epoch: 4 | loss: 0.2186774
	speed: 0.0249s/iter; left time: 172.1589s
	iters: 700, epoch: 4 | loss: 0.2518778
	speed: 0.0251s/iter; left time: 171.0963s
	iters: 800, epoch: 4 | loss: 0.2505721
	speed: 0.0235s/iter; left time: 158.1379s
	iters: 900, epoch: 4 | loss: 0.2292137
	speed: 0.0253s/iter; left time: 167.4433s
	iters: 1000, epoch: 4 | loss: 0.2160424
	speed: 0.0263s/iter; left time: 171.4082s
Epoch: 4 cost time: 27.862075328826904
Epoch: 4, Steps: 1074 | Train Loss: 0.2233801 Vali Loss: 0.1795156 Test Loss: 0.2084730
Validation loss decreased (0.181285 --> 0.179516).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2107112
	speed: 0.2116s/iter; left time: 1342.3950s
	iters: 200, epoch: 5 | loss: 0.1944611
	speed: 0.0273s/iter; left time: 170.7340s
	iters: 300, epoch: 5 | loss: 0.2098678
	speed: 0.0252s/iter; left time: 154.5481s
	iters: 400, epoch: 5 | loss: 0.2194223
	speed: 0.0240s/iter; left time: 145.3097s
	iters: 500, epoch: 5 | loss: 0.2044550
	speed: 0.0242s/iter; left time: 144.1484s
	iters: 600, epoch: 5 | loss: 0.1976400
	speed: 0.0261s/iter; left time: 152.3391s
	iters: 700, epoch: 5 | loss: 0.1864576
	speed: 0.0237s/iter; left time: 136.2421s
	iters: 800, epoch: 5 | loss: 0.2096803
	speed: 0.0263s/iter; left time: 148.4770s
	iters: 900, epoch: 5 | loss: 0.2181120
	speed: 0.0250s/iter; left time: 138.6263s
	iters: 1000, epoch: 5 | loss: 0.2161435
	speed: 0.0246s/iter; left time: 133.9860s
Epoch: 5 cost time: 28.310450315475464
Epoch: 5, Steps: 1074 | Train Loss: 0.2220513 Vali Loss: 0.1782962 Test Loss: 0.2073109
Validation loss decreased (0.179516 --> 0.178296).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2466670
	speed: 0.2050s/iter; left time: 1080.7368s
	iters: 200, epoch: 6 | loss: 0.2672602
	speed: 0.0224s/iter; left time: 116.0038s
	iters: 300, epoch: 6 | loss: 0.2321166
	speed: 0.0232s/iter; left time: 117.7855s
	iters: 400, epoch: 6 | loss: 0.2207890
	speed: 0.0234s/iter; left time: 116.4641s
	iters: 500, epoch: 6 | loss: 0.2067437
	speed: 0.0219s/iter; left time: 106.7946s
	iters: 600, epoch: 6 | loss: 0.1900594
	speed: 0.0230s/iter; left time: 109.7105s
	iters: 700, epoch: 6 | loss: 0.2133616
	speed: 0.0232s/iter; left time: 108.3286s
	iters: 800, epoch: 6 | loss: 0.2257872
	speed: 0.0234s/iter; left time: 106.9821s
	iters: 900, epoch: 6 | loss: 0.2436118
	speed: 0.0223s/iter; left time: 99.5353s
	iters: 1000, epoch: 6 | loss: 0.2374451
	speed: 0.0229s/iter; left time: 100.1929s
Epoch: 6 cost time: 25.574857473373413
Epoch: 6, Steps: 1074 | Train Loss: 0.2213717 Vali Loss: 0.1785409 Test Loss: 0.2073433
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2114014
	speed: 0.1977s/iter; left time: 829.9012s
	iters: 200, epoch: 7 | loss: 0.2372385
	speed: 0.0223s/iter; left time: 91.3889s
	iters: 300, epoch: 7 | loss: 0.2614270
	speed: 0.0221s/iter; left time: 88.1731s
	iters: 400, epoch: 7 | loss: 0.2686353
	speed: 0.0232s/iter; left time: 90.5134s
	iters: 500, epoch: 7 | loss: 0.2202068
	speed: 0.0232s/iter; left time: 88.2565s
	iters: 600, epoch: 7 | loss: 0.1998853
	speed: 0.0233s/iter; left time: 86.1578s
	iters: 700, epoch: 7 | loss: 0.2802040
	speed: 0.0229s/iter; left time: 82.3630s
	iters: 800, epoch: 7 | loss: 0.1942922
	speed: 0.0225s/iter; left time: 78.7622s
	iters: 900, epoch: 7 | loss: 0.2226877
	speed: 0.0222s/iter; left time: 75.5646s
	iters: 1000, epoch: 7 | loss: 0.2165053
	speed: 0.0230s/iter; left time: 75.6682s
Epoch: 7 cost time: 25.48080825805664
Epoch: 7, Steps: 1074 | Train Loss: 0.2209727 Vali Loss: 0.1777106 Test Loss: 0.2066245
Validation loss decreased (0.178296 --> 0.177711).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2162351
	speed: 0.1998s/iter; left time: 624.1030s
	iters: 200, epoch: 8 | loss: 0.2431540
	speed: 0.0224s/iter; left time: 67.6853s
	iters: 300, epoch: 8 | loss: 0.2464575
	speed: 0.0224s/iter; left time: 65.4773s
	iters: 400, epoch: 8 | loss: 0.2226815
	speed: 0.0234s/iter; left time: 66.0581s
	iters: 500, epoch: 8 | loss: 0.2456931
	speed: 0.0230s/iter; left time: 62.6003s
	iters: 600, epoch: 8 | loss: 0.2088242
	speed: 0.0225s/iter; left time: 58.9213s
	iters: 700, epoch: 8 | loss: 0.2107499
	speed: 0.0230s/iter; left time: 58.1438s
	iters: 800, epoch: 8 | loss: 0.2176819
	speed: 0.0236s/iter; left time: 57.1694s
	iters: 900, epoch: 8 | loss: 0.2557682
	speed: 0.0241s/iter; left time: 55.8792s
	iters: 1000, epoch: 8 | loss: 0.2391511
	speed: 0.0233s/iter; left time: 51.7117s
Epoch: 8 cost time: 25.60525918006897
Epoch: 8, Steps: 1074 | Train Loss: 0.2207274 Vali Loss: 0.1774322 Test Loss: 0.2064635
Validation loss decreased (0.177711 --> 0.177432).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2310358
	speed: 0.1959s/iter; left time: 401.3193s
	iters: 200, epoch: 9 | loss: 0.2307921
	speed: 0.0232s/iter; left time: 45.1836s
	iters: 300, epoch: 9 | loss: 0.2230823
	speed: 0.0226s/iter; left time: 41.7879s
	iters: 400, epoch: 9 | loss: 0.1955109
	speed: 0.0224s/iter; left time: 39.2502s
	iters: 500, epoch: 9 | loss: 0.2394815
	speed: 0.0227s/iter; left time: 37.3772s
	iters: 600, epoch: 9 | loss: 0.2152676
	speed: 0.0219s/iter; left time: 33.8585s
	iters: 700, epoch: 9 | loss: 0.2255627
	speed: 0.0242s/iter; left time: 35.0405s
	iters: 800, epoch: 9 | loss: 0.2360228
	speed: 0.0231s/iter; left time: 31.1208s
	iters: 900, epoch: 9 | loss: 0.2595436
	speed: 0.0227s/iter; left time: 28.4025s
	iters: 1000, epoch: 9 | loss: 0.2001675
	speed: 0.0223s/iter; left time: 25.6324s
Epoch: 9 cost time: 25.396617889404297
Epoch: 9, Steps: 1074 | Train Loss: 0.2206241 Vali Loss: 0.1773019 Test Loss: 0.2063076
Validation loss decreased (0.177432 --> 0.177302).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2015393
	speed: 0.1977s/iter; left time: 192.7188s
	iters: 200, epoch: 10 | loss: 0.2100381
	speed: 0.0221s/iter; left time: 19.3097s
	iters: 300, epoch: 10 | loss: 0.2279283
	speed: 0.0237s/iter; left time: 18.3681s
	iters: 400, epoch: 10 | loss: 0.2028096
	speed: 0.0222s/iter; left time: 14.9964s
	iters: 500, epoch: 10 | loss: 0.2389912
	speed: 0.0224s/iter; left time: 12.8983s
	iters: 600, epoch: 10 | loss: 0.2227504
	speed: 0.0230s/iter; left time: 10.9075s
	iters: 700, epoch: 10 | loss: 0.2547579
	speed: 0.0238s/iter; left time: 8.9436s
	iters: 800, epoch: 10 | loss: 0.2206090
	speed: 0.0225s/iter; left time: 6.1892s
	iters: 900, epoch: 10 | loss: 0.2530267
	speed: 0.0231s/iter; left time: 4.0398s
	iters: 1000, epoch: 10 | loss: 0.2149466
	speed: 0.0228s/iter; left time: 1.7105s
Epoch: 10 cost time: 25.405590057373047
Epoch: 10, Steps: 1074 | Train Loss: 0.2205587 Vali Loss: 0.1773634 Test Loss: 0.2063001
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_504_720_NLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2062239944934845, mae:0.29444068670272827
