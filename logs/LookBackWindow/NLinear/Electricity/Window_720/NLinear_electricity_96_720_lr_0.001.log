Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_96_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_96_720_NLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3588415
	speed: 0.0223s/iter; left time: 243.3128s
	iters: 200, epoch: 1 | loss: 0.2893097
	speed: 0.0157s/iter; left time: 169.4355s
	iters: 300, epoch: 1 | loss: 0.3566578
	speed: 0.0155s/iter; left time: 165.5791s
	iters: 400, epoch: 1 | loss: 0.2478222
	speed: 0.0150s/iter; left time: 158.8572s
	iters: 500, epoch: 1 | loss: 0.2622049
	speed: 0.0155s/iter; left time: 162.9449s
	iters: 600, epoch: 1 | loss: 0.2839856
	speed: 0.0151s/iter; left time: 157.1100s
	iters: 700, epoch: 1 | loss: 0.2608980
	speed: 0.0154s/iter; left time: 158.5870s
	iters: 800, epoch: 1 | loss: 0.2866735
	speed: 0.0152s/iter; left time: 155.1740s
	iters: 900, epoch: 1 | loss: 0.2793215
	speed: 0.0162s/iter; left time: 163.0662s
	iters: 1000, epoch: 1 | loss: 0.3221547
	speed: 0.0167s/iter; left time: 166.5831s
Epoch: 1 cost time: 17.828235626220703
Epoch: 1, Steps: 1099 | Train Loss: 0.3231719 Vali Loss: 0.2338117 Test Loss: 0.2627448
Validation loss decreased (inf --> 0.233812).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2900904
	speed: 0.1534s/iter; left time: 1502.4723s
	iters: 200, epoch: 2 | loss: 0.2775013
	speed: 0.0159s/iter; left time: 153.6911s
	iters: 300, epoch: 2 | loss: 0.2479287
	speed: 0.0161s/iter; left time: 154.3178s
	iters: 400, epoch: 2 | loss: 0.3063547
	speed: 0.0154s/iter; left time: 146.2139s
	iters: 500, epoch: 2 | loss: 0.3158927
	speed: 0.0156s/iter; left time: 146.1313s
	iters: 600, epoch: 2 | loss: 0.2674185
	speed: 0.0157s/iter; left time: 145.5080s
	iters: 700, epoch: 2 | loss: 0.2477652
	speed: 0.0158s/iter; left time: 145.1269s
	iters: 800, epoch: 2 | loss: 0.2511706
	speed: 0.0160s/iter; left time: 145.5178s
	iters: 900, epoch: 2 | loss: 0.2655334
	speed: 0.0159s/iter; left time: 143.1986s
	iters: 1000, epoch: 2 | loss: 0.2833031
	speed: 0.0164s/iter; left time: 145.8650s
Epoch: 2 cost time: 18.356075286865234
Epoch: 2, Steps: 1099 | Train Loss: 0.2746853 Vali Loss: 0.2277997 Test Loss: 0.2569391
Validation loss decreased (0.233812 --> 0.227800).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2807295
	speed: 0.1515s/iter; left time: 1316.8854s
	iters: 200, epoch: 3 | loss: 0.3093313
	speed: 0.0153s/iter; left time: 131.6145s
	iters: 300, epoch: 3 | loss: 0.2714232
	speed: 0.0156s/iter; left time: 132.3754s
	iters: 400, epoch: 3 | loss: 0.2730435
	speed: 0.0156s/iter; left time: 130.9201s
	iters: 500, epoch: 3 | loss: 0.2501559
	speed: 0.0163s/iter; left time: 135.0243s
	iters: 600, epoch: 3 | loss: 0.2882562
	speed: 0.0157s/iter; left time: 128.6695s
	iters: 700, epoch: 3 | loss: 0.2719235
	speed: 0.0159s/iter; left time: 128.8152s
	iters: 800, epoch: 3 | loss: 0.2953012
	speed: 0.0159s/iter; left time: 127.0653s
	iters: 900, epoch: 3 | loss: 0.2850028
	speed: 0.0164s/iter; left time: 129.1891s
	iters: 1000, epoch: 3 | loss: 0.2674208
	speed: 0.0199s/iter; left time: 154.8454s
Epoch: 3 cost time: 19.075254678726196
Epoch: 3, Steps: 1099 | Train Loss: 0.2714714 Vali Loss: 0.2261525 Test Loss: 0.2558949
Validation loss decreased (0.227800 --> 0.226152).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2811670
	speed: 0.1567s/iter; left time: 1189.9154s
	iters: 200, epoch: 4 | loss: 0.2706849
	speed: 0.0158s/iter; left time: 118.5321s
	iters: 300, epoch: 4 | loss: 0.3062884
	speed: 0.0157s/iter; left time: 116.0785s
	iters: 400, epoch: 4 | loss: 0.2559855
	speed: 0.0154s/iter; left time: 112.5890s
	iters: 500, epoch: 4 | loss: 0.2476230
	speed: 0.0159s/iter; left time: 114.4720s
	iters: 600, epoch: 4 | loss: 0.2481069
	speed: 0.0156s/iter; left time: 110.5642s
	iters: 700, epoch: 4 | loss: 0.2376410
	speed: 0.0156s/iter; left time: 109.2637s
	iters: 800, epoch: 4 | loss: 0.2830726
	speed: 0.0176s/iter; left time: 121.0633s
	iters: 900, epoch: 4 | loss: 0.2379436
	speed: 0.0170s/iter; left time: 115.7148s
	iters: 1000, epoch: 4 | loss: 0.2591992
	speed: 0.0198s/iter; left time: 132.4257s
Epoch: 4 cost time: 19.015649557113647
Epoch: 4, Steps: 1099 | Train Loss: 0.2705319 Vali Loss: 0.2259115 Test Loss: 0.2548612
Validation loss decreased (0.226152 --> 0.225911).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3137802
	speed: 0.1553s/iter; left time: 1008.9503s
	iters: 200, epoch: 5 | loss: 0.2689815
	speed: 0.0163s/iter; left time: 104.0559s
	iters: 300, epoch: 5 | loss: 0.2536233
	speed: 0.0166s/iter; left time: 104.3918s
	iters: 400, epoch: 5 | loss: 0.2845133
	speed: 0.0151s/iter; left time: 93.6820s
	iters: 500, epoch: 5 | loss: 0.2606003
	speed: 0.0160s/iter; left time: 97.6270s
	iters: 600, epoch: 5 | loss: 0.2567877
	speed: 0.0158s/iter; left time: 94.4713s
	iters: 700, epoch: 5 | loss: 0.2412644
	speed: 0.0155s/iter; left time: 91.4976s
	iters: 800, epoch: 5 | loss: 0.2656846
	speed: 0.0156s/iter; left time: 90.4043s
	iters: 900, epoch: 5 | loss: 0.3293084
	speed: 0.0170s/iter; left time: 96.6347s
	iters: 1000, epoch: 5 | loss: 0.3094238
	speed: 0.0155s/iter; left time: 86.7301s
Epoch: 5 cost time: 18.35539436340332
Epoch: 5, Steps: 1099 | Train Loss: 0.2700658 Vali Loss: 0.2255734 Test Loss: 0.2547297
Validation loss decreased (0.225911 --> 0.225573).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2724864
	speed: 0.1530s/iter; left time: 825.7795s
	iters: 200, epoch: 6 | loss: 0.3080683
	speed: 0.0149s/iter; left time: 78.8056s
	iters: 300, epoch: 6 | loss: 0.2669993
	speed: 0.0150s/iter; left time: 77.9477s
	iters: 400, epoch: 6 | loss: 0.2878578
	speed: 0.0153s/iter; left time: 77.9528s
	iters: 500, epoch: 6 | loss: 0.2256250
	speed: 0.0153s/iter; left time: 76.5278s
	iters: 600, epoch: 6 | loss: 0.2566015
	speed: 0.0163s/iter; left time: 79.9047s
	iters: 700, epoch: 6 | loss: 0.2666830
	speed: 0.0157s/iter; left time: 75.2372s
	iters: 800, epoch: 6 | loss: 0.3541777
	speed: 0.0159s/iter; left time: 74.6483s
	iters: 900, epoch: 6 | loss: 0.2665181
	speed: 0.0166s/iter; left time: 76.5102s
	iters: 1000, epoch: 6 | loss: 0.2617473
	speed: 0.0159s/iter; left time: 71.6580s
Epoch: 6 cost time: 18.139585733413696
Epoch: 6, Steps: 1099 | Train Loss: 0.2698523 Vali Loss: 0.2251213 Test Loss: 0.2544794
Validation loss decreased (0.225573 --> 0.225121).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2442733
	speed: 0.1598s/iter; left time: 686.5234s
	iters: 200, epoch: 7 | loss: 0.2739100
	speed: 0.0154s/iter; left time: 64.4572s
	iters: 300, epoch: 7 | loss: 0.2520866
	speed: 0.0152s/iter; left time: 62.2179s
	iters: 400, epoch: 7 | loss: 0.3172880
	speed: 0.0153s/iter; left time: 61.1753s
	iters: 500, epoch: 7 | loss: 0.2624974
	speed: 0.0157s/iter; left time: 61.2583s
	iters: 600, epoch: 7 | loss: 0.2625472
	speed: 0.0155s/iter; left time: 59.0329s
	iters: 700, epoch: 7 | loss: 0.2659749
	speed: 0.0155s/iter; left time: 57.3530s
	iters: 800, epoch: 7 | loss: 0.2759891
	speed: 0.0156s/iter; left time: 56.2168s
	iters: 900, epoch: 7 | loss: 0.3224627
	speed: 0.0159s/iter; left time: 55.6566s
	iters: 1000, epoch: 7 | loss: 0.2659945
	speed: 0.0153s/iter; left time: 51.9548s
Epoch: 7 cost time: 17.944376468658447
Epoch: 7, Steps: 1099 | Train Loss: 0.2697226 Vali Loss: 0.2251994 Test Loss: 0.2543660
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2313731
	speed: 0.1569s/iter; left time: 501.8495s
	iters: 200, epoch: 8 | loss: 0.3055506
	speed: 0.0154s/iter; left time: 47.6577s
	iters: 300, epoch: 8 | loss: 0.2709445
	speed: 0.0155s/iter; left time: 46.4820s
	iters: 400, epoch: 8 | loss: 0.2880134
	speed: 0.0156s/iter; left time: 45.1780s
	iters: 500, epoch: 8 | loss: 0.2683358
	speed: 0.0151s/iter; left time: 42.3567s
	iters: 600, epoch: 8 | loss: 0.2471911
	speed: 0.0151s/iter; left time: 40.6164s
	iters: 700, epoch: 8 | loss: 0.2669443
	speed: 0.0158s/iter; left time: 41.0632s
	iters: 800, epoch: 8 | loss: 0.2699280
	speed: 0.0153s/iter; left time: 38.2781s
	iters: 900, epoch: 8 | loss: 0.2558989
	speed: 0.0159s/iter; left time: 38.1126s
	iters: 1000, epoch: 8 | loss: 0.2858010
	speed: 0.0161s/iter; left time: 37.0384s
Epoch: 8 cost time: 17.828100204467773
Epoch: 8, Steps: 1099 | Train Loss: 0.2696391 Vali Loss: 0.2250559 Test Loss: 0.2543226
Validation loss decreased (0.225121 --> 0.225056).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2370019
	speed: 0.1547s/iter; left time: 324.8037s
	iters: 200, epoch: 9 | loss: 0.2914879
	speed: 0.0150s/iter; left time: 29.9336s
	iters: 300, epoch: 9 | loss: 0.2562866
	speed: 0.0154s/iter; left time: 29.2441s
	iters: 400, epoch: 9 | loss: 0.2572477
	speed: 0.0155s/iter; left time: 27.9032s
	iters: 500, epoch: 9 | loss: 0.2559115
	speed: 0.0157s/iter; left time: 26.6561s
	iters: 600, epoch: 9 | loss: 0.2450163
	speed: 0.0154s/iter; left time: 24.5521s
	iters: 700, epoch: 9 | loss: 0.2597165
	speed: 0.0156s/iter; left time: 23.3109s
	iters: 800, epoch: 9 | loss: 0.2743523
	speed: 0.0155s/iter; left time: 21.7178s
	iters: 900, epoch: 9 | loss: 0.2903259
	speed: 0.0163s/iter; left time: 21.1864s
	iters: 1000, epoch: 9 | loss: 0.2874777
	speed: 0.0170s/iter; left time: 20.4419s
Epoch: 9 cost time: 18.04205870628357
Epoch: 9, Steps: 1099 | Train Loss: 0.2696335 Vali Loss: 0.2250721 Test Loss: 0.2543064
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2477656
	speed: 0.1498s/iter; left time: 149.8257s
	iters: 200, epoch: 10 | loss: 0.2598438
	speed: 0.0150s/iter; left time: 13.4649s
	iters: 300, epoch: 10 | loss: 0.2702098
	speed: 0.0152s/iter; left time: 12.1877s
	iters: 400, epoch: 10 | loss: 0.2891558
	speed: 0.0154s/iter; left time: 10.8057s
	iters: 500, epoch: 10 | loss: 0.2907378
	speed: 0.0153s/iter; left time: 9.1819s
	iters: 600, epoch: 10 | loss: 0.2847850
	speed: 0.0159s/iter; left time: 7.9444s
	iters: 700, epoch: 10 | loss: 0.2854082
	speed: 0.0155s/iter; left time: 6.1923s
	iters: 800, epoch: 10 | loss: 0.2392839
	speed: 0.0160s/iter; left time: 4.8005s
	iters: 900, epoch: 10 | loss: 0.2847319
	speed: 0.0164s/iter; left time: 3.2890s
	iters: 1000, epoch: 10 | loss: 0.2351365
	speed: 0.0158s/iter; left time: 1.5773s
Epoch: 10 cost time: 17.925914764404297
Epoch: 10, Steps: 1099 | Train Loss: 0.2696375 Vali Loss: 0.2250808 Test Loss: 0.2543012
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_96_720_NLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.25426262617111206, mae:0.3259650766849518
