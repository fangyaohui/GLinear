Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_144_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_144_720_NLinear_custom_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17549
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3223155
	speed: 0.0235s/iter; left time: 255.0661s
	iters: 200, epoch: 1 | loss: 0.2763841
	speed: 0.0163s/iter; left time: 175.9009s
	iters: 300, epoch: 1 | loss: 0.3451673
	speed: 0.0168s/iter; left time: 179.2024s
	iters: 400, epoch: 1 | loss: 0.2340478
	speed: 0.0166s/iter; left time: 174.9408s
	iters: 500, epoch: 1 | loss: 0.2640669
	speed: 0.0164s/iter; left time: 171.6610s
	iters: 600, epoch: 1 | loss: 0.2355347
	speed: 0.0160s/iter; left time: 165.6159s
	iters: 700, epoch: 1 | loss: 0.2389988
	speed: 0.0163s/iter; left time: 166.8126s
	iters: 800, epoch: 1 | loss: 0.2192356
	speed: 0.0166s/iter; left time: 168.6248s
	iters: 900, epoch: 1 | loss: 0.2613550
	speed: 0.0166s/iter; left time: 167.4938s
	iters: 1000, epoch: 1 | loss: 0.2392550
	speed: 0.0168s/iter; left time: 166.8884s
Epoch: 1 cost time: 18.910421133041382
Epoch: 1, Steps: 1096 | Train Loss: 0.2899564 Vali Loss: 0.2062363 Test Loss: 0.2364565
Validation loss decreased (inf --> 0.206236).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2571662
	speed: 0.1552s/iter; left time: 1515.8610s
	iters: 200, epoch: 2 | loss: 0.2453839
	speed: 0.0166s/iter; left time: 160.3776s
	iters: 300, epoch: 2 | loss: 0.2863885
	speed: 0.0169s/iter; left time: 161.2740s
	iters: 400, epoch: 2 | loss: 0.2737370
	speed: 0.0164s/iter; left time: 155.6362s
	iters: 500, epoch: 2 | loss: 0.3044323
	speed: 0.0162s/iter; left time: 151.7491s
	iters: 600, epoch: 2 | loss: 0.2411762
	speed: 0.0160s/iter; left time: 148.5363s
	iters: 700, epoch: 2 | loss: 0.2232695
	speed: 0.0168s/iter; left time: 153.8299s
	iters: 800, epoch: 2 | loss: 0.2670567
	speed: 0.0171s/iter; left time: 155.4170s
	iters: 900, epoch: 2 | loss: 0.2233823
	speed: 0.0164s/iter; left time: 147.1085s
	iters: 1000, epoch: 2 | loss: 0.2588437
	speed: 0.0169s/iter; left time: 150.1252s
Epoch: 2 cost time: 19.112162113189697
Epoch: 2, Steps: 1096 | Train Loss: 0.2498502 Vali Loss: 0.2026891 Test Loss: 0.2332580
Validation loss decreased (0.206236 --> 0.202689).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2266513
	speed: 0.1552s/iter; left time: 1345.2276s
	iters: 200, epoch: 3 | loss: 0.2219553
	speed: 0.0153s/iter; left time: 130.8721s
	iters: 300, epoch: 3 | loss: 0.2279982
	speed: 0.0159s/iter; left time: 134.5995s
	iters: 400, epoch: 3 | loss: 0.2448872
	speed: 0.0163s/iter; left time: 136.6837s
	iters: 500, epoch: 3 | loss: 0.2718615
	speed: 0.0162s/iter; left time: 134.3008s
	iters: 600, epoch: 3 | loss: 0.2158896
	speed: 0.0160s/iter; left time: 130.6663s
	iters: 700, epoch: 3 | loss: 0.2750278
	speed: 0.0162s/iter; left time: 130.8675s
	iters: 800, epoch: 3 | loss: 0.2322556
	speed: 0.0162s/iter; left time: 129.1972s
	iters: 900, epoch: 3 | loss: 0.2264294
	speed: 0.0165s/iter; left time: 129.6501s
	iters: 1000, epoch: 3 | loss: 0.2055798
	speed: 0.0161s/iter; left time: 124.7798s
Epoch: 3 cost time: 18.61552381515503
Epoch: 3, Steps: 1096 | Train Loss: 0.2466263 Vali Loss: 0.2011815 Test Loss: 0.2310327
Validation loss decreased (0.202689 --> 0.201181).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2407761
	speed: 0.1559s/iter; left time: 1180.9556s
	iters: 200, epoch: 4 | loss: 0.2374282
	speed: 0.0165s/iter; left time: 123.6207s
	iters: 300, epoch: 4 | loss: 0.2346821
	speed: 0.0166s/iter; left time: 122.2247s
	iters: 400, epoch: 4 | loss: 0.2576265
	speed: 0.0167s/iter; left time: 121.5292s
	iters: 500, epoch: 4 | loss: 0.2721184
	speed: 0.0161s/iter; left time: 115.6303s
	iters: 600, epoch: 4 | loss: 0.2423802
	speed: 0.0160s/iter; left time: 113.3409s
	iters: 700, epoch: 4 | loss: 0.2801349
	speed: 0.0161s/iter; left time: 112.3517s
	iters: 800, epoch: 4 | loss: 0.2800213
	speed: 0.0160s/iter; left time: 109.7720s
	iters: 900, epoch: 4 | loss: 0.2564055
	speed: 0.0164s/iter; left time: 111.0001s
	iters: 1000, epoch: 4 | loss: 0.2494719
	speed: 0.0167s/iter; left time: 111.1121s
Epoch: 4 cost time: 18.934873580932617
Epoch: 4, Steps: 1096 | Train Loss: 0.2455514 Vali Loss: 0.2005234 Test Loss: 0.2306494
Validation loss decreased (0.201181 --> 0.200523).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2288711
	speed: 0.1561s/iter; left time: 1010.7978s
	iters: 200, epoch: 5 | loss: 0.2336110
	speed: 0.0160s/iter; left time: 101.9615s
	iters: 300, epoch: 5 | loss: 0.2544788
	speed: 0.0164s/iter; left time: 103.1462s
	iters: 400, epoch: 5 | loss: 0.2626015
	speed: 0.0162s/iter; left time: 100.2895s
	iters: 500, epoch: 5 | loss: 0.2584552
	speed: 0.0161s/iter; left time: 97.8495s
	iters: 600, epoch: 5 | loss: 0.2228571
	speed: 0.0166s/iter; left time: 99.1615s
	iters: 700, epoch: 5 | loss: 0.2410107
	speed: 0.0161s/iter; left time: 94.8250s
	iters: 800, epoch: 5 | loss: 0.2473540
	speed: 0.0163s/iter; left time: 94.0943s
	iters: 900, epoch: 5 | loss: 0.2727347
	speed: 0.0160s/iter; left time: 91.0825s
	iters: 1000, epoch: 5 | loss: 0.2606587
	speed: 0.0163s/iter; left time: 90.7240s
Epoch: 5 cost time: 18.838844776153564
Epoch: 5, Steps: 1096 | Train Loss: 0.2450357 Vali Loss: 0.1997563 Test Loss: 0.2299514
Validation loss decreased (0.200523 --> 0.199756).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2678040
	speed: 0.1541s/iter; left time: 828.9850s
	iters: 200, epoch: 6 | loss: 0.2647618
	speed: 0.0168s/iter; left time: 88.6553s
	iters: 300, epoch: 6 | loss: 0.2372951
	speed: 0.0163s/iter; left time: 84.5112s
	iters: 400, epoch: 6 | loss: 0.2520446
	speed: 0.0163s/iter; left time: 82.6865s
	iters: 500, epoch: 6 | loss: 0.2275164
	speed: 0.0158s/iter; left time: 78.5072s
	iters: 600, epoch: 6 | loss: 0.2186906
	speed: 0.0162s/iter; left time: 79.1657s
	iters: 700, epoch: 6 | loss: 0.2415966
	speed: 0.0166s/iter; left time: 79.4769s
	iters: 800, epoch: 6 | loss: 0.2288926
	speed: 0.0161s/iter; left time: 75.5371s
	iters: 900, epoch: 6 | loss: 0.2377445
	speed: 0.0165s/iter; left time: 75.6305s
	iters: 1000, epoch: 6 | loss: 0.2546341
	speed: 0.0161s/iter; left time: 72.2866s
Epoch: 6 cost time: 18.905620098114014
Epoch: 6, Steps: 1096 | Train Loss: 0.2447532 Vali Loss: 0.1995264 Test Loss: 0.2298348
Validation loss decreased (0.199756 --> 0.199526).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2029064
	speed: 0.1552s/iter; left time: 664.8981s
	iters: 200, epoch: 7 | loss: 0.2282366
	speed: 0.0161s/iter; left time: 67.4219s
	iters: 300, epoch: 7 | loss: 0.2242652
	speed: 0.0164s/iter; left time: 67.1169s
	iters: 400, epoch: 7 | loss: 0.2658269
	speed: 0.0160s/iter; left time: 63.8663s
	iters: 500, epoch: 7 | loss: 0.2232292
	speed: 0.0159s/iter; left time: 61.7392s
	iters: 600, epoch: 7 | loss: 0.2846321
	speed: 0.0165s/iter; left time: 62.4743s
	iters: 700, epoch: 7 | loss: 0.2447513
	speed: 0.0167s/iter; left time: 61.6760s
	iters: 800, epoch: 7 | loss: 0.2728052
	speed: 0.0162s/iter; left time: 58.1189s
	iters: 900, epoch: 7 | loss: 0.2316960
	speed: 0.0163s/iter; left time: 56.8195s
	iters: 1000, epoch: 7 | loss: 0.2365067
	speed: 0.0165s/iter; left time: 55.9149s
Epoch: 7 cost time: 18.816778659820557
Epoch: 7, Steps: 1096 | Train Loss: 0.2446010 Vali Loss: 0.1996242 Test Loss: 0.2296916
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2498884
	speed: 0.1549s/iter; left time: 493.9273s
	iters: 200, epoch: 8 | loss: 0.2428108
	speed: 0.0160s/iter; left time: 49.5559s
	iters: 300, epoch: 8 | loss: 0.2781645
	speed: 0.0165s/iter; left time: 49.3800s
	iters: 400, epoch: 8 | loss: 0.2520892
	speed: 0.0163s/iter; left time: 47.1301s
	iters: 500, epoch: 8 | loss: 0.2519037
	speed: 0.0157s/iter; left time: 43.8619s
	iters: 600, epoch: 8 | loss: 0.2418099
	speed: 0.0158s/iter; left time: 42.5859s
	iters: 700, epoch: 8 | loss: 0.2445190
	speed: 0.0161s/iter; left time: 41.7732s
	iters: 800, epoch: 8 | loss: 0.2001125
	speed: 0.0161s/iter; left time: 40.0510s
	iters: 900, epoch: 8 | loss: 0.2518018
	speed: 0.0163s/iter; left time: 38.9910s
	iters: 1000, epoch: 8 | loss: 0.2336478
	speed: 0.0168s/iter; left time: 38.4401s
Epoch: 8 cost time: 18.792563915252686
Epoch: 8, Steps: 1096 | Train Loss: 0.2445308 Vali Loss: 0.1995227 Test Loss: 0.2296511
Validation loss decreased (0.199526 --> 0.199523).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3144236
	speed: 0.1551s/iter; left time: 324.6591s
	iters: 200, epoch: 9 | loss: 0.2230449
	speed: 0.0158s/iter; left time: 31.5647s
	iters: 300, epoch: 9 | loss: 0.2106700
	speed: 0.0158s/iter; left time: 29.8406s
	iters: 400, epoch: 9 | loss: 0.2764203
	speed: 0.0162s/iter; left time: 29.0732s
	iters: 500, epoch: 9 | loss: 0.2369083
	speed: 0.0162s/iter; left time: 27.5010s
	iters: 600, epoch: 9 | loss: 0.2445811
	speed: 0.0160s/iter; left time: 25.4577s
	iters: 700, epoch: 9 | loss: 0.2776439
	speed: 0.0160s/iter; left time: 23.8178s
	iters: 800, epoch: 9 | loss: 0.2398976
	speed: 0.0158s/iter; left time: 22.0692s
	iters: 900, epoch: 9 | loss: 0.2471494
	speed: 0.0161s/iter; left time: 20.7575s
	iters: 1000, epoch: 9 | loss: 0.2009022
	speed: 0.0178s/iter; left time: 21.2102s
Epoch: 9 cost time: 18.745593070983887
Epoch: 9, Steps: 1096 | Train Loss: 0.2444905 Vali Loss: 0.1994408 Test Loss: 0.2296108
Validation loss decreased (0.199523 --> 0.199441).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2426235
	speed: 0.1551s/iter; left time: 154.6513s
	iters: 200, epoch: 10 | loss: 0.2511625
	speed: 0.0166s/iter; left time: 14.8503s
	iters: 300, epoch: 10 | loss: 0.2282500
	speed: 0.0167s/iter; left time: 13.2971s
	iters: 400, epoch: 10 | loss: 0.2250938
	speed: 0.0162s/iter; left time: 11.2610s
	iters: 500, epoch: 10 | loss: 0.2444061
	speed: 0.0164s/iter; left time: 9.7877s
	iters: 600, epoch: 10 | loss: 0.2681824
	speed: 0.0158s/iter; left time: 7.8638s
	iters: 700, epoch: 10 | loss: 0.2599103
	speed: 0.0162s/iter; left time: 6.4496s
	iters: 800, epoch: 10 | loss: 0.2263035
	speed: 0.0171s/iter; left time: 5.0768s
	iters: 900, epoch: 10 | loss: 0.2289003
	speed: 0.0161s/iter; left time: 3.1766s
	iters: 1000, epoch: 10 | loss: 0.2448468
	speed: 0.0179s/iter; left time: 1.7352s
Epoch: 10 cost time: 19.024335861206055
Epoch: 10, Steps: 1096 | Train Loss: 0.2444133 Vali Loss: 0.1995633 Test Loss: 0.2295985
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_144_720_NLinear_custom_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2295335978269577, mae:0.31133416295051575
