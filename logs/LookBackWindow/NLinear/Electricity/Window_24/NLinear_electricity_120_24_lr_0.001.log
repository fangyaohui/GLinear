Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_120_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=120, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_120_24_NLinear_custom_ftM_sl120_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18269
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2693645
	speed: 0.0151s/iter; left time: 171.0098s
	iters: 200, epoch: 1 | loss: 0.2177956
	speed: 0.0061s/iter; left time: 68.2879s
	iters: 300, epoch: 1 | loss: 0.1797192
	speed: 0.0063s/iter; left time: 70.2893s
	iters: 400, epoch: 1 | loss: 0.2877554
	speed: 0.0061s/iter; left time: 67.4255s
	iters: 500, epoch: 1 | loss: 0.1796605
	speed: 0.0062s/iter; left time: 67.2734s
	iters: 600, epoch: 1 | loss: 0.1870688
	speed: 0.0064s/iter; left time: 69.6276s
	iters: 700, epoch: 1 | loss: 0.1636257
	speed: 0.0060s/iter; left time: 64.2054s
	iters: 800, epoch: 1 | loss: 0.1827064
	speed: 0.0063s/iter; left time: 66.3700s
	iters: 900, epoch: 1 | loss: 0.1763799
	speed: 0.0076s/iter; left time: 79.6266s
	iters: 1000, epoch: 1 | loss: 0.1612932
	speed: 0.0067s/iter; left time: 70.1197s
	iters: 1100, epoch: 1 | loss: 0.2012424
	speed: 0.0069s/iter; left time: 70.7319s
Epoch: 1 cost time: 8.340538024902344
Epoch: 1, Steps: 1141 | Train Loss: 0.2138377 Vali Loss: 0.1549641 Test Loss: 0.1665524
Validation loss decreased (inf --> 0.154964).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1855018
	speed: 0.0634s/iter; left time: 644.7527s
	iters: 200, epoch: 2 | loss: 0.1812530
	speed: 0.0065s/iter; left time: 65.0453s
	iters: 300, epoch: 2 | loss: 0.1590435
	speed: 0.0065s/iter; left time: 64.6912s
	iters: 400, epoch: 2 | loss: 0.1402166
	speed: 0.0063s/iter; left time: 62.3038s
	iters: 500, epoch: 2 | loss: 0.1418985
	speed: 0.0065s/iter; left time: 63.5859s
	iters: 600, epoch: 2 | loss: 0.1398183
	speed: 0.0066s/iter; left time: 63.8406s
	iters: 700, epoch: 2 | loss: 0.1594459
	speed: 0.0060s/iter; left time: 56.9991s
	iters: 800, epoch: 2 | loss: 0.1162565
	speed: 0.0061s/iter; left time: 57.7993s
	iters: 900, epoch: 2 | loss: 0.1451711
	speed: 0.0062s/iter; left time: 58.0696s
	iters: 1000, epoch: 2 | loss: 0.1612658
	speed: 0.0062s/iter; left time: 57.7743s
	iters: 1100, epoch: 2 | loss: 0.1833358
	speed: 0.0065s/iter; left time: 59.9455s
Epoch: 2 cost time: 8.186042308807373
Epoch: 2, Steps: 1141 | Train Loss: 0.1665161 Vali Loss: 0.1504461 Test Loss: 0.1620865
Validation loss decreased (0.154964 --> 0.150446).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1522304
	speed: 0.0622s/iter; left time: 561.5041s
	iters: 200, epoch: 3 | loss: 0.1370035
	speed: 0.0061s/iter; left time: 54.6249s
	iters: 300, epoch: 3 | loss: 0.1439773
	speed: 0.0061s/iter; left time: 54.2692s
	iters: 400, epoch: 3 | loss: 0.1467839
	speed: 0.0061s/iter; left time: 52.9027s
	iters: 500, epoch: 3 | loss: 0.1673250
	speed: 0.0066s/iter; left time: 56.7157s
	iters: 600, epoch: 3 | loss: 0.1801187
	speed: 0.0065s/iter; left time: 55.2958s
	iters: 700, epoch: 3 | loss: 0.1614874
	speed: 0.0062s/iter; left time: 52.1051s
	iters: 800, epoch: 3 | loss: 0.1402219
	speed: 0.0062s/iter; left time: 51.4234s
	iters: 900, epoch: 3 | loss: 0.1604313
	speed: 0.0061s/iter; left time: 50.1137s
	iters: 1000, epoch: 3 | loss: 0.2230474
	speed: 0.0063s/iter; left time: 50.8386s
	iters: 1100, epoch: 3 | loss: 0.2013434
	speed: 0.0064s/iter; left time: 51.5170s
Epoch: 3 cost time: 7.977373361587524
Epoch: 3, Steps: 1141 | Train Loss: 0.1638887 Vali Loss: 0.1492347 Test Loss: 0.1606456
Validation loss decreased (0.150446 --> 0.149235).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1781487
	speed: 0.0600s/iter; left time: 473.1729s
	iters: 200, epoch: 4 | loss: 0.1762558
	speed: 0.0065s/iter; left time: 50.3134s
	iters: 300, epoch: 4 | loss: 0.1765886
	speed: 0.0062s/iter; left time: 47.6588s
	iters: 400, epoch: 4 | loss: 0.1985809
	speed: 0.0063s/iter; left time: 47.4619s
	iters: 500, epoch: 4 | loss: 0.1683067
	speed: 0.0063s/iter; left time: 47.5289s
	iters: 600, epoch: 4 | loss: 0.1539598
	speed: 0.0063s/iter; left time: 46.7858s
	iters: 700, epoch: 4 | loss: 0.1571987
	speed: 0.0062s/iter; left time: 45.5032s
	iters: 800, epoch: 4 | loss: 0.1751692
	speed: 0.0062s/iter; left time: 44.6973s
	iters: 900, epoch: 4 | loss: 0.1643032
	speed: 0.0063s/iter; left time: 44.5084s
	iters: 1000, epoch: 4 | loss: 0.1927693
	speed: 0.0064s/iter; left time: 44.5239s
	iters: 1100, epoch: 4 | loss: 0.1997246
	speed: 0.0065s/iter; left time: 44.7220s
Epoch: 4 cost time: 7.9505743980407715
Epoch: 4, Steps: 1141 | Train Loss: 0.1630089 Vali Loss: 0.1487587 Test Loss: 0.1604052
Validation loss decreased (0.149235 --> 0.148759).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2074387
	speed: 0.0596s/iter; left time: 402.4492s
	iters: 200, epoch: 5 | loss: 0.1419396
	speed: 0.0061s/iter; left time: 40.8590s
	iters: 300, epoch: 5 | loss: 0.1357506
	speed: 0.0063s/iter; left time: 41.5368s
	iters: 400, epoch: 5 | loss: 0.1276591
	speed: 0.0063s/iter; left time: 40.5389s
	iters: 500, epoch: 5 | loss: 0.1646251
	speed: 0.0065s/iter; left time: 40.9591s
	iters: 600, epoch: 5 | loss: 0.1300081
	speed: 0.0062s/iter; left time: 38.9867s
	iters: 700, epoch: 5 | loss: 0.1731422
	speed: 0.0064s/iter; left time: 39.5598s
	iters: 800, epoch: 5 | loss: 0.1446970
	speed: 0.0065s/iter; left time: 39.1919s
	iters: 900, epoch: 5 | loss: 0.1526826
	speed: 0.0062s/iter; left time: 37.0080s
	iters: 1000, epoch: 5 | loss: 0.1693541
	speed: 0.0061s/iter; left time: 35.7143s
	iters: 1100, epoch: 5 | loss: 0.1788212
	speed: 0.0062s/iter; left time: 35.5539s
Epoch: 5 cost time: 7.920470714569092
Epoch: 5, Steps: 1141 | Train Loss: 0.1626621 Vali Loss: 0.1485103 Test Loss: 0.1600485
Validation loss decreased (0.148759 --> 0.148510).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1393109
	speed: 0.0623s/iter; left time: 349.3838s
	iters: 200, epoch: 6 | loss: 0.1686364
	speed: 0.0065s/iter; left time: 35.5790s
	iters: 300, epoch: 6 | loss: 0.1910575
	speed: 0.0063s/iter; left time: 33.9985s
	iters: 400, epoch: 6 | loss: 0.2010879
	speed: 0.0065s/iter; left time: 34.3213s
	iters: 500, epoch: 6 | loss: 0.1636670
	speed: 0.0064s/iter; left time: 33.1767s
	iters: 600, epoch: 6 | loss: 0.1743114
	speed: 0.0065s/iter; left time: 33.0875s
	iters: 700, epoch: 6 | loss: 0.1948441
	speed: 0.0066s/iter; left time: 32.9208s
	iters: 800, epoch: 6 | loss: 0.2015333
	speed: 0.0066s/iter; left time: 32.3406s
	iters: 900, epoch: 6 | loss: 0.1670321
	speed: 0.0065s/iter; left time: 31.1628s
	iters: 1000, epoch: 6 | loss: 0.1932798
	speed: 0.0065s/iter; left time: 30.5186s
	iters: 1100, epoch: 6 | loss: 0.1574464
	speed: 0.0062s/iter; left time: 28.5877s
Epoch: 6 cost time: 8.078222513198853
Epoch: 6, Steps: 1141 | Train Loss: 0.1624146 Vali Loss: 0.1484430 Test Loss: 0.1600570
Validation loss decreased (0.148510 --> 0.148443).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1514785
	speed: 0.0598s/iter; left time: 266.8762s
	iters: 200, epoch: 7 | loss: 0.1355002
	speed: 0.0058s/iter; left time: 25.4486s
	iters: 300, epoch: 7 | loss: 0.1790147
	speed: 0.0059s/iter; left time: 25.1743s
	iters: 400, epoch: 7 | loss: 0.1712391
	speed: 0.0063s/iter; left time: 26.1355s
	iters: 500, epoch: 7 | loss: 0.1763639
	speed: 0.0064s/iter; left time: 26.1902s
	iters: 600, epoch: 7 | loss: 0.1576078
	speed: 0.0065s/iter; left time: 25.7018s
	iters: 700, epoch: 7 | loss: 0.1535331
	speed: 0.0066s/iter; left time: 25.3659s
	iters: 800, epoch: 7 | loss: 0.1623681
	speed: 0.0065s/iter; left time: 24.6502s
	iters: 900, epoch: 7 | loss: 0.1361681
	speed: 0.0062s/iter; left time: 22.7615s
	iters: 1000, epoch: 7 | loss: 0.1476436
	speed: 0.0064s/iter; left time: 22.9004s
	iters: 1100, epoch: 7 | loss: 0.1455882
	speed: 0.0071s/iter; left time: 24.4704s
Epoch: 7 cost time: 7.9836695194244385
Epoch: 7, Steps: 1141 | Train Loss: 0.1623441 Vali Loss: 0.1484541 Test Loss: 0.1599750
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1368780
	speed: 0.0602s/iter; left time: 200.0478s
	iters: 200, epoch: 8 | loss: 0.1595895
	speed: 0.0063s/iter; left time: 20.3988s
	iters: 300, epoch: 8 | loss: 0.2000089
	speed: 0.0061s/iter; left time: 19.1478s
	iters: 400, epoch: 8 | loss: 0.1560224
	speed: 0.0063s/iter; left time: 19.0704s
	iters: 500, epoch: 8 | loss: 0.1781289
	speed: 0.0062s/iter; left time: 18.1374s
	iters: 600, epoch: 8 | loss: 0.1587135
	speed: 0.0061s/iter; left time: 17.3242s
	iters: 700, epoch: 8 | loss: 0.2350913
	speed: 0.0059s/iter; left time: 15.9616s
	iters: 800, epoch: 8 | loss: 0.1643883
	speed: 0.0061s/iter; left time: 15.9537s
	iters: 900, epoch: 8 | loss: 0.2201496
	speed: 0.0063s/iter; left time: 15.9623s
	iters: 1000, epoch: 8 | loss: 0.1951207
	speed: 0.0066s/iter; left time: 15.9818s
	iters: 1100, epoch: 8 | loss: 0.1619270
	speed: 0.0067s/iter; left time: 15.4763s
Epoch: 8 cost time: 7.9120190143585205
Epoch: 8, Steps: 1141 | Train Loss: 0.1622874 Vali Loss: 0.1482629 Test Loss: 0.1598233
Validation loss decreased (0.148443 --> 0.148263).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1361492
	speed: 0.0593s/iter; left time: 129.5456s
	iters: 200, epoch: 9 | loss: 0.1788631
	speed: 0.0064s/iter; left time: 13.3785s
	iters: 300, epoch: 9 | loss: 0.1450204
	speed: 0.0062s/iter; left time: 12.2528s
	iters: 400, epoch: 9 | loss: 0.1698353
	speed: 0.0063s/iter; left time: 11.8226s
	iters: 500, epoch: 9 | loss: 0.1391439
	speed: 0.0062s/iter; left time: 11.1400s
	iters: 600, epoch: 9 | loss: 0.1207855
	speed: 0.0065s/iter; left time: 10.8658s
	iters: 700, epoch: 9 | loss: 0.1817476
	speed: 0.0063s/iter; left time: 9.9572s
	iters: 800, epoch: 9 | loss: 0.1459589
	speed: 0.0065s/iter; left time: 9.6650s
	iters: 900, epoch: 9 | loss: 0.1634022
	speed: 0.0064s/iter; left time: 8.8179s
	iters: 1000, epoch: 9 | loss: 0.1362324
	speed: 0.0065s/iter; left time: 8.2969s
	iters: 1100, epoch: 9 | loss: 0.1832371
	speed: 0.0064s/iter; left time: 7.6171s
Epoch: 9 cost time: 7.990561246871948
Epoch: 9, Steps: 1141 | Train Loss: 0.1622725 Vali Loss: 0.1481523 Test Loss: 0.1598106
Validation loss decreased (0.148263 --> 0.148152).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1372491
	speed: 0.0607s/iter; left time: 63.2254s
	iters: 200, epoch: 10 | loss: 0.2539435
	speed: 0.0063s/iter; left time: 5.8903s
	iters: 300, epoch: 10 | loss: 0.1648379
	speed: 0.0061s/iter; left time: 5.1056s
	iters: 400, epoch: 10 | loss: 0.1311818
	speed: 0.0061s/iter; left time: 4.5209s
	iters: 500, epoch: 10 | loss: 0.1754530
	speed: 0.0064s/iter; left time: 4.1269s
	iters: 600, epoch: 10 | loss: 0.1640999
	speed: 0.0065s/iter; left time: 3.5428s
	iters: 700, epoch: 10 | loss: 0.1413498
	speed: 0.0063s/iter; left time: 2.8048s
	iters: 800, epoch: 10 | loss: 0.1390957
	speed: 0.0063s/iter; left time: 2.1485s
	iters: 900, epoch: 10 | loss: 0.1431106
	speed: 0.0063s/iter; left time: 1.5301s
	iters: 1000, epoch: 10 | loss: 0.1681931
	speed: 0.0063s/iter; left time: 0.8932s
	iters: 1100, epoch: 10 | loss: 0.1562236
	speed: 0.0061s/iter; left time: 0.2567s
Epoch: 10 cost time: 7.897381067276001
Epoch: 10, Steps: 1141 | Train Loss: 0.1622700 Vali Loss: 0.1482542 Test Loss: 0.1598011
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_120_24_NLinear_custom_ftM_sl120_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.15948259830474854, mae:0.2437085658311844
