Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_720_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_24_NLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17669
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1533227
	speed: 0.0256s/iter; left time: 280.3712s
	iters: 200, epoch: 1 | loss: 0.1734636
	speed: 0.0166s/iter; left time: 180.3902s
	iters: 300, epoch: 1 | loss: 0.1173761
	speed: 0.0169s/iter; left time: 181.6806s
	iters: 400, epoch: 1 | loss: 0.1052671
	speed: 0.0181s/iter; left time: 192.3480s
	iters: 500, epoch: 1 | loss: 0.1281857
	speed: 0.0171s/iter; left time: 180.2027s
	iters: 600, epoch: 1 | loss: 0.1207465
	speed: 0.0162s/iter; left time: 168.7680s
	iters: 700, epoch: 1 | loss: 0.1336998
	speed: 0.0173s/iter; left time: 179.3697s
	iters: 800, epoch: 1 | loss: 0.1149018
	speed: 0.0161s/iter; left time: 165.1595s
	iters: 900, epoch: 1 | loss: 0.1403679
	speed: 0.0162s/iter; left time: 163.9127s
	iters: 1000, epoch: 1 | loss: 0.1176238
	speed: 0.0157s/iter; left time: 157.4765s
	iters: 1100, epoch: 1 | loss: 0.1180506
	speed: 0.0167s/iter; left time: 166.4245s
Epoch: 1 cost time: 19.43185067176819
Epoch: 1, Steps: 1104 | Train Loss: 0.1383563 Vali Loss: 0.1036567 Test Loss: 0.1156496
Validation loss decreased (inf --> 0.103657).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1309490
	speed: 0.1302s/iter; left time: 1280.4653s
	iters: 200, epoch: 2 | loss: 0.0974828
	speed: 0.0172s/iter; left time: 167.1784s
	iters: 300, epoch: 2 | loss: 0.1046761
	speed: 0.0167s/iter; left time: 160.9497s
	iters: 400, epoch: 2 | loss: 0.1039766
	speed: 0.0174s/iter; left time: 166.0650s
	iters: 500, epoch: 2 | loss: 0.1059986
	speed: 0.0174s/iter; left time: 164.3824s
	iters: 600, epoch: 2 | loss: 0.1276732
	speed: 0.0174s/iter; left time: 162.3968s
	iters: 700, epoch: 2 | loss: 0.1095429
	speed: 0.0162s/iter; left time: 149.9076s
	iters: 800, epoch: 2 | loss: 0.1004601
	speed: 0.0172s/iter; left time: 157.0382s
	iters: 900, epoch: 2 | loss: 0.1158437
	speed: 0.0168s/iter; left time: 151.8710s
	iters: 1000, epoch: 2 | loss: 0.1058485
	speed: 0.0173s/iter; left time: 154.5154s
	iters: 1100, epoch: 2 | loss: 0.1247353
	speed: 0.0161s/iter; left time: 142.4115s
Epoch: 2 cost time: 19.726778745651245
Epoch: 2, Steps: 1104 | Train Loss: 0.1148150 Vali Loss: 0.0983007 Test Loss: 0.1108233
Validation loss decreased (0.103657 --> 0.098301).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1105739
	speed: 0.1293s/iter; left time: 1129.4221s
	iters: 200, epoch: 3 | loss: 0.2106662
	speed: 0.0167s/iter; left time: 144.4274s
	iters: 300, epoch: 3 | loss: 0.1086757
	speed: 0.0163s/iter; left time: 138.7800s
	iters: 400, epoch: 3 | loss: 0.1026055
	speed: 0.0167s/iter; left time: 141.2286s
	iters: 500, epoch: 3 | loss: 0.0910274
	speed: 0.0168s/iter; left time: 139.7700s
	iters: 600, epoch: 3 | loss: 0.1000959
	speed: 0.0169s/iter; left time: 139.1818s
	iters: 700, epoch: 3 | loss: 0.1025346
	speed: 0.0164s/iter; left time: 133.2843s
	iters: 800, epoch: 3 | loss: 0.1012660
	speed: 0.0169s/iter; left time: 135.9425s
	iters: 900, epoch: 3 | loss: 0.1197144
	speed: 0.0181s/iter; left time: 143.4864s
	iters: 1000, epoch: 3 | loss: 0.0903789
	speed: 0.0174s/iter; left time: 136.2107s
	iters: 1100, epoch: 3 | loss: 0.1025588
	speed: 0.0168s/iter; left time: 129.8312s
Epoch: 3 cost time: 19.59677505493164
Epoch: 3, Steps: 1104 | Train Loss: 0.1097585 Vali Loss: 0.0940250 Test Loss: 0.1057768
Validation loss decreased (0.098301 --> 0.094025).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0878293
	speed: 0.1308s/iter; left time: 998.0157s
	iters: 200, epoch: 4 | loss: 0.0865434
	speed: 0.0165s/iter; left time: 124.6036s
	iters: 300, epoch: 4 | loss: 0.1040450
	speed: 0.0163s/iter; left time: 121.4462s
	iters: 400, epoch: 4 | loss: 0.0972583
	speed: 0.0175s/iter; left time: 128.1750s
	iters: 500, epoch: 4 | loss: 0.1017667
	speed: 0.0174s/iter; left time: 125.5981s
	iters: 600, epoch: 4 | loss: 0.0982040
	speed: 0.0180s/iter; left time: 128.1376s
	iters: 700, epoch: 4 | loss: 0.1118753
	speed: 0.0168s/iter; left time: 117.9014s
	iters: 800, epoch: 4 | loss: 0.1195507
	speed: 0.0172s/iter; left time: 119.0188s
	iters: 900, epoch: 4 | loss: 0.0887248
	speed: 0.0162s/iter; left time: 110.7692s
	iters: 1000, epoch: 4 | loss: 0.1115386
	speed: 0.0159s/iter; left time: 106.9875s
	iters: 1100, epoch: 4 | loss: 0.0953073
	speed: 0.0158s/iter; left time: 105.0405s
Epoch: 4 cost time: 19.420111417770386
Epoch: 4, Steps: 1104 | Train Loss: 0.1078727 Vali Loss: 0.0934448 Test Loss: 0.1049652
Validation loss decreased (0.094025 --> 0.093445).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0982228
	speed: 0.1223s/iter; left time: 798.0883s
	iters: 200, epoch: 5 | loss: 0.1256290
	speed: 0.0158s/iter; left time: 101.2562s
	iters: 300, epoch: 5 | loss: 0.0898177
	speed: 0.0159s/iter; left time: 100.5559s
	iters: 400, epoch: 5 | loss: 0.1102390
	speed: 0.0158s/iter; left time: 98.4016s
	iters: 500, epoch: 5 | loss: 0.0954540
	speed: 0.0162s/iter; left time: 99.2021s
	iters: 600, epoch: 5 | loss: 0.0939990
	speed: 0.0170s/iter; left time: 102.3638s
	iters: 700, epoch: 5 | loss: 0.1086135
	speed: 0.0162s/iter; left time: 96.0017s
	iters: 800, epoch: 5 | loss: 0.1057807
	speed: 0.0159s/iter; left time: 92.4143s
	iters: 900, epoch: 5 | loss: 0.0869599
	speed: 0.0166s/iter; left time: 95.1266s
	iters: 1000, epoch: 5 | loss: 0.1189850
	speed: 0.0162s/iter; left time: 91.3443s
	iters: 1100, epoch: 5 | loss: 0.0999495
	speed: 0.0163s/iter; left time: 90.0164s
Epoch: 5 cost time: 18.647336959838867
Epoch: 5, Steps: 1104 | Train Loss: 0.1067150 Vali Loss: 0.0927416 Test Loss: 0.1046402
Validation loss decreased (0.093445 --> 0.092742).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1067860
	speed: 0.1235s/iter; left time: 669.5929s
	iters: 200, epoch: 6 | loss: 0.1046434
	speed: 0.0158s/iter; left time: 84.3339s
	iters: 300, epoch: 6 | loss: 0.1003577
	speed: 0.0164s/iter; left time: 85.5438s
	iters: 400, epoch: 6 | loss: 0.1000218
	speed: 0.0162s/iter; left time: 83.0370s
	iters: 500, epoch: 6 | loss: 0.0924381
	speed: 0.0165s/iter; left time: 82.6718s
	iters: 600, epoch: 6 | loss: 0.0935553
	speed: 0.0161s/iter; left time: 79.4073s
	iters: 700, epoch: 6 | loss: 0.1061346
	speed: 0.0164s/iter; left time: 78.8329s
	iters: 800, epoch: 6 | loss: 0.0946638
	speed: 0.0159s/iter; left time: 75.0476s
	iters: 900, epoch: 6 | loss: 0.0783464
	speed: 0.0162s/iter; left time: 74.7963s
	iters: 1000, epoch: 6 | loss: 0.0846125
	speed: 0.0166s/iter; left time: 74.8912s
	iters: 1100, epoch: 6 | loss: 0.0921684
	speed: 0.0172s/iter; left time: 76.1212s
Epoch: 6 cost time: 18.98793053627014
Epoch: 6, Steps: 1104 | Train Loss: 0.1062448 Vali Loss: 0.0927429 Test Loss: 0.1042944
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1028461
	speed: 0.1226s/iter; left time: 529.1545s
	iters: 200, epoch: 7 | loss: 0.0906067
	speed: 0.0159s/iter; left time: 67.1866s
	iters: 300, epoch: 7 | loss: 0.0829759
	speed: 0.0167s/iter; left time: 68.9472s
	iters: 400, epoch: 7 | loss: 0.1220878
	speed: 0.0166s/iter; left time: 66.6392s
	iters: 500, epoch: 7 | loss: 0.0872712
	speed: 0.0165s/iter; left time: 64.7015s
	iters: 600, epoch: 7 | loss: 0.1021777
	speed: 0.0168s/iter; left time: 64.0619s
	iters: 700, epoch: 7 | loss: 0.0947858
	speed: 0.0165s/iter; left time: 61.2200s
	iters: 800, epoch: 7 | loss: 0.1174354
	speed: 0.0159s/iter; left time: 57.3434s
	iters: 900, epoch: 7 | loss: 0.0991887
	speed: 0.0164s/iter; left time: 57.6626s
	iters: 1000, epoch: 7 | loss: 0.1066806
	speed: 0.0178s/iter; left time: 60.8584s
	iters: 1100, epoch: 7 | loss: 0.0895670
	speed: 0.0163s/iter; left time: 54.0733s
Epoch: 7 cost time: 19.163541555404663
Epoch: 7, Steps: 1104 | Train Loss: 0.1059613 Vali Loss: 0.0923116 Test Loss: 0.1041430
Validation loss decreased (0.092742 --> 0.092312).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1095061
	speed: 0.1287s/iter; left time: 413.3870s
	iters: 200, epoch: 8 | loss: 0.0993421
	speed: 0.0161s/iter; left time: 50.0093s
	iters: 300, epoch: 8 | loss: 0.1042853
	speed: 0.0165s/iter; left time: 49.6330s
	iters: 400, epoch: 8 | loss: 0.1122210
	speed: 0.0168s/iter; left time: 48.8573s
	iters: 500, epoch: 8 | loss: 0.1025791
	speed: 0.0165s/iter; left time: 46.5166s
	iters: 600, epoch: 8 | loss: 0.0916822
	speed: 0.0165s/iter; left time: 44.7995s
	iters: 700, epoch: 8 | loss: 0.1190544
	speed: 0.0166s/iter; left time: 43.2981s
	iters: 800, epoch: 8 | loss: 0.0938606
	speed: 0.0167s/iter; left time: 41.8803s
	iters: 900, epoch: 8 | loss: 0.0995356
	speed: 0.0170s/iter; left time: 40.9425s
	iters: 1000, epoch: 8 | loss: 0.1317148
	speed: 0.0173s/iter; left time: 40.0613s
	iters: 1100, epoch: 8 | loss: 0.0829878
	speed: 0.0166s/iter; left time: 36.7591s
Epoch: 8 cost time: 19.533694744110107
Epoch: 8, Steps: 1104 | Train Loss: 0.1057867 Vali Loss: 0.0921032 Test Loss: 0.1039904
Validation loss decreased (0.092312 --> 0.092103).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1018003
	speed: 0.1276s/iter; left time: 269.0960s
	iters: 200, epoch: 9 | loss: 0.1559317
	speed: 0.0168s/iter; left time: 33.8135s
	iters: 300, epoch: 9 | loss: 0.1170794
	speed: 0.0168s/iter; left time: 32.1309s
	iters: 400, epoch: 9 | loss: 0.1034731
	speed: 0.0166s/iter; left time: 29.9546s
	iters: 500, epoch: 9 | loss: 0.1201484
	speed: 0.0160s/iter; left time: 27.4061s
	iters: 600, epoch: 9 | loss: 0.1150036
	speed: 0.0160s/iter; left time: 25.7558s
	iters: 700, epoch: 9 | loss: 0.1035990
	speed: 0.0170s/iter; left time: 25.5941s
	iters: 800, epoch: 9 | loss: 0.0989162
	speed: 0.0167s/iter; left time: 23.4748s
	iters: 900, epoch: 9 | loss: 0.1357059
	speed: 0.0164s/iter; left time: 21.4870s
	iters: 1000, epoch: 9 | loss: 0.1272660
	speed: 0.0176s/iter; left time: 21.2180s
	iters: 1100, epoch: 9 | loss: 0.1156488
	speed: 0.0163s/iter; left time: 18.0517s
Epoch: 9 cost time: 19.40322709083557
Epoch: 9, Steps: 1104 | Train Loss: 0.1057102 Vali Loss: 0.0921530 Test Loss: 0.1038647
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0903045
	speed: 0.1254s/iter; left time: 126.0185s
	iters: 200, epoch: 10 | loss: 0.0866956
	speed: 0.0172s/iter; left time: 15.5480s
	iters: 300, epoch: 10 | loss: 0.1075822
	speed: 0.0170s/iter; left time: 13.6603s
	iters: 400, epoch: 10 | loss: 0.1051415
	speed: 0.0167s/iter; left time: 11.7899s
	iters: 500, epoch: 10 | loss: 0.1170016
	speed: 0.0165s/iter; left time: 9.9772s
	iters: 600, epoch: 10 | loss: 0.0836578
	speed: 0.0169s/iter; left time: 8.5256s
	iters: 700, epoch: 10 | loss: 0.0960610
	speed: 0.0169s/iter; left time: 6.8349s
	iters: 800, epoch: 10 | loss: 0.0939089
	speed: 0.0162s/iter; left time: 4.9519s
	iters: 900, epoch: 10 | loss: 0.0951114
	speed: 0.0162s/iter; left time: 3.3312s
	iters: 1000, epoch: 10 | loss: 0.1056547
	speed: 0.0166s/iter; left time: 1.7450s
	iters: 1100, epoch: 10 | loss: 0.0961961
	speed: 0.0162s/iter; left time: 0.0812s
Epoch: 10 cost time: 19.364761114120483
Epoch: 10, Steps: 1104 | Train Loss: 0.1056694 Vali Loss: 0.0920855 Test Loss: 0.1038537
Validation loss decreased (0.092103 --> 0.092086).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_720_24_NLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10352569818496704, mae:0.20154497027397156
