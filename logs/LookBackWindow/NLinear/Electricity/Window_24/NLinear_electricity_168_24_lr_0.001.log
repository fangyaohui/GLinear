Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_168_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=168, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_168_24_NLinear_custom_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2023891
	speed: 0.0137s/iter; left time: 154.3823s
	iters: 200, epoch: 1 | loss: 0.1664453
	speed: 0.0069s/iter; left time: 77.2202s
	iters: 300, epoch: 1 | loss: 0.1593936
	speed: 0.0071s/iter; left time: 78.7357s
	iters: 400, epoch: 1 | loss: 0.1468709
	speed: 0.0068s/iter; left time: 75.1512s
	iters: 500, epoch: 1 | loss: 0.1423488
	speed: 0.0066s/iter; left time: 72.3494s
	iters: 600, epoch: 1 | loss: 0.1538240
	speed: 0.0069s/iter; left time: 73.9792s
	iters: 700, epoch: 1 | loss: 0.1151909
	speed: 0.0071s/iter; left time: 75.4170s
	iters: 800, epoch: 1 | loss: 0.1375055
	speed: 0.0070s/iter; left time: 73.6617s
	iters: 900, epoch: 1 | loss: 0.1134399
	speed: 0.0068s/iter; left time: 71.4635s
	iters: 1000, epoch: 1 | loss: 0.1724467
	speed: 0.0068s/iter; left time: 70.8238s
	iters: 1100, epoch: 1 | loss: 0.1303514
	speed: 0.0072s/iter; left time: 74.3357s
Epoch: 1 cost time: 8.668378353118896
Epoch: 1, Steps: 1138 | Train Loss: 0.1742911 Vali Loss: 0.1175826 Test Loss: 0.1297613
Validation loss decreased (inf --> 0.117583).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1453784
	speed: 0.0651s/iter; left time: 660.5748s
	iters: 200, epoch: 2 | loss: 0.1204576
	speed: 0.0068s/iter; left time: 68.7330s
	iters: 300, epoch: 2 | loss: 0.1537213
	speed: 0.0069s/iter; left time: 69.0265s
	iters: 400, epoch: 2 | loss: 0.1291199
	speed: 0.0069s/iter; left time: 67.5357s
	iters: 500, epoch: 2 | loss: 0.1394672
	speed: 0.0066s/iter; left time: 64.4860s
	iters: 600, epoch: 2 | loss: 0.0981011
	speed: 0.0073s/iter; left time: 70.1211s
	iters: 700, epoch: 2 | loss: 0.1049084
	speed: 0.0070s/iter; left time: 66.6973s
	iters: 800, epoch: 2 | loss: 0.1162627
	speed: 0.0070s/iter; left time: 66.4160s
	iters: 900, epoch: 2 | loss: 0.1173521
	speed: 0.0071s/iter; left time: 66.8022s
	iters: 1000, epoch: 2 | loss: 0.1277212
	speed: 0.0072s/iter; left time: 66.1130s
	iters: 1100, epoch: 2 | loss: 0.1129223
	speed: 0.0070s/iter; left time: 64.0383s
Epoch: 2 cost time: 8.688384056091309
Epoch: 2, Steps: 1138 | Train Loss: 0.1281708 Vali Loss: 0.1141389 Test Loss: 0.1268118
Validation loss decreased (0.117583 --> 0.114139).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1432233
	speed: 0.0666s/iter; left time: 600.0371s
	iters: 200, epoch: 3 | loss: 0.1060560
	speed: 0.0072s/iter; left time: 64.4496s
	iters: 300, epoch: 3 | loss: 0.1127459
	speed: 0.0070s/iter; left time: 61.7546s
	iters: 400, epoch: 3 | loss: 0.1202603
	speed: 0.0070s/iter; left time: 60.9859s
	iters: 500, epoch: 3 | loss: 0.1163382
	speed: 0.0068s/iter; left time: 58.7089s
	iters: 600, epoch: 3 | loss: 0.1140704
	speed: 0.0068s/iter; left time: 57.7198s
	iters: 700, epoch: 3 | loss: 0.1186494
	speed: 0.0071s/iter; left time: 59.5832s
	iters: 800, epoch: 3 | loss: 0.1170982
	speed: 0.0072s/iter; left time: 59.4172s
	iters: 900, epoch: 3 | loss: 0.1360112
	speed: 0.0073s/iter; left time: 59.5638s
	iters: 1000, epoch: 3 | loss: 0.1137733
	speed: 0.0074s/iter; left time: 60.2310s
	iters: 1100, epoch: 3 | loss: 0.1055283
	speed: 0.0069s/iter; left time: 55.0258s
Epoch: 3 cost time: 8.786823511123657
Epoch: 3, Steps: 1138 | Train Loss: 0.1254240 Vali Loss: 0.1116624 Test Loss: 0.1237880
Validation loss decreased (0.114139 --> 0.111662).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1466880
	speed: 0.0679s/iter; left time: 534.2605s
	iters: 200, epoch: 4 | loss: 0.1290843
	speed: 0.0072s/iter; left time: 55.5387s
	iters: 300, epoch: 4 | loss: 0.1357225
	speed: 0.0074s/iter; left time: 56.7894s
	iters: 400, epoch: 4 | loss: 0.1604823
	speed: 0.0069s/iter; left time: 52.0507s
	iters: 500, epoch: 4 | loss: 0.1299700
	speed: 0.0069s/iter; left time: 51.5321s
	iters: 600, epoch: 4 | loss: 0.1095814
	speed: 0.0070s/iter; left time: 51.3109s
	iters: 700, epoch: 4 | loss: 0.1171171
	speed: 0.0068s/iter; left time: 49.4226s
	iters: 800, epoch: 4 | loss: 0.1134745
	speed: 0.0070s/iter; left time: 50.0104s
	iters: 900, epoch: 4 | loss: 0.1243462
	speed: 0.0067s/iter; left time: 47.4355s
	iters: 1000, epoch: 4 | loss: 0.1516524
	speed: 0.0069s/iter; left time: 47.9494s
	iters: 1100, epoch: 4 | loss: 0.1024311
	speed: 0.0072s/iter; left time: 49.3466s
Epoch: 4 cost time: 8.840790033340454
Epoch: 4, Steps: 1138 | Train Loss: 0.1245839 Vali Loss: 0.1111486 Test Loss: 0.1235721
Validation loss decreased (0.111662 --> 0.111149).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1174740
	speed: 0.0673s/iter; left time: 452.7204s
	iters: 200, epoch: 5 | loss: 0.1402258
	speed: 0.0072s/iter; left time: 47.7882s
	iters: 300, epoch: 5 | loss: 0.1257596
	speed: 0.0073s/iter; left time: 47.6083s
	iters: 400, epoch: 5 | loss: 0.1432784
	speed: 0.0066s/iter; left time: 42.4340s
	iters: 500, epoch: 5 | loss: 0.1268649
	speed: 0.0071s/iter; left time: 45.0719s
	iters: 600, epoch: 5 | loss: 0.1114289
	speed: 0.0072s/iter; left time: 44.6517s
	iters: 700, epoch: 5 | loss: 0.1257885
	speed: 0.0070s/iter; left time: 43.0928s
	iters: 800, epoch: 5 | loss: 0.1085732
	speed: 0.0072s/iter; left time: 43.2066s
	iters: 900, epoch: 5 | loss: 0.1215879
	speed: 0.0073s/iter; left time: 43.5508s
	iters: 1000, epoch: 5 | loss: 0.1218860
	speed: 0.0072s/iter; left time: 42.0333s
	iters: 1100, epoch: 5 | loss: 0.1332606
	speed: 0.0077s/iter; left time: 44.0668s
Epoch: 5 cost time: 8.914515972137451
Epoch: 5, Steps: 1138 | Train Loss: 0.1241253 Vali Loss: 0.1128421 Test Loss: 0.1248641
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1198340
	speed: 0.0672s/iter; left time: 375.6451s
	iters: 200, epoch: 6 | loss: 0.1137324
	speed: 0.0070s/iter; left time: 38.5865s
	iters: 300, epoch: 6 | loss: 0.1105207
	speed: 0.0070s/iter; left time: 37.4904s
	iters: 400, epoch: 6 | loss: 0.1222005
	speed: 0.0070s/iter; left time: 37.2590s
	iters: 500, epoch: 6 | loss: 0.1161006
	speed: 0.0067s/iter; left time: 34.8243s
	iters: 600, epoch: 6 | loss: 0.1145260
	speed: 0.0068s/iter; left time: 34.5381s
	iters: 700, epoch: 6 | loss: 0.1217959
	speed: 0.0068s/iter; left time: 33.8848s
	iters: 800, epoch: 6 | loss: 0.1327379
	speed: 0.0070s/iter; left time: 34.4160s
	iters: 900, epoch: 6 | loss: 0.1164162
	speed: 0.0073s/iter; left time: 34.9006s
	iters: 1000, epoch: 6 | loss: 0.1069198
	speed: 0.0071s/iter; left time: 33.4653s
	iters: 1100, epoch: 6 | loss: 0.1076468
	speed: 0.0078s/iter; left time: 35.6631s
Epoch: 6 cost time: 8.814057111740112
Epoch: 6, Steps: 1138 | Train Loss: 0.1239598 Vali Loss: 0.1110621 Test Loss: 0.1232717
Validation loss decreased (0.111149 --> 0.111062).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1457555
	speed: 0.0673s/iter; left time: 299.8335s
	iters: 200, epoch: 7 | loss: 0.1118537
	speed: 0.0073s/iter; left time: 31.7703s
	iters: 300, epoch: 7 | loss: 0.1155255
	speed: 0.0069s/iter; left time: 29.5445s
	iters: 400, epoch: 7 | loss: 0.1151607
	speed: 0.0068s/iter; left time: 28.1122s
	iters: 500, epoch: 7 | loss: 0.1312521
	speed: 0.0068s/iter; left time: 27.6127s
	iters: 600, epoch: 7 | loss: 0.1169421
	speed: 0.0067s/iter; left time: 26.4311s
	iters: 700, epoch: 7 | loss: 0.1062175
	speed: 0.0067s/iter; left time: 25.8488s
	iters: 800, epoch: 7 | loss: 0.1575301
	speed: 0.0071s/iter; left time: 26.4912s
	iters: 900, epoch: 7 | loss: 0.1194082
	speed: 0.0069s/iter; left time: 25.2512s
	iters: 1000, epoch: 7 | loss: 0.1138988
	speed: 0.0072s/iter; left time: 25.7349s
	iters: 1100, epoch: 7 | loss: 0.1398459
	speed: 0.0079s/iter; left time: 27.1433s
Epoch: 7 cost time: 8.780818223953247
Epoch: 7, Steps: 1138 | Train Loss: 0.1238279 Vali Loss: 0.1112165 Test Loss: 0.1232393
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1283607
	speed: 0.0671s/iter; left time: 222.5114s
	iters: 200, epoch: 8 | loss: 0.1211725
	speed: 0.0068s/iter; left time: 21.7111s
	iters: 300, epoch: 8 | loss: 0.1204790
	speed: 0.0068s/iter; left time: 21.2755s
	iters: 400, epoch: 8 | loss: 0.1109838
	speed: 0.0067s/iter; left time: 20.2451s
	iters: 500, epoch: 8 | loss: 0.1057354
	speed: 0.0072s/iter; left time: 21.0847s
	iters: 600, epoch: 8 | loss: 0.1720433
	speed: 0.0068s/iter; left time: 19.1583s
	iters: 700, epoch: 8 | loss: 0.1134695
	speed: 0.0068s/iter; left time: 18.5490s
	iters: 800, epoch: 8 | loss: 0.1301281
	speed: 0.0068s/iter; left time: 17.7237s
	iters: 900, epoch: 8 | loss: 0.1072140
	speed: 0.0071s/iter; left time: 17.8854s
	iters: 1000, epoch: 8 | loss: 0.1126845
	speed: 0.0069s/iter; left time: 16.7698s
	iters: 1100, epoch: 8 | loss: 0.1104961
	speed: 0.0069s/iter; left time: 15.8954s
Epoch: 8 cost time: 8.581485748291016
Epoch: 8, Steps: 1138 | Train Loss: 0.1237674 Vali Loss: 0.1108790 Test Loss: 0.1230573
Validation loss decreased (0.111062 --> 0.110879).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1288367
	speed: 0.0668s/iter; left time: 145.3839s
	iters: 200, epoch: 9 | loss: 0.1166337
	speed: 0.0069s/iter; left time: 14.3040s
	iters: 300, epoch: 9 | loss: 0.1097721
	speed: 0.0067s/iter; left time: 13.2933s
	iters: 400, epoch: 9 | loss: 0.1128917
	speed: 0.0068s/iter; left time: 12.7906s
	iters: 500, epoch: 9 | loss: 0.1533788
	speed: 0.0067s/iter; left time: 11.8422s
	iters: 600, epoch: 9 | loss: 0.1142717
	speed: 0.0069s/iter; left time: 11.5457s
	iters: 700, epoch: 9 | loss: 0.1323254
	speed: 0.0068s/iter; left time: 10.6678s
	iters: 800, epoch: 9 | loss: 0.1583838
	speed: 0.0074s/iter; left time: 10.8820s
	iters: 900, epoch: 9 | loss: 0.1302178
	speed: 0.0070s/iter; left time: 9.5956s
	iters: 1000, epoch: 9 | loss: 0.1341905
	speed: 0.0071s/iter; left time: 9.0374s
	iters: 1100, epoch: 9 | loss: 0.1075504
	speed: 0.0071s/iter; left time: 8.3446s
Epoch: 9 cost time: 8.655138731002808
Epoch: 9, Steps: 1138 | Train Loss: 0.1237374 Vali Loss: 0.1109556 Test Loss: 0.1230395
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1492773
	speed: 0.0664s/iter; left time: 68.9882s
	iters: 200, epoch: 10 | loss: 0.1315192
	speed: 0.0073s/iter; left time: 6.8152s
	iters: 300, epoch: 10 | loss: 0.1251128
	speed: 0.0074s/iter; left time: 6.1871s
	iters: 400, epoch: 10 | loss: 0.0941817
	speed: 0.0070s/iter; left time: 5.1607s
	iters: 500, epoch: 10 | loss: 0.1155867
	speed: 0.0072s/iter; left time: 4.5801s
	iters: 600, epoch: 10 | loss: 0.1033851
	speed: 0.0072s/iter; left time: 3.8657s
	iters: 700, epoch: 10 | loss: 0.1005799
	speed: 0.0071s/iter; left time: 3.1080s
	iters: 800, epoch: 10 | loss: 0.1193504
	speed: 0.0070s/iter; left time: 2.3805s
	iters: 900, epoch: 10 | loss: 0.1090030
	speed: 0.0070s/iter; left time: 1.6769s
	iters: 1000, epoch: 10 | loss: 0.1327785
	speed: 0.0074s/iter; left time: 1.0244s
	iters: 1100, epoch: 10 | loss: 0.1196230
	speed: 0.0070s/iter; left time: 0.2749s
Epoch: 10 cost time: 8.889528036117554
Epoch: 10, Steps: 1138 | Train Loss: 0.1237371 Vali Loss: 0.1108392 Test Loss: 0.1230447
Validation loss decreased (0.110879 --> 0.110839).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_168_24_NLinear_custom_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.12281060218811035, mae:0.22033379971981049
