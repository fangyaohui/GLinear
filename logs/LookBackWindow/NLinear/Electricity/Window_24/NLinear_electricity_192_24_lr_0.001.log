Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_192_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=192, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_192_24_NLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18197
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1839581
	speed: 0.0130s/iter; left time: 146.1672s
	iters: 200, epoch: 1 | loss: 0.1828239
	speed: 0.0070s/iter; left time: 77.8528s
	iters: 300, epoch: 1 | loss: 0.1344396
	speed: 0.0069s/iter; left time: 76.5419s
	iters: 400, epoch: 1 | loss: 0.1355269
	speed: 0.0072s/iter; left time: 79.4023s
	iters: 500, epoch: 1 | loss: 0.1431966
	speed: 0.0071s/iter; left time: 77.5869s
	iters: 600, epoch: 1 | loss: 0.1399335
	speed: 0.0074s/iter; left time: 79.1968s
	iters: 700, epoch: 1 | loss: 0.1328642
	speed: 0.0074s/iter; left time: 78.4321s
	iters: 800, epoch: 1 | loss: 0.1126181
	speed: 0.0074s/iter; left time: 77.7796s
	iters: 900, epoch: 1 | loss: 0.1147069
	speed: 0.0073s/iter; left time: 76.8724s
	iters: 1000, epoch: 1 | loss: 0.2096940
	speed: 0.0075s/iter; left time: 77.5691s
	iters: 1100, epoch: 1 | loss: 0.1607396
	speed: 0.0074s/iter; left time: 76.4920s
Epoch: 1 cost time: 8.900022268295288
Epoch: 1, Steps: 1137 | Train Loss: 0.1693710 Vali Loss: 0.1131412 Test Loss: 0.1246252
Validation loss decreased (inf --> 0.113141).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1153133
	speed: 0.0632s/iter; left time: 640.0519s
	iters: 200, epoch: 2 | loss: 0.1134202
	speed: 0.0073s/iter; left time: 73.4470s
	iters: 300, epoch: 2 | loss: 0.1012120
	speed: 0.0072s/iter; left time: 71.0465s
	iters: 400, epoch: 2 | loss: 0.1218467
	speed: 0.0069s/iter; left time: 68.2543s
	iters: 500, epoch: 2 | loss: 0.1352601
	speed: 0.0075s/iter; left time: 73.2491s
	iters: 600, epoch: 2 | loss: 0.1081312
	speed: 0.0075s/iter; left time: 72.0634s
	iters: 700, epoch: 2 | loss: 0.1365692
	speed: 0.0071s/iter; left time: 67.4821s
	iters: 800, epoch: 2 | loss: 0.1327491
	speed: 0.0070s/iter; left time: 66.1644s
	iters: 900, epoch: 2 | loss: 0.1925185
	speed: 0.0071s/iter; left time: 66.7074s
	iters: 1000, epoch: 2 | loss: 0.1343686
	speed: 0.0073s/iter; left time: 67.5563s
	iters: 1100, epoch: 2 | loss: 0.1071477
	speed: 0.0078s/iter; left time: 70.8536s
Epoch: 2 cost time: 8.965426921844482
Epoch: 2, Steps: 1137 | Train Loss: 0.1236057 Vali Loss: 0.1084480 Test Loss: 0.1206238
Validation loss decreased (0.113141 --> 0.108448).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1385974
	speed: 0.0676s/iter; left time: 608.1768s
	iters: 200, epoch: 3 | loss: 0.1014828
	speed: 0.0072s/iter; left time: 64.2522s
	iters: 300, epoch: 3 | loss: 0.1169091
	speed: 0.0072s/iter; left time: 63.4365s
	iters: 400, epoch: 3 | loss: 0.1087488
	speed: 0.0072s/iter; left time: 62.3076s
	iters: 500, epoch: 3 | loss: 0.1754458
	speed: 0.0074s/iter; left time: 64.0379s
	iters: 600, epoch: 3 | loss: 0.1058835
	speed: 0.0073s/iter; left time: 62.2272s
	iters: 700, epoch: 3 | loss: 0.1229839
	speed: 0.0075s/iter; left time: 62.6455s
	iters: 800, epoch: 3 | loss: 0.1104239
	speed: 0.0072s/iter; left time: 59.9366s
	iters: 900, epoch: 3 | loss: 0.1479568
	speed: 0.0070s/iter; left time: 57.3914s
	iters: 1000, epoch: 3 | loss: 0.1154292
	speed: 0.0076s/iter; left time: 61.1805s
	iters: 1100, epoch: 3 | loss: 0.1114233
	speed: 0.0077s/iter; left time: 61.6791s
Epoch: 3 cost time: 9.15510630607605
Epoch: 3, Steps: 1137 | Train Loss: 0.1209216 Vali Loss: 0.1074434 Test Loss: 0.1196388
Validation loss decreased (0.108448 --> 0.107443).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1111931
	speed: 0.0646s/iter; left time: 507.5006s
	iters: 200, epoch: 4 | loss: 0.0988247
	speed: 0.0073s/iter; left time: 56.2729s
	iters: 300, epoch: 4 | loss: 0.1168823
	speed: 0.0071s/iter; left time: 54.4090s
	iters: 400, epoch: 4 | loss: 0.1041059
	speed: 0.0071s/iter; left time: 53.6348s
	iters: 500, epoch: 4 | loss: 0.1153933
	speed: 0.0074s/iter; left time: 55.0566s
	iters: 600, epoch: 4 | loss: 0.1228045
	speed: 0.0072s/iter; left time: 53.2032s
	iters: 700, epoch: 4 | loss: 0.1226088
	speed: 0.0069s/iter; left time: 50.4195s
	iters: 800, epoch: 4 | loss: 0.0937341
	speed: 0.0070s/iter; left time: 49.8631s
	iters: 900, epoch: 4 | loss: 0.1192322
	speed: 0.0071s/iter; left time: 50.2512s
	iters: 1000, epoch: 4 | loss: 0.1105357
	speed: 0.0077s/iter; left time: 53.6953s
	iters: 1100, epoch: 4 | loss: 0.1273133
	speed: 0.0071s/iter; left time: 48.9155s
Epoch: 4 cost time: 8.882254123687744
Epoch: 4, Steps: 1137 | Train Loss: 0.1201227 Vali Loss: 0.1071354 Test Loss: 0.1188718
Validation loss decreased (0.107443 --> 0.107135).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1191395
	speed: 0.0639s/iter; left time: 429.3677s
	iters: 200, epoch: 5 | loss: 0.1707821
	speed: 0.0072s/iter; left time: 47.5982s
	iters: 300, epoch: 5 | loss: 0.1185747
	speed: 0.0072s/iter; left time: 47.0899s
	iters: 400, epoch: 5 | loss: 0.1132963
	speed: 0.0071s/iter; left time: 45.4850s
	iters: 500, epoch: 5 | loss: 0.1249027
	speed: 0.0075s/iter; left time: 47.4755s
	iters: 600, epoch: 5 | loss: 0.1049483
	speed: 0.0073s/iter; left time: 45.2669s
	iters: 700, epoch: 5 | loss: 0.1321234
	speed: 0.0072s/iter; left time: 43.8938s
	iters: 800, epoch: 5 | loss: 0.1062184
	speed: 0.0072s/iter; left time: 43.6558s
	iters: 900, epoch: 5 | loss: 0.1085007
	speed: 0.0073s/iter; left time: 43.4410s
	iters: 1000, epoch: 5 | loss: 0.1136896
	speed: 0.0082s/iter; left time: 47.6738s
	iters: 1100, epoch: 5 | loss: 0.1067222
	speed: 0.0074s/iter; left time: 42.3383s
Epoch: 5 cost time: 9.025094985961914
Epoch: 5, Steps: 1137 | Train Loss: 0.1197063 Vali Loss: 0.1066405 Test Loss: 0.1185680
Validation loss decreased (0.107135 --> 0.106641).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1133335
	speed: 0.0627s/iter; left time: 350.3282s
	iters: 200, epoch: 6 | loss: 0.1152855
	speed: 0.0074s/iter; left time: 40.7463s
	iters: 300, epoch: 6 | loss: 0.1239616
	speed: 0.0070s/iter; left time: 37.8126s
	iters: 400, epoch: 6 | loss: 0.1143207
	speed: 0.0068s/iter; left time: 35.8305s
	iters: 500, epoch: 6 | loss: 0.1043942
	speed: 0.0067s/iter; left time: 34.7903s
	iters: 600, epoch: 6 | loss: 0.1386275
	speed: 0.0071s/iter; left time: 36.0743s
	iters: 700, epoch: 6 | loss: 0.1132975
	speed: 0.0071s/iter; left time: 35.4955s
	iters: 800, epoch: 6 | loss: 0.1513886
	speed: 0.0070s/iter; left time: 33.9955s
	iters: 900, epoch: 6 | loss: 0.0885405
	speed: 0.0070s/iter; left time: 33.6024s
	iters: 1000, epoch: 6 | loss: 0.1063880
	speed: 0.0071s/iter; left time: 33.4981s
	iters: 1100, epoch: 6 | loss: 0.1143807
	speed: 0.0075s/iter; left time: 34.3118s
Epoch: 6 cost time: 8.694011926651001
Epoch: 6, Steps: 1137 | Train Loss: 0.1194533 Vali Loss: 0.1063814 Test Loss: 0.1183270
Validation loss decreased (0.106641 --> 0.106381).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1058069
	speed: 0.0646s/iter; left time: 287.5479s
	iters: 200, epoch: 7 | loss: 0.1193695
	speed: 0.0071s/iter; left time: 30.9624s
	iters: 300, epoch: 7 | loss: 0.1103293
	speed: 0.0071s/iter; left time: 30.3627s
	iters: 400, epoch: 7 | loss: 0.1243457
	speed: 0.0070s/iter; left time: 29.2123s
	iters: 500, epoch: 7 | loss: 0.1085713
	speed: 0.0072s/iter; left time: 29.1867s
	iters: 600, epoch: 7 | loss: 0.1352485
	speed: 0.0074s/iter; left time: 29.2929s
	iters: 700, epoch: 7 | loss: 0.1169258
	speed: 0.0069s/iter; left time: 26.3956s
	iters: 800, epoch: 7 | loss: 0.1289080
	speed: 0.0071s/iter; left time: 26.7988s
	iters: 900, epoch: 7 | loss: 0.1330476
	speed: 0.0072s/iter; left time: 26.1488s
	iters: 1000, epoch: 7 | loss: 0.1103320
	speed: 0.0072s/iter; left time: 25.5826s
	iters: 1100, epoch: 7 | loss: 0.1394128
	speed: 0.0073s/iter; left time: 25.1317s
Epoch: 7 cost time: 8.909234046936035
Epoch: 7, Steps: 1137 | Train Loss: 0.1193346 Vali Loss: 0.1063143 Test Loss: 0.1182601
Validation loss decreased (0.106381 --> 0.106314).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1141232
	speed: 0.0654s/iter; left time: 216.6416s
	iters: 200, epoch: 8 | loss: 0.1206904
	speed: 0.0073s/iter; left time: 23.3886s
	iters: 300, epoch: 8 | loss: 0.1365839
	speed: 0.0069s/iter; left time: 21.3958s
	iters: 400, epoch: 8 | loss: 0.1052969
	speed: 0.0071s/iter; left time: 21.4608s
	iters: 500, epoch: 8 | loss: 0.1099254
	speed: 0.0072s/iter; left time: 20.9324s
	iters: 600, epoch: 8 | loss: 0.1061434
	speed: 0.0070s/iter; left time: 19.5510s
	iters: 700, epoch: 8 | loss: 0.1138856
	speed: 0.0069s/iter; left time: 18.6513s
	iters: 800, epoch: 8 | loss: 0.1106599
	speed: 0.0069s/iter; left time: 18.0554s
	iters: 900, epoch: 8 | loss: 0.1339240
	speed: 0.0069s/iter; left time: 17.2118s
	iters: 1000, epoch: 8 | loss: 0.1095992
	speed: 0.0070s/iter; left time: 16.7730s
	iters: 1100, epoch: 8 | loss: 0.1159699
	speed: 0.0073s/iter; left time: 16.7759s
Epoch: 8 cost time: 8.748580694198608
Epoch: 8, Steps: 1137 | Train Loss: 0.1192803 Vali Loss: 0.1063336 Test Loss: 0.1182430
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1086701
	speed: 0.0630s/iter; left time: 136.9703s
	iters: 200, epoch: 9 | loss: 0.2131788
	speed: 0.0070s/iter; left time: 14.4983s
	iters: 300, epoch: 9 | loss: 0.1337717
	speed: 0.0070s/iter; left time: 13.8548s
	iters: 400, epoch: 9 | loss: 0.1102687
	speed: 0.0070s/iter; left time: 13.1786s
	iters: 500, epoch: 9 | loss: 0.0965642
	speed: 0.0071s/iter; left time: 12.6060s
	iters: 600, epoch: 9 | loss: 0.1500896
	speed: 0.0074s/iter; left time: 12.3378s
	iters: 700, epoch: 9 | loss: 0.1898127
	speed: 0.0074s/iter; left time: 11.7013s
	iters: 800, epoch: 9 | loss: 0.1330294
	speed: 0.0072s/iter; left time: 10.5892s
	iters: 900, epoch: 9 | loss: 0.1075894
	speed: 0.0069s/iter; left time: 9.5389s
	iters: 1000, epoch: 9 | loss: 0.1309301
	speed: 0.0072s/iter; left time: 9.2400s
	iters: 1100, epoch: 9 | loss: 0.1031694
	speed: 0.0079s/iter; left time: 9.2338s
Epoch: 9 cost time: 8.81969404220581
Epoch: 9, Steps: 1137 | Train Loss: 0.1192404 Vali Loss: 0.1063330 Test Loss: 0.1182308
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1107044
	speed: 0.0651s/iter; left time: 67.6003s
	iters: 200, epoch: 10 | loss: 0.0958053
	speed: 0.0074s/iter; left time: 6.9462s
	iters: 300, epoch: 10 | loss: 0.1039502
	speed: 0.0069s/iter; left time: 5.7638s
	iters: 400, epoch: 10 | loss: 0.1039120
	speed: 0.0070s/iter; left time: 5.1471s
	iters: 500, epoch: 10 | loss: 0.1134518
	speed: 0.0072s/iter; left time: 4.5794s
	iters: 600, epoch: 10 | loss: 0.1175398
	speed: 0.0072s/iter; left time: 3.8543s
	iters: 700, epoch: 10 | loss: 0.1779421
	speed: 0.0070s/iter; left time: 3.0800s
	iters: 800, epoch: 10 | loss: 0.1459525
	speed: 0.0070s/iter; left time: 2.3729s
	iters: 900, epoch: 10 | loss: 0.1245487
	speed: 0.0073s/iter; left time: 1.7441s
	iters: 1000, epoch: 10 | loss: 0.1242416
	speed: 0.0073s/iter; left time: 1.0052s
	iters: 1100, epoch: 10 | loss: 0.1105398
	speed: 0.0073s/iter; left time: 0.2777s
Epoch: 10 cost time: 8.804970502853394
Epoch: 10, Steps: 1137 | Train Loss: 0.1192286 Vali Loss: 0.1063029 Test Loss: 0.1182239
Validation loss decreased (0.106314 --> 0.106303).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_192_24_NLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.11797254532575607, mae:0.2155972719192505
