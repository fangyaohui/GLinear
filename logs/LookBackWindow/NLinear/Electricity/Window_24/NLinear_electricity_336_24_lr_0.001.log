Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18053
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1750239
	speed: 0.0162s/iter; left time: 181.4709s
	iters: 200, epoch: 1 | loss: 0.1385878
	speed: 0.0091s/iter; left time: 100.5315s
	iters: 300, epoch: 1 | loss: 0.1304537
	speed: 0.0088s/iter; left time: 96.7212s
	iters: 400, epoch: 1 | loss: 0.1154253
	speed: 0.0091s/iter; left time: 99.2648s
	iters: 500, epoch: 1 | loss: 0.1334341
	speed: 0.0093s/iter; left time: 100.7205s
	iters: 600, epoch: 1 | loss: 0.1268693
	speed: 0.0094s/iter; left time: 100.4992s
	iters: 700, epoch: 1 | loss: 0.1473467
	speed: 0.0096s/iter; left time: 101.0681s
	iters: 800, epoch: 1 | loss: 0.1604902
	speed: 0.0095s/iter; left time: 99.2063s
	iters: 900, epoch: 1 | loss: 0.1109617
	speed: 0.0099s/iter; left time: 102.5611s
	iters: 1000, epoch: 1 | loss: 0.1194016
	speed: 0.0096s/iter; left time: 98.8305s
	iters: 1100, epoch: 1 | loss: 0.1109275
	speed: 0.0098s/iter; left time: 100.0277s
Epoch: 1 cost time: 11.403295040130615
Epoch: 1, Steps: 1128 | Train Loss: 0.1505533 Vali Loss: 0.1094941 Test Loss: 0.1207762
Validation loss decreased (inf --> 0.109494).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1255901
	speed: 0.0796s/iter; left time: 800.5617s
	iters: 200, epoch: 2 | loss: 0.1027364
	speed: 0.0095s/iter; left time: 94.6323s
	iters: 300, epoch: 2 | loss: 0.1223356
	speed: 0.0090s/iter; left time: 88.4756s
	iters: 400, epoch: 2 | loss: 0.1041895
	speed: 0.0093s/iter; left time: 90.2894s
	iters: 500, epoch: 2 | loss: 0.1513035
	speed: 0.0089s/iter; left time: 86.1098s
	iters: 600, epoch: 2 | loss: 0.1138494
	speed: 0.0095s/iter; left time: 90.3246s
	iters: 700, epoch: 2 | loss: 0.0919039
	speed: 0.0095s/iter; left time: 90.2301s
	iters: 800, epoch: 2 | loss: 0.1083649
	speed: 0.0098s/iter; left time: 91.5573s
	iters: 900, epoch: 2 | loss: 0.1016928
	speed: 0.0090s/iter; left time: 83.2446s
	iters: 1000, epoch: 2 | loss: 0.1051363
	speed: 0.0098s/iter; left time: 90.0316s
	iters: 1100, epoch: 2 | loss: 0.1101443
	speed: 0.0100s/iter; left time: 90.2721s
Epoch: 2 cost time: 11.4216947555542
Epoch: 2, Steps: 1128 | Train Loss: 0.1184152 Vali Loss: 0.1062731 Test Loss: 0.1184866
Validation loss decreased (0.109494 --> 0.106273).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0971453
	speed: 0.0780s/iter; left time: 695.8608s
	iters: 200, epoch: 3 | loss: 0.1248019
	speed: 0.0093s/iter; left time: 82.4493s
	iters: 300, epoch: 3 | loss: 0.1264975
	speed: 0.0094s/iter; left time: 81.7179s
	iters: 400, epoch: 3 | loss: 0.1066747
	speed: 0.0087s/iter; left time: 75.3000s
	iters: 500, epoch: 3 | loss: 0.1065279
	speed: 0.0090s/iter; left time: 77.1157s
	iters: 600, epoch: 3 | loss: 0.0962514
	speed: 0.0087s/iter; left time: 73.6141s
	iters: 700, epoch: 3 | loss: 0.1411508
	speed: 0.0087s/iter; left time: 72.7296s
	iters: 800, epoch: 3 | loss: 0.1152000
	speed: 0.0088s/iter; left time: 72.6463s
	iters: 900, epoch: 3 | loss: 0.1723596
	speed: 0.0094s/iter; left time: 76.6802s
	iters: 1000, epoch: 3 | loss: 0.0972637
	speed: 0.0092s/iter; left time: 74.0302s
	iters: 1100, epoch: 3 | loss: 0.1215765
	speed: 0.0091s/iter; left time: 72.5099s
Epoch: 3 cost time: 10.968650817871094
Epoch: 3, Steps: 1128 | Train Loss: 0.1152782 Vali Loss: 0.1005092 Test Loss: 0.1119041
Validation loss decreased (0.106273 --> 0.100509).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1308655
	speed: 0.0764s/iter; left time: 595.3297s
	iters: 200, epoch: 4 | loss: 0.1087646
	speed: 0.0092s/iter; left time: 70.4423s
	iters: 300, epoch: 4 | loss: 0.0986241
	speed: 0.0090s/iter; left time: 68.0846s
	iters: 400, epoch: 4 | loss: 0.1037364
	speed: 0.0092s/iter; left time: 69.0471s
	iters: 500, epoch: 4 | loss: 0.0967160
	speed: 0.0091s/iter; left time: 67.4311s
	iters: 600, epoch: 4 | loss: 0.0979134
	speed: 0.0091s/iter; left time: 66.2014s
	iters: 700, epoch: 4 | loss: 0.1372413
	speed: 0.0091s/iter; left time: 65.7898s
	iters: 800, epoch: 4 | loss: 0.1186668
	speed: 0.0093s/iter; left time: 65.9473s
	iters: 900, epoch: 4 | loss: 0.1012624
	speed: 0.0095s/iter; left time: 66.2620s
	iters: 1000, epoch: 4 | loss: 0.0916208
	speed: 0.0097s/iter; left time: 66.6497s
	iters: 1100, epoch: 4 | loss: 0.1668698
	speed: 0.0095s/iter; left time: 64.6674s
Epoch: 4 cost time: 11.19437575340271
Epoch: 4, Steps: 1128 | Train Loss: 0.1141158 Vali Loss: 0.0996702 Test Loss: 0.1114412
Validation loss decreased (0.100509 --> 0.099670).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1077077
	speed: 0.0786s/iter; left time: 524.3725s
	iters: 200, epoch: 5 | loss: 0.0955068
	speed: 0.0089s/iter; left time: 58.4499s
	iters: 300, epoch: 5 | loss: 0.1043925
	speed: 0.0094s/iter; left time: 60.6310s
	iters: 400, epoch: 5 | loss: 0.0913484
	speed: 0.0092s/iter; left time: 58.8447s
	iters: 500, epoch: 5 | loss: 0.0983808
	speed: 0.0089s/iter; left time: 55.7420s
	iters: 600, epoch: 5 | loss: 0.0995893
	speed: 0.0091s/iter; left time: 56.1894s
	iters: 700, epoch: 5 | loss: 0.1251550
	speed: 0.0092s/iter; left time: 55.7962s
	iters: 800, epoch: 5 | loss: 0.1174986
	speed: 0.0091s/iter; left time: 54.5791s
	iters: 900, epoch: 5 | loss: 0.1107491
	speed: 0.0095s/iter; left time: 55.6394s
	iters: 1000, epoch: 5 | loss: 0.1099728
	speed: 0.0094s/iter; left time: 54.3571s
	iters: 1100, epoch: 5 | loss: 0.0982264
	speed: 0.0096s/iter; left time: 54.4357s
Epoch: 5 cost time: 11.323647260665894
Epoch: 5, Steps: 1128 | Train Loss: 0.1135003 Vali Loss: 0.0994328 Test Loss: 0.1108937
Validation loss decreased (0.099670 --> 0.099433).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1000381
	speed: 0.0769s/iter; left time: 426.1174s
	iters: 200, epoch: 6 | loss: 0.1100682
	speed: 0.0094s/iter; left time: 51.3583s
	iters: 300, epoch: 6 | loss: 0.1268402
	speed: 0.0092s/iter; left time: 49.0384s
	iters: 400, epoch: 6 | loss: 0.1023581
	speed: 0.0092s/iter; left time: 48.0275s
	iters: 500, epoch: 6 | loss: 0.0941214
	speed: 0.0087s/iter; left time: 44.8186s
	iters: 600, epoch: 6 | loss: 0.1090868
	speed: 0.0086s/iter; left time: 43.3025s
	iters: 700, epoch: 6 | loss: 0.0903292
	speed: 0.0090s/iter; left time: 44.5915s
	iters: 800, epoch: 6 | loss: 0.1191229
	speed: 0.0092s/iter; left time: 44.7697s
	iters: 900, epoch: 6 | loss: 0.0979975
	speed: 0.0096s/iter; left time: 45.6443s
	iters: 1000, epoch: 6 | loss: 0.1313699
	speed: 0.0097s/iter; left time: 45.2276s
	iters: 1100, epoch: 6 | loss: 0.0981212
	speed: 0.0101s/iter; left time: 45.6434s
Epoch: 6 cost time: 11.212866067886353
Epoch: 6, Steps: 1128 | Train Loss: 0.1131561 Vali Loss: 0.0994614 Test Loss: 0.1108534
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1140833
	speed: 0.0763s/iter; left time: 336.8726s
	iters: 200, epoch: 7 | loss: 0.1022622
	speed: 0.0092s/iter; left time: 39.7724s
	iters: 300, epoch: 7 | loss: 0.1029061
	speed: 0.0092s/iter; left time: 38.7110s
	iters: 400, epoch: 7 | loss: 0.1172195
	speed: 0.0096s/iter; left time: 39.5321s
	iters: 500, epoch: 7 | loss: 0.1155749
	speed: 0.0091s/iter; left time: 36.5854s
	iters: 600, epoch: 7 | loss: 0.1057422
	speed: 0.0093s/iter; left time: 36.2726s
	iters: 700, epoch: 7 | loss: 0.0995892
	speed: 0.0086s/iter; left time: 32.9138s
	iters: 800, epoch: 7 | loss: 0.0947677
	speed: 0.0091s/iter; left time: 33.7637s
	iters: 900, epoch: 7 | loss: 0.1225512
	speed: 0.0091s/iter; left time: 33.0322s
	iters: 1000, epoch: 7 | loss: 0.1210580
	speed: 0.0093s/iter; left time: 32.8086s
	iters: 1100, epoch: 7 | loss: 0.0973955
	speed: 0.0099s/iter; left time: 33.7409s
Epoch: 7 cost time: 11.136967658996582
Epoch: 7, Steps: 1128 | Train Loss: 0.1129506 Vali Loss: 0.0993077 Test Loss: 0.1107338
Validation loss decreased (0.099433 --> 0.099308).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0900123
	speed: 0.0798s/iter; left time: 262.2813s
	iters: 200, epoch: 8 | loss: 0.1473668
	speed: 0.0096s/iter; left time: 30.5640s
	iters: 300, epoch: 8 | loss: 0.1072174
	speed: 0.0092s/iter; left time: 28.4519s
	iters: 400, epoch: 8 | loss: 0.0996386
	speed: 0.0092s/iter; left time: 27.4120s
	iters: 500, epoch: 8 | loss: 0.1635327
	speed: 0.0092s/iter; left time: 26.4330s
	iters: 600, epoch: 8 | loss: 0.1448685
	speed: 0.0094s/iter; left time: 26.0792s
	iters: 700, epoch: 8 | loss: 0.1259615
	speed: 0.0090s/iter; left time: 24.2941s
	iters: 800, epoch: 8 | loss: 0.1217009
	speed: 0.0090s/iter; left time: 23.3346s
	iters: 900, epoch: 8 | loss: 0.1173029
	speed: 0.0092s/iter; left time: 22.9571s
	iters: 1000, epoch: 8 | loss: 0.1065062
	speed: 0.0102s/iter; left time: 24.3818s
	iters: 1100, epoch: 8 | loss: 0.0966264
	speed: 0.0097s/iter; left time: 22.2320s
Epoch: 8 cost time: 11.422916412353516
Epoch: 8, Steps: 1128 | Train Loss: 0.1128647 Vali Loss: 0.0994355 Test Loss: 0.1107553
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1323663
	speed: 0.0802s/iter; left time: 172.9857s
	iters: 200, epoch: 9 | loss: 0.1174718
	speed: 0.0094s/iter; left time: 19.4101s
	iters: 300, epoch: 9 | loss: 0.1089184
	speed: 0.0095s/iter; left time: 18.6548s
	iters: 400, epoch: 9 | loss: 0.1158792
	speed: 0.0094s/iter; left time: 17.4692s
	iters: 500, epoch: 9 | loss: 0.1121164
	speed: 0.0095s/iter; left time: 16.7444s
	iters: 600, epoch: 9 | loss: 0.0957322
	speed: 0.0091s/iter; left time: 15.0802s
	iters: 700, epoch: 9 | loss: 0.1300739
	speed: 0.0092s/iter; left time: 14.2559s
	iters: 800, epoch: 9 | loss: 0.0887907
	speed: 0.0094s/iter; left time: 13.6771s
	iters: 900, epoch: 9 | loss: 0.1076653
	speed: 0.0096s/iter; left time: 13.0279s
	iters: 1000, epoch: 9 | loss: 0.1064685
	speed: 0.0102s/iter; left time: 12.8376s
	iters: 1100, epoch: 9 | loss: 0.1133094
	speed: 0.0098s/iter; left time: 11.3661s
Epoch: 9 cost time: 11.575808763504028
Epoch: 9, Steps: 1128 | Train Loss: 0.1128015 Vali Loss: 0.0992181 Test Loss: 0.1106477
Validation loss decreased (0.099308 --> 0.099218).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1087109
	speed: 0.0770s/iter; left time: 79.2792s
	iters: 200, epoch: 10 | loss: 0.0964786
	speed: 0.0096s/iter; left time: 8.8749s
	iters: 300, epoch: 10 | loss: 0.1032662
	speed: 0.0094s/iter; left time: 7.7566s
	iters: 400, epoch: 10 | loss: 0.0944134
	speed: 0.0087s/iter; left time: 6.3281s
	iters: 500, epoch: 10 | loss: 0.1044402
	speed: 0.0088s/iter; left time: 5.5324s
	iters: 600, epoch: 10 | loss: 0.0996465
	speed: 0.0090s/iter; left time: 4.7376s
	iters: 700, epoch: 10 | loss: 0.0991215
	speed: 0.0090s/iter; left time: 3.8525s
	iters: 800, epoch: 10 | loss: 0.1051227
	speed: 0.0093s/iter; left time: 3.0742s
	iters: 900, epoch: 10 | loss: 0.1426749
	speed: 0.0097s/iter; left time: 2.2192s
	iters: 1000, epoch: 10 | loss: 0.1202279
	speed: 0.0095s/iter; left time: 1.2228s
	iters: 1100, epoch: 10 | loss: 0.1540066
	speed: 0.0096s/iter; left time: 0.2778s
Epoch: 10 cost time: 11.169044971466064
Epoch: 10, Steps: 1128 | Train Loss: 0.1127820 Vali Loss: 0.0991911 Test Loss: 0.1106272
Validation loss decreased (0.099218 --> 0.099191).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.11033638566732407, mae:0.20918528735637665
