Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_504_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_504_24_NLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1810235
	speed: 0.0195s/iter; left time: 215.7652s
	iters: 200, epoch: 1 | loss: 0.1229354
	speed: 0.0117s/iter; left time: 128.0044s
	iters: 300, epoch: 1 | loss: 0.1202211
	speed: 0.0116s/iter; left time: 126.0856s
	iters: 400, epoch: 1 | loss: 0.1118204
	speed: 0.0119s/iter; left time: 128.5273s
	iters: 500, epoch: 1 | loss: 0.1284798
	speed: 0.0118s/iter; left time: 126.0708s
	iters: 600, epoch: 1 | loss: 0.1104586
	speed: 0.0114s/iter; left time: 120.8227s
	iters: 700, epoch: 1 | loss: 0.1043087
	speed: 0.0117s/iter; left time: 122.4112s
	iters: 800, epoch: 1 | loss: 0.1341999
	speed: 0.0115s/iter; left time: 119.6147s
	iters: 900, epoch: 1 | loss: 0.1151896
	speed: 0.0115s/iter; left time: 117.7586s
	iters: 1000, epoch: 1 | loss: 0.1339642
	speed: 0.0125s/iter; left time: 127.5601s
	iters: 1100, epoch: 1 | loss: 0.1248163
	speed: 0.0122s/iter; left time: 122.4832s
Epoch: 1 cost time: 13.995630025863647
Epoch: 1, Steps: 1117 | Train Loss: 0.1396687 Vali Loss: 0.1020799 Test Loss: 0.1139813
Validation loss decreased (inf --> 0.102080).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1024254
	speed: 0.0933s/iter; left time: 928.8348s
	iters: 200, epoch: 2 | loss: 0.1228022
	speed: 0.0122s/iter; left time: 120.3435s
	iters: 300, epoch: 2 | loss: 0.1090372
	speed: 0.0115s/iter; left time: 112.6041s
	iters: 400, epoch: 2 | loss: 0.0945667
	speed: 0.0114s/iter; left time: 109.6299s
	iters: 500, epoch: 2 | loss: 0.1223717
	speed: 0.0115s/iter; left time: 109.5034s
	iters: 600, epoch: 2 | loss: 0.1083734
	speed: 0.0119s/iter; left time: 112.6053s
	iters: 700, epoch: 2 | loss: 0.1243263
	speed: 0.0114s/iter; left time: 106.5530s
	iters: 800, epoch: 2 | loss: 0.1012585
	speed: 0.0114s/iter; left time: 105.7765s
	iters: 900, epoch: 2 | loss: 0.1013398
	speed: 0.0116s/iter; left time: 106.1076s
	iters: 1000, epoch: 2 | loss: 0.1294387
	speed: 0.0132s/iter; left time: 119.3425s
	iters: 1100, epoch: 2 | loss: 0.1064910
	speed: 0.0121s/iter; left time: 108.0670s
Epoch: 2 cost time: 13.907246828079224
Epoch: 2, Steps: 1117 | Train Loss: 0.1162909 Vali Loss: 0.0988028 Test Loss: 0.1111683
Validation loss decreased (0.102080 --> 0.098803).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0906504
	speed: 0.0931s/iter; left time: 822.7691s
	iters: 200, epoch: 3 | loss: 0.0937733
	speed: 0.0117s/iter; left time: 102.5399s
	iters: 300, epoch: 3 | loss: 0.0985800
	speed: 0.0116s/iter; left time: 100.0086s
	iters: 400, epoch: 3 | loss: 0.1023592
	speed: 0.0118s/iter; left time: 100.7121s
	iters: 500, epoch: 3 | loss: 0.1372259
	speed: 0.0115s/iter; left time: 97.3424s
	iters: 600, epoch: 3 | loss: 0.1159231
	speed: 0.0120s/iter; left time: 100.0724s
	iters: 700, epoch: 3 | loss: 0.1392322
	speed: 0.0122s/iter; left time: 100.1977s
	iters: 800, epoch: 3 | loss: 0.0981846
	speed: 0.0119s/iter; left time: 96.5877s
	iters: 900, epoch: 3 | loss: 0.1194206
	speed: 0.0118s/iter; left time: 94.8231s
	iters: 1000, epoch: 3 | loss: 0.1108027
	speed: 0.0126s/iter; left time: 99.6555s
	iters: 1100, epoch: 3 | loss: 0.1138113
	speed: 0.0123s/iter; left time: 96.2762s
Epoch: 3 cost time: 14.130808353424072
Epoch: 3, Steps: 1117 | Train Loss: 0.1117252 Vali Loss: 0.0966188 Test Loss: 0.1084333
Validation loss decreased (0.098803 --> 0.096619).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1085684
	speed: 0.0958s/iter; left time: 739.4206s
	iters: 200, epoch: 4 | loss: 0.0977892
	speed: 0.0119s/iter; left time: 90.8528s
	iters: 300, epoch: 4 | loss: 0.1143164
	speed: 0.0113s/iter; left time: 85.3256s
	iters: 400, epoch: 4 | loss: 0.0922505
	speed: 0.0129s/iter; left time: 95.6295s
	iters: 500, epoch: 4 | loss: 0.1069803
	speed: 0.0168s/iter; left time: 123.0308s
	iters: 600, epoch: 4 | loss: 0.0953862
	speed: 0.0120s/iter; left time: 86.4370s
	iters: 700, epoch: 4 | loss: 0.1044897
	speed: 0.0136s/iter; left time: 97.0032s
	iters: 800, epoch: 4 | loss: 0.0969415
	speed: 0.0129s/iter; left time: 90.4177s
	iters: 900, epoch: 4 | loss: 0.1064510
	speed: 0.0125s/iter; left time: 86.4564s
	iters: 1000, epoch: 4 | loss: 0.1000147
	speed: 0.0116s/iter; left time: 79.2062s
	iters: 1100, epoch: 4 | loss: 0.1155206
	speed: 0.0121s/iter; left time: 81.3937s
Epoch: 4 cost time: 14.891649007797241
Epoch: 4, Steps: 1117 | Train Loss: 0.1100130 Vali Loss: 0.0975696 Test Loss: 0.1092797
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0952520
	speed: 0.1014s/iter; left time: 669.8618s
	iters: 200, epoch: 5 | loss: 0.1213708
	speed: 0.0139s/iter; left time: 90.0688s
	iters: 300, epoch: 5 | loss: 0.1065158
	speed: 0.0131s/iter; left time: 84.1479s
	iters: 400, epoch: 5 | loss: 0.1268947
	speed: 0.0117s/iter; left time: 73.7581s
	iters: 500, epoch: 5 | loss: 0.1232320
	speed: 0.0145s/iter; left time: 89.9686s
	iters: 600, epoch: 5 | loss: 0.1173248
	speed: 0.0131s/iter; left time: 80.1812s
	iters: 700, epoch: 5 | loss: 0.0966076
	speed: 0.0127s/iter; left time: 76.2774s
	iters: 800, epoch: 5 | loss: 0.1179004
	speed: 0.0123s/iter; left time: 72.4166s
	iters: 900, epoch: 5 | loss: 0.1070547
	speed: 0.0117s/iter; left time: 67.8198s
	iters: 1000, epoch: 5 | loss: 0.0930107
	speed: 0.0146s/iter; left time: 83.3138s
	iters: 1100, epoch: 5 | loss: 0.0909264
	speed: 0.0117s/iter; left time: 65.7158s
Epoch: 5 cost time: 15.158137083053589
Epoch: 5, Steps: 1117 | Train Loss: 0.1093542 Vali Loss: 0.0949308 Test Loss: 0.1069759
Validation loss decreased (0.096619 --> 0.094931).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0990035
	speed: 0.1053s/iter; left time: 577.8639s
	iters: 200, epoch: 6 | loss: 0.1095983
	speed: 0.0128s/iter; left time: 68.8827s
	iters: 300, epoch: 6 | loss: 0.0928550
	speed: 0.0125s/iter; left time: 65.8496s
	iters: 400, epoch: 6 | loss: 0.1331374
	speed: 0.0130s/iter; left time: 67.5516s
	iters: 500, epoch: 6 | loss: 0.0820569
	speed: 0.0141s/iter; left time: 71.5793s
	iters: 600, epoch: 6 | loss: 0.0877728
	speed: 0.0133s/iter; left time: 66.1934s
	iters: 700, epoch: 6 | loss: 0.0976851
	speed: 0.0136s/iter; left time: 66.4827s
	iters: 800, epoch: 6 | loss: 0.0955917
	speed: 0.0131s/iter; left time: 62.9353s
	iters: 900, epoch: 6 | loss: 0.0893726
	speed: 0.0129s/iter; left time: 60.3888s
	iters: 1000, epoch: 6 | loss: 0.0969992
	speed: 0.0136s/iter; left time: 62.2226s
	iters: 1100, epoch: 6 | loss: 0.0927296
	speed: 0.0135s/iter; left time: 60.7239s
Epoch: 6 cost time: 15.645933866500854
Epoch: 6, Steps: 1117 | Train Loss: 0.1089004 Vali Loss: 0.0948680 Test Loss: 0.1069516
Validation loss decreased (0.094931 --> 0.094868).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1123752
	speed: 0.1064s/iter; left time: 464.7699s
	iters: 200, epoch: 7 | loss: 0.1290196
	speed: 0.0129s/iter; left time: 54.9549s
	iters: 300, epoch: 7 | loss: 0.0954064
	speed: 0.0135s/iter; left time: 56.4192s
	iters: 400, epoch: 7 | loss: 0.0969832
	speed: 0.0136s/iter; left time: 55.2646s
	iters: 500, epoch: 7 | loss: 0.0988415
	speed: 0.0132s/iter; left time: 52.3233s
	iters: 600, epoch: 7 | loss: 0.1103731
	speed: 0.0133s/iter; left time: 51.3119s
	iters: 700, epoch: 7 | loss: 0.1114302
	speed: 0.0131s/iter; left time: 49.4318s
	iters: 800, epoch: 7 | loss: 0.1001672
	speed: 0.0136s/iter; left time: 50.0117s
	iters: 900, epoch: 7 | loss: 0.1196819
	speed: 0.0126s/iter; left time: 45.0715s
	iters: 1000, epoch: 7 | loss: 0.1010465
	speed: 0.0134s/iter; left time: 46.4007s
	iters: 1100, epoch: 7 | loss: 0.0938751
	speed: 0.0131s/iter; left time: 44.2047s
Epoch: 7 cost time: 15.68314790725708
Epoch: 7, Steps: 1117 | Train Loss: 0.1086845 Vali Loss: 0.0949216 Test Loss: 0.1069597
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1200011
	speed: 0.1021s/iter; left time: 332.0807s
	iters: 200, epoch: 8 | loss: 0.0916056
	speed: 0.0128s/iter; left time: 40.2068s
	iters: 300, epoch: 8 | loss: 0.1121478
	speed: 0.0130s/iter; left time: 39.7976s
	iters: 400, epoch: 8 | loss: 0.0879780
	speed: 0.0141s/iter; left time: 41.6939s
	iters: 500, epoch: 8 | loss: 0.1008765
	speed: 0.0140s/iter; left time: 40.0194s
	iters: 600, epoch: 8 | loss: 0.0878388
	speed: 0.0130s/iter; left time: 35.7223s
	iters: 700, epoch: 8 | loss: 0.1013825
	speed: 0.0123s/iter; left time: 32.7106s
	iters: 800, epoch: 8 | loss: 0.1080911
	speed: 0.0125s/iter; left time: 31.8792s
	iters: 900, epoch: 8 | loss: 0.1025730
	speed: 0.0131s/iter; left time: 32.0338s
	iters: 1000, epoch: 8 | loss: 0.1182912
	speed: 0.0129s/iter; left time: 30.3901s
	iters: 1100, epoch: 8 | loss: 0.1230354
	speed: 0.0139s/iter; left time: 31.3658s
Epoch: 8 cost time: 15.53502893447876
Epoch: 8, Steps: 1117 | Train Loss: 0.1085571 Vali Loss: 0.0947113 Test Loss: 0.1066439
Validation loss decreased (0.094868 --> 0.094711).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0812968
	speed: 0.1033s/iter; left time: 220.5319s
	iters: 200, epoch: 9 | loss: 0.1017764
	speed: 0.0122s/iter; left time: 24.9156s
	iters: 300, epoch: 9 | loss: 0.1203564
	speed: 0.0130s/iter; left time: 25.2120s
	iters: 400, epoch: 9 | loss: 0.1029191
	speed: 0.0128s/iter; left time: 23.3967s
	iters: 500, epoch: 9 | loss: 0.1490376
	speed: 0.0130s/iter; left time: 22.5026s
	iters: 600, epoch: 9 | loss: 0.0909987
	speed: 0.0135s/iter; left time: 22.0209s
	iters: 700, epoch: 9 | loss: 0.1510783
	speed: 0.0132s/iter; left time: 20.1855s
	iters: 800, epoch: 9 | loss: 0.1008642
	speed: 0.0134s/iter; left time: 19.2460s
	iters: 900, epoch: 9 | loss: 0.0858265
	speed: 0.0128s/iter; left time: 17.0741s
	iters: 1000, epoch: 9 | loss: 0.1169905
	speed: 0.0130s/iter; left time: 16.0073s
	iters: 1100, epoch: 9 | loss: 0.0937180
	speed: 0.0133s/iter; left time: 15.1128s
Epoch: 9 cost time: 15.379231691360474
Epoch: 9, Steps: 1117 | Train Loss: 0.1084955 Vali Loss: 0.0946411 Test Loss: 0.1065340
Validation loss decreased (0.094711 --> 0.094641).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0942019
	speed: 0.1040s/iter; left time: 105.9171s
	iters: 200, epoch: 10 | loss: 0.0997847
	speed: 0.0130s/iter; left time: 11.9793s
	iters: 300, epoch: 10 | loss: 0.1201870
	speed: 0.0130s/iter; left time: 10.6342s
	iters: 400, epoch: 10 | loss: 0.0895867
	speed: 0.0129s/iter; left time: 9.2518s
	iters: 500, epoch: 10 | loss: 0.1175352
	speed: 0.0132s/iter; left time: 8.1658s
	iters: 600, epoch: 10 | loss: 0.1465040
	speed: 0.0127s/iter; left time: 6.5708s
	iters: 700, epoch: 10 | loss: 0.0883580
	speed: 0.0130s/iter; left time: 5.4201s
	iters: 800, epoch: 10 | loss: 0.1003117
	speed: 0.0129s/iter; left time: 4.1059s
	iters: 900, epoch: 10 | loss: 0.0873317
	speed: 0.0126s/iter; left time: 2.7369s
	iters: 1000, epoch: 10 | loss: 0.1032700
	speed: 0.0131s/iter; left time: 1.5515s
	iters: 1100, epoch: 10 | loss: 0.1471564
	speed: 0.0127s/iter; left time: 0.2292s
Epoch: 10 cost time: 15.381245613098145
Epoch: 10, Steps: 1117 | Train Loss: 0.1084379 Vali Loss: 0.0946380 Test Loss: 0.1065134
Validation loss decreased (0.094641 --> 0.094638).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_504_24_NLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10620110481977463, mae:0.20483215153217316
