Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='Electricity_72_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=72, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_72_24_NLinear_custom_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2427484
	speed: 0.0205s/iter; left time: 232.7216s
	iters: 200, epoch: 1 | loss: 0.2530560
	speed: 0.0130s/iter; left time: 146.3656s
	iters: 300, epoch: 1 | loss: 0.1950566
	speed: 0.0126s/iter; left time: 140.2247s
	iters: 400, epoch: 1 | loss: 0.2180826
	speed: 0.0120s/iter; left time: 132.4932s
	iters: 500, epoch: 1 | loss: 0.1798477
	speed: 0.0118s/iter; left time: 129.6033s
	iters: 600, epoch: 1 | loss: 0.1845288
	speed: 0.0064s/iter; left time: 68.8519s
	iters: 700, epoch: 1 | loss: 0.1728927
	speed: 0.0086s/iter; left time: 92.0064s
	iters: 800, epoch: 1 | loss: 0.1667484
	speed: 0.0063s/iter; left time: 67.4530s
	iters: 900, epoch: 1 | loss: 0.1715690
	speed: 0.0062s/iter; left time: 65.5779s
	iters: 1000, epoch: 1 | loss: 0.1724200
	speed: 0.0072s/iter; left time: 75.6681s
	iters: 1100, epoch: 1 | loss: 0.1947728
	speed: 0.0062s/iter; left time: 63.9265s
Epoch: 1 cost time: 11.436454057693481
Epoch: 1, Steps: 1144 | Train Loss: 0.2288344 Vali Loss: 0.1652397 Test Loss: 0.1780872
Validation loss decreased (inf --> 0.165240).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1586402
	speed: 0.0679s/iter; left time: 692.1559s
	iters: 200, epoch: 2 | loss: 0.1572343
	speed: 0.0060s/iter; left time: 60.5792s
	iters: 300, epoch: 2 | loss: 0.1191686
	speed: 0.0057s/iter; left time: 57.1019s
	iters: 400, epoch: 2 | loss: 0.1334303
	speed: 0.0057s/iter; left time: 56.7683s
	iters: 500, epoch: 2 | loss: 0.1590734
	speed: 0.0054s/iter; left time: 53.1364s
	iters: 600, epoch: 2 | loss: 0.1882918
	speed: 0.0056s/iter; left time: 54.4155s
	iters: 700, epoch: 2 | loss: 0.1774593
	speed: 0.0057s/iter; left time: 54.4829s
	iters: 800, epoch: 2 | loss: 0.2293344
	speed: 0.0058s/iter; left time: 55.1448s
	iters: 900, epoch: 2 | loss: 0.1807175
	speed: 0.0057s/iter; left time: 53.2761s
	iters: 1000, epoch: 2 | loss: 0.1766158
	speed: 0.0064s/iter; left time: 59.5236s
	iters: 1100, epoch: 2 | loss: 0.1906906
	speed: 0.0071s/iter; left time: 65.3262s
Epoch: 2 cost time: 7.969906330108643
Epoch: 2, Steps: 1144 | Train Loss: 0.1777141 Vali Loss: 0.1605632 Test Loss: 0.1732633
Validation loss decreased (0.165240 --> 0.160563).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1534586
	speed: 0.0677s/iter; left time: 612.8549s
	iters: 200, epoch: 3 | loss: 0.2013100
	speed: 0.0056s/iter; left time: 49.9729s
	iters: 300, epoch: 3 | loss: 0.1638460
	speed: 0.0057s/iter; left time: 50.2871s
	iters: 400, epoch: 3 | loss: 0.2099805
	speed: 0.0056s/iter; left time: 48.9362s
	iters: 500, epoch: 3 | loss: 0.1694612
	speed: 0.0056s/iter; left time: 48.0924s
	iters: 600, epoch: 3 | loss: 0.1637083
	speed: 0.0057s/iter; left time: 48.4924s
	iters: 700, epoch: 3 | loss: 0.1736434
	speed: 0.0059s/iter; left time: 49.4705s
	iters: 800, epoch: 3 | loss: 0.1663600
	speed: 0.0061s/iter; left time: 50.7291s
	iters: 900, epoch: 3 | loss: 0.1960147
	speed: 0.0057s/iter; left time: 47.1944s
	iters: 1000, epoch: 3 | loss: 0.2111246
	speed: 0.0059s/iter; left time: 48.1507s
	iters: 1100, epoch: 3 | loss: 0.1924615
	speed: 0.0059s/iter; left time: 47.2336s
Epoch: 3 cost time: 7.636637449264526
Epoch: 3, Steps: 1144 | Train Loss: 0.1753139 Vali Loss: 0.1601225 Test Loss: 0.1725809
Validation loss decreased (0.160563 --> 0.160122).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1895312
	speed: 0.0664s/iter; left time: 525.0688s
	iters: 200, epoch: 4 | loss: 0.1581603
	speed: 0.0056s/iter; left time: 43.9675s
	iters: 300, epoch: 4 | loss: 0.1576870
	speed: 0.0056s/iter; left time: 43.2457s
	iters: 400, epoch: 4 | loss: 0.1762523
	speed: 0.0059s/iter; left time: 45.2538s
	iters: 500, epoch: 4 | loss: 0.2374861
	speed: 0.0059s/iter; left time: 44.1588s
	iters: 600, epoch: 4 | loss: 0.1558225
	speed: 0.0056s/iter; left time: 41.2647s
	iters: 700, epoch: 4 | loss: 0.2078381
	speed: 0.0056s/iter; left time: 40.7185s
	iters: 800, epoch: 4 | loss: 0.1484122
	speed: 0.0056s/iter; left time: 40.1093s
	iters: 900, epoch: 4 | loss: 0.1866303
	speed: 0.0055s/iter; left time: 39.4011s
	iters: 1000, epoch: 4 | loss: 0.1864787
	speed: 0.0058s/iter; left time: 40.7613s
	iters: 1100, epoch: 4 | loss: 0.1632460
	speed: 0.0055s/iter; left time: 38.3422s
Epoch: 4 cost time: 7.521230936050415
Epoch: 4, Steps: 1144 | Train Loss: 0.1746521 Vali Loss: 0.1595357 Test Loss: 0.1720757
Validation loss decreased (0.160122 --> 0.159536).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1534726
	speed: 0.0994s/iter; left time: 672.5046s
	iters: 200, epoch: 5 | loss: 0.1995297
	speed: 0.0129s/iter; left time: 86.0815s
	iters: 300, epoch: 5 | loss: 0.1746863
	speed: 0.0131s/iter; left time: 86.0592s
	iters: 400, epoch: 5 | loss: 0.1795741
	speed: 0.0138s/iter; left time: 88.9377s
	iters: 500, epoch: 5 | loss: 0.2026498
	speed: 0.0147s/iter; left time: 93.5068s
	iters: 600, epoch: 5 | loss: 0.1379092
	speed: 0.0131s/iter; left time: 81.9005s
	iters: 700, epoch: 5 | loss: 0.1823856
	speed: 0.0134s/iter; left time: 82.6540s
	iters: 800, epoch: 5 | loss: 0.1820199
	speed: 0.0133s/iter; left time: 80.6197s
	iters: 900, epoch: 5 | loss: 0.1672455
	speed: 0.0129s/iter; left time: 77.0676s
	iters: 1000, epoch: 5 | loss: 0.1829905
	speed: 0.0130s/iter; left time: 76.4477s
	iters: 1100, epoch: 5 | loss: 0.1630491
	speed: 0.0133s/iter; left time: 76.4350s
Epoch: 5 cost time: 16.260348796844482
Epoch: 5, Steps: 1144 | Train Loss: 0.1743732 Vali Loss: 0.1593613 Test Loss: 0.1718964
Validation loss decreased (0.159536 --> 0.159361).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1471293
	speed: 0.1149s/iter; left time: 646.1203s
	iters: 200, epoch: 6 | loss: 0.1813847
	speed: 0.0137s/iter; left time: 75.5445s
	iters: 300, epoch: 6 | loss: 0.1553454
	speed: 0.0130s/iter; left time: 70.2956s
	iters: 400, epoch: 6 | loss: 0.1306466
	speed: 0.0132s/iter; left time: 70.2682s
	iters: 500, epoch: 6 | loss: 0.1787038
	speed: 0.0140s/iter; left time: 73.1175s
	iters: 600, epoch: 6 | loss: 0.1853721
	speed: 0.0131s/iter; left time: 67.1919s
	iters: 700, epoch: 6 | loss: 0.1450816
	speed: 0.0135s/iter; left time: 67.7876s
	iters: 800, epoch: 6 | loss: 0.1531654
	speed: 0.0132s/iter; left time: 65.1110s
	iters: 900, epoch: 6 | loss: 0.1389614
	speed: 0.0125s/iter; left time: 60.3053s
	iters: 1000, epoch: 6 | loss: 0.1681075
	speed: 0.0121s/iter; left time: 57.0545s
	iters: 1100, epoch: 6 | loss: 0.1324211
	speed: 0.0136s/iter; left time: 62.6896s
Epoch: 6 cost time: 16.120243072509766
Epoch: 6, Steps: 1144 | Train Loss: 0.1742278 Vali Loss: 0.1592286 Test Loss: 0.1717945
Validation loss decreased (0.159361 --> 0.159229).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1718521
	speed: 0.1021s/iter; left time: 457.1000s
	iters: 200, epoch: 7 | loss: 0.1740193
	speed: 0.0106s/iter; left time: 46.3116s
	iters: 300, epoch: 7 | loss: 0.1689596
	speed: 0.0118s/iter; left time: 50.4184s
	iters: 400, epoch: 7 | loss: 0.1417535
	speed: 0.0104s/iter; left time: 43.3017s
	iters: 500, epoch: 7 | loss: 0.1816382
	speed: 0.0118s/iter; left time: 48.0682s
	iters: 600, epoch: 7 | loss: 0.1505472
	speed: 0.0114s/iter; left time: 45.3075s
	iters: 700, epoch: 7 | loss: 0.1700557
	speed: 0.0113s/iter; left time: 43.8649s
	iters: 800, epoch: 7 | loss: 0.2102557
	speed: 0.0121s/iter; left time: 45.5927s
	iters: 900, epoch: 7 | loss: 0.1863033
	speed: 0.0116s/iter; left time: 42.7267s
	iters: 1000, epoch: 7 | loss: 0.1450697
	speed: 0.0125s/iter; left time: 44.6363s
	iters: 1100, epoch: 7 | loss: 0.2345806
	speed: 0.0126s/iter; left time: 43.7633s
Epoch: 7 cost time: 14.386940002441406
Epoch: 7, Steps: 1144 | Train Loss: 0.1741884 Vali Loss: 0.1592433 Test Loss: 0.1717474
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1504436
	speed: 0.1067s/iter; left time: 355.5769s
	iters: 200, epoch: 8 | loss: 0.1780183
	speed: 0.0130s/iter; left time: 42.1044s
	iters: 300, epoch: 8 | loss: 0.1909868
	speed: 0.0129s/iter; left time: 40.4517s
	iters: 400, epoch: 8 | loss: 0.1792581
	speed: 0.0126s/iter; left time: 38.2803s
	iters: 500, epoch: 8 | loss: 0.1516630
	speed: 0.0128s/iter; left time: 37.6379s
	iters: 600, epoch: 8 | loss: 0.1458167
	speed: 0.0130s/iter; left time: 36.9291s
	iters: 700, epoch: 8 | loss: 0.1845276
	speed: 0.0132s/iter; left time: 36.1035s
	iters: 800, epoch: 8 | loss: 0.1746568
	speed: 0.0128s/iter; left time: 33.7555s
	iters: 900, epoch: 8 | loss: 0.1594612
	speed: 0.0132s/iter; left time: 33.4117s
	iters: 1000, epoch: 8 | loss: 0.1423981
	speed: 0.0132s/iter; left time: 32.1162s
	iters: 1100, epoch: 8 | loss: 0.1723233
	speed: 0.0133s/iter; left time: 30.9395s
Epoch: 8 cost time: 15.780405282974243
Epoch: 8, Steps: 1144 | Train Loss: 0.1741424 Vali Loss: 0.1591413 Test Loss: 0.1717383
Validation loss decreased (0.159229 --> 0.159141).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1801703
	speed: 0.1062s/iter; left time: 232.4945s
	iters: 200, epoch: 9 | loss: 0.2081113
	speed: 0.0132s/iter; left time: 27.6375s
	iters: 300, epoch: 9 | loss: 0.1916030
	speed: 0.0126s/iter; left time: 25.0859s
	iters: 400, epoch: 9 | loss: 0.2239000
	speed: 0.0130s/iter; left time: 24.6392s
	iters: 500, epoch: 9 | loss: 0.1884877
	speed: 0.0126s/iter; left time: 22.5655s
	iters: 600, epoch: 9 | loss: 0.1418689
	speed: 0.0124s/iter; left time: 20.9373s
	iters: 700, epoch: 9 | loss: 0.1687685
	speed: 0.0126s/iter; left time: 19.9785s
	iters: 800, epoch: 9 | loss: 0.1968903
	speed: 0.0123s/iter; left time: 18.2753s
	iters: 900, epoch: 9 | loss: 0.1524471
	speed: 0.0126s/iter; left time: 17.5685s
	iters: 1000, epoch: 9 | loss: 0.1648552
	speed: 0.0123s/iter; left time: 15.9157s
	iters: 1100, epoch: 9 | loss: 0.1638649
	speed: 0.0123s/iter; left time: 14.5693s
Epoch: 9 cost time: 15.410341024398804
Epoch: 9, Steps: 1144 | Train Loss: 0.1741037 Vali Loss: 0.1591467 Test Loss: 0.1717339
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2040256
	speed: 0.1052s/iter; left time: 109.8930s
	iters: 200, epoch: 10 | loss: 0.1964754
	speed: 0.0123s/iter; left time: 11.6018s
	iters: 300, epoch: 10 | loss: 0.1877290
	speed: 0.0128s/iter; left time: 10.8481s
	iters: 400, epoch: 10 | loss: 0.1505777
	speed: 0.0123s/iter; left time: 9.1570s
	iters: 500, epoch: 10 | loss: 0.1682848
	speed: 0.0124s/iter; left time: 7.9874s
	iters: 600, epoch: 10 | loss: 0.1577072
	speed: 0.0122s/iter; left time: 6.6282s
	iters: 700, epoch: 10 | loss: 0.1834420
	speed: 0.0126s/iter; left time: 5.6289s
	iters: 800, epoch: 10 | loss: 0.1931540
	speed: 0.0122s/iter; left time: 4.2218s
	iters: 900, epoch: 10 | loss: 0.1696836
	speed: 0.0127s/iter; left time: 3.1036s
	iters: 1000, epoch: 10 | loss: 0.2104840
	speed: 0.0116s/iter; left time: 1.6750s
	iters: 1100, epoch: 10 | loss: 0.1763882
	speed: 0.0121s/iter; left time: 0.5441s
Epoch: 10 cost time: 15.082914113998413
Epoch: 10, Steps: 1144 | Train Loss: 0.1741248 Vali Loss: 0.1592294 Test Loss: 0.1717317
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_72_24_NLinear_custom_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.17136074602603912, mae:0.2495715320110321
