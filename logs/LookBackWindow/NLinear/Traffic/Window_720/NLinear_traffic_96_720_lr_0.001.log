Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_96_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_96_720_NLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5678673
	speed: 0.0480s/iter; left time: 338.6210s
	iters: 200, epoch: 1 | loss: 0.4861529
	speed: 0.0384s/iter; left time: 267.0967s
	iters: 300, epoch: 1 | loss: 0.4574270
	speed: 0.0390s/iter; left time: 267.5243s
	iters: 400, epoch: 1 | loss: 0.4338563
	speed: 0.0395s/iter; left time: 267.1450s
	iters: 500, epoch: 1 | loss: 0.4059476
	speed: 0.0387s/iter; left time: 257.9768s
	iters: 600, epoch: 1 | loss: 0.4364220
	speed: 0.0393s/iter; left time: 257.7068s
	iters: 700, epoch: 1 | loss: 0.4103974
	speed: 0.0388s/iter; left time: 250.4913s
Epoch: 1 cost time: 28.851341724395752
Epoch: 1, Steps: 716 | Train Loss: 0.5074813 Vali Loss: 0.5642080 Test Loss: 0.6758461
Validation loss decreased (inf --> 0.564208).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4089739
	speed: 0.3806s/iter; left time: 2415.1491s
	iters: 200, epoch: 2 | loss: 0.3836914
	speed: 0.0384s/iter; left time: 240.1080s
	iters: 300, epoch: 2 | loss: 0.3962982
	speed: 0.0389s/iter; left time: 239.1703s
	iters: 400, epoch: 2 | loss: 0.4292831
	speed: 0.0388s/iter; left time: 234.3887s
	iters: 500, epoch: 2 | loss: 0.3943054
	speed: 0.0387s/iter; left time: 230.0375s
	iters: 600, epoch: 2 | loss: 0.4132384
	speed: 0.0395s/iter; left time: 231.1442s
	iters: 700, epoch: 2 | loss: 0.4005824
	speed: 0.0385s/iter; left time: 221.1740s
Epoch: 2 cost time: 28.585059881210327
Epoch: 2, Steps: 716 | Train Loss: 0.4101790 Vali Loss: 0.5497304 Test Loss: 0.6558103
Validation loss decreased (0.564208 --> 0.549730).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3992127
	speed: 0.3767s/iter; left time: 2120.5219s
	iters: 200, epoch: 3 | loss: 0.3880101
	speed: 0.0387s/iter; left time: 213.7529s
	iters: 300, epoch: 3 | loss: 0.3908818
	speed: 0.0390s/iter; left time: 211.6355s
	iters: 400, epoch: 3 | loss: 0.4170214
	speed: 0.0391s/iter; left time: 208.5018s
	iters: 500, epoch: 3 | loss: 0.3987764
	speed: 0.0389s/iter; left time: 203.1857s
	iters: 600, epoch: 3 | loss: 0.4058781
	speed: 0.0391s/iter; left time: 200.5369s
	iters: 700, epoch: 3 | loss: 0.3841626
	speed: 0.0391s/iter; left time: 196.7184s
Epoch: 3 cost time: 28.717455625534058
Epoch: 3, Steps: 716 | Train Loss: 0.4038697 Vali Loss: 0.5472374 Test Loss: 0.6514335
Validation loss decreased (0.549730 --> 0.547237).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4049233
	speed: 0.3791s/iter; left time: 1862.5808s
	iters: 200, epoch: 4 | loss: 0.3889581
	speed: 0.0386s/iter; left time: 185.6900s
	iters: 300, epoch: 4 | loss: 0.4068809
	speed: 0.0391s/iter; left time: 184.0995s
	iters: 400, epoch: 4 | loss: 0.4214503
	speed: 0.0382s/iter; left time: 176.0577s
	iters: 500, epoch: 4 | loss: 0.4198281
	speed: 0.0386s/iter; left time: 174.0615s
	iters: 600, epoch: 4 | loss: 0.3847106
	speed: 0.0385s/iter; left time: 170.0784s
	iters: 700, epoch: 4 | loss: 0.4076680
	speed: 0.0391s/iter; left time: 168.6926s
Epoch: 4 cost time: 28.599456787109375
Epoch: 4, Steps: 716 | Train Loss: 0.4020746 Vali Loss: 0.5454662 Test Loss: 0.6506756
Validation loss decreased (0.547237 --> 0.545466).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4607701
	speed: 0.3849s/iter; left time: 1615.4433s
	iters: 200, epoch: 5 | loss: 0.4035054
	speed: 0.0394s/iter; left time: 161.4127s
	iters: 300, epoch: 5 | loss: 0.3873350
	speed: 0.0383s/iter; left time: 153.1981s
	iters: 400, epoch: 5 | loss: 0.3902899
	speed: 0.0390s/iter; left time: 151.8031s
	iters: 500, epoch: 5 | loss: 0.3867212
	speed: 0.0384s/iter; left time: 145.9942s
	iters: 600, epoch: 5 | loss: 0.4129159
	speed: 0.0388s/iter; left time: 143.5026s
	iters: 700, epoch: 5 | loss: 0.3998853
	speed: 0.0388s/iter; left time: 139.6340s
Epoch: 5 cost time: 28.844658851623535
Epoch: 5, Steps: 716 | Train Loss: 0.4011709 Vali Loss: 0.5449995 Test Loss: 0.6483088
Validation loss decreased (0.545466 --> 0.544999).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4330766
	speed: 0.3891s/iter; left time: 1354.5179s
	iters: 200, epoch: 6 | loss: 0.3859100
	speed: 0.0384s/iter; left time: 129.8108s
	iters: 300, epoch: 6 | loss: 0.3941319
	speed: 0.0389s/iter; left time: 127.5182s
	iters: 400, epoch: 6 | loss: 0.3776064
	speed: 0.0381s/iter; left time: 121.2248s
	iters: 500, epoch: 6 | loss: 0.3643180
	speed: 0.0386s/iter; left time: 118.9128s
	iters: 600, epoch: 6 | loss: 0.4148080
	speed: 0.0385s/iter; left time: 114.7274s
	iters: 700, epoch: 6 | loss: 0.4056901
	speed: 0.0384s/iter; left time: 110.7087s
Epoch: 6 cost time: 28.705999612808228
Epoch: 6, Steps: 716 | Train Loss: 0.4007509 Vali Loss: 0.5439480 Test Loss: 0.6482922
Validation loss decreased (0.544999 --> 0.543948).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4076525
	speed: 0.3829s/iter; left time: 1058.6131s
	iters: 200, epoch: 7 | loss: 0.4123923
	speed: 0.0384s/iter; left time: 102.4292s
	iters: 300, epoch: 7 | loss: 0.3900806
	speed: 0.0374s/iter; left time: 95.8388s
	iters: 400, epoch: 7 | loss: 0.3895019
	speed: 0.0389s/iter; left time: 95.8523s
	iters: 500, epoch: 7 | loss: 0.4186909
	speed: 0.0384s/iter; left time: 90.7435s
	iters: 600, epoch: 7 | loss: 0.4215686
	speed: 0.0387s/iter; left time: 87.7376s
	iters: 700, epoch: 7 | loss: 0.3890005
	speed: 0.0400s/iter; left time: 86.6468s
Epoch: 7 cost time: 28.57879114151001
Epoch: 7, Steps: 716 | Train Loss: 0.4004918 Vali Loss: 0.5436197 Test Loss: 0.6481286
Validation loss decreased (0.543948 --> 0.543620).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3685023
	speed: 0.3863s/iter; left time: 791.5221s
	iters: 200, epoch: 8 | loss: 0.3882454
	speed: 0.0384s/iter; left time: 74.8148s
	iters: 300, epoch: 8 | loss: 0.4280958
	speed: 0.0384s/iter; left time: 71.0587s
	iters: 400, epoch: 8 | loss: 0.3757443
	speed: 0.0376s/iter; left time: 65.8465s
	iters: 500, epoch: 8 | loss: 0.3838701
	speed: 0.0376s/iter; left time: 62.0128s
	iters: 600, epoch: 8 | loss: 0.4211850
	speed: 0.0384s/iter; left time: 59.4417s
	iters: 700, epoch: 8 | loss: 0.4470833
	speed: 0.0383s/iter; left time: 55.5146s
Epoch: 8 cost time: 28.213619709014893
Epoch: 8, Steps: 716 | Train Loss: 0.4004254 Vali Loss: 0.5442156 Test Loss: 0.6479043
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3921349
	speed: 0.3810s/iter; left time: 507.8136s
	iters: 200, epoch: 9 | loss: 0.4083531
	speed: 0.0380s/iter; left time: 46.8068s
	iters: 300, epoch: 9 | loss: 0.3948138
	speed: 0.0395s/iter; left time: 44.7408s
	iters: 400, epoch: 9 | loss: 0.4078237
	speed: 0.0390s/iter; left time: 40.2973s
	iters: 500, epoch: 9 | loss: 0.3956614
	speed: 0.0381s/iter; left time: 35.5058s
	iters: 600, epoch: 9 | loss: 0.3885761
	speed: 0.0388s/iter; left time: 32.3335s
	iters: 700, epoch: 9 | loss: 0.3769631
	speed: 0.0378s/iter; left time: 27.6723s
Epoch: 9 cost time: 28.35363268852234
Epoch: 9, Steps: 716 | Train Loss: 0.4003465 Vali Loss: 0.5441792 Test Loss: 0.6479396
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4158807
	speed: 0.3973s/iter; left time: 245.1361s
	iters: 200, epoch: 10 | loss: 0.4077976
	speed: 0.0445s/iter; left time: 22.9845s
	iters: 300, epoch: 10 | loss: 0.3722006
	speed: 0.0454s/iter; left time: 18.9338s
	iters: 400, epoch: 10 | loss: 0.3902909
	speed: 0.0425s/iter; left time: 13.4809s
	iters: 500, epoch: 10 | loss: 0.3819565
	speed: 0.0429s/iter; left time: 9.3021s
	iters: 600, epoch: 10 | loss: 0.4241989
	speed: 0.0398s/iter; left time: 4.6521s
	iters: 700, epoch: 10 | loss: 0.3900261
	speed: 0.0414s/iter; left time: 0.7034s
Epoch: 10 cost time: 32.00196385383606
Epoch: 10, Steps: 716 | Train Loss: 0.4003105 Vali Loss: 0.5441306 Test Loss: 0.6479049
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_96_720_NLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.6470776200294495, mae:0.38928189873695374
