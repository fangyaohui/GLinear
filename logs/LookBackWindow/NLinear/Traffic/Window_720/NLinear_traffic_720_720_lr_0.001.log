Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_720_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_720_720_NLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10841
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.3417817
	speed: 0.0801s/iter; left time: 534.3355s
	iters: 200, epoch: 1 | loss: 0.3147915
	speed: 0.0732s/iter; left time: 480.7279s
	iters: 300, epoch: 1 | loss: 0.2930679
	speed: 0.0740s/iter; left time: 478.9948s
	iters: 400, epoch: 1 | loss: 0.2865107
	speed: 0.0747s/iter; left time: 476.0840s
	iters: 500, epoch: 1 | loss: 0.2829817
	speed: 0.0742s/iter; left time: 465.6150s
	iters: 600, epoch: 1 | loss: 0.2968347
	speed: 0.0714s/iter; left time: 440.6851s
Epoch: 1 cost time: 50.51101899147034
Epoch: 1, Steps: 677 | Train Loss: 0.3351273 Vali Loss: 0.4170210 Test Loss: 0.4893234
Validation loss decreased (inf --> 0.417021).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3015828
	speed: 0.5725s/iter; left time: 3431.4607s
	iters: 200, epoch: 2 | loss: 0.3038025
	speed: 0.0708s/iter; left time: 417.0935s
	iters: 300, epoch: 2 | loss: 0.2880584
	speed: 0.0719s/iter; left time: 416.4388s
	iters: 400, epoch: 2 | loss: 0.2836130
	speed: 0.0713s/iter; left time: 405.9166s
	iters: 500, epoch: 2 | loss: 0.2813654
	speed: 0.0705s/iter; left time: 394.2509s
	iters: 600, epoch: 2 | loss: 0.2675196
	speed: 0.0709s/iter; left time: 389.5334s
Epoch: 2 cost time: 49.32372999191284
Epoch: 2, Steps: 677 | Train Loss: 0.2892317 Vali Loss: 0.4068997 Test Loss: 0.4778520
Validation loss decreased (0.417021 --> 0.406900).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2702479
	speed: 0.5651s/iter; left time: 3004.7250s
	iters: 200, epoch: 3 | loss: 0.2623793
	speed: 0.0725s/iter; left time: 378.2390s
	iters: 300, epoch: 3 | loss: 0.2762174
	speed: 0.0707s/iter; left time: 361.6590s
	iters: 400, epoch: 3 | loss: 0.2835401
	speed: 0.0715s/iter; left time: 358.6068s
	iters: 500, epoch: 3 | loss: 0.2949387
	speed: 0.0687s/iter; left time: 338.0290s
	iters: 600, epoch: 3 | loss: 0.2672656
	speed: 0.0701s/iter; left time: 337.9054s
Epoch: 3 cost time: 48.785988330841064
Epoch: 3, Steps: 677 | Train Loss: 0.2785701 Vali Loss: 0.3943132 Test Loss: 0.4595390
Validation loss decreased (0.406900 --> 0.394313).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2910945
	speed: 0.5600s/iter; left time: 2598.3627s
	iters: 200, epoch: 4 | loss: 0.2666835
	speed: 0.0701s/iter; left time: 318.1554s
	iters: 300, epoch: 4 | loss: 0.2709464
	speed: 0.0707s/iter; left time: 314.0827s
	iters: 400, epoch: 4 | loss: 0.2742220
	speed: 0.0717s/iter; left time: 310.9972s
	iters: 500, epoch: 4 | loss: 0.3008209
	speed: 0.0713s/iter; left time: 302.1522s
	iters: 600, epoch: 4 | loss: 0.2743758
	speed: 0.0702s/iter; left time: 290.8054s
Epoch: 4 cost time: 48.725934982299805
Epoch: 4, Steps: 677 | Train Loss: 0.2746051 Vali Loss: 0.3901958 Test Loss: 0.4559910
Validation loss decreased (0.394313 --> 0.390196).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3029415
	speed: 0.5563s/iter; left time: 2204.8108s
	iters: 200, epoch: 5 | loss: 0.2834136
	speed: 0.0704s/iter; left time: 271.9690s
	iters: 300, epoch: 5 | loss: 0.2672364
	speed: 0.0702s/iter; left time: 264.0945s
	iters: 400, epoch: 5 | loss: 0.2625631
	speed: 0.0700s/iter; left time: 256.2884s
	iters: 500, epoch: 5 | loss: 0.2670372
	speed: 0.0724s/iter; left time: 258.0438s
	iters: 600, epoch: 5 | loss: 0.2884247
	speed: 0.0694s/iter; left time: 240.3902s
Epoch: 5 cost time: 48.66363978385925
Epoch: 5, Steps: 677 | Train Loss: 0.2727060 Vali Loss: 0.3883257 Test Loss: 0.4539362
Validation loss decreased (0.390196 --> 0.388326).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2615163
	speed: 0.5626s/iter; left time: 1848.6256s
	iters: 200, epoch: 6 | loss: 0.2742880
	speed: 0.0691s/iter; left time: 220.0458s
	iters: 300, epoch: 6 | loss: 0.2737671
	speed: 0.0688s/iter; left time: 212.4099s
	iters: 400, epoch: 6 | loss: 0.2566899
	speed: 0.0699s/iter; left time: 208.8562s
	iters: 500, epoch: 6 | loss: 0.2502059
	speed: 0.0696s/iter; left time: 200.9652s
	iters: 600, epoch: 6 | loss: 0.2887125
	speed: 0.0719s/iter; left time: 200.3950s
Epoch: 6 cost time: 48.03327488899231
Epoch: 6, Steps: 677 | Train Loss: 0.2716316 Vali Loss: 0.3871207 Test Loss: 0.4524684
Validation loss decreased (0.388326 --> 0.387121).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2770109
	speed: 0.5672s/iter; left time: 1479.8870s
	iters: 200, epoch: 7 | loss: 0.2494666
	speed: 0.0726s/iter; left time: 182.1750s
	iters: 300, epoch: 7 | loss: 0.2661914
	speed: 0.0718s/iter; left time: 173.0116s
	iters: 400, epoch: 7 | loss: 0.2736582
	speed: 0.0690s/iter; left time: 159.3081s
	iters: 500, epoch: 7 | loss: 0.2848140
	speed: 0.0720s/iter; left time: 158.9698s
	iters: 600, epoch: 7 | loss: 0.2671747
	speed: 0.0724s/iter; left time: 152.6764s
Epoch: 7 cost time: 49.70771360397339
Epoch: 7, Steps: 677 | Train Loss: 0.2710737 Vali Loss: 0.3862395 Test Loss: 0.4509954
Validation loss decreased (0.387121 --> 0.386240).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2507470
	speed: 0.5679s/iter; left time: 1097.2411s
	iters: 200, epoch: 8 | loss: 0.2811597
	speed: 0.0692s/iter; left time: 126.7736s
	iters: 300, epoch: 8 | loss: 0.2798054
	speed: 0.0699s/iter; left time: 121.1510s
	iters: 400, epoch: 8 | loss: 0.2868314
	speed: 0.0723s/iter; left time: 117.9965s
	iters: 500, epoch: 8 | loss: 0.2484313
	speed: 0.0740s/iter; left time: 113.3920s
	iters: 600, epoch: 8 | loss: 0.2693897
	speed: 0.0700s/iter; left time: 100.2198s
Epoch: 8 cost time: 48.92704939842224
Epoch: 8, Steps: 677 | Train Loss: 0.2707478 Vali Loss: 0.3862317 Test Loss: 0.4516440
Validation loss decreased (0.386240 --> 0.386232).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2743619
	speed: 0.5587s/iter; left time: 701.1928s
	iters: 200, epoch: 9 | loss: 0.2922447
	speed: 0.0725s/iter; left time: 83.6981s
	iters: 300, epoch: 9 | loss: 0.2648731
	speed: 0.0704s/iter; left time: 74.2696s
	iters: 400, epoch: 9 | loss: 0.2752337
	speed: 0.0716s/iter; left time: 68.3845s
	iters: 500, epoch: 9 | loss: 0.2807550
	speed: 0.0729s/iter; left time: 62.3457s
	iters: 600, epoch: 9 | loss: 0.2654250
	speed: 0.0692s/iter; left time: 52.2808s
Epoch: 9 cost time: 49.227397441864014
Epoch: 9, Steps: 677 | Train Loss: 0.2705755 Vali Loss: 0.3862365 Test Loss: 0.4509899
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2612958
	speed: 0.5553s/iter; left time: 320.9475s
	iters: 200, epoch: 10 | loss: 0.2793952
	speed: 0.0689s/iter; left time: 32.9394s
	iters: 300, epoch: 10 | loss: 0.2557016
	speed: 0.0692s/iter; left time: 26.1544s
	iters: 400, epoch: 10 | loss: 0.2813273
	speed: 0.0703s/iter; left time: 19.5417s
	iters: 500, epoch: 10 | loss: 0.2543432
	speed: 0.0704s/iter; left time: 12.5351s
	iters: 600, epoch: 10 | loss: 0.2922978
	speed: 0.0692s/iter; left time: 5.3961s
Epoch: 10 cost time: 48.17976093292236
Epoch: 10, Steps: 677 | Train Loss: 0.2704628 Vali Loss: 0.3864106 Test Loss: 0.4507500
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_720_720_NLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.45147716999053955, mae:0.3044792413711548
