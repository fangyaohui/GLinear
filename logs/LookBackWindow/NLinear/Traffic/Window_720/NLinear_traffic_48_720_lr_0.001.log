Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_48_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=48, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_48_720_NLinear_custom_ftM_sl48_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11513
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6942912
	speed: 0.0460s/iter; left time: 326.0299s
	iters: 200, epoch: 1 | loss: 0.5544857
	speed: 0.0384s/iter; left time: 268.3968s
	iters: 300, epoch: 1 | loss: 0.5659357
	speed: 0.0380s/iter; left time: 262.1546s
	iters: 400, epoch: 1 | loss: 0.5599376
	speed: 0.0383s/iter; left time: 260.1926s
	iters: 500, epoch: 1 | loss: 0.6020180
	speed: 0.0392s/iter; left time: 262.4738s
	iters: 600, epoch: 1 | loss: 0.5136667
	speed: 0.0388s/iter; left time: 255.5824s
	iters: 700, epoch: 1 | loss: 0.5446404
	speed: 0.0392s/iter; left time: 254.3201s
Epoch: 1 cost time: 28.551052808761597
Epoch: 1, Steps: 719 | Train Loss: 0.6383200 Vali Loss: 0.7013445 Test Loss: 0.8581386
Validation loss decreased (inf --> 0.701344).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4856591
	speed: 0.3468s/iter; left time: 2209.5711s
	iters: 200, epoch: 2 | loss: 0.5315855
	speed: 0.0392s/iter; left time: 245.9291s
	iters: 300, epoch: 2 | loss: 0.5651922
	speed: 0.0393s/iter; left time: 242.8361s
	iters: 400, epoch: 2 | loss: 0.4961661
	speed: 0.0396s/iter; left time: 240.7257s
	iters: 500, epoch: 2 | loss: 0.5156511
	speed: 0.0394s/iter; left time: 235.1640s
	iters: 600, epoch: 2 | loss: 0.4970871
	speed: 0.0401s/iter; left time: 235.3237s
	iters: 700, epoch: 2 | loss: 0.4887387
	speed: 0.0401s/iter; left time: 231.6487s
Epoch: 2 cost time: 29.46523404121399
Epoch: 2, Steps: 719 | Train Loss: 0.5243289 Vali Loss: 0.6878157 Test Loss: 0.8408844
Validation loss decreased (0.701344 --> 0.687816).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5445445
	speed: 0.3538s/iter; left time: 2000.2537s
	iters: 200, epoch: 3 | loss: 0.5071167
	speed: 0.0409s/iter; left time: 227.0904s
	iters: 300, epoch: 3 | loss: 0.5435131
	speed: 0.0414s/iter; left time: 225.8692s
	iters: 400, epoch: 3 | loss: 0.5799885
	speed: 0.0458s/iter; left time: 245.3584s
	iters: 500, epoch: 3 | loss: 0.5553906
	speed: 0.0397s/iter; left time: 208.3786s
	iters: 600, epoch: 3 | loss: 0.5479290
	speed: 0.0393s/iter; left time: 202.7559s
	iters: 700, epoch: 3 | loss: 0.5198356
	speed: 0.0407s/iter; left time: 205.6393s
Epoch: 3 cost time: 30.45475149154663
Epoch: 3, Steps: 719 | Train Loss: 0.5181303 Vali Loss: 0.6843518 Test Loss: 0.8355008
Validation loss decreased (0.687816 --> 0.684352).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4896066
	speed: 0.3615s/iter; left time: 1783.6264s
	iters: 200, epoch: 4 | loss: 0.5518260
	speed: 0.0398s/iter; left time: 192.3619s
	iters: 300, epoch: 4 | loss: 0.5629691
	speed: 0.0407s/iter; left time: 192.7535s
	iters: 400, epoch: 4 | loss: 0.5605468
	speed: 0.0389s/iter; left time: 180.1829s
	iters: 500, epoch: 4 | loss: 0.5601828
	speed: 0.0404s/iter; left time: 183.2268s
	iters: 600, epoch: 4 | loss: 0.4755391
	speed: 0.0417s/iter; left time: 185.0435s
	iters: 700, epoch: 4 | loss: 0.4748015
	speed: 0.0395s/iter; left time: 171.2405s
Epoch: 4 cost time: 29.786392211914062
Epoch: 4, Steps: 719 | Train Loss: 0.5165147 Vali Loss: 0.6835823 Test Loss: 0.8328944
Validation loss decreased (0.684352 --> 0.683582).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5111523
	speed: 0.3688s/iter; left time: 1554.3118s
	iters: 200, epoch: 5 | loss: 0.4765606
	speed: 0.0410s/iter; left time: 168.7858s
	iters: 300, epoch: 5 | loss: 0.5607690
	speed: 0.0423s/iter; left time: 169.7007s
	iters: 400, epoch: 5 | loss: 0.5798880
	speed: 0.0456s/iter; left time: 178.5807s
	iters: 500, epoch: 5 | loss: 0.5354487
	speed: 0.0418s/iter; left time: 159.3645s
	iters: 600, epoch: 5 | loss: 0.5706977
	speed: 0.0419s/iter; left time: 155.8259s
	iters: 700, epoch: 5 | loss: 0.5302144
	speed: 0.0404s/iter; left time: 146.0265s
Epoch: 5 cost time: 31.190581798553467
Epoch: 5, Steps: 719 | Train Loss: 0.5156899 Vali Loss: 0.6824664 Test Loss: 0.8323896
Validation loss decreased (0.683582 --> 0.682466).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.5176625
	speed: 0.4007s/iter; left time: 1400.8483s
	iters: 200, epoch: 6 | loss: 0.4582070
	speed: 0.0399s/iter; left time: 135.4980s
	iters: 300, epoch: 6 | loss: 0.4818624
	speed: 0.0422s/iter; left time: 139.2026s
	iters: 400, epoch: 6 | loss: 0.5412420
	speed: 0.0449s/iter; left time: 143.6019s
	iters: 500, epoch: 6 | loss: 0.5461461
	speed: 0.0435s/iter; left time: 134.5844s
	iters: 600, epoch: 6 | loss: 0.5260031
	speed: 0.0429s/iter; left time: 128.6734s
	iters: 700, epoch: 6 | loss: 0.5406430
	speed: 0.0449s/iter; left time: 130.1294s
Epoch: 6 cost time: 32.76604771614075
Epoch: 6, Steps: 719 | Train Loss: 0.5152897 Vali Loss: 0.6820908 Test Loss: 0.8320746
Validation loss decreased (0.682466 --> 0.682091).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.5111642
	speed: 0.3896s/iter; left time: 1081.9749s
	iters: 200, epoch: 7 | loss: 0.5308109
	speed: 0.0455s/iter; left time: 121.9022s
	iters: 300, epoch: 7 | loss: 0.5013492
	speed: 0.0478s/iter; left time: 123.2450s
	iters: 400, epoch: 7 | loss: 0.5478695
	speed: 0.0477s/iter; left time: 118.1726s
	iters: 500, epoch: 7 | loss: 0.5325989
	speed: 0.0470s/iter; left time: 111.6818s
	iters: 600, epoch: 7 | loss: 0.5409208
	speed: 0.0470s/iter; left time: 107.0379s
	iters: 700, epoch: 7 | loss: 0.5595567
	speed: 0.0474s/iter; left time: 103.2907s
Epoch: 7 cost time: 34.673434019088745
Epoch: 7, Steps: 719 | Train Loss: 0.5150847 Vali Loss: 0.6816908 Test Loss: 0.8316300
Validation loss decreased (0.682091 --> 0.681691).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4990627
	speed: 0.3971s/iter; left time: 817.1589s
	iters: 200, epoch: 8 | loss: 0.5105673
	speed: 0.0465s/iter; left time: 90.9542s
	iters: 300, epoch: 8 | loss: 0.5396883
	speed: 0.0462s/iter; left time: 85.7501s
	iters: 400, epoch: 8 | loss: 0.5832006
	speed: 0.0486s/iter; left time: 85.4900s
	iters: 500, epoch: 8 | loss: 0.5108584
	speed: 0.0474s/iter; left time: 78.5138s
	iters: 600, epoch: 8 | loss: 0.5498685
	speed: 0.0484s/iter; left time: 75.3304s
	iters: 700, epoch: 8 | loss: 0.5522991
	speed: 0.0463s/iter; left time: 67.5642s
Epoch: 8 cost time: 34.89261198043823
Epoch: 8, Steps: 719 | Train Loss: 0.5149587 Vali Loss: 0.6811495 Test Loss: 0.8314966
Validation loss decreased (0.681691 --> 0.681149).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.5875863
	speed: 0.4040s/iter; left time: 540.9345s
	iters: 200, epoch: 9 | loss: 0.4846049
	speed: 0.0463s/iter; left time: 57.3323s
	iters: 300, epoch: 9 | loss: 0.5284001
	speed: 0.0459s/iter; left time: 52.2594s
	iters: 400, epoch: 9 | loss: 0.4708052
	speed: 0.0466s/iter; left time: 48.3910s
	iters: 500, epoch: 9 | loss: 0.5657237
	speed: 0.0455s/iter; left time: 42.7651s
	iters: 600, epoch: 9 | loss: 0.5007327
	speed: 0.0486s/iter; left time: 40.7628s
	iters: 700, epoch: 9 | loss: 0.5606962
	speed: 0.0482s/iter; left time: 35.5876s
Epoch: 9 cost time: 34.643654584884644
Epoch: 9, Steps: 719 | Train Loss: 0.5149941 Vali Loss: 0.6812820 Test Loss: 0.8314767
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4955156
	speed: 0.4008s/iter; left time: 248.5197s
	iters: 200, epoch: 10 | loss: 0.5411956
	speed: 0.0469s/iter; left time: 24.4113s
	iters: 300, epoch: 10 | loss: 0.5107031
	speed: 0.0459s/iter; left time: 19.2617s
	iters: 400, epoch: 10 | loss: 0.5078944
	speed: 0.0474s/iter; left time: 15.1590s
	iters: 500, epoch: 10 | loss: 0.4845437
	speed: 0.0456s/iter; left time: 10.0407s
	iters: 600, epoch: 10 | loss: 0.5115871
	speed: 0.0474s/iter; left time: 5.6902s
	iters: 700, epoch: 10 | loss: 0.5583363
	speed: 0.0472s/iter; left time: 0.9448s
Epoch: 10 cost time: 34.527294397354126
Epoch: 10, Steps: 719 | Train Loss: 0.5148988 Vali Loss: 0.6823652 Test Loss: 0.8314392
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_48_720_NLinear_custom_ftM_sl48_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.8312137722969055, mae:0.4652886390686035
