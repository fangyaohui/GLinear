Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_144_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_144_720_NLinear_custom_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11417
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4948350
	speed: 0.0434s/iter; left time: 305.3744s
	iters: 200, epoch: 1 | loss: 0.4058388
	speed: 0.0356s/iter; left time: 247.0355s
	iters: 300, epoch: 1 | loss: 0.3892443
	speed: 0.0362s/iter; left time: 246.9749s
	iters: 400, epoch: 1 | loss: 0.3786222
	speed: 0.0364s/iter; left time: 245.0337s
	iters: 500, epoch: 1 | loss: 0.3539781
	speed: 0.0361s/iter; left time: 239.3472s
	iters: 600, epoch: 1 | loss: 0.3450268
	speed: 0.0367s/iter; left time: 239.4705s
	iters: 700, epoch: 1 | loss: 0.3450283
	speed: 0.0359s/iter; left time: 230.8743s
Epoch: 1 cost time: 26.565279006958008
Epoch: 1, Steps: 713 | Train Loss: 0.4236138 Vali Loss: 0.4673373 Test Loss: 0.5506794
Validation loss decreased (inf --> 0.467337).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3376505
	speed: 0.3341s/iter; left time: 2110.6246s
	iters: 200, epoch: 2 | loss: 0.3249041
	speed: 0.0398s/iter; left time: 247.6731s
	iters: 300, epoch: 2 | loss: 0.3469689
	speed: 0.0407s/iter; left time: 249.1675s
	iters: 400, epoch: 2 | loss: 0.2879924
	speed: 0.0405s/iter; left time: 243.8995s
	iters: 500, epoch: 2 | loss: 0.3220068
	speed: 0.0401s/iter; left time: 237.5309s
	iters: 600, epoch: 2 | loss: 0.3383770
	speed: 0.0404s/iter; left time: 235.1486s
	iters: 700, epoch: 2 | loss: 0.3206541
	speed: 0.0404s/iter; left time: 231.1025s
Epoch: 2 cost time: 29.53505825996399
Epoch: 2, Steps: 713 | Train Loss: 0.3349215 Vali Loss: 0.4583085 Test Loss: 0.5386297
Validation loss decreased (0.467337 --> 0.458309).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3384416
	speed: 0.3308s/iter; left time: 1854.3545s
	iters: 200, epoch: 3 | loss: 0.3560219
	speed: 0.0391s/iter; left time: 215.4886s
	iters: 300, epoch: 3 | loss: 0.3072495
	speed: 0.0398s/iter; left time: 215.3763s
	iters: 400, epoch: 3 | loss: 0.3324402
	speed: 0.0401s/iter; left time: 212.5341s
	iters: 500, epoch: 3 | loss: 0.3083118
	speed: 0.0407s/iter; left time: 212.0192s
	iters: 600, epoch: 3 | loss: 0.3354247
	speed: 0.0399s/iter; left time: 203.7173s
	iters: 700, epoch: 3 | loss: 0.3435803
	speed: 0.0398s/iter; left time: 199.3791s
Epoch: 3 cost time: 29.303627252578735
Epoch: 3, Steps: 713 | Train Loss: 0.3293688 Vali Loss: 0.4542595 Test Loss: 0.5320383
Validation loss decreased (0.458309 --> 0.454259).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3388061
	speed: 0.3328s/iter; left time: 1628.2922s
	iters: 200, epoch: 4 | loss: 0.3369930
	speed: 0.0395s/iter; left time: 189.4493s
	iters: 300, epoch: 4 | loss: 0.3342679
	speed: 0.0402s/iter; left time: 188.7630s
	iters: 400, epoch: 4 | loss: 0.2973678
	speed: 0.0408s/iter; left time: 187.2840s
	iters: 500, epoch: 4 | loss: 0.3188300
	speed: 0.0396s/iter; left time: 177.8262s
	iters: 600, epoch: 4 | loss: 0.3487666
	speed: 0.0401s/iter; left time: 175.9413s
	iters: 700, epoch: 4 | loss: 0.3076778
	speed: 0.0413s/iter; left time: 177.2336s
Epoch: 4 cost time: 29.53364062309265
Epoch: 4, Steps: 713 | Train Loss: 0.3275477 Vali Loss: 0.4525730 Test Loss: 0.5296177
Validation loss decreased (0.454259 --> 0.452573).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3226364
	speed: 0.3444s/iter; left time: 1439.1781s
	iters: 200, epoch: 5 | loss: 0.3429787
	speed: 0.0414s/iter; left time: 168.6761s
	iters: 300, epoch: 5 | loss: 0.3182018
	speed: 0.0427s/iter; left time: 169.8542s
	iters: 400, epoch: 5 | loss: 0.3261835
	speed: 0.0423s/iter; left time: 164.1420s
	iters: 500, epoch: 5 | loss: 0.3335934
	speed: 0.0452s/iter; left time: 170.7370s
	iters: 600, epoch: 5 | loss: 0.3122620
	speed: 0.0419s/iter; left time: 154.1253s
	iters: 700, epoch: 5 | loss: 0.3277937
	speed: 0.0419s/iter; left time: 149.9982s
Epoch: 5 cost time: 31.598334550857544
Epoch: 5, Steps: 713 | Train Loss: 0.3266625 Vali Loss: 0.4514900 Test Loss: 0.5286897
Validation loss decreased (0.452573 --> 0.451490).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3344507
	speed: 0.3562s/iter; left time: 1234.6948s
	iters: 200, epoch: 6 | loss: 0.3155852
	speed: 0.0407s/iter; left time: 136.9184s
	iters: 300, epoch: 6 | loss: 0.3152134
	speed: 0.0416s/iter; left time: 135.8084s
	iters: 400, epoch: 6 | loss: 0.3575205
	speed: 0.0397s/iter; left time: 125.5947s
	iters: 500, epoch: 6 | loss: 0.3327828
	speed: 0.0412s/iter; left time: 126.3193s
	iters: 600, epoch: 6 | loss: 0.3474572
	speed: 0.0411s/iter; left time: 121.8958s
	iters: 700, epoch: 6 | loss: 0.3256592
	speed: 0.0404s/iter; left time: 115.8372s
Epoch: 6 cost time: 30.10620880126953
Epoch: 6, Steps: 713 | Train Loss: 0.3262332 Vali Loss: 0.4509521 Test Loss: 0.5281469
Validation loss decreased (0.451490 --> 0.450952).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3004293
	speed: 0.3457s/iter; left time: 951.7245s
	iters: 200, epoch: 7 | loss: 0.3403829
	speed: 0.0421s/iter; left time: 111.8069s
	iters: 300, epoch: 7 | loss: 0.3144322
	speed: 0.0429s/iter; left time: 109.6036s
	iters: 400, epoch: 7 | loss: 0.3307797
	speed: 0.0423s/iter; left time: 103.7115s
	iters: 500, epoch: 7 | loss: 0.3167673
	speed: 0.0421s/iter; left time: 98.9984s
	iters: 600, epoch: 7 | loss: 0.3398941
	speed: 0.0433s/iter; left time: 97.6191s
	iters: 700, epoch: 7 | loss: 0.3103830
	speed: 0.0427s/iter; left time: 92.0367s
Epoch: 7 cost time: 31.336405277252197
Epoch: 7, Steps: 713 | Train Loss: 0.3260184 Vali Loss: 0.4510099 Test Loss: 0.5279773
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3196068
	speed: 0.3456s/iter; left time: 705.1213s
	iters: 200, epoch: 8 | loss: 0.3407252
	speed: 0.0391s/iter; left time: 75.9119s
	iters: 300, epoch: 8 | loss: 0.3193945
	speed: 0.0396s/iter; left time: 72.9382s
	iters: 400, epoch: 8 | loss: 0.3101651
	speed: 0.0416s/iter; left time: 72.3035s
	iters: 500, epoch: 8 | loss: 0.3186327
	speed: 0.0410s/iter; left time: 67.2377s
	iters: 600, epoch: 8 | loss: 0.3238873
	speed: 0.0407s/iter; left time: 62.6148s
	iters: 700, epoch: 8 | loss: 0.3473535
	speed: 0.0400s/iter; left time: 57.5645s
Epoch: 8 cost time: 29.558849811553955
Epoch: 8, Steps: 713 | Train Loss: 0.3258861 Vali Loss: 0.4508722 Test Loss: 0.5278023
Validation loss decreased (0.450952 --> 0.450872).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3119984
	speed: 0.3406s/iter; left time: 451.9972s
	iters: 200, epoch: 9 | loss: 0.3222530
	speed: 0.0398s/iter; left time: 48.8294s
	iters: 300, epoch: 9 | loss: 0.3201212
	speed: 0.0397s/iter; left time: 44.6948s
	iters: 400, epoch: 9 | loss: 0.3007604
	speed: 0.0392s/iter; left time: 40.2092s
	iters: 500, epoch: 9 | loss: 0.3321204
	speed: 0.0404s/iter; left time: 37.4879s
	iters: 600, epoch: 9 | loss: 0.3244621
	speed: 0.0402s/iter; left time: 33.2466s
	iters: 700, epoch: 9 | loss: 0.3114542
	speed: 0.0408s/iter; left time: 29.6327s
Epoch: 9 cost time: 29.381884574890137
Epoch: 9, Steps: 713 | Train Loss: 0.3258266 Vali Loss: 0.4509870 Test Loss: 0.5278217
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3250230
	speed: 0.3405s/iter; left time: 209.0948s
	iters: 200, epoch: 10 | loss: 0.3447368
	speed: 0.0395s/iter; left time: 20.2847s
	iters: 300, epoch: 10 | loss: 0.3337378
	speed: 0.0398s/iter; left time: 16.4714s
	iters: 400, epoch: 10 | loss: 0.3006393
	speed: 0.0401s/iter; left time: 12.5761s
	iters: 500, epoch: 10 | loss: 0.3360308
	speed: 0.0393s/iter; left time: 8.4057s
	iters: 600, epoch: 10 | loss: 0.3113125
	speed: 0.0401s/iter; left time: 4.5725s
	iters: 700, epoch: 10 | loss: 0.3203235
	speed: 0.0402s/iter; left time: 0.5623s
Epoch: 10 cost time: 29.23642325401306
Epoch: 10, Steps: 713 | Train Loss: 0.3257972 Vali Loss: 0.4510449 Test Loss: 0.5278618
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_144_720_NLinear_custom_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.5276936292648315, mae:0.3393692970275879
