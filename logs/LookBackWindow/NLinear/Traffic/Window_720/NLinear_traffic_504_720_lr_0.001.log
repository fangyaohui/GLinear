Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_504_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_504_720_NLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11057
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.3762801
	speed: 0.0680s/iter; left time: 463.3714s
	iters: 200, epoch: 1 | loss: 0.3357317
	speed: 0.0621s/iter; left time: 416.4242s
	iters: 300, epoch: 1 | loss: 0.3161851
	speed: 0.0606s/iter; left time: 400.3751s
	iters: 400, epoch: 1 | loss: 0.3003934
	speed: 0.0606s/iter; left time: 394.3545s
	iters: 500, epoch: 1 | loss: 0.3022462
	speed: 0.0612s/iter; left time: 392.2030s
	iters: 600, epoch: 1 | loss: 0.3278090
	speed: 0.0609s/iter; left time: 384.5853s
Epoch: 1 cost time: 42.907188177108765
Epoch: 1, Steps: 691 | Train Loss: 0.3429965 Vali Loss: 0.4154366 Test Loss: 0.4872422
Validation loss decreased (inf --> 0.415437).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2526635
	speed: 0.5164s/iter; left time: 3160.1585s
	iters: 200, epoch: 2 | loss: 0.3061564
	speed: 0.0591s/iter; left time: 355.8000s
	iters: 300, epoch: 2 | loss: 0.2907559
	speed: 0.0594s/iter; left time: 351.8708s
	iters: 400, epoch: 2 | loss: 0.2844983
	speed: 0.0565s/iter; left time: 328.7417s
	iters: 500, epoch: 2 | loss: 0.2917569
	speed: 0.0592s/iter; left time: 338.7135s
	iters: 600, epoch: 2 | loss: 0.2848361
	speed: 0.0585s/iter; left time: 328.4942s
Epoch: 2 cost time: 41.34633016586304
Epoch: 2, Steps: 691 | Train Loss: 0.2897113 Vali Loss: 0.4054282 Test Loss: 0.4722576
Validation loss decreased (0.415437 --> 0.405428).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3016719
	speed: 0.5203s/iter; left time: 2824.8772s
	iters: 200, epoch: 3 | loss: 0.2599764
	speed: 0.0608s/iter; left time: 324.2459s
	iters: 300, epoch: 3 | loss: 0.2667933
	speed: 0.0585s/iter; left time: 305.9559s
	iters: 400, epoch: 3 | loss: 0.2871080
	speed: 0.0602s/iter; left time: 308.9681s
	iters: 500, epoch: 3 | loss: 0.2847075
	speed: 0.0602s/iter; left time: 302.9266s
	iters: 600, epoch: 3 | loss: 0.3044699
	speed: 0.0609s/iter; left time: 300.1274s
Epoch: 3 cost time: 42.3797550201416
Epoch: 3, Steps: 691 | Train Loss: 0.2816449 Vali Loss: 0.3976008 Test Loss: 0.4629148
Validation loss decreased (0.405428 --> 0.397601).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2686079
	speed: 0.5170s/iter; left time: 2449.3961s
	iters: 200, epoch: 4 | loss: 0.2815679
	speed: 0.0576s/iter; left time: 267.1848s
	iters: 300, epoch: 4 | loss: 0.2861774
	speed: 0.0572s/iter; left time: 259.5950s
	iters: 400, epoch: 4 | loss: 0.2795795
	speed: 0.0580s/iter; left time: 257.5932s
	iters: 500, epoch: 4 | loss: 0.2957617
	speed: 0.0586s/iter; left time: 254.1795s
	iters: 600, epoch: 4 | loss: 0.2990212
	speed: 0.0578s/iter; left time: 244.9823s
Epoch: 4 cost time: 41.12996578216553
Epoch: 4, Steps: 691 | Train Loss: 0.2784212 Vali Loss: 0.3942705 Test Loss: 0.4589083
Validation loss decreased (0.397601 --> 0.394271).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3037642
	speed: 0.5178s/iter; left time: 2095.7190s
	iters: 200, epoch: 5 | loss: 0.2635266
	speed: 0.0574s/iter; left time: 226.5464s
	iters: 300, epoch: 5 | loss: 0.2929661
	speed: 0.0586s/iter; left time: 225.4214s
	iters: 400, epoch: 5 | loss: 0.3108248
	speed: 0.0593s/iter; left time: 222.3688s
	iters: 500, epoch: 5 | loss: 0.2877198
	speed: 0.0584s/iter; left time: 212.9395s
	iters: 600, epoch: 5 | loss: 0.2870146
	speed: 0.0630s/iter; left time: 223.5695s
Epoch: 5 cost time: 41.90017795562744
Epoch: 5, Steps: 691 | Train Loss: 0.2770073 Vali Loss: 0.3933736 Test Loss: 0.4560489
Validation loss decreased (0.394271 --> 0.393374).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2703810
	speed: 0.5170s/iter; left time: 1735.1881s
	iters: 200, epoch: 6 | loss: 0.2707584
	speed: 0.0587s/iter; left time: 191.1035s
	iters: 300, epoch: 6 | loss: 0.2609853
	speed: 0.0574s/iter; left time: 181.2959s
	iters: 400, epoch: 6 | loss: 0.2666667
	speed: 0.0574s/iter; left time: 175.3828s
	iters: 500, epoch: 6 | loss: 0.2533199
	speed: 0.0580s/iter; left time: 171.4772s
	iters: 600, epoch: 6 | loss: 0.2702027
	speed: 0.0578s/iter; left time: 164.9782s
Epoch: 6 cost time: 41.187129497528076
Epoch: 6, Steps: 691 | Train Loss: 0.2761323 Vali Loss: 0.3921306 Test Loss: 0.4558799
Validation loss decreased (0.393374 --> 0.392131).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2869866
	speed: 0.5164s/iter; left time: 1376.2019s
	iters: 200, epoch: 7 | loss: 0.2696704
	speed: 0.0588s/iter; left time: 150.7942s
	iters: 300, epoch: 7 | loss: 0.2778762
	speed: 0.0595s/iter; left time: 146.5451s
	iters: 400, epoch: 7 | loss: 0.2745612
	speed: 0.0597s/iter; left time: 141.1255s
	iters: 500, epoch: 7 | loss: 0.2813824
	speed: 0.0572s/iter; left time: 129.5959s
	iters: 600, epoch: 7 | loss: 0.2702239
	speed: 0.0579s/iter; left time: 125.4111s
Epoch: 7 cost time: 41.43364071846008
Epoch: 7, Steps: 691 | Train Loss: 0.2756891 Vali Loss: 0.3920535 Test Loss: 0.4555480
Validation loss decreased (0.392131 --> 0.392053).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2687561
	speed: 0.5150s/iter; left time: 1016.5924s
	iters: 200, epoch: 8 | loss: 0.2797793
	speed: 0.0577s/iter; left time: 108.1171s
	iters: 300, epoch: 8 | loss: 0.2596449
	speed: 0.0578s/iter; left time: 102.6246s
	iters: 400, epoch: 8 | loss: 0.2522905
	speed: 0.0591s/iter; left time: 99.0081s
	iters: 500, epoch: 8 | loss: 0.3117350
	speed: 0.0584s/iter; left time: 91.9723s
	iters: 600, epoch: 8 | loss: 0.2641306
	speed: 0.0576s/iter; left time: 84.9182s
Epoch: 8 cost time: 41.15361285209656
Epoch: 8, Steps: 691 | Train Loss: 0.2754257 Vali Loss: 0.3911912 Test Loss: 0.4551387
Validation loss decreased (0.392053 --> 0.391191).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2907000
	speed: 0.5130s/iter; left time: 658.1921s
	iters: 200, epoch: 9 | loss: 0.2857347
	speed: 0.0587s/iter; left time: 69.4027s
	iters: 300, epoch: 9 | loss: 0.2628981
	speed: 0.0564s/iter; left time: 61.1056s
	iters: 400, epoch: 9 | loss: 0.2877018
	speed: 0.0572s/iter; left time: 56.2496s
	iters: 500, epoch: 9 | loss: 0.2933704
	speed: 0.0593s/iter; left time: 52.3404s
	iters: 600, epoch: 9 | loss: 0.2639267
	speed: 0.0571s/iter; left time: 44.7275s
Epoch: 9 cost time: 40.82263398170471
Epoch: 9, Steps: 691 | Train Loss: 0.2753039 Vali Loss: 0.3916538 Test Loss: 0.4548270
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2862000
	speed: 0.5139s/iter; left time: 304.2554s
	iters: 200, epoch: 10 | loss: 0.2747438
	speed: 0.0570s/iter; left time: 28.0247s
	iters: 300, epoch: 10 | loss: 0.2743828
	speed: 0.0571s/iter; left time: 22.3684s
	iters: 400, epoch: 10 | loss: 0.2667889
	speed: 0.0604s/iter; left time: 17.6375s
	iters: 500, epoch: 10 | loss: 0.2739070
	speed: 0.0561s/iter; left time: 10.7695s
	iters: 600, epoch: 10 | loss: 0.2680490
	speed: 0.0579s/iter; left time: 5.3262s
Epoch: 10 cost time: 41.05760931968689
Epoch: 10, Steps: 691 | Train Loss: 0.2752130 Vali Loss: 0.3910964 Test Loss: 0.4545899
Validation loss decreased (0.391191 --> 0.391096).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_504_720_NLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4544057250022888, mae:0.3052671253681183
