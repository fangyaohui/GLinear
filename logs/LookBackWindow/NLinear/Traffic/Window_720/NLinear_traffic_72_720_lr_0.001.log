Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_72_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=72, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_72_720_NLinear_custom_ftM_sl72_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11489
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6141391
	speed: 0.0548s/iter; left time: 388.2547s
	iters: 200, epoch: 1 | loss: 0.5218828
	speed: 0.0419s/iter; left time: 292.8413s
	iters: 300, epoch: 1 | loss: 0.5249472
	speed: 0.0437s/iter; left time: 300.7245s
	iters: 400, epoch: 1 | loss: 0.4729839
	speed: 0.0436s/iter; left time: 295.8662s
	iters: 500, epoch: 1 | loss: 0.4719900
	speed: 0.0446s/iter; left time: 297.7262s
	iters: 600, epoch: 1 | loss: 0.4723974
	speed: 0.0430s/iter; left time: 282.8957s
	iters: 700, epoch: 1 | loss: 0.4455445
	speed: 0.0444s/iter; left time: 287.6679s
Epoch: 1 cost time: 32.405107498168945
Epoch: 1, Steps: 718 | Train Loss: 0.5660121 Vali Loss: 0.6267734 Test Loss: 0.7598900
Validation loss decreased (inf --> 0.626773).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4473394
	speed: 0.9494s/iter; left time: 6041.1664s
	iters: 200, epoch: 2 | loss: 0.4799945
	speed: 0.0491s/iter; left time: 307.6506s
	iters: 300, epoch: 2 | loss: 0.4377941
	speed: 0.0478s/iter; left time: 294.3284s
	iters: 400, epoch: 2 | loss: 0.4896145
	speed: 0.0474s/iter; left time: 287.5819s
	iters: 500, epoch: 2 | loss: 0.4648468
	speed: 0.0475s/iter; left time: 283.5388s
	iters: 600, epoch: 2 | loss: 0.4768874
	speed: 0.0473s/iter; left time: 277.5499s
	iters: 700, epoch: 2 | loss: 0.4843258
	speed: 0.0465s/iter; left time: 267.8608s
Epoch: 2 cost time: 35.083778619766235
Epoch: 2, Steps: 718 | Train Loss: 0.4611381 Vali Loss: 0.6111575 Test Loss: 0.7377216
Validation loss decreased (0.626773 --> 0.611158).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5048190
	speed: 0.8280s/iter; left time: 4674.2977s
	iters: 200, epoch: 3 | loss: 0.4734097
	speed: 0.0403s/iter; left time: 223.4051s
	iters: 300, epoch: 3 | loss: 0.4702503
	speed: 0.0442s/iter; left time: 240.4319s
	iters: 400, epoch: 3 | loss: 0.4410820
	speed: 0.0457s/iter; left time: 244.1158s
	iters: 500, epoch: 3 | loss: 0.4418879
	speed: 0.0475s/iter; left time: 248.9913s
	iters: 600, epoch: 3 | loss: 0.4317997
	speed: 0.0475s/iter; left time: 244.5503s
	iters: 700, epoch: 3 | loss: 0.4583996
	speed: 0.0459s/iter; left time: 231.7295s
Epoch: 3 cost time: 33.05420160293579
Epoch: 3, Steps: 718 | Train Loss: 0.4546340 Vali Loss: 0.6090363 Test Loss: 0.7349671
Validation loss decreased (0.611158 --> 0.609036).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4350410
	speed: 0.4502s/iter; left time: 2218.0196s
	iters: 200, epoch: 4 | loss: 0.4600886
	speed: 0.0476s/iter; left time: 229.7592s
	iters: 300, epoch: 4 | loss: 0.4772061
	speed: 0.0481s/iter; left time: 227.2196s
	iters: 400, epoch: 4 | loss: 0.4310356
	speed: 0.0488s/iter; left time: 225.7923s
	iters: 500, epoch: 4 | loss: 0.4465817
	speed: 0.0486s/iter; left time: 219.8007s
	iters: 600, epoch: 4 | loss: 0.4472188
	speed: 0.0453s/iter; left time: 200.7277s
	iters: 700, epoch: 4 | loss: 0.4380215
	speed: 0.0438s/iter; left time: 189.6290s
Epoch: 4 cost time: 34.85123801231384
Epoch: 4, Steps: 718 | Train Loss: 0.4527565 Vali Loss: 0.6068851 Test Loss: 0.7329776
Validation loss decreased (0.609036 --> 0.606885).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4265112
	speed: 1.3748s/iter; left time: 5786.3352s
	iters: 200, epoch: 5 | loss: 0.4619819
	speed: 0.0468s/iter; left time: 192.1979s
	iters: 300, epoch: 5 | loss: 0.4414230
	speed: 0.0472s/iter; left time: 189.3703s
	iters: 400, epoch: 5 | loss: 0.4336754
	speed: 0.0460s/iter; left time: 179.7876s
	iters: 500, epoch: 5 | loss: 0.4680309
	speed: 0.0479s/iter; left time: 182.4702s
	iters: 600, epoch: 5 | loss: 0.4773006
	speed: 0.0482s/iter; left time: 178.7371s
	iters: 700, epoch: 5 | loss: 0.4506100
	speed: 0.0469s/iter; left time: 169.2481s
Epoch: 5 cost time: 34.705655336380005
Epoch: 5, Steps: 718 | Train Loss: 0.4519725 Vali Loss: 0.6072192 Test Loss: 0.7325411
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4468552
	speed: 1.0386s/iter; left time: 3625.6725s
	iters: 200, epoch: 6 | loss: 0.4438953
	speed: 0.0455s/iter; left time: 154.3568s
	iters: 300, epoch: 6 | loss: 0.4530538
	speed: 0.0465s/iter; left time: 153.0062s
	iters: 400, epoch: 6 | loss: 0.4532566
	speed: 0.0471s/iter; left time: 150.3907s
	iters: 500, epoch: 6 | loss: 0.4980287
	speed: 0.0481s/iter; left time: 148.5733s
	iters: 600, epoch: 6 | loss: 0.4514140
	speed: 0.0480s/iter; left time: 143.5148s
	iters: 700, epoch: 6 | loss: 0.4553014
	speed: 0.0476s/iter; left time: 137.6192s
Epoch: 6 cost time: 34.59168887138367
Epoch: 6, Steps: 718 | Train Loss: 0.4515498 Vali Loss: 0.6059406 Test Loss: 0.7318420
Validation loss decreased (0.606885 --> 0.605941).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4308684
	speed: 0.9398s/iter; left time: 2606.0070s
	iters: 200, epoch: 7 | loss: 0.5015842
	speed: 0.0460s/iter; left time: 123.0454s
	iters: 300, epoch: 7 | loss: 0.4732633
	speed: 0.0496s/iter; left time: 127.5704s
	iters: 400, epoch: 7 | loss: 0.4204289
	speed: 0.0488s/iter; left time: 120.7165s
	iters: 500, epoch: 7 | loss: 0.4561375
	speed: 0.0465s/iter; left time: 110.3590s
	iters: 600, epoch: 7 | loss: 0.4729570
	speed: 0.0518s/iter; left time: 117.6773s
	iters: 700, epoch: 7 | loss: 0.4495738
	speed: 0.0493s/iter; left time: 107.1257s
Epoch: 7 cost time: 35.622273683547974
Epoch: 7, Steps: 718 | Train Loss: 0.4513352 Vali Loss: 0.6061597 Test Loss: 0.7319400
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4544443
	speed: 0.4513s/iter; left time: 927.5117s
	iters: 200, epoch: 8 | loss: 0.4610675
	speed: 0.0512s/iter; left time: 100.0298s
	iters: 300, epoch: 8 | loss: 0.4595660
	speed: 0.0446s/iter; left time: 82.6526s
	iters: 400, epoch: 8 | loss: 0.4861934
	speed: 0.0447s/iter; left time: 78.4347s
	iters: 500, epoch: 8 | loss: 0.4604261
	speed: 0.0421s/iter; left time: 69.6101s
	iters: 600, epoch: 8 | loss: 0.4508587
	speed: 0.0415s/iter; left time: 64.5015s
	iters: 700, epoch: 8 | loss: 0.4541938
	speed: 0.0436s/iter; left time: 63.4108s
Epoch: 8 cost time: 33.36997079849243
Epoch: 8, Steps: 718 | Train Loss: 0.4512332 Vali Loss: 0.6067665 Test Loss: 0.7318028
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4381463
	speed: 0.6145s/iter; left time: 821.6481s
	iters: 200, epoch: 9 | loss: 0.4720252
	speed: 0.0448s/iter; left time: 55.4592s
	iters: 300, epoch: 9 | loss: 0.4516238
	speed: 0.0484s/iter; left time: 55.0404s
	iters: 400, epoch: 9 | loss: 0.4402789
	speed: 0.0494s/iter; left time: 51.2198s
	iters: 500, epoch: 9 | loss: 0.4246627
	speed: 0.0475s/iter; left time: 44.4890s
	iters: 600, epoch: 9 | loss: 0.4806168
	speed: 0.0480s/iter; left time: 40.1647s
	iters: 700, epoch: 9 | loss: 0.4367708
	speed: 0.0482s/iter; left time: 35.5089s
Epoch: 9 cost time: 35.08212733268738
Epoch: 9, Steps: 718 | Train Loss: 0.4511502 Vali Loss: 0.6063188 Test Loss: 0.7317642
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_72_720_NLinear_custom_ftM_sl72_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.7312019467353821, mae:0.4237203001976013
