Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_96_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_96_24_NLinear_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12161
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.5821412
	speed: 0.0163s/iter; left time: 122.1663s
	iters: 200, epoch: 1 | loss: 0.5530046
	speed: 0.0092s/iter; left time: 68.2057s
	iters: 300, epoch: 1 | loss: 0.4197922
	speed: 0.0093s/iter; left time: 68.0965s
	iters: 400, epoch: 1 | loss: 0.4276370
	speed: 0.0095s/iter; left time: 68.0687s
	iters: 500, epoch: 1 | loss: 0.4448883
	speed: 0.0097s/iter; left time: 68.6715s
	iters: 600, epoch: 1 | loss: 0.4932363
	speed: 0.0093s/iter; left time: 64.8733s
	iters: 700, epoch: 1 | loss: 0.4026825
	speed: 0.0093s/iter; left time: 64.2473s
Epoch: 1 cost time: 7.928852558135986
Epoch: 1, Steps: 760 | Train Loss: 0.5004932 Vali Loss: 0.5446339 Test Loss: 0.6268616
Validation loss decreased (inf --> 0.544634).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4300891
	speed: 0.0734s/iter; left time: 494.9525s
	iters: 200, epoch: 2 | loss: 0.3680542
	speed: 0.0100s/iter; left time: 66.4296s
	iters: 300, epoch: 2 | loss: 0.3801461
	speed: 0.0100s/iter; left time: 65.7158s
	iters: 400, epoch: 2 | loss: 0.3755435
	speed: 0.0095s/iter; left time: 61.1565s
	iters: 500, epoch: 2 | loss: 0.3947756
	speed: 0.0096s/iter; left time: 61.0639s
	iters: 600, epoch: 2 | loss: 0.3712372
	speed: 0.0098s/iter; left time: 61.3651s
	iters: 700, epoch: 2 | loss: 0.4290484
	speed: 0.0098s/iter; left time: 59.9244s
Epoch: 2 cost time: 8.189214944839478
Epoch: 2, Steps: 760 | Train Loss: 0.4043270 Vali Loss: 0.5325109 Test Loss: 0.6086042
Validation loss decreased (0.544634 --> 0.532511).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3883287
	speed: 0.0714s/iter; left time: 426.9274s
	iters: 200, epoch: 3 | loss: 0.3870019
	speed: 0.0103s/iter; left time: 60.4262s
	iters: 300, epoch: 3 | loss: 0.3490604
	speed: 0.0095s/iter; left time: 55.0566s
	iters: 400, epoch: 3 | loss: 0.3738574
	speed: 0.0096s/iter; left time: 54.6079s
	iters: 500, epoch: 3 | loss: 0.4388102
	speed: 0.0097s/iter; left time: 54.1940s
	iters: 600, epoch: 3 | loss: 0.3677127
	speed: 0.0101s/iter; left time: 55.5571s
	iters: 700, epoch: 3 | loss: 0.3953457
	speed: 0.0094s/iter; left time: 50.8155s
Epoch: 3 cost time: 8.192647457122803
Epoch: 3, Steps: 760 | Train Loss: 0.3978561 Vali Loss: 0.5273792 Test Loss: 0.6038173
Validation loss decreased (0.532511 --> 0.527379).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4064263
	speed: 0.0726s/iter; left time: 379.0243s
	iters: 200, epoch: 4 | loss: 0.3626452
	speed: 0.0099s/iter; left time: 50.8683s
	iters: 300, epoch: 4 | loss: 0.4688173
	speed: 0.0098s/iter; left time: 49.2711s
	iters: 400, epoch: 4 | loss: 0.4462729
	speed: 0.0102s/iter; left time: 50.1033s
	iters: 500, epoch: 4 | loss: 0.3798143
	speed: 0.0102s/iter; left time: 49.2735s
	iters: 600, epoch: 4 | loss: 0.4389092
	speed: 0.0101s/iter; left time: 47.9036s
	iters: 700, epoch: 4 | loss: 0.4170442
	speed: 0.0103s/iter; left time: 47.5299s
Epoch: 4 cost time: 8.373724699020386
Epoch: 4, Steps: 760 | Train Loss: 0.3960509 Vali Loss: 0.5253713 Test Loss: 0.6018785
Validation loss decreased (0.527379 --> 0.525371).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3798841
	speed: 0.0711s/iter; left time: 317.3092s
	iters: 200, epoch: 5 | loss: 0.4313243
	speed: 0.0095s/iter; left time: 41.2538s
	iters: 300, epoch: 5 | loss: 0.4212041
	speed: 0.0100s/iter; left time: 42.6999s
	iters: 400, epoch: 5 | loss: 0.5110056
	speed: 0.0095s/iter; left time: 39.6435s
	iters: 500, epoch: 5 | loss: 0.4005668
	speed: 0.0095s/iter; left time: 38.5591s
	iters: 600, epoch: 5 | loss: 0.4042665
	speed: 0.0096s/iter; left time: 37.9242s
	iters: 700, epoch: 5 | loss: 0.3711726
	speed: 0.0096s/iter; left time: 36.8933s
Epoch: 5 cost time: 8.089885473251343
Epoch: 5, Steps: 760 | Train Loss: 0.3950758 Vali Loss: 0.5251563 Test Loss: 0.6005438
Validation loss decreased (0.525371 --> 0.525156).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4266174
	speed: 0.0713s/iter; left time: 263.6968s
	iters: 200, epoch: 6 | loss: 0.4676071
	speed: 0.0099s/iter; left time: 35.7585s
	iters: 300, epoch: 6 | loss: 0.3719322
	speed: 0.0100s/iter; left time: 35.1670s
	iters: 400, epoch: 6 | loss: 0.4354404
	speed: 0.0101s/iter; left time: 34.2503s
	iters: 500, epoch: 6 | loss: 0.4056097
	speed: 0.0098s/iter; left time: 32.4678s
	iters: 600, epoch: 6 | loss: 0.3638152
	speed: 0.0103s/iter; left time: 32.9166s
	iters: 700, epoch: 6 | loss: 0.3983437
	speed: 0.0104s/iter; left time: 32.3230s
Epoch: 6 cost time: 8.386494159698486
Epoch: 6, Steps: 760 | Train Loss: 0.3945852 Vali Loss: 0.5250120 Test Loss: 0.6005182
Validation loss decreased (0.525156 --> 0.525012).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3928448
	speed: 0.0715s/iter; left time: 210.1393s
	iters: 200, epoch: 7 | loss: 0.3904764
	speed: 0.0101s/iter; left time: 28.7768s
	iters: 300, epoch: 7 | loss: 0.3128492
	speed: 0.0096s/iter; left time: 26.3014s
	iters: 400, epoch: 7 | loss: 0.3884211
	speed: 0.0095s/iter; left time: 24.9945s
	iters: 500, epoch: 7 | loss: 0.3733220
	speed: 0.0096s/iter; left time: 24.4788s
	iters: 600, epoch: 7 | loss: 0.3565768
	speed: 0.0093s/iter; left time: 22.6239s
	iters: 700, epoch: 7 | loss: 0.3503754
	speed: 0.0103s/iter; left time: 24.0389s
Epoch: 7 cost time: 8.179996013641357
Epoch: 7, Steps: 760 | Train Loss: 0.3943526 Vali Loss: 0.5248048 Test Loss: 0.6000254
Validation loss decreased (0.525012 --> 0.524805).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4270222
	speed: 0.0726s/iter; left time: 158.3714s
	iters: 200, epoch: 8 | loss: 0.2968851
	speed: 0.0101s/iter; left time: 20.9213s
	iters: 300, epoch: 8 | loss: 0.3852189
	speed: 0.0102s/iter; left time: 20.2622s
	iters: 400, epoch: 8 | loss: 0.3223647
	speed: 0.0101s/iter; left time: 18.9235s
	iters: 500, epoch: 8 | loss: 0.3891291
	speed: 0.0100s/iter; left time: 17.8746s
	iters: 600, epoch: 8 | loss: 0.3332350
	speed: 0.0103s/iter; left time: 17.2568s
	iters: 700, epoch: 8 | loss: 0.4100614
	speed: 0.0097s/iter; left time: 15.2836s
Epoch: 8 cost time: 8.422182321548462
Epoch: 8, Steps: 760 | Train Loss: 0.3942528 Vali Loss: 0.5248656 Test Loss: 0.6000109
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3949976
	speed: 0.0735s/iter; left time: 104.3932s
	iters: 200, epoch: 9 | loss: 0.3619096
	speed: 0.0099s/iter; left time: 13.1108s
	iters: 300, epoch: 9 | loss: 0.3804660
	speed: 0.0099s/iter; left time: 12.1456s
	iters: 400, epoch: 9 | loss: 0.4055370
	speed: 0.0101s/iter; left time: 11.3028s
	iters: 500, epoch: 9 | loss: 0.4115536
	speed: 0.0098s/iter; left time: 9.9924s
	iters: 600, epoch: 9 | loss: 0.3713768
	speed: 0.0096s/iter; left time: 8.8572s
	iters: 700, epoch: 9 | loss: 0.3187350
	speed: 0.0099s/iter; left time: 8.1003s
Epoch: 9 cost time: 8.391932725906372
Epoch: 9, Steps: 760 | Train Loss: 0.3941830 Vali Loss: 0.5247893 Test Loss: 0.5998968
Validation loss decreased (0.524805 --> 0.524789).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4630919
	speed: 0.0725s/iter; left time: 47.9491s
	iters: 200, epoch: 10 | loss: 0.3534716
	speed: 0.0098s/iter; left time: 5.4739s
	iters: 300, epoch: 10 | loss: 0.3730421
	speed: 0.0095s/iter; left time: 4.3781s
	iters: 400, epoch: 10 | loss: 0.4226137
	speed: 0.0097s/iter; left time: 3.4934s
	iters: 500, epoch: 10 | loss: 0.3685731
	speed: 0.0099s/iter; left time: 2.5931s
	iters: 600, epoch: 10 | loss: 0.3668687
	speed: 0.0106s/iter; left time: 1.7036s
	iters: 700, epoch: 10 | loss: 0.4520572
	speed: 0.0099s/iter; left time: 0.6016s
Epoch: 10 cost time: 8.298750162124634
Epoch: 10, Steps: 760 | Train Loss: 0.3941469 Vali Loss: 0.5242136 Test Loss: 0.5999189
Validation loss decreased (0.524789 --> 0.524214).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_96_24_NLinear_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.6001622676849365, mae:0.3757416009902954
