Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11921
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.3609811
	speed: 0.0260s/iter; left time: 191.1228s
	iters: 200, epoch: 1 | loss: 0.3050484
	speed: 0.0183s/iter; left time: 132.6523s
	iters: 300, epoch: 1 | loss: 0.2547398
	speed: 0.0185s/iter; left time: 132.1433s
	iters: 400, epoch: 1 | loss: 0.2710770
	speed: 0.0189s/iter; left time: 133.3083s
	iters: 500, epoch: 1 | loss: 0.2719596
	speed: 0.0182s/iter; left time: 126.5353s
	iters: 600, epoch: 1 | loss: 0.2978785
	speed: 0.0186s/iter; left time: 127.5940s
	iters: 700, epoch: 1 | loss: 0.2022729
	speed: 0.0182s/iter; left time: 122.9493s
Epoch: 1 cost time: 14.664392232894897
Epoch: 1, Steps: 745 | Train Loss: 0.3066257 Vali Loss: 0.3340617 Test Loss: 0.3933952
Validation loss decreased (inf --> 0.334062).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3489543
	speed: 0.1143s/iter; left time: 755.1249s
	iters: 200, epoch: 2 | loss: 0.2101886
	speed: 0.0184s/iter; left time: 119.5377s
	iters: 300, epoch: 2 | loss: 0.2008577
	speed: 0.0181s/iter; left time: 115.7873s
	iters: 400, epoch: 2 | loss: 0.2676974
	speed: 0.0188s/iter; left time: 118.2397s
	iters: 500, epoch: 2 | loss: 0.2577178
	speed: 0.0184s/iter; left time: 114.3906s
	iters: 600, epoch: 2 | loss: 0.2655850
	speed: 0.0186s/iter; left time: 113.5335s
	iters: 700, epoch: 2 | loss: 0.2701628
	speed: 0.0186s/iter; left time: 111.8400s
Epoch: 2 cost time: 14.705150365829468
Epoch: 2, Steps: 745 | Train Loss: 0.2401653 Vali Loss: 0.3261240 Test Loss: 0.3827583
Validation loss decreased (0.334062 --> 0.326124).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2407707
	speed: 0.1154s/iter; left time: 676.6258s
	iters: 200, epoch: 3 | loss: 0.2134547
	speed: 0.0185s/iter; left time: 106.8253s
	iters: 300, epoch: 3 | loss: 0.2841503
	speed: 0.0180s/iter; left time: 102.0750s
	iters: 400, epoch: 3 | loss: 0.2159745
	speed: 0.0184s/iter; left time: 102.4842s
	iters: 500, epoch: 3 | loss: 0.1935108
	speed: 0.0183s/iter; left time: 99.9042s
	iters: 600, epoch: 3 | loss: 0.2371139
	speed: 0.0181s/iter; left time: 97.0764s
	iters: 700, epoch: 3 | loss: 0.2904392
	speed: 0.0180s/iter; left time: 94.7960s
Epoch: 3 cost time: 14.532464265823364
Epoch: 3, Steps: 745 | Train Loss: 0.2344526 Vali Loss: 0.3203288 Test Loss: 0.3749878
Validation loss decreased (0.326124 --> 0.320329).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1996263
	speed: 0.1164s/iter; left time: 595.4435s
	iters: 200, epoch: 4 | loss: 0.2022051
	speed: 0.0188s/iter; left time: 94.2855s
	iters: 300, epoch: 4 | loss: 0.2067116
	speed: 0.0178s/iter; left time: 87.5169s
	iters: 400, epoch: 4 | loss: 0.2264850
	speed: 0.0181s/iter; left time: 86.9669s
	iters: 500, epoch: 4 | loss: 0.2787199
	speed: 0.0184s/iter; left time: 86.9690s
	iters: 600, epoch: 4 | loss: 0.1800984
	speed: 0.0179s/iter; left time: 82.7773s
	iters: 700, epoch: 4 | loss: 0.2759091
	speed: 0.0183s/iter; left time: 82.8605s
Epoch: 4 cost time: 14.592432260513306
Epoch: 4, Steps: 745 | Train Loss: 0.2322721 Vali Loss: 0.3198948 Test Loss: 0.3752066
Validation loss decreased (0.320329 --> 0.319895).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1942958
	speed: 0.1155s/iter; left time: 504.8504s
	iters: 200, epoch: 5 | loss: 0.2662814
	speed: 0.0186s/iter; left time: 79.4145s
	iters: 300, epoch: 5 | loss: 0.2383231
	speed: 0.0184s/iter; left time: 76.8366s
	iters: 400, epoch: 5 | loss: 0.1913636
	speed: 0.0179s/iter; left time: 73.0257s
	iters: 500, epoch: 5 | loss: 0.2064063
	speed: 0.0182s/iter; left time: 72.3412s
	iters: 600, epoch: 5 | loss: 0.3126383
	speed: 0.0178s/iter; left time: 68.8460s
	iters: 700, epoch: 5 | loss: 0.2302563
	speed: 0.0180s/iter; left time: 68.0647s
Epoch: 5 cost time: 14.553380727767944
Epoch: 5, Steps: 745 | Train Loss: 0.2312638 Vali Loss: 0.3188102 Test Loss: 0.3731785
Validation loss decreased (0.319895 --> 0.318810).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2579071
	speed: 0.1159s/iter; left time: 420.2810s
	iters: 200, epoch: 6 | loss: 0.2052609
	speed: 0.0185s/iter; left time: 65.0646s
	iters: 300, epoch: 6 | loss: 0.2524949
	speed: 0.0181s/iter; left time: 62.0811s
	iters: 400, epoch: 6 | loss: 0.2402708
	speed: 0.0183s/iter; left time: 60.8291s
	iters: 500, epoch: 6 | loss: 0.2310098
	speed: 0.0180s/iter; left time: 58.0903s
	iters: 600, epoch: 6 | loss: 0.1914456
	speed: 0.0180s/iter; left time: 56.1605s
	iters: 700, epoch: 6 | loss: 0.2156816
	speed: 0.0184s/iter; left time: 55.6432s
Epoch: 6 cost time: 14.506223917007446
Epoch: 6, Steps: 745 | Train Loss: 0.2307616 Vali Loss: 0.3177673 Test Loss: 0.3722520
Validation loss decreased (0.318810 --> 0.317767).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2354865
	speed: 0.1155s/iter; left time: 332.8448s
	iters: 200, epoch: 7 | loss: 0.2101014
	speed: 0.0183s/iter; left time: 50.8870s
	iters: 300, epoch: 7 | loss: 0.2387984
	speed: 0.0183s/iter; left time: 48.9630s
	iters: 400, epoch: 7 | loss: 0.2102624
	speed: 0.0183s/iter; left time: 47.3426s
	iters: 500, epoch: 7 | loss: 0.2775528
	speed: 0.0188s/iter; left time: 46.5265s
	iters: 600, epoch: 7 | loss: 0.2036668
	speed: 0.0184s/iter; left time: 43.7257s
	iters: 700, epoch: 7 | loss: 0.1739326
	speed: 0.0188s/iter; left time: 42.9659s
Epoch: 7 cost time: 14.66977858543396
Epoch: 7, Steps: 745 | Train Loss: 0.2304444 Vali Loss: 0.3174875 Test Loss: 0.3722277
Validation loss decreased (0.317767 --> 0.317488).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2671200
	speed: 0.1160s/iter; left time: 247.6856s
	iters: 200, epoch: 8 | loss: 0.2143464
	speed: 0.0183s/iter; left time: 37.2609s
	iters: 300, epoch: 8 | loss: 0.2400093
	speed: 0.0180s/iter; left time: 34.9344s
	iters: 400, epoch: 8 | loss: 0.1846183
	speed: 0.0179s/iter; left time: 32.8516s
	iters: 500, epoch: 8 | loss: 0.2240228
	speed: 0.0185s/iter; left time: 32.0730s
	iters: 600, epoch: 8 | loss: 0.1903490
	speed: 0.0186s/iter; left time: 30.3872s
	iters: 700, epoch: 8 | loss: 0.2107148
	speed: 0.0183s/iter; left time: 28.0551s
Epoch: 8 cost time: 14.540181636810303
Epoch: 8, Steps: 745 | Train Loss: 0.2303124 Vali Loss: 0.3169563 Test Loss: 0.3717518
Validation loss decreased (0.317488 --> 0.316956).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2165907
	speed: 0.1152s/iter; left time: 160.2005s
	iters: 200, epoch: 9 | loss: 0.2247832
	speed: 0.0180s/iter; left time: 23.2209s
	iters: 300, epoch: 9 | loss: 0.2434422
	speed: 0.0180s/iter; left time: 21.3799s
	iters: 400, epoch: 9 | loss: 0.2140512
	speed: 0.0184s/iter; left time: 20.0861s
	iters: 500, epoch: 9 | loss: 0.2177664
	speed: 0.0180s/iter; left time: 17.8493s
	iters: 600, epoch: 9 | loss: 0.2207396
	speed: 0.0178s/iter; left time: 15.8979s
	iters: 700, epoch: 9 | loss: 0.2284971
	speed: 0.0184s/iter; left time: 14.5513s
Epoch: 9 cost time: 14.412803173065186
Epoch: 9, Steps: 745 | Train Loss: 0.2302114 Vali Loss: 0.3175579 Test Loss: 0.3718691
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2128478
	speed: 0.1152s/iter; left time: 74.3964s
	iters: 200, epoch: 10 | loss: 0.2091653
	speed: 0.0181s/iter; left time: 9.8678s
	iters: 300, epoch: 10 | loss: 0.2185239
	speed: 0.0182s/iter; left time: 8.1265s
	iters: 400, epoch: 10 | loss: 0.2528034
	speed: 0.0189s/iter; left time: 6.5489s
	iters: 500, epoch: 10 | loss: 0.2137390
	speed: 0.0195s/iter; left time: 4.7935s
	iters: 600, epoch: 10 | loss: 0.2238054
	speed: 0.0181s/iter; left time: 2.6472s
	iters: 700, epoch: 10 | loss: 0.3157022
	speed: 0.0182s/iter; left time: 0.8380s
Epoch: 10 cost time: 14.680167436599731
Epoch: 10, Steps: 745 | Train Loss: 0.2301558 Vali Loss: 0.3174787 Test Loss: 0.3718340
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.37191081047058105, mae:0.2682032585144043
