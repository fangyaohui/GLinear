Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_504_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_504_24_NLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.3547831
	speed: 0.0347s/iter; left time: 250.9586s
	iters: 200, epoch: 1 | loss: 0.3310675
	speed: 0.0273s/iter; left time: 195.3037s
	iters: 300, epoch: 1 | loss: 0.2277551
	speed: 0.0261s/iter; left time: 184.0084s
	iters: 400, epoch: 1 | loss: 0.2323892
	speed: 0.0276s/iter; left time: 191.6686s
	iters: 500, epoch: 1 | loss: 0.2213784
	speed: 0.0283s/iter; left time: 193.6930s
	iters: 600, epoch: 1 | loss: 0.2451799
	speed: 0.0284s/iter; left time: 191.7289s
	iters: 700, epoch: 1 | loss: 0.1921729
	speed: 0.0267s/iter; left time: 177.5276s
Epoch: 1 cost time: 20.922532081604004
Epoch: 1, Steps: 734 | Train Loss: 0.2849220 Vali Loss: 0.3246139 Test Loss: 0.3804182
Validation loss decreased (inf --> 0.324614).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2713008
	speed: 0.1619s/iter; left time: 1053.2995s
	iters: 200, epoch: 2 | loss: 0.2582162
	speed: 0.0286s/iter; left time: 183.2772s
	iters: 300, epoch: 2 | loss: 0.2347885
	speed: 0.0294s/iter; left time: 185.4710s
	iters: 400, epoch: 2 | loss: 0.1802715
	speed: 0.0275s/iter; left time: 170.4748s
	iters: 500, epoch: 2 | loss: 0.2492463
	speed: 0.0290s/iter; left time: 177.2050s
	iters: 600, epoch: 2 | loss: 0.2490164
	speed: 0.0283s/iter; left time: 169.9216s
	iters: 700, epoch: 2 | loss: 0.2029830
	speed: 0.0274s/iter; left time: 162.0876s
Epoch: 2 cost time: 21.858789682388306
Epoch: 2, Steps: 734 | Train Loss: 0.2337102 Vali Loss: 0.3151271 Test Loss: 0.3672589
Validation loss decreased (0.324614 --> 0.315127).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2232840
	speed: 0.1584s/iter; left time: 914.5566s
	iters: 200, epoch: 3 | loss: 0.1985532
	speed: 0.0275s/iter; left time: 155.8916s
	iters: 300, epoch: 3 | loss: 0.1924615
	speed: 0.0286s/iter; left time: 159.2638s
	iters: 400, epoch: 3 | loss: 0.2331310
	speed: 0.0297s/iter; left time: 162.6593s
	iters: 500, epoch: 3 | loss: 0.2369403
	speed: 0.0273s/iter; left time: 146.6753s
	iters: 600, epoch: 3 | loss: 0.2056534
	speed: 0.0277s/iter; left time: 146.1963s
	iters: 700, epoch: 3 | loss: 0.1995477
	speed: 0.0287s/iter; left time: 148.5243s
Epoch: 3 cost time: 21.679131746292114
Epoch: 3, Steps: 734 | Train Loss: 0.2265731 Vali Loss: 0.3112617 Test Loss: 0.3634865
Validation loss decreased (0.315127 --> 0.311262).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2912825
	speed: 0.1773s/iter; left time: 893.6018s
	iters: 200, epoch: 4 | loss: 0.2372008
	speed: 0.0277s/iter; left time: 136.9512s
	iters: 300, epoch: 4 | loss: 0.2919257
	speed: 0.0289s/iter; left time: 139.9350s
	iters: 400, epoch: 4 | loss: 0.2486849
	speed: 0.0278s/iter; left time: 131.5821s
	iters: 500, epoch: 4 | loss: 0.2319797
	speed: 0.0282s/iter; left time: 130.8590s
	iters: 600, epoch: 4 | loss: 0.1974925
	speed: 0.0279s/iter; left time: 126.6624s
	iters: 700, epoch: 4 | loss: 0.2126560
	speed: 0.0295s/iter; left time: 131.1319s
Epoch: 4 cost time: 21.814003944396973
Epoch: 4, Steps: 734 | Train Loss: 0.2239773 Vali Loss: 0.3091742 Test Loss: 0.3605375
Validation loss decreased (0.311262 --> 0.309174).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2471105
	speed: 0.1558s/iter; left time: 670.8653s
	iters: 200, epoch: 5 | loss: 0.1959988
	speed: 0.0277s/iter; left time: 116.3281s
	iters: 300, epoch: 5 | loss: 0.2626211
	speed: 0.0272s/iter; left time: 111.5932s
	iters: 400, epoch: 5 | loss: 0.2184355
	speed: 0.0270s/iter; left time: 108.3307s
	iters: 500, epoch: 5 | loss: 0.2963773
	speed: 0.0283s/iter; left time: 110.4107s
	iters: 600, epoch: 5 | loss: 0.2332648
	speed: 0.0287s/iter; left time: 109.2553s
	iters: 700, epoch: 5 | loss: 0.1653969
	speed: 0.0283s/iter; left time: 104.8286s
Epoch: 5 cost time: 21.19945454597473
Epoch: 5, Steps: 734 | Train Loss: 0.2228309 Vali Loss: 0.3093410 Test Loss: 0.3610641
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2303780
	speed: 0.1575s/iter; left time: 562.4157s
	iters: 200, epoch: 6 | loss: 0.2414593
	speed: 0.0272s/iter; left time: 94.2603s
	iters: 300, epoch: 6 | loss: 0.1922746
	speed: 0.0273s/iter; left time: 91.9604s
	iters: 400, epoch: 6 | loss: 0.2010415
	speed: 0.0264s/iter; left time: 86.4164s
	iters: 500, epoch: 6 | loss: 0.2004327
	speed: 0.0282s/iter; left time: 89.3205s
	iters: 600, epoch: 6 | loss: 0.1886427
	speed: 0.0267s/iter; left time: 82.0130s
	iters: 700, epoch: 6 | loss: 0.2146920
	speed: 0.0276s/iter; left time: 81.9307s
Epoch: 6 cost time: 21.39739966392517
Epoch: 6, Steps: 734 | Train Loss: 0.2221617 Vali Loss: 0.3086708 Test Loss: 0.3592959
Validation loss decreased (0.309174 --> 0.308671).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2358253
	speed: 0.1518s/iter; left time: 430.7812s
	iters: 200, epoch: 7 | loss: 0.2186974
	speed: 0.0271s/iter; left time: 74.1622s
	iters: 300, epoch: 7 | loss: 0.1975915
	speed: 0.0270s/iter; left time: 71.1356s
	iters: 400, epoch: 7 | loss: 0.2658198
	speed: 0.0284s/iter; left time: 72.1512s
	iters: 500, epoch: 7 | loss: 0.1820733
	speed: 0.0275s/iter; left time: 67.0888s
	iters: 600, epoch: 7 | loss: 0.1948888
	speed: 0.0273s/iter; left time: 63.8138s
	iters: 700, epoch: 7 | loss: 0.2261689
	speed: 0.0267s/iter; left time: 59.7171s
Epoch: 7 cost time: 21.069283962249756
Epoch: 7, Steps: 734 | Train Loss: 0.2218553 Vali Loss: 0.3080728 Test Loss: 0.3592337
Validation loss decreased (0.308671 --> 0.308073).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2283079
	speed: 0.1566s/iter; left time: 329.2283s
	iters: 200, epoch: 8 | loss: 0.2359655
	speed: 0.0274s/iter; left time: 54.9503s
	iters: 300, epoch: 8 | loss: 0.2023311
	speed: 0.0255s/iter; left time: 48.5724s
	iters: 400, epoch: 8 | loss: 0.2037529
	speed: 0.0276s/iter; left time: 49.8526s
	iters: 500, epoch: 8 | loss: 0.2255805
	speed: 0.0284s/iter; left time: 48.2955s
	iters: 600, epoch: 8 | loss: 0.1902560
	speed: 0.0290s/iter; left time: 46.4401s
	iters: 700, epoch: 8 | loss: 0.2176816
	speed: 0.0279s/iter; left time: 41.8611s
Epoch: 8 cost time: 21.24506115913391
Epoch: 8, Steps: 734 | Train Loss: 0.2215896 Vali Loss: 0.3080926 Test Loss: 0.3591575
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2346803
	speed: 0.1607s/iter; left time: 220.0527s
	iters: 200, epoch: 9 | loss: 0.1973954
	speed: 0.0275s/iter; left time: 34.8822s
	iters: 300, epoch: 9 | loss: 0.2334410
	speed: 0.0280s/iter; left time: 32.7635s
	iters: 400, epoch: 9 | loss: 0.2013539
	speed: 0.0281s/iter; left time: 30.0917s
	iters: 500, epoch: 9 | loss: 0.2081339
	speed: 0.0277s/iter; left time: 26.8368s
	iters: 600, epoch: 9 | loss: 0.1855527
	speed: 0.0277s/iter; left time: 24.0472s
	iters: 700, epoch: 9 | loss: 0.2735597
	speed: 0.0282s/iter; left time: 21.6675s
Epoch: 9 cost time: 21.304872751235962
Epoch: 9, Steps: 734 | Train Loss: 0.2214904 Vali Loss: 0.3073982 Test Loss: 0.3588162
Validation loss decreased (0.308073 --> 0.307398).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2262715
	speed: 0.1611s/iter; left time: 102.3051s
	iters: 200, epoch: 10 | loss: 0.2740909
	speed: 0.0272s/iter; left time: 14.5434s
	iters: 300, epoch: 10 | loss: 0.1961673
	speed: 0.0282s/iter; left time: 12.2880s
	iters: 400, epoch: 10 | loss: 0.2486504
	speed: 0.0267s/iter; left time: 8.9463s
	iters: 500, epoch: 10 | loss: 0.2298833
	speed: 0.0273s/iter; left time: 6.4194s
	iters: 600, epoch: 10 | loss: 0.2251315
	speed: 0.0263s/iter; left time: 3.5555s
	iters: 700, epoch: 10 | loss: 0.1646119
	speed: 0.0274s/iter; left time: 0.9600s
Epoch: 10 cost time: 20.922708749771118
Epoch: 10, Steps: 734 | Train Loss: 0.2214280 Vali Loss: 0.3074455 Test Loss: 0.3587196
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_504_24_NLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.3589605987071991, mae:0.2626499533653259
