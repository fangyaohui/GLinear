Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='traffic_144_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_144_24_NLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12113
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.4596964
	speed: 0.0187s/iter; left time: 139.5410s
	iters: 200, epoch: 1 | loss: 0.4414807
	speed: 0.0117s/iter; left time: 86.1976s
	iters: 300, epoch: 1 | loss: 0.3789015
	speed: 0.0118s/iter; left time: 85.6743s
	iters: 400, epoch: 1 | loss: 0.3185848
	speed: 0.0119s/iter; left time: 85.0293s
	iters: 500, epoch: 1 | loss: 0.3300413
	speed: 0.0117s/iter; left time: 82.6266s
	iters: 600, epoch: 1 | loss: 0.3080098
	speed: 0.0118s/iter; left time: 81.9981s
	iters: 700, epoch: 1 | loss: 0.2943117
	speed: 0.0116s/iter; left time: 79.6385s
Epoch: 1 cost time: 9.64367938041687
Epoch: 1, Steps: 757 | Train Loss: 0.4174859 Vali Loss: 0.4297342 Test Loss: 0.5026804
Validation loss decreased (inf --> 0.429734).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3191650
	speed: 0.0842s/iter; left time: 565.6475s
	iters: 200, epoch: 2 | loss: 0.3194889
	speed: 0.0111s/iter; left time: 73.5799s
	iters: 300, epoch: 2 | loss: 0.3362918
	speed: 0.0114s/iter; left time: 74.3041s
	iters: 400, epoch: 2 | loss: 0.3509650
	speed: 0.0108s/iter; left time: 69.2315s
	iters: 500, epoch: 2 | loss: 0.3317558
	speed: 0.0106s/iter; left time: 66.6472s
	iters: 600, epoch: 2 | loss: 0.2995154
	speed: 0.0110s/iter; left time: 68.3133s
	iters: 700, epoch: 2 | loss: 0.3198615
	speed: 0.0119s/iter; left time: 72.7317s
Epoch: 2 cost time: 9.417609453201294
Epoch: 2, Steps: 757 | Train Loss: 0.3202380 Vali Loss: 0.4182703 Test Loss: 0.4876001
Validation loss decreased (0.429734 --> 0.418270).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3482315
	speed: 0.0815s/iter; left time: 485.3506s
	iters: 200, epoch: 3 | loss: 0.3046326
	speed: 0.0117s/iter; left time: 68.3960s
	iters: 300, epoch: 3 | loss: 0.2928552
	speed: 0.0110s/iter; left time: 63.5470s
	iters: 400, epoch: 3 | loss: 0.2757659
	speed: 0.0114s/iter; left time: 64.4798s
	iters: 500, epoch: 3 | loss: 0.3077725
	speed: 0.0112s/iter; left time: 62.0369s
	iters: 600, epoch: 3 | loss: 0.3115119
	speed: 0.0115s/iter; left time: 62.9215s
	iters: 700, epoch: 3 | loss: 0.2999620
	speed: 0.0113s/iter; left time: 60.3556s
Epoch: 3 cost time: 9.42047643661499
Epoch: 3, Steps: 757 | Train Loss: 0.3138666 Vali Loss: 0.4132320 Test Loss: 0.4809435
Validation loss decreased (0.418270 --> 0.413232).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3045236
	speed: 0.0811s/iter; left time: 421.9484s
	iters: 200, epoch: 4 | loss: 0.4062909
	speed: 0.0115s/iter; left time: 58.4342s
	iters: 300, epoch: 4 | loss: 0.3508037
	speed: 0.0113s/iter; left time: 56.7308s
	iters: 400, epoch: 4 | loss: 0.3033475
	speed: 0.0112s/iter; left time: 54.9143s
	iters: 500, epoch: 4 | loss: 0.3165597
	speed: 0.0113s/iter; left time: 54.0030s
	iters: 600, epoch: 4 | loss: 0.3258699
	speed: 0.0113s/iter; left time: 53.3387s
	iters: 700, epoch: 4 | loss: 0.3608264
	speed: 0.0117s/iter; left time: 53.5983s
Epoch: 4 cost time: 9.571323871612549
Epoch: 4, Steps: 757 | Train Loss: 0.3120283 Vali Loss: 0.4119002 Test Loss: 0.4789677
Validation loss decreased (0.413232 --> 0.411900).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3259482
	speed: 0.0820s/iter; left time: 364.5299s
	iters: 200, epoch: 5 | loss: 0.2780666
	speed: 0.0116s/iter; left time: 50.2135s
	iters: 300, epoch: 5 | loss: 0.3086194
	speed: 0.0116s/iter; left time: 49.0457s
	iters: 400, epoch: 5 | loss: 0.3020215
	speed: 0.0111s/iter; left time: 46.0166s
	iters: 500, epoch: 5 | loss: 0.3451814
	speed: 0.0112s/iter; left time: 45.4656s
	iters: 600, epoch: 5 | loss: 0.3236368
	speed: 0.0117s/iter; left time: 46.2108s
	iters: 700, epoch: 5 | loss: 0.3090040
	speed: 0.0121s/iter; left time: 46.5262s
Epoch: 5 cost time: 9.573836088180542
Epoch: 5, Steps: 757 | Train Loss: 0.3110383 Vali Loss: 0.4105258 Test Loss: 0.4772384
Validation loss decreased (0.411900 --> 0.410526).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3390106
	speed: 0.0818s/iter; left time: 301.4477s
	iters: 200, epoch: 6 | loss: 0.3011645
	speed: 0.0114s/iter; left time: 41.0002s
	iters: 300, epoch: 6 | loss: 0.3378047
	speed: 0.0112s/iter; left time: 39.1672s
	iters: 400, epoch: 6 | loss: 0.4632157
	speed: 0.0112s/iter; left time: 37.9364s
	iters: 500, epoch: 6 | loss: 0.3273448
	speed: 0.0112s/iter; left time: 36.7769s
	iters: 600, epoch: 6 | loss: 0.2969943
	speed: 0.0115s/iter; left time: 36.6053s
	iters: 700, epoch: 6 | loss: 0.2867279
	speed: 0.0113s/iter; left time: 34.8530s
Epoch: 6 cost time: 9.539491891860962
Epoch: 6, Steps: 757 | Train Loss: 0.3105962 Vali Loss: 0.4103377 Test Loss: 0.4771293
Validation loss decreased (0.410526 --> 0.410338).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4091888
	speed: 0.0835s/iter; left time: 244.5869s
	iters: 200, epoch: 7 | loss: 0.2566215
	speed: 0.0120s/iter; left time: 33.8877s
	iters: 300, epoch: 7 | loss: 0.3103205
	speed: 0.0119s/iter; left time: 32.3609s
	iters: 400, epoch: 7 | loss: 0.3166109
	speed: 0.0117s/iter; left time: 30.8638s
	iters: 500, epoch: 7 | loss: 0.3160081
	speed: 0.0119s/iter; left time: 30.0847s
	iters: 600, epoch: 7 | loss: 0.3370654
	speed: 0.0119s/iter; left time: 28.9130s
	iters: 700, epoch: 7 | loss: 0.3388793
	speed: 0.0122s/iter; left time: 28.4090s
Epoch: 7 cost time: 9.86062741279602
Epoch: 7, Steps: 757 | Train Loss: 0.3103966 Vali Loss: 0.4102342 Test Loss: 0.4769982
Validation loss decreased (0.410338 --> 0.410234).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3420176
	speed: 0.0834s/iter; left time: 181.1326s
	iters: 200, epoch: 8 | loss: 0.2651410
	speed: 0.0122s/iter; left time: 25.3617s
	iters: 300, epoch: 8 | loss: 0.3465506
	speed: 0.0117s/iter; left time: 23.0108s
	iters: 400, epoch: 8 | loss: 0.3062313
	speed: 0.0115s/iter; left time: 21.5653s
	iters: 500, epoch: 8 | loss: 0.2887250
	speed: 0.0118s/iter; left time: 20.9091s
	iters: 600, epoch: 8 | loss: 0.3112442
	speed: 0.0119s/iter; left time: 19.8712s
	iters: 700, epoch: 8 | loss: 0.3309536
	speed: 0.0119s/iter; left time: 18.7054s
Epoch: 8 cost time: 9.903716802597046
Epoch: 8, Steps: 757 | Train Loss: 0.3102562 Vali Loss: 0.4102767 Test Loss: 0.4769053
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3814166
	speed: 0.0840s/iter; left time: 118.8969s
	iters: 200, epoch: 9 | loss: 0.3190297
	speed: 0.0119s/iter; left time: 15.6708s
	iters: 300, epoch: 9 | loss: 0.3343761
	speed: 0.0115s/iter; left time: 13.9654s
	iters: 400, epoch: 9 | loss: 0.3337419
	speed: 0.0112s/iter; left time: 12.5079s
	iters: 500, epoch: 9 | loss: 0.2943869
	speed: 0.0113s/iter; left time: 11.5087s
	iters: 600, epoch: 9 | loss: 0.2751767
	speed: 0.0115s/iter; left time: 10.5066s
	iters: 700, epoch: 9 | loss: 0.4015501
	speed: 0.0114s/iter; left time: 9.2561s
Epoch: 9 cost time: 9.566835641860962
Epoch: 9, Steps: 757 | Train Loss: 0.3101969 Vali Loss: 0.4100014 Test Loss: 0.4767421
Validation loss decreased (0.410234 --> 0.410001).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2947489
	speed: 0.0850s/iter; left time: 55.9399s
	iters: 200, epoch: 10 | loss: 0.3122906
	speed: 0.0119s/iter; left time: 6.6314s
	iters: 300, epoch: 10 | loss: 0.3567323
	speed: 0.0126s/iter; left time: 5.7481s
	iters: 400, epoch: 10 | loss: 0.2899830
	speed: 0.0116s/iter; left time: 4.1540s
	iters: 500, epoch: 10 | loss: 0.2882007
	speed: 0.0123s/iter; left time: 3.1816s
	iters: 600, epoch: 10 | loss: 0.2642612
	speed: 0.0115s/iter; left time: 1.8174s
	iters: 700, epoch: 10 | loss: 0.2615512
	speed: 0.0116s/iter; left time: 0.6721s
Epoch: 10 cost time: 10.02866005897522
Epoch: 10, Steps: 757 | Train Loss: 0.3101559 Vali Loss: 0.4098513 Test Loss: 0.4768258
Validation loss decreased (0.410001 --> 0.409851).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_144_24_NLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.4770244061946869, mae:0.3240340054035187
