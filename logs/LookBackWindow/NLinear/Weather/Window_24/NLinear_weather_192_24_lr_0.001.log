Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='weather_192_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=192, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_24_NLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36672
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.2614535
	speed: 0.0105s/iter; left time: 239.1354s
	iters: 200, epoch: 1 | loss: 0.6197725
	speed: 0.0041s/iter; left time: 92.1736s
	iters: 300, epoch: 1 | loss: 1.2387326
	speed: 0.0040s/iter; left time: 91.6058s
	iters: 400, epoch: 1 | loss: 0.2770967
	speed: 0.0039s/iter; left time: 87.7694s
	iters: 500, epoch: 1 | loss: 0.1951604
	speed: 0.0040s/iter; left time: 89.9509s
	iters: 600, epoch: 1 | loss: 0.1934596
	speed: 0.0042s/iter; left time: 93.2381s
	iters: 700, epoch: 1 | loss: 0.1390604
	speed: 0.0040s/iter; left time: 89.8116s
	iters: 800, epoch: 1 | loss: 0.2494700
	speed: 0.0040s/iter; left time: 88.1524s
	iters: 900, epoch: 1 | loss: 0.3434840
	speed: 0.0040s/iter; left time: 87.5600s
	iters: 1000, epoch: 1 | loss: 0.4007816
	speed: 0.0040s/iter; left time: 87.8389s
	iters: 1100, epoch: 1 | loss: 0.2234099
	speed: 0.0040s/iter; left time: 88.2649s
	iters: 1200, epoch: 1 | loss: 0.2013019
	speed: 0.0048s/iter; left time: 105.2905s
	iters: 1300, epoch: 1 | loss: 0.1882864
	speed: 0.0047s/iter; left time: 101.6236s
	iters: 1400, epoch: 1 | loss: 0.2132820
	speed: 0.0037s/iter; left time: 79.7316s
	iters: 1500, epoch: 1 | loss: 0.5183060
	speed: 0.0041s/iter; left time: 88.6146s
	iters: 1600, epoch: 1 | loss: 0.9254720
	speed: 0.0039s/iter; left time: 82.6277s
	iters: 1700, epoch: 1 | loss: 0.2257366
	speed: 0.0038s/iter; left time: 80.3446s
	iters: 1800, epoch: 1 | loss: 0.1423700
	speed: 0.0040s/iter; left time: 84.7784s
	iters: 1900, epoch: 1 | loss: 0.2193806
	speed: 0.0040s/iter; left time: 83.4428s
	iters: 2000, epoch: 1 | loss: 0.1962544
	speed: 0.0041s/iter; left time: 84.8949s
	iters: 2100, epoch: 1 | loss: 0.1729597
	speed: 0.0039s/iter; left time: 81.4839s
	iters: 2200, epoch: 1 | loss: 0.2198499
	speed: 0.0041s/iter; left time: 85.2543s
Epoch: 1 cost time: 10.072754859924316
Epoch: 1, Steps: 2292 | Train Loss: 0.4169131 Vali Loss: 0.3145247 Test Loss: 0.1124869
Validation loss decreased (inf --> 0.314525).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2704279
	speed: 0.0609s/iter; left time: 1249.8700s
	iters: 200, epoch: 2 | loss: 0.1206875
	speed: 0.0041s/iter; left time: 82.9088s
	iters: 300, epoch: 2 | loss: 0.3011553
	speed: 0.0043s/iter; left time: 88.1137s
	iters: 400, epoch: 2 | loss: 0.1290028
	speed: 0.0038s/iter; left time: 77.6713s
	iters: 500, epoch: 2 | loss: 0.3728650
	speed: 0.0039s/iter; left time: 79.1974s
	iters: 600, epoch: 2 | loss: 0.2996240
	speed: 0.0039s/iter; left time: 78.9116s
	iters: 700, epoch: 2 | loss: 0.1846055
	speed: 0.0036s/iter; left time: 72.6260s
	iters: 800, epoch: 2 | loss: 2.8873706
	speed: 0.0038s/iter; left time: 74.7049s
	iters: 900, epoch: 2 | loss: 0.4125634
	speed: 0.0040s/iter; left time: 78.8608s
	iters: 1000, epoch: 2 | loss: 0.1761364
	speed: 0.0039s/iter; left time: 77.4922s
	iters: 1100, epoch: 2 | loss: 0.1602090
	speed: 0.0047s/iter; left time: 91.9720s
	iters: 1200, epoch: 2 | loss: 0.2615577
	speed: 0.0043s/iter; left time: 84.0053s
	iters: 1300, epoch: 2 | loss: 0.2325453
	speed: 0.0039s/iter; left time: 76.1896s
	iters: 1400, epoch: 2 | loss: 0.4471928
	speed: 0.0039s/iter; left time: 74.8672s
	iters: 1500, epoch: 2 | loss: 0.2588126
	speed: 0.0038s/iter; left time: 72.5588s
	iters: 1600, epoch: 2 | loss: 0.1608877
	speed: 0.0038s/iter; left time: 72.4992s
	iters: 1700, epoch: 2 | loss: 0.1965669
	speed: 0.0038s/iter; left time: 71.9160s
	iters: 1800, epoch: 2 | loss: 0.1513504
	speed: 0.0039s/iter; left time: 72.5416s
	iters: 1900, epoch: 2 | loss: 0.1983768
	speed: 0.0042s/iter; left time: 79.5127s
	iters: 2000, epoch: 2 | loss: 0.1835079
	speed: 0.0041s/iter; left time: 76.0627s
	iters: 2100, epoch: 2 | loss: 0.2086613
	speed: 0.0043s/iter; left time: 78.8532s
	iters: 2200, epoch: 2 | loss: 0.2040588
	speed: 0.0041s/iter; left time: 76.1587s
Epoch: 2 cost time: 9.999588012695312
Epoch: 2, Steps: 2292 | Train Loss: 0.4067717 Vali Loss: 0.3102490 Test Loss: 0.1102176
Validation loss decreased (0.314525 --> 0.310249).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2918903
	speed: 0.0592s/iter; left time: 1080.0469s
	iters: 200, epoch: 3 | loss: 0.1387042
	speed: 0.0041s/iter; left time: 74.9716s
	iters: 300, epoch: 3 | loss: 0.1312068
	speed: 0.0040s/iter; left time: 71.8582s
	iters: 400, epoch: 3 | loss: 0.2344108
	speed: 0.0040s/iter; left time: 71.7548s
	iters: 500, epoch: 3 | loss: 0.1933349
	speed: 0.0043s/iter; left time: 76.7775s
	iters: 600, epoch: 3 | loss: 0.1594176
	speed: 0.0041s/iter; left time: 72.3277s
	iters: 700, epoch: 3 | loss: 0.3474255
	speed: 0.0041s/iter; left time: 71.8754s
	iters: 800, epoch: 3 | loss: 0.1663541
	speed: 0.0038s/iter; left time: 65.9612s
	iters: 900, epoch: 3 | loss: 0.1368392
	speed: 0.0036s/iter; left time: 63.5279s
	iters: 1000, epoch: 3 | loss: 0.2077920
	speed: 0.0039s/iter; left time: 67.3659s
	iters: 1100, epoch: 3 | loss: 0.1899305
	speed: 0.0041s/iter; left time: 70.3395s
	iters: 1200, epoch: 3 | loss: 0.1546994
	speed: 0.0040s/iter; left time: 67.9026s
	iters: 1300, epoch: 3 | loss: 0.2713940
	speed: 0.0042s/iter; left time: 71.1147s
	iters: 1400, epoch: 3 | loss: 1.6530341
	speed: 0.0038s/iter; left time: 64.4938s
	iters: 1500, epoch: 3 | loss: 0.2517681
	speed: 0.0039s/iter; left time: 66.2166s
	iters: 1600, epoch: 3 | loss: 0.2098691
	speed: 0.0037s/iter; left time: 62.0893s
	iters: 1700, epoch: 3 | loss: 0.2865662
	speed: 0.0039s/iter; left time: 64.5984s
	iters: 1800, epoch: 3 | loss: 0.1653967
	speed: 0.0038s/iter; left time: 62.5498s
	iters: 1900, epoch: 3 | loss: 0.1501475
	speed: 0.0038s/iter; left time: 62.4142s
	iters: 2000, epoch: 3 | loss: 0.2261714
	speed: 0.0042s/iter; left time: 69.2706s
	iters: 2100, epoch: 3 | loss: 0.2649646
	speed: 0.0044s/iter; left time: 70.6991s
	iters: 2200, epoch: 3 | loss: 0.9538890
	speed: 0.0043s/iter; left time: 68.6110s
Epoch: 3 cost time: 9.906852960586548
Epoch: 3, Steps: 2292 | Train Loss: 0.3797842 Vali Loss: 0.3109841 Test Loss: 0.1120342
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1081722
	speed: 0.0595s/iter; left time: 948.5567s
	iters: 200, epoch: 4 | loss: 0.1153431
	speed: 0.0042s/iter; left time: 65.8371s
	iters: 300, epoch: 4 | loss: 0.2299165
	speed: 0.0041s/iter; left time: 64.5217s
	iters: 400, epoch: 4 | loss: 0.1791125
	speed: 0.0043s/iter; left time: 66.8987s
	iters: 500, epoch: 4 | loss: 0.1856153
	speed: 0.0043s/iter; left time: 67.4367s
	iters: 600, epoch: 4 | loss: 0.3543888
	speed: 0.0040s/iter; left time: 61.5225s
	iters: 700, epoch: 4 | loss: 0.1209295
	speed: 0.0039s/iter; left time: 59.6693s
	iters: 800, epoch: 4 | loss: 0.4091537
	speed: 0.0039s/iter; left time: 59.5876s
	iters: 900, epoch: 4 | loss: 0.5711988
	speed: 0.0038s/iter; left time: 57.6132s
	iters: 1000, epoch: 4 | loss: 1.0608722
	speed: 0.0038s/iter; left time: 56.6387s
	iters: 1100, epoch: 4 | loss: 0.1061626
	speed: 0.0037s/iter; left time: 55.8271s
	iters: 1200, epoch: 4 | loss: 0.1401184
	speed: 0.0038s/iter; left time: 57.0108s
	iters: 1300, epoch: 4 | loss: 0.2073992
	speed: 0.0040s/iter; left time: 58.4365s
	iters: 1400, epoch: 4 | loss: 0.2308510
	speed: 0.0038s/iter; left time: 55.7088s
	iters: 1500, epoch: 4 | loss: 0.3377585
	speed: 0.0038s/iter; left time: 55.3618s
	iters: 1600, epoch: 4 | loss: 0.3257225
	speed: 0.0039s/iter; left time: 55.9005s
	iters: 1700, epoch: 4 | loss: 0.2332400
	speed: 0.0038s/iter; left time: 55.2269s
	iters: 1800, epoch: 4 | loss: 0.3500219
	speed: 0.0041s/iter; left time: 58.6567s
	iters: 1900, epoch: 4 | loss: 0.1537015
	speed: 0.0042s/iter; left time: 58.7815s
	iters: 2000, epoch: 4 | loss: 0.2589728
	speed: 0.0041s/iter; left time: 58.1363s
	iters: 2100, epoch: 4 | loss: 0.1969809
	speed: 0.0040s/iter; left time: 56.3416s
	iters: 2200, epoch: 4 | loss: 0.1339200
	speed: 0.0041s/iter; left time: 56.2133s
Epoch: 4 cost time: 9.926746606826782
Epoch: 4, Steps: 2292 | Train Loss: 0.3457193 Vali Loss: 0.2977534 Test Loss: 0.1101221
Validation loss decreased (0.310249 --> 0.297753).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2313647
	speed: 0.0596s/iter; left time: 813.2533s
	iters: 200, epoch: 5 | loss: 0.1351827
	speed: 0.0039s/iter; left time: 53.1769s
	iters: 300, epoch: 5 | loss: 0.2011765
	speed: 0.0040s/iter; left time: 53.3985s
	iters: 400, epoch: 5 | loss: 0.2819414
	speed: 0.0040s/iter; left time: 52.8868s
	iters: 500, epoch: 5 | loss: 0.5497920
	speed: 0.0039s/iter; left time: 51.5328s
	iters: 600, epoch: 5 | loss: 0.1907427
	speed: 0.0039s/iter; left time: 50.7635s
	iters: 700, epoch: 5 | loss: 0.2630916
	speed: 0.0041s/iter; left time: 53.8789s
	iters: 800, epoch: 5 | loss: 0.3593698
	speed: 0.0040s/iter; left time: 51.5046s
	iters: 900, epoch: 5 | loss: 0.1663650
	speed: 0.0038s/iter; left time: 48.3441s
	iters: 1000, epoch: 5 | loss: 0.2919877
	speed: 0.0041s/iter; left time: 52.0457s
	iters: 1100, epoch: 5 | loss: 1.4901832
	speed: 0.0048s/iter; left time: 60.4804s
	iters: 1200, epoch: 5 | loss: 0.1542744
	speed: 0.0040s/iter; left time: 50.0889s
	iters: 1300, epoch: 5 | loss: 0.2162127
	speed: 0.0040s/iter; left time: 49.6183s
	iters: 1400, epoch: 5 | loss: 0.3152160
	speed: 0.0041s/iter; left time: 50.0938s
	iters: 1500, epoch: 5 | loss: 0.1869383
	speed: 0.0041s/iter; left time: 50.7488s
	iters: 1600, epoch: 5 | loss: 0.1413283
	speed: 0.0041s/iter; left time: 49.8068s
	iters: 1700, epoch: 5 | loss: 0.5203444
	speed: 0.0039s/iter; left time: 47.5211s
	iters: 1800, epoch: 5 | loss: 0.2876955
	speed: 0.0040s/iter; left time: 47.4357s
	iters: 1900, epoch: 5 | loss: 0.1694857
	speed: 0.0039s/iter; left time: 46.6519s
	iters: 2000, epoch: 5 | loss: 0.5566646
	speed: 0.0039s/iter; left time: 45.6491s
	iters: 2100, epoch: 5 | loss: 0.2815458
	speed: 0.0039s/iter; left time: 45.4262s
	iters: 2200, epoch: 5 | loss: 0.1402036
	speed: 0.0040s/iter; left time: 46.6577s
Epoch: 5 cost time: 9.899438381195068
Epoch: 5, Steps: 2292 | Train Loss: 0.3449745 Vali Loss: 0.3019015 Test Loss: 0.1088966
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3043208
	speed: 0.0581s/iter; left time: 659.9449s
	iters: 200, epoch: 6 | loss: 0.1928554
	speed: 0.0039s/iter; left time: 44.4419s
	iters: 300, epoch: 6 | loss: 0.1980510
	speed: 0.0040s/iter; left time: 44.4670s
	iters: 400, epoch: 6 | loss: 0.5213205
	speed: 0.0040s/iter; left time: 44.1452s
	iters: 500, epoch: 6 | loss: 0.2087614
	speed: 0.0039s/iter; left time: 42.2621s
	iters: 600, epoch: 6 | loss: 0.4437706
	speed: 0.0039s/iter; left time: 41.9949s
	iters: 700, epoch: 6 | loss: 0.2512876
	speed: 0.0038s/iter; left time: 40.8080s
	iters: 800, epoch: 6 | loss: 0.7888089
	speed: 0.0038s/iter; left time: 40.7474s
	iters: 900, epoch: 6 | loss: 0.2844838
	speed: 0.0038s/iter; left time: 40.4875s
	iters: 1000, epoch: 6 | loss: 0.1906576
	speed: 0.0038s/iter; left time: 40.0476s
	iters: 1100, epoch: 6 | loss: 0.1682933
	speed: 0.0038s/iter; left time: 39.8238s
	iters: 1200, epoch: 6 | loss: 0.1586001
	speed: 0.0038s/iter; left time: 39.2332s
	iters: 1300, epoch: 6 | loss: 0.2008531
	speed: 0.0040s/iter; left time: 40.8357s
	iters: 1400, epoch: 6 | loss: 0.3786018
	speed: 0.0041s/iter; left time: 41.3411s
	iters: 1500, epoch: 6 | loss: 0.1177852
	speed: 0.0041s/iter; left time: 40.7424s
	iters: 1600, epoch: 6 | loss: 0.3124301
	speed: 0.0041s/iter; left time: 40.5116s
	iters: 1700, epoch: 6 | loss: 0.2847951
	speed: 0.0040s/iter; left time: 39.1704s
	iters: 1800, epoch: 6 | loss: 0.1405659
	speed: 0.0041s/iter; left time: 39.1765s
	iters: 1900, epoch: 6 | loss: 0.2293096
	speed: 0.0041s/iter; left time: 38.9156s
	iters: 2000, epoch: 6 | loss: 0.1890384
	speed: 0.0040s/iter; left time: 37.4875s
	iters: 2100, epoch: 6 | loss: 0.1510043
	speed: 0.0040s/iter; left time: 37.1213s
	iters: 2200, epoch: 6 | loss: 0.1666577
	speed: 0.0039s/iter; left time: 35.7493s
Epoch: 6 cost time: 9.71840524673462
Epoch: 6, Steps: 2292 | Train Loss: 0.3398363 Vali Loss: 0.3521750 Test Loss: 0.1347056
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2011083
	speed: 0.0604s/iter; left time: 547.5780s
	iters: 200, epoch: 7 | loss: 0.1670614
	speed: 0.0038s/iter; left time: 33.9132s
	iters: 300, epoch: 7 | loss: 0.2112400
	speed: 0.0040s/iter; left time: 35.4917s
	iters: 400, epoch: 7 | loss: 0.2811918
	speed: 0.0037s/iter; left time: 32.2677s
	iters: 500, epoch: 7 | loss: 0.2031618
	speed: 0.0036s/iter; left time: 31.2202s
	iters: 600, epoch: 7 | loss: 0.4971673
	speed: 0.0037s/iter; left time: 32.0206s
	iters: 700, epoch: 7 | loss: 0.1124045
	speed: 0.0037s/iter; left time: 31.4124s
	iters: 800, epoch: 7 | loss: 0.1433955
	speed: 0.0037s/iter; left time: 31.0078s
	iters: 900, epoch: 7 | loss: 1.1433671
	speed: 0.0040s/iter; left time: 32.7083s
	iters: 1000, epoch: 7 | loss: 0.1543220
	speed: 0.0040s/iter; left time: 32.6687s
	iters: 1100, epoch: 7 | loss: 0.2856470
	speed: 0.0038s/iter; left time: 30.5544s
	iters: 1200, epoch: 7 | loss: 0.6873130
	speed: 0.0040s/iter; left time: 32.0846s
	iters: 1300, epoch: 7 | loss: 0.1832560
	speed: 0.0038s/iter; left time: 30.1178s
	iters: 1400, epoch: 7 | loss: 0.0973661
	speed: 0.0038s/iter; left time: 29.8891s
	iters: 1500, epoch: 7 | loss: 0.1919526
	speed: 0.0038s/iter; left time: 29.4520s
	iters: 1600, epoch: 7 | loss: 0.2049587
	speed: 0.0037s/iter; left time: 28.2494s
	iters: 1700, epoch: 7 | loss: 0.1103973
	speed: 0.0039s/iter; left time: 29.0216s
	iters: 1800, epoch: 7 | loss: 0.2158533
	speed: 0.0038s/iter; left time: 27.9870s
	iters: 1900, epoch: 7 | loss: 0.1874936
	speed: 0.0037s/iter; left time: 27.0057s
	iters: 2000, epoch: 7 | loss: 0.2159069
	speed: 0.0037s/iter; left time: 26.4475s
	iters: 2100, epoch: 7 | loss: 0.1826987
	speed: 0.0037s/iter; left time: 26.0020s
	iters: 2200, epoch: 7 | loss: 0.1566827
	speed: 0.0037s/iter; left time: 25.7895s
Epoch: 7 cost time: 9.426759719848633
Epoch: 7, Steps: 2292 | Train Loss: 0.3407964 Vali Loss: 0.3007243 Test Loss: 0.1089762
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_24_NLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.1102355420589447, mae:0.15156856179237366
