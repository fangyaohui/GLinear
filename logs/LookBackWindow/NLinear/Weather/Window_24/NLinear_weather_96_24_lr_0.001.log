Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='weather_96_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_96_24_NLinear_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36768
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.3347670
	speed: 0.0105s/iter; left time: 240.4273s
	iters: 200, epoch: 1 | loss: 0.2600909
	speed: 0.0040s/iter; left time: 91.9813s
	iters: 300, epoch: 1 | loss: 0.2521388
	speed: 0.0040s/iter; left time: 91.0291s
	iters: 400, epoch: 1 | loss: 0.3242393
	speed: 0.0040s/iter; left time: 91.1776s
	iters: 500, epoch: 1 | loss: 0.4715289
	speed: 0.0041s/iter; left time: 91.2024s
	iters: 600, epoch: 1 | loss: 0.2882207
	speed: 0.0040s/iter; left time: 90.2264s
	iters: 700, epoch: 1 | loss: 0.2191267
	speed: 0.0040s/iter; left time: 88.7518s
	iters: 800, epoch: 1 | loss: 0.1961818
	speed: 0.0040s/iter; left time: 89.4635s
	iters: 900, epoch: 1 | loss: 0.3792132
	speed: 0.0042s/iter; left time: 93.4484s
	iters: 1000, epoch: 1 | loss: 0.2429295
	speed: 0.0041s/iter; left time: 89.2009s
	iters: 1100, epoch: 1 | loss: 0.1398277
	speed: 0.0042s/iter; left time: 91.2957s
	iters: 1200, epoch: 1 | loss: 0.1613750
	speed: 0.0040s/iter; left time: 88.1219s
	iters: 1300, epoch: 1 | loss: 0.1662793
	speed: 0.0040s/iter; left time: 87.2293s
	iters: 1400, epoch: 1 | loss: 0.1980500
	speed: 0.0043s/iter; left time: 93.0574s
	iters: 1500, epoch: 1 | loss: 0.3843071
	speed: 0.0042s/iter; left time: 90.9079s
	iters: 1600, epoch: 1 | loss: 0.2428938
	speed: 0.0041s/iter; left time: 86.9468s
	iters: 1700, epoch: 1 | loss: 0.3170600
	speed: 0.0040s/iter; left time: 85.3555s
	iters: 1800, epoch: 1 | loss: 0.4961358
	speed: 0.0040s/iter; left time: 84.7390s
	iters: 1900, epoch: 1 | loss: 0.1116246
	speed: 0.0041s/iter; left time: 85.4335s
	iters: 2000, epoch: 1 | loss: 0.1323258
	speed: 0.0040s/iter; left time: 83.9144s
	iters: 2100, epoch: 1 | loss: 0.3437864
	speed: 0.0040s/iter; left time: 84.4533s
	iters: 2200, epoch: 1 | loss: 0.1878040
	speed: 0.0040s/iter; left time: 84.1150s
Epoch: 1 cost time: 10.095661163330078
Epoch: 1, Steps: 2298 | Train Loss: 0.4245854 Vali Loss: 0.3415704 Test Loss: 0.1199282
Validation loss decreased (inf --> 0.341570).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3268744
	speed: 0.0592s/iter; left time: 1218.8207s
	iters: 200, epoch: 2 | loss: 0.3326838
	speed: 0.0040s/iter; left time: 82.2451s
	iters: 300, epoch: 2 | loss: 0.1645029
	speed: 0.0043s/iter; left time: 87.3287s
	iters: 400, epoch: 2 | loss: 0.3618132
	speed: 0.0041s/iter; left time: 82.3573s
	iters: 500, epoch: 2 | loss: 0.1999691
	speed: 0.0039s/iter; left time: 78.2095s
	iters: 600, epoch: 2 | loss: 0.1499068
	speed: 0.0041s/iter; left time: 82.3044s
	iters: 700, epoch: 2 | loss: 0.2675883
	speed: 0.0039s/iter; left time: 78.8748s
	iters: 800, epoch: 2 | loss: 0.1934930
	speed: 0.0040s/iter; left time: 79.7162s
	iters: 900, epoch: 2 | loss: 0.2205294
	speed: 0.0043s/iter; left time: 85.8486s
	iters: 1000, epoch: 2 | loss: 0.3344651
	speed: 0.0047s/iter; left time: 92.8134s
	iters: 1100, epoch: 2 | loss: 0.2357864
	speed: 0.0041s/iter; left time: 80.4961s
	iters: 1200, epoch: 2 | loss: 0.1360423
	speed: 0.0041s/iter; left time: 79.2282s
	iters: 1300, epoch: 2 | loss: 1.2309426
	speed: 0.0041s/iter; left time: 79.9582s
	iters: 1400, epoch: 2 | loss: 0.2298037
	speed: 0.0042s/iter; left time: 80.8646s
	iters: 1500, epoch: 2 | loss: 0.2831481
	speed: 0.0041s/iter; left time: 78.0662s
	iters: 1600, epoch: 2 | loss: 0.1921238
	speed: 0.0037s/iter; left time: 70.5154s
	iters: 1700, epoch: 2 | loss: 0.4662128
	speed: 0.0041s/iter; left time: 78.6241s
	iters: 1800, epoch: 2 | loss: 0.2302614
	speed: 0.0040s/iter; left time: 76.1829s
	iters: 1900, epoch: 2 | loss: 0.2877677
	speed: 0.0041s/iter; left time: 76.8384s
	iters: 2000, epoch: 2 | loss: 0.6248534
	speed: 0.0041s/iter; left time: 76.0549s
	iters: 2100, epoch: 2 | loss: 0.5397565
	speed: 0.0041s/iter; left time: 76.1180s
	iters: 2200, epoch: 2 | loss: 0.1636433
	speed: 0.0040s/iter; left time: 73.6569s
Epoch: 2 cost time: 10.155690431594849
Epoch: 2, Steps: 2298 | Train Loss: 0.4086665 Vali Loss: 0.3415647 Test Loss: 0.1200389
Validation loss decreased (0.341570 --> 0.341565).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2238926
	speed: 0.0592s/iter; left time: 1082.0592s
	iters: 200, epoch: 3 | loss: 0.1773108
	speed: 0.0040s/iter; left time: 73.6425s
	iters: 300, epoch: 3 | loss: 0.6702720
	speed: 0.0040s/iter; left time: 72.0409s
	iters: 400, epoch: 3 | loss: 0.1623889
	speed: 0.0040s/iter; left time: 72.2628s
	iters: 500, epoch: 3 | loss: 0.1923724
	speed: 0.0040s/iter; left time: 71.1200s
	iters: 600, epoch: 3 | loss: 0.1602667
	speed: 0.0040s/iter; left time: 71.8952s
	iters: 700, epoch: 3 | loss: 0.4245195
	speed: 0.0041s/iter; left time: 71.6424s
	iters: 800, epoch: 3 | loss: 0.1706128
	speed: 0.0040s/iter; left time: 70.0979s
	iters: 900, epoch: 3 | loss: 0.3122224
	speed: 0.0040s/iter; left time: 69.9852s
	iters: 1000, epoch: 3 | loss: 0.2113677
	speed: 0.0041s/iter; left time: 71.2199s
	iters: 1100, epoch: 3 | loss: 0.1490804
	speed: 0.0040s/iter; left time: 69.8319s
	iters: 1200, epoch: 3 | loss: 0.2201907
	speed: 0.0040s/iter; left time: 69.5888s
	iters: 1300, epoch: 3 | loss: 0.2919970
	speed: 0.0041s/iter; left time: 69.4408s
	iters: 1400, epoch: 3 | loss: 0.5064732
	speed: 0.0040s/iter; left time: 68.1231s
	iters: 1500, epoch: 3 | loss: 0.1801930
	speed: 0.0040s/iter; left time: 67.1593s
	iters: 1600, epoch: 3 | loss: 0.3960580
	speed: 0.0041s/iter; left time: 68.9453s
	iters: 1700, epoch: 3 | loss: 0.2705752
	speed: 0.0040s/iter; left time: 66.9332s
	iters: 1800, epoch: 3 | loss: 0.1950398
	speed: 0.0040s/iter; left time: 67.0495s
	iters: 1900, epoch: 3 | loss: 0.2278453
	speed: 0.0040s/iter; left time: 66.6895s
	iters: 2000, epoch: 3 | loss: 0.2135434
	speed: 0.0040s/iter; left time: 65.4881s
	iters: 2100, epoch: 3 | loss: 0.1698291
	speed: 0.0040s/iter; left time: 65.3389s
	iters: 2200, epoch: 3 | loss: 0.4981203
	speed: 0.0040s/iter; left time: 65.2345s
Epoch: 3 cost time: 9.995877027511597
Epoch: 3, Steps: 2298 | Train Loss: 0.3846090 Vali Loss: 0.3347698 Test Loss: 0.1182005
Validation loss decreased (0.341565 --> 0.334770).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1830906
	speed: 0.0588s/iter; left time: 939.7219s
	iters: 200, epoch: 4 | loss: 0.1462020
	speed: 0.0040s/iter; left time: 63.2115s
	iters: 300, epoch: 4 | loss: 0.2758290
	speed: 0.0041s/iter; left time: 64.1695s
	iters: 400, epoch: 4 | loss: 0.2205089
	speed: 0.0041s/iter; left time: 64.9688s
	iters: 500, epoch: 4 | loss: 0.1584362
	speed: 0.0041s/iter; left time: 63.9239s
	iters: 600, epoch: 4 | loss: 0.4142637
	speed: 0.0041s/iter; left time: 62.8849s
	iters: 700, epoch: 4 | loss: 0.2485572
	speed: 0.0041s/iter; left time: 63.4659s
	iters: 800, epoch: 4 | loss: 0.2489558
	speed: 0.0041s/iter; left time: 62.3603s
	iters: 900, epoch: 4 | loss: 0.6179442
	speed: 0.0045s/iter; left time: 68.2713s
	iters: 1000, epoch: 4 | loss: 0.1292540
	speed: 0.0044s/iter; left time: 65.7519s
	iters: 1100, epoch: 4 | loss: 0.3227643
	speed: 0.0042s/iter; left time: 62.4051s
	iters: 1200, epoch: 4 | loss: 0.1981130
	speed: 0.0040s/iter; left time: 59.5911s
	iters: 1300, epoch: 4 | loss: 0.3466538
	speed: 0.0038s/iter; left time: 55.9322s
	iters: 1400, epoch: 4 | loss: 0.1764964
	speed: 0.0044s/iter; left time: 64.0655s
	iters: 1500, epoch: 4 | loss: 0.3077411
	speed: 0.0044s/iter; left time: 64.7325s
	iters: 1600, epoch: 4 | loss: 0.3983293
	speed: 0.0046s/iter; left time: 65.9214s
	iters: 1700, epoch: 4 | loss: 0.2134717
	speed: 0.0044s/iter; left time: 62.6250s
	iters: 1800, epoch: 4 | loss: 0.2603595
	speed: 0.0040s/iter; left time: 57.1550s
	iters: 1900, epoch: 4 | loss: 0.2071315
	speed: 0.0039s/iter; left time: 55.8038s
	iters: 2000, epoch: 4 | loss: 0.2551269
	speed: 0.0039s/iter; left time: 55.4298s
	iters: 2100, epoch: 4 | loss: 0.6256205
	speed: 0.0040s/iter; left time: 55.7352s
	iters: 2200, epoch: 4 | loss: 0.5922574
	speed: 0.0039s/iter; left time: 54.3830s
Epoch: 4 cost time: 10.253222703933716
Epoch: 4, Steps: 2298 | Train Loss: 0.3729969 Vali Loss: 0.3372370 Test Loss: 0.1179598
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1669340
	speed: 0.0593s/iter; left time: 812.3606s
	iters: 200, epoch: 5 | loss: 1.6696485
	speed: 0.0039s/iter; left time: 52.9798s
	iters: 300, epoch: 5 | loss: 0.3632471
	speed: 0.0039s/iter; left time: 52.8545s
	iters: 400, epoch: 5 | loss: 0.1755130
	speed: 0.0039s/iter; left time: 52.4665s
	iters: 500, epoch: 5 | loss: 0.3520841
	speed: 0.0039s/iter; left time: 51.9103s
	iters: 600, epoch: 5 | loss: 0.2071322
	speed: 0.0039s/iter; left time: 51.4971s
	iters: 700, epoch: 5 | loss: 0.2559234
	speed: 0.0039s/iter; left time: 51.4494s
	iters: 800, epoch: 5 | loss: 0.2072738
	speed: 0.0040s/iter; left time: 51.6880s
	iters: 900, epoch: 5 | loss: 0.1388064
	speed: 0.0048s/iter; left time: 61.9725s
	iters: 1000, epoch: 5 | loss: 0.2038097
	speed: 0.0044s/iter; left time: 56.0273s
	iters: 1100, epoch: 5 | loss: 0.2645255
	speed: 0.0040s/iter; left time: 51.0636s
	iters: 1200, epoch: 5 | loss: 0.2977609
	speed: 0.0041s/iter; left time: 51.3560s
	iters: 1300, epoch: 5 | loss: 0.1354766
	speed: 0.0041s/iter; left time: 50.8165s
	iters: 1400, epoch: 5 | loss: 0.2327056
	speed: 0.0041s/iter; left time: 50.8156s
	iters: 1500, epoch: 5 | loss: 0.3437221
	speed: 0.0040s/iter; left time: 49.2229s
	iters: 1600, epoch: 5 | loss: 0.1518927
	speed: 0.0041s/iter; left time: 50.1149s
	iters: 1700, epoch: 5 | loss: 0.1622626
	speed: 0.0041s/iter; left time: 49.3962s
	iters: 1800, epoch: 5 | loss: 0.2500054
	speed: 0.0041s/iter; left time: 48.7998s
	iters: 1900, epoch: 5 | loss: 0.2139592
	speed: 0.0039s/iter; left time: 46.2017s
	iters: 2000, epoch: 5 | loss: 0.4210190
	speed: 0.0039s/iter; left time: 45.8911s
	iters: 2100, epoch: 5 | loss: 0.2683463
	speed: 0.0038s/iter; left time: 44.2958s
	iters: 2200, epoch: 5 | loss: 0.1883317
	speed: 0.0039s/iter; left time: 44.6274s
Epoch: 5 cost time: 10.134584903717041
Epoch: 5, Steps: 2298 | Train Loss: 0.3723667 Vali Loss: 0.3349821 Test Loss: 0.1170400
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1520069
	speed: 0.0576s/iter; left time: 656.6672s
	iters: 200, epoch: 6 | loss: 0.2287300
	speed: 0.0043s/iter; left time: 48.0100s
	iters: 300, epoch: 6 | loss: 0.1485581
	speed: 0.0040s/iter; left time: 44.7304s
	iters: 400, epoch: 6 | loss: 0.1596321
	speed: 0.0043s/iter; left time: 47.6107s
	iters: 500, epoch: 6 | loss: 0.2725113
	speed: 0.0041s/iter; left time: 44.8415s
	iters: 600, epoch: 6 | loss: 0.1318244
	speed: 0.0042s/iter; left time: 46.1204s
	iters: 700, epoch: 6 | loss: 0.1547546
	speed: 0.0041s/iter; left time: 44.4984s
	iters: 800, epoch: 6 | loss: 0.1883487
	speed: 0.0041s/iter; left time: 44.3536s
	iters: 900, epoch: 6 | loss: 0.2309215
	speed: 0.0043s/iter; left time: 45.4916s
	iters: 1000, epoch: 6 | loss: 0.3168132
	speed: 0.0047s/iter; left time: 49.6463s
	iters: 1100, epoch: 6 | loss: 0.2175458
	speed: 0.0042s/iter; left time: 43.6062s
	iters: 1200, epoch: 6 | loss: 1.1178569
	speed: 0.0040s/iter; left time: 41.0479s
	iters: 1300, epoch: 6 | loss: 0.3706712
	speed: 0.0040s/iter; left time: 40.6685s
	iters: 1400, epoch: 6 | loss: 0.2072665
	speed: 0.0039s/iter; left time: 39.3177s
	iters: 1500, epoch: 6 | loss: 0.2679904
	speed: 0.0039s/iter; left time: 39.3643s
	iters: 1600, epoch: 6 | loss: 0.2941099
	speed: 0.0039s/iter; left time: 38.5061s
	iters: 1700, epoch: 6 | loss: 0.1761825
	speed: 0.0041s/iter; left time: 40.3605s
	iters: 1800, epoch: 6 | loss: 0.1338401
	speed: 0.0040s/iter; left time: 38.3697s
	iters: 1900, epoch: 6 | loss: 0.3945765
	speed: 0.0041s/iter; left time: 39.1799s
	iters: 2000, epoch: 6 | loss: 0.2600622
	speed: 0.0039s/iter; left time: 37.1552s
	iters: 2100, epoch: 6 | loss: 0.2889568
	speed: 0.0040s/iter; left time: 37.5891s
	iters: 2200, epoch: 6 | loss: 0.6342341
	speed: 0.0039s/iter; left time: 36.4372s
Epoch: 6 cost time: 10.114929914474487
Epoch: 6, Steps: 2298 | Train Loss: 0.3693956 Vali Loss: 0.3361179 Test Loss: 0.1174409
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_96_24_NLinear_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.11832132190465927, mae:0.15460313856601715
