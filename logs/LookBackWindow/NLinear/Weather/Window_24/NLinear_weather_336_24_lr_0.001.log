Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='weather_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36528
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.7455518
	speed: 0.0107s/iter; left time: 243.9205s
	iters: 200, epoch: 1 | loss: 0.3091308
	speed: 0.0042s/iter; left time: 94.9657s
	iters: 300, epoch: 1 | loss: 1.0084683
	speed: 0.0042s/iter; left time: 94.5448s
	iters: 400, epoch: 1 | loss: 0.2445709
	speed: 0.0042s/iter; left time: 93.2994s
	iters: 500, epoch: 1 | loss: 0.2363650
	speed: 0.0039s/iter; left time: 88.1706s
	iters: 600, epoch: 1 | loss: 0.2833890
	speed: 0.0040s/iter; left time: 89.6256s
	iters: 700, epoch: 1 | loss: 0.2737278
	speed: 0.0041s/iter; left time: 89.6692s
	iters: 800, epoch: 1 | loss: 0.5354844
	speed: 0.0042s/iter; left time: 92.5654s
	iters: 900, epoch: 1 | loss: 0.1819921
	speed: 0.0042s/iter; left time: 91.2822s
	iters: 1000, epoch: 1 | loss: 0.1756510
	speed: 0.0041s/iter; left time: 89.7403s
	iters: 1100, epoch: 1 | loss: 0.2778604
	speed: 0.0041s/iter; left time: 88.4979s
	iters: 1200, epoch: 1 | loss: 0.4374273
	speed: 0.0054s/iter; left time: 116.7754s
	iters: 1300, epoch: 1 | loss: 0.2019441
	speed: 0.0052s/iter; left time: 112.6936s
	iters: 1400, epoch: 1 | loss: 0.2165232
	speed: 0.0040s/iter; left time: 86.0770s
	iters: 1500, epoch: 1 | loss: 0.3211973
	speed: 0.0042s/iter; left time: 90.4523s
	iters: 1600, epoch: 1 | loss: 0.2911075
	speed: 0.0044s/iter; left time: 93.9189s
	iters: 1700, epoch: 1 | loss: 6.8207364
	speed: 0.0044s/iter; left time: 93.3749s
	iters: 1800, epoch: 1 | loss: 0.1801198
	speed: 0.0042s/iter; left time: 89.1712s
	iters: 1900, epoch: 1 | loss: 0.1515342
	speed: 0.0042s/iter; left time: 88.7359s
	iters: 2000, epoch: 1 | loss: 0.2116874
	speed: 0.0043s/iter; left time: 89.3808s
	iters: 2100, epoch: 1 | loss: 0.2562593
	speed: 0.0041s/iter; left time: 85.0114s
	iters: 2200, epoch: 1 | loss: 0.2267517
	speed: 0.0038s/iter; left time: 79.1404s
Epoch: 1 cost time: 10.465370655059814
Epoch: 1, Steps: 2283 | Train Loss: 0.4133002 Vali Loss: 0.3204868 Test Loss: 0.1155482
Validation loss decreased (inf --> 0.320487).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 9.8734169
	speed: 0.0624s/iter; left time: 1275.6357s
	iters: 200, epoch: 2 | loss: 0.1917640
	speed: 0.0040s/iter; left time: 82.2642s
	iters: 300, epoch: 2 | loss: 0.4442973
	speed: 0.0040s/iter; left time: 81.5103s
	iters: 400, epoch: 2 | loss: 0.2709112
	speed: 0.0043s/iter; left time: 85.9706s
	iters: 500, epoch: 2 | loss: 0.1355735
	speed: 0.0041s/iter; left time: 82.4942s
	iters: 600, epoch: 2 | loss: 0.1656545
	speed: 0.0044s/iter; left time: 88.3882s
	iters: 700, epoch: 2 | loss: 0.1314697
	speed: 0.0042s/iter; left time: 83.4575s
	iters: 800, epoch: 2 | loss: 0.1786732
	speed: 0.0042s/iter; left time: 83.2481s
	iters: 900, epoch: 2 | loss: 0.1969928
	speed: 0.0043s/iter; left time: 84.8503s
	iters: 1000, epoch: 2 | loss: 0.2125893
	speed: 0.0041s/iter; left time: 80.5672s
	iters: 1100, epoch: 2 | loss: 0.2711506
	speed: 0.0046s/iter; left time: 90.3825s
	iters: 1200, epoch: 2 | loss: 0.1090928
	speed: 0.0056s/iter; left time: 107.6215s
	iters: 1300, epoch: 2 | loss: 0.2238317
	speed: 0.0044s/iter; left time: 85.3316s
	iters: 1400, epoch: 2 | loss: 0.2361808
	speed: 0.0041s/iter; left time: 79.1529s
	iters: 1500, epoch: 2 | loss: 0.1279770
	speed: 0.0041s/iter; left time: 78.6223s
	iters: 1600, epoch: 2 | loss: 0.1223442
	speed: 0.0044s/iter; left time: 83.5923s
	iters: 1700, epoch: 2 | loss: 0.1820282
	speed: 0.0045s/iter; left time: 84.5532s
	iters: 1800, epoch: 2 | loss: 0.1801283
	speed: 0.0046s/iter; left time: 85.6622s
	iters: 1900, epoch: 2 | loss: 0.2832566
	speed: 0.0043s/iter; left time: 79.3762s
	iters: 2000, epoch: 2 | loss: 0.2438777
	speed: 0.0045s/iter; left time: 83.3099s
	iters: 2100, epoch: 2 | loss: 0.3637072
	speed: 0.0045s/iter; left time: 82.2708s
	iters: 2200, epoch: 2 | loss: 0.1102995
	speed: 0.0040s/iter; left time: 73.2878s
Epoch: 2 cost time: 10.78774380683899
Epoch: 2, Steps: 2283 | Train Loss: 0.4424446 Vali Loss: 0.2918508 Test Loss: 0.1055215
Validation loss decreased (0.320487 --> 0.291851).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4546645
	speed: 0.0628s/iter; left time: 1140.8496s
	iters: 200, epoch: 3 | loss: 0.1311752
	speed: 0.0044s/iter; left time: 79.3081s
	iters: 300, epoch: 3 | loss: 0.3560984
	speed: 0.0043s/iter; left time: 77.4363s
	iters: 400, epoch: 3 | loss: 0.3344169
	speed: 0.0043s/iter; left time: 77.5706s
	iters: 500, epoch: 3 | loss: 0.1482642
	speed: 0.0041s/iter; left time: 72.7155s
	iters: 600, epoch: 3 | loss: 0.1718097
	speed: 0.0039s/iter; left time: 69.1787s
	iters: 700, epoch: 3 | loss: 0.2733178
	speed: 0.0043s/iter; left time: 75.3443s
	iters: 800, epoch: 3 | loss: 0.2537183
	speed: 0.0043s/iter; left time: 75.8885s
	iters: 900, epoch: 3 | loss: 0.1308129
	speed: 0.0042s/iter; left time: 73.6684s
	iters: 1000, epoch: 3 | loss: 0.2982512
	speed: 0.0046s/iter; left time: 78.6681s
	iters: 1100, epoch: 3 | loss: 0.1381237
	speed: 0.0047s/iter; left time: 80.7607s
	iters: 1200, epoch: 3 | loss: 0.2760792
	speed: 0.0044s/iter; left time: 75.8431s
	iters: 1300, epoch: 3 | loss: 0.2853048
	speed: 0.0043s/iter; left time: 72.3737s
	iters: 1400, epoch: 3 | loss: 0.2297488
	speed: 0.0044s/iter; left time: 74.1790s
	iters: 1500, epoch: 3 | loss: 0.4399143
	speed: 0.0046s/iter; left time: 77.1214s
	iters: 1600, epoch: 3 | loss: 0.2249405
	speed: 0.0043s/iter; left time: 71.4933s
	iters: 1700, epoch: 3 | loss: 0.1740532
	speed: 0.0042s/iter; left time: 68.9110s
	iters: 1800, epoch: 3 | loss: 0.2634423
	speed: 0.0043s/iter; left time: 71.2561s
	iters: 1900, epoch: 3 | loss: 0.1514420
	speed: 0.0052s/iter; left time: 84.9221s
	iters: 2000, epoch: 3 | loss: 0.1587182
	speed: 0.0046s/iter; left time: 75.4790s
	iters: 2100, epoch: 3 | loss: 0.2264948
	speed: 0.0048s/iter; left time: 76.9295s
	iters: 2200, epoch: 3 | loss: 0.1986876
	speed: 0.0044s/iter; left time: 71.0146s
Epoch: 3 cost time: 10.797608375549316
Epoch: 3, Steps: 2283 | Train Loss: 0.4031745 Vali Loss: 0.3086949 Test Loss: 0.1121280
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1921299
	speed: 0.0606s/iter; left time: 962.1194s
	iters: 200, epoch: 4 | loss: 0.1437795
	speed: 0.0039s/iter; left time: 60.8497s
	iters: 300, epoch: 4 | loss: 0.3167016
	speed: 0.0040s/iter; left time: 62.1829s
	iters: 400, epoch: 4 | loss: 0.1790167
	speed: 0.0039s/iter; left time: 61.5484s
	iters: 500, epoch: 4 | loss: 0.7564215
	speed: 0.0043s/iter; left time: 66.7434s
	iters: 600, epoch: 4 | loss: 0.2318429
	speed: 0.0044s/iter; left time: 67.9102s
	iters: 700, epoch: 4 | loss: 0.1154473
	speed: 0.0043s/iter; left time: 66.4144s
	iters: 800, epoch: 4 | loss: 0.2383889
	speed: 0.0043s/iter; left time: 64.9386s
	iters: 900, epoch: 4 | loss: 0.0792364
	speed: 0.0043s/iter; left time: 64.4504s
	iters: 1000, epoch: 4 | loss: 0.2307579
	speed: 0.0044s/iter; left time: 65.2276s
	iters: 1100, epoch: 4 | loss: 0.2572932
	speed: 0.0044s/iter; left time: 65.0761s
	iters: 1200, epoch: 4 | loss: 0.1485428
	speed: 0.0048s/iter; left time: 70.4542s
	iters: 1300, epoch: 4 | loss: 0.2157122
	speed: 0.0044s/iter; left time: 64.4157s
	iters: 1400, epoch: 4 | loss: 0.1174002
	speed: 0.0041s/iter; left time: 60.2198s
	iters: 1500, epoch: 4 | loss: 0.7474023
	speed: 0.0041s/iter; left time: 59.2498s
	iters: 1600, epoch: 4 | loss: 0.1081982
	speed: 0.0040s/iter; left time: 57.9408s
	iters: 1700, epoch: 4 | loss: 0.2792584
	speed: 0.0042s/iter; left time: 60.0229s
	iters: 1800, epoch: 4 | loss: 0.2119461
	speed: 0.0042s/iter; left time: 59.3679s
	iters: 1900, epoch: 4 | loss: 0.1171286
	speed: 0.0041s/iter; left time: 57.0711s
	iters: 2000, epoch: 4 | loss: 0.4379841
	speed: 0.0040s/iter; left time: 55.4753s
	iters: 2100, epoch: 4 | loss: 0.2933680
	speed: 0.0042s/iter; left time: 57.8720s
	iters: 2200, epoch: 4 | loss: 0.6828182
	speed: 0.0042s/iter; left time: 57.9149s
Epoch: 4 cost time: 10.343870162963867
Epoch: 4, Steps: 2283 | Train Loss: 0.3498992 Vali Loss: 0.2927770 Test Loss: 0.1040813
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1701839
	speed: 0.0639s/iter; left time: 868.9299s
	iters: 200, epoch: 5 | loss: 0.3583337
	speed: 0.0043s/iter; left time: 58.0117s
	iters: 300, epoch: 5 | loss: 0.1499137
	speed: 0.0041s/iter; left time: 55.4317s
	iters: 400, epoch: 5 | loss: 0.1854583
	speed: 0.0040s/iter; left time: 52.9795s
	iters: 500, epoch: 5 | loss: 0.3703156
	speed: 0.0042s/iter; left time: 55.4672s
	iters: 600, epoch: 5 | loss: 0.4056102
	speed: 0.0041s/iter; left time: 53.8394s
	iters: 700, epoch: 5 | loss: 0.1512011
	speed: 0.0041s/iter; left time: 52.7962s
	iters: 800, epoch: 5 | loss: 0.5379669
	speed: 0.0041s/iter; left time: 53.4369s
	iters: 900, epoch: 5 | loss: 0.2277109
	speed: 0.0042s/iter; left time: 54.3775s
	iters: 1000, epoch: 5 | loss: 0.1303542
	speed: 0.0042s/iter; left time: 53.5086s
	iters: 1100, epoch: 5 | loss: 0.3132812
	speed: 0.0042s/iter; left time: 52.3072s
	iters: 1200, epoch: 5 | loss: 0.0798585
	speed: 0.0041s/iter; left time: 51.8511s
	iters: 1300, epoch: 5 | loss: 0.1545932
	speed: 0.0040s/iter; left time: 49.7569s
	iters: 1400, epoch: 5 | loss: 0.1569724
	speed: 0.0042s/iter; left time: 51.8919s
	iters: 1500, epoch: 5 | loss: 0.1348194
	speed: 0.0040s/iter; left time: 48.9358s
	iters: 1600, epoch: 5 | loss: 0.2777376
	speed: 0.0040s/iter; left time: 49.0003s
	iters: 1700, epoch: 5 | loss: 0.1724826
	speed: 0.0043s/iter; left time: 51.1847s
	iters: 1800, epoch: 5 | loss: 0.3968192
	speed: 0.0041s/iter; left time: 48.2084s
	iters: 1900, epoch: 5 | loss: 0.2802361
	speed: 0.0042s/iter; left time: 49.2861s
	iters: 2000, epoch: 5 | loss: 0.3394321
	speed: 0.0042s/iter; left time: 48.6666s
	iters: 2100, epoch: 5 | loss: 0.1958569
	speed: 0.0041s/iter; left time: 48.0423s
	iters: 2200, epoch: 5 | loss: 0.7396836
	speed: 0.0047s/iter; left time: 54.1364s
Epoch: 5 cost time: 10.305446863174438
Epoch: 5, Steps: 2283 | Train Loss: 0.3372802 Vali Loss: 0.2926991 Test Loss: 0.1032433
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_24_NLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.10562875121831894, mae:0.1453014612197876
