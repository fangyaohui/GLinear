Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_96_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_96_24_NLinear_ETTh1_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8521
val 2857
test 2857
	iters: 100, epoch: 1 | loss: 0.2759369
	speed: 0.0104s/iter; left time: 109.6413s
	iters: 200, epoch: 1 | loss: 0.2847885
	speed: 0.0037s/iter; left time: 38.4385s
	iters: 300, epoch: 1 | loss: 0.3536670
	speed: 0.0037s/iter; left time: 38.3981s
	iters: 400, epoch: 1 | loss: 0.2066539
	speed: 0.0037s/iter; left time: 37.6704s
	iters: 500, epoch: 1 | loss: 0.3118033
	speed: 0.0036s/iter; left time: 36.7423s
	iters: 600, epoch: 1 | loss: 0.2241489
	speed: 0.0036s/iter; left time: 36.5359s
	iters: 700, epoch: 1 | loss: 0.2383088
	speed: 0.0036s/iter; left time: 36.2239s
	iters: 800, epoch: 1 | loss: 0.2763487
	speed: 0.0037s/iter; left time: 36.2923s
	iters: 900, epoch: 1 | loss: 0.3210092
	speed: 0.0036s/iter; left time: 35.5420s
	iters: 1000, epoch: 1 | loss: 0.2261957
	speed: 0.0037s/iter; left time: 35.4407s
Epoch: 1 cost time: 4.674283504486084
Epoch: 1, Steps: 1065 | Train Loss: 0.3071252 Vali Loss: 0.4151574 Test Loss: 0.3220906
Validation loss decreased (inf --> 0.415157).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3686325
	speed: 0.0474s/iter; left time: 449.7266s
	iters: 200, epoch: 2 | loss: 0.3276632
	speed: 0.0040s/iter; left time: 37.1058s
	iters: 300, epoch: 2 | loss: 0.2300431
	speed: 0.0040s/iter; left time: 37.1095s
	iters: 400, epoch: 2 | loss: 0.4117309
	speed: 0.0038s/iter; left time: 34.9256s
	iters: 500, epoch: 2 | loss: 0.2483721
	speed: 0.0036s/iter; left time: 33.0149s
	iters: 600, epoch: 2 | loss: 0.3433712
	speed: 0.0036s/iter; left time: 32.0991s
	iters: 700, epoch: 2 | loss: 0.2435526
	speed: 0.0036s/iter; left time: 32.0698s
	iters: 800, epoch: 2 | loss: 0.2554422
	speed: 0.0037s/iter; left time: 32.2139s
	iters: 900, epoch: 2 | loss: 0.2940850
	speed: 0.0037s/iter; left time: 31.8953s
	iters: 1000, epoch: 2 | loss: 0.3347863
	speed: 0.0037s/iter; left time: 31.5158s
Epoch: 2 cost time: 4.71173095703125
Epoch: 2, Steps: 1065 | Train Loss: 0.2801661 Vali Loss: 0.4306270 Test Loss: 0.3154237
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4027992
	speed: 0.0469s/iter; left time: 394.7882s
	iters: 200, epoch: 3 | loss: 0.2162293
	speed: 0.0037s/iter; left time: 30.4214s
	iters: 300, epoch: 3 | loss: 0.2457949
	speed: 0.0037s/iter; left time: 30.4145s
	iters: 400, epoch: 3 | loss: 0.2162681
	speed: 0.0037s/iter; left time: 29.7717s
	iters: 500, epoch: 3 | loss: 0.2719106
	speed: 0.0037s/iter; left time: 29.7229s
	iters: 600, epoch: 3 | loss: 0.2416836
	speed: 0.0037s/iter; left time: 29.4496s
	iters: 700, epoch: 3 | loss: 0.2880288
	speed: 0.0037s/iter; left time: 29.2229s
	iters: 800, epoch: 3 | loss: 0.1896795
	speed: 0.0037s/iter; left time: 28.1948s
	iters: 900, epoch: 3 | loss: 0.2606160
	speed: 0.0037s/iter; left time: 28.2400s
	iters: 1000, epoch: 3 | loss: 0.3155977
	speed: 0.0037s/iter; left time: 27.5663s
Epoch: 3 cost time: 4.64085841178894
Epoch: 3, Steps: 1065 | Train Loss: 0.2752956 Vali Loss: 0.4107449 Test Loss: 0.3108890
Validation loss decreased (0.415157 --> 0.410745).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3422720
	speed: 0.0468s/iter; left time: 344.3511s
	iters: 200, epoch: 4 | loss: 0.2290166
	speed: 0.0037s/iter; left time: 27.1978s
	iters: 300, epoch: 4 | loss: 0.2374952
	speed: 0.0037s/iter; left time: 26.1257s
	iters: 400, epoch: 4 | loss: 0.4267648
	speed: 0.0036s/iter; left time: 25.3329s
	iters: 500, epoch: 4 | loss: 0.2558278
	speed: 0.0036s/iter; left time: 25.1330s
	iters: 600, epoch: 4 | loss: 0.2943771
	speed: 0.0036s/iter; left time: 25.0197s
	iters: 700, epoch: 4 | loss: 0.2791849
	speed: 0.0037s/iter; left time: 24.8837s
	iters: 800, epoch: 4 | loss: 0.2076251
	speed: 0.0039s/iter; left time: 25.7660s
	iters: 900, epoch: 4 | loss: 0.2178356
	speed: 0.0037s/iter; left time: 24.1992s
	iters: 1000, epoch: 4 | loss: 0.2897972
	speed: 0.0038s/iter; left time: 24.5020s
Epoch: 4 cost time: 4.6867311000823975
Epoch: 4, Steps: 1065 | Train Loss: 0.2731720 Vali Loss: 0.4089622 Test Loss: 0.3106532
Validation loss decreased (0.410745 --> 0.408962).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2763378
	speed: 0.0468s/iter; left time: 294.6510s
	iters: 200, epoch: 5 | loss: 0.1888393
	speed: 0.0037s/iter; left time: 22.8176s
	iters: 300, epoch: 5 | loss: 0.2803392
	speed: 0.0037s/iter; left time: 22.5586s
	iters: 400, epoch: 5 | loss: 0.2743320
	speed: 0.0037s/iter; left time: 22.3467s
	iters: 500, epoch: 5 | loss: 0.2031507
	speed: 0.0037s/iter; left time: 22.0036s
	iters: 600, epoch: 5 | loss: 0.2895200
	speed: 0.0037s/iter; left time: 21.2138s
	iters: 700, epoch: 5 | loss: 0.2538325
	speed: 0.0037s/iter; left time: 20.7741s
	iters: 800, epoch: 5 | loss: 0.3474695
	speed: 0.0038s/iter; left time: 21.1437s
	iters: 900, epoch: 5 | loss: 0.4398095
	speed: 0.0037s/iter; left time: 20.1161s
	iters: 1000, epoch: 5 | loss: 0.3222458
	speed: 0.0038s/iter; left time: 20.2250s
Epoch: 5 cost time: 4.627224445343018
Epoch: 5, Steps: 1065 | Train Loss: 0.2722266 Vali Loss: 0.4007590 Test Loss: 0.3112177
Validation loss decreased (0.408962 --> 0.400759).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2489696
	speed: 0.0469s/iter; left time: 244.9789s
	iters: 200, epoch: 6 | loss: 0.2960997
	speed: 0.0037s/iter; left time: 18.9330s
	iters: 300, epoch: 6 | loss: 0.2593467
	speed: 0.0037s/iter; left time: 18.5180s
	iters: 400, epoch: 6 | loss: 0.2423562
	speed: 0.0037s/iter; left time: 18.1964s
	iters: 500, epoch: 6 | loss: 0.3464511
	speed: 0.0037s/iter; left time: 17.6392s
	iters: 600, epoch: 6 | loss: 0.2665718
	speed: 0.0037s/iter; left time: 17.2856s
	iters: 700, epoch: 6 | loss: 0.2309761
	speed: 0.0037s/iter; left time: 17.0026s
	iters: 800, epoch: 6 | loss: 0.2701044
	speed: 0.0036s/iter; left time: 16.4881s
	iters: 900, epoch: 6 | loss: 0.2585514
	speed: 0.0037s/iter; left time: 16.2229s
	iters: 1000, epoch: 6 | loss: 0.2977230
	speed: 0.0037s/iter; left time: 16.0219s
Epoch: 6 cost time: 4.6843414306640625
Epoch: 6, Steps: 1065 | Train Loss: 0.2716962 Vali Loss: 0.4008694 Test Loss: 0.3104677
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4939099
	speed: 0.0470s/iter; left time: 195.4681s
	iters: 200, epoch: 7 | loss: 0.2028113
	speed: 0.0038s/iter; left time: 15.4738s
	iters: 300, epoch: 7 | loss: 0.2010142
	speed: 0.0035s/iter; left time: 14.0415s
	iters: 400, epoch: 7 | loss: 0.2258050
	speed: 0.0035s/iter; left time: 13.6012s
	iters: 500, epoch: 7 | loss: 0.2646854
	speed: 0.0035s/iter; left time: 13.2152s
	iters: 600, epoch: 7 | loss: 0.2879853
	speed: 0.0036s/iter; left time: 13.0073s
	iters: 700, epoch: 7 | loss: 0.1753104
	speed: 0.0036s/iter; left time: 12.7785s
	iters: 800, epoch: 7 | loss: 0.2881876
	speed: 0.0036s/iter; left time: 12.3002s
	iters: 900, epoch: 7 | loss: 0.2335147
	speed: 0.0036s/iter; left time: 12.0137s
	iters: 1000, epoch: 7 | loss: 0.2248227
	speed: 0.0037s/iter; left time: 11.9541s
Epoch: 7 cost time: 4.6058361530303955
Epoch: 7, Steps: 1065 | Train Loss: 0.2713482 Vali Loss: 0.4019107 Test Loss: 0.3100521
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2442664
	speed: 0.0479s/iter; left time: 148.4029s
	iters: 200, epoch: 8 | loss: 0.2479544
	speed: 0.0039s/iter; left time: 11.5961s
	iters: 300, epoch: 8 | loss: 0.2934215
	speed: 0.0037s/iter; left time: 10.8351s
	iters: 400, epoch: 8 | loss: 0.2207763
	speed: 0.0038s/iter; left time: 10.5737s
	iters: 500, epoch: 8 | loss: 0.3142017
	speed: 0.0037s/iter; left time: 10.0738s
	iters: 600, epoch: 8 | loss: 0.1901041
	speed: 0.0038s/iter; left time: 9.8706s
	iters: 700, epoch: 8 | loss: 0.2989322
	speed: 0.0037s/iter; left time: 9.3065s
	iters: 800, epoch: 8 | loss: 0.4319983
	speed: 0.0038s/iter; left time: 9.1971s
	iters: 900, epoch: 8 | loss: 0.3425929
	speed: 0.0037s/iter; left time: 8.5881s
	iters: 1000, epoch: 8 | loss: 0.2326888
	speed: 0.0038s/iter; left time: 8.3151s
Epoch: 8 cost time: 4.723648309707642
Epoch: 8, Steps: 1065 | Train Loss: 0.2712497 Vali Loss: 0.3995903 Test Loss: 0.3108956
Validation loss decreased (0.400759 --> 0.399590).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.5584485
	speed: 0.0477s/iter; left time: 96.8025s
	iters: 200, epoch: 9 | loss: 0.3646651
	speed: 0.0037s/iter; left time: 7.1106s
	iters: 300, epoch: 9 | loss: 0.3851544
	speed: 0.0040s/iter; left time: 7.3720s
	iters: 400, epoch: 9 | loss: 0.1599093
	speed: 0.0039s/iter; left time: 6.6742s
	iters: 500, epoch: 9 | loss: 0.2698846
	speed: 0.0036s/iter; left time: 5.8664s
	iters: 600, epoch: 9 | loss: 0.2306320
	speed: 0.0036s/iter; left time: 5.5468s
	iters: 700, epoch: 9 | loss: 0.3743302
	speed: 0.0034s/iter; left time: 4.8880s
	iters: 800, epoch: 9 | loss: 0.2293660
	speed: 0.0037s/iter; left time: 4.9038s
	iters: 900, epoch: 9 | loss: 0.2434773
	speed: 0.0041s/iter; left time: 4.9878s
	iters: 1000, epoch: 9 | loss: 0.2591672
	speed: 0.0042s/iter; left time: 4.7062s
Epoch: 9 cost time: 4.8551552295684814
Epoch: 9, Steps: 1065 | Train Loss: 0.2712261 Vali Loss: 0.4004126 Test Loss: 0.3104327
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2563236
	speed: 0.0485s/iter; left time: 46.8396s
	iters: 200, epoch: 10 | loss: 0.3759415
	speed: 0.0038s/iter; left time: 3.2637s
	iters: 300, epoch: 10 | loss: 0.8399725
	speed: 0.0037s/iter; left time: 2.8482s
	iters: 400, epoch: 10 | loss: 0.2180259
	speed: 0.0037s/iter; left time: 2.4838s
	iters: 500, epoch: 10 | loss: 0.4017019
	speed: 0.0038s/iter; left time: 2.1646s
	iters: 600, epoch: 10 | loss: 0.3099988
	speed: 0.0036s/iter; left time: 1.6938s
	iters: 700, epoch: 10 | loss: 0.3515218
	speed: 0.0037s/iter; left time: 1.3399s
	iters: 800, epoch: 10 | loss: 0.2347961
	speed: 0.0037s/iter; left time: 0.9743s
	iters: 900, epoch: 10 | loss: 0.2468591
	speed: 0.0036s/iter; left time: 0.6041s
	iters: 1000, epoch: 10 | loss: 0.2616310
	speed: 0.0037s/iter; left time: 0.2412s
Epoch: 10 cost time: 4.629700422286987
Epoch: 10, Steps: 1065 | Train Loss: 0.2711461 Vali Loss: 0.4004828 Test Loss: 0.3104512
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : ETTh1_96_24_NLinear_ETTh1_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2857
mse:0.31145626306533813, mae:0.3523472845554352
