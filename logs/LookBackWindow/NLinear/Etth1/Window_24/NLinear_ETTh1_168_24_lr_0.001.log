Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_168_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=168, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_168_24_NLinear_ETTh1_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2857
test 2857
	iters: 100, epoch: 1 | loss: 0.2726821
	speed: 0.0095s/iter; left time: 99.0955s
	iters: 200, epoch: 1 | loss: 0.3172058
	speed: 0.0037s/iter; left time: 38.4912s
	iters: 300, epoch: 1 | loss: 0.2871008
	speed: 0.0038s/iter; left time: 38.6444s
	iters: 400, epoch: 1 | loss: 0.2996210
	speed: 0.0038s/iter; left time: 38.3099s
	iters: 500, epoch: 1 | loss: 0.3992826
	speed: 0.0037s/iter; left time: 37.7277s
	iters: 600, epoch: 1 | loss: 0.2994756
	speed: 0.0038s/iter; left time: 37.4263s
	iters: 700, epoch: 1 | loss: 0.2760862
	speed: 0.0038s/iter; left time: 37.0409s
	iters: 800, epoch: 1 | loss: 0.3696369
	speed: 0.0038s/iter; left time: 36.9118s
	iters: 900, epoch: 1 | loss: 0.2216153
	speed: 0.0037s/iter; left time: 35.8653s
	iters: 1000, epoch: 1 | loss: 0.1650861
	speed: 0.0037s/iter; left time: 34.9299s
Epoch: 1 cost time: 4.663110971450806
Epoch: 1, Steps: 1056 | Train Loss: 0.3030589 Vali Loss: 0.4138634 Test Loss: 0.3309033
Validation loss decreased (inf --> 0.413863).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4370871
	speed: 0.0482s/iter; left time: 453.4308s
	iters: 200, epoch: 2 | loss: 0.2027038
	speed: 0.0038s/iter; left time: 35.6668s
	iters: 300, epoch: 2 | loss: 0.3473205
	speed: 0.0038s/iter; left time: 35.0559s
	iters: 400, epoch: 2 | loss: 0.2315045
	speed: 0.0043s/iter; left time: 39.5409s
	iters: 500, epoch: 2 | loss: 0.2845357
	speed: 0.0040s/iter; left time: 35.9665s
	iters: 600, epoch: 2 | loss: 0.3883251
	speed: 0.0039s/iter; left time: 34.3896s
	iters: 700, epoch: 2 | loss: 0.2293024
	speed: 0.0038s/iter; left time: 33.2665s
	iters: 800, epoch: 2 | loss: 0.2584575
	speed: 0.0038s/iter; left time: 32.9000s
	iters: 900, epoch: 2 | loss: 0.2074595
	speed: 0.0038s/iter; left time: 32.5322s
	iters: 1000, epoch: 2 | loss: 0.2923428
	speed: 0.0038s/iter; left time: 32.1452s
Epoch: 2 cost time: 4.774832725524902
Epoch: 2, Steps: 1056 | Train Loss: 0.2757646 Vali Loss: 0.4505478 Test Loss: 0.3281380
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2265875
	speed: 0.0458s/iter; left time: 382.6248s
	iters: 200, epoch: 3 | loss: 0.2205130
	speed: 0.0039s/iter; left time: 31.9252s
	iters: 300, epoch: 3 | loss: 0.2087296
	speed: 0.0039s/iter; left time: 31.4864s
	iters: 400, epoch: 3 | loss: 0.3049495
	speed: 0.0039s/iter; left time: 31.0547s
	iters: 500, epoch: 3 | loss: 0.1863757
	speed: 0.0038s/iter; left time: 30.5311s
	iters: 600, epoch: 3 | loss: 0.4213557
	speed: 0.0039s/iter; left time: 30.4464s
	iters: 700, epoch: 3 | loss: 0.2111318
	speed: 0.0039s/iter; left time: 29.9048s
	iters: 800, epoch: 3 | loss: 0.3017681
	speed: 0.0038s/iter; left time: 29.4301s
	iters: 900, epoch: 3 | loss: 0.3694900
	speed: 0.0040s/iter; left time: 29.9788s
	iters: 1000, epoch: 3 | loss: 0.2369934
	speed: 0.0043s/iter; left time: 31.8517s
Epoch: 3 cost time: 4.797521591186523
Epoch: 3, Steps: 1056 | Train Loss: 0.2683203 Vali Loss: 0.4154814 Test Loss: 0.3178958
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3242432
	speed: 0.0452s/iter; left time: 329.8632s
	iters: 200, epoch: 4 | loss: 0.2706515
	speed: 0.0040s/iter; left time: 28.5495s
	iters: 300, epoch: 4 | loss: 0.1863212
	speed: 0.0043s/iter; left time: 30.3255s
	iters: 400, epoch: 4 | loss: 0.2686978
	speed: 0.0038s/iter; left time: 26.3136s
	iters: 500, epoch: 4 | loss: 0.2792851
	speed: 0.0038s/iter; left time: 26.2458s
	iters: 600, epoch: 4 | loss: 0.2582672
	speed: 0.0037s/iter; left time: 25.3272s
	iters: 700, epoch: 4 | loss: 0.1847018
	speed: 0.0037s/iter; left time: 25.0917s
	iters: 800, epoch: 4 | loss: 0.1947159
	speed: 0.0038s/iter; left time: 24.8443s
	iters: 900, epoch: 4 | loss: 0.2944112
	speed: 0.0044s/iter; left time: 28.4466s
	iters: 1000, epoch: 4 | loss: 0.1871469
	speed: 0.0037s/iter; left time: 23.8517s
Epoch: 4 cost time: 4.798844337463379
Epoch: 4, Steps: 1056 | Train Loss: 0.2656261 Vali Loss: 0.4047714 Test Loss: 0.3161802
Validation loss decreased (0.413863 --> 0.404771).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2606107
	speed: 0.0482s/iter; left time: 300.7910s
	iters: 200, epoch: 5 | loss: 0.2676685
	speed: 0.0039s/iter; left time: 23.8336s
	iters: 300, epoch: 5 | loss: 0.2168409
	speed: 0.0039s/iter; left time: 23.8423s
	iters: 400, epoch: 5 | loss: 0.4034808
	speed: 0.0041s/iter; left time: 24.2084s
	iters: 500, epoch: 5 | loss: 0.2342693
	speed: 0.0040s/iter; left time: 23.6361s
	iters: 600, epoch: 5 | loss: 0.2686441
	speed: 0.0040s/iter; left time: 23.2193s
	iters: 700, epoch: 5 | loss: 0.2174845
	speed: 0.0042s/iter; left time: 23.6045s
	iters: 800, epoch: 5 | loss: 0.2437375
	speed: 0.0038s/iter; left time: 20.9661s
	iters: 900, epoch: 5 | loss: 0.3147059
	speed: 0.0036s/iter; left time: 19.6075s
	iters: 1000, epoch: 5 | loss: 0.2326394
	speed: 0.0036s/iter; left time: 19.2835s
Epoch: 5 cost time: 4.851589679718018
Epoch: 5, Steps: 1056 | Train Loss: 0.2639623 Vali Loss: 0.4121960 Test Loss: 0.3135918
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3226284
	speed: 0.0496s/iter; left time: 256.8773s
	iters: 200, epoch: 6 | loss: 0.2420094
	speed: 0.0038s/iter; left time: 19.2571s
	iters: 300, epoch: 6 | loss: 0.2890581
	speed: 0.0038s/iter; left time: 19.0509s
	iters: 400, epoch: 6 | loss: 0.2485799
	speed: 0.0038s/iter; left time: 18.3809s
	iters: 500, epoch: 6 | loss: 0.2352199
	speed: 0.0038s/iter; left time: 18.2683s
	iters: 600, epoch: 6 | loss: 0.5369489
	speed: 0.0038s/iter; left time: 17.6826s
	iters: 700, epoch: 6 | loss: 0.2214877
	speed: 0.0038s/iter; left time: 17.2474s
	iters: 800, epoch: 6 | loss: 0.3365737
	speed: 0.0038s/iter; left time: 17.2428s
	iters: 900, epoch: 6 | loss: 0.3165742
	speed: 0.0038s/iter; left time: 16.6977s
	iters: 1000, epoch: 6 | loss: 0.1962874
	speed: 0.0039s/iter; left time: 16.5563s
Epoch: 6 cost time: 4.730732440948486
Epoch: 6, Steps: 1056 | Train Loss: 0.2632633 Vali Loss: 0.4028409 Test Loss: 0.3154788
Validation loss decreased (0.404771 --> 0.402841).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2321949
	speed: 0.0471s/iter; left time: 194.4425s
	iters: 200, epoch: 7 | loss: 0.2496094
	speed: 0.0039s/iter; left time: 15.7213s
	iters: 300, epoch: 7 | loss: 0.2010127
	speed: 0.0040s/iter; left time: 15.8724s
	iters: 400, epoch: 7 | loss: 0.3435163
	speed: 0.0039s/iter; left time: 15.0503s
	iters: 500, epoch: 7 | loss: 0.4286566
	speed: 0.0039s/iter; left time: 14.7003s
	iters: 600, epoch: 7 | loss: 0.2262452
	speed: 0.0038s/iter; left time: 13.7032s
	iters: 700, epoch: 7 | loss: 0.2978494
	speed: 0.0038s/iter; left time: 13.3320s
	iters: 800, epoch: 7 | loss: 0.1907841
	speed: 0.0038s/iter; left time: 12.9732s
	iters: 900, epoch: 7 | loss: 0.3798117
	speed: 0.0039s/iter; left time: 13.0804s
	iters: 1000, epoch: 7 | loss: 0.3729306
	speed: 0.0039s/iter; left time: 12.6304s
Epoch: 7 cost time: 4.818759441375732
Epoch: 7, Steps: 1056 | Train Loss: 0.2627929 Vali Loss: 0.4018643 Test Loss: 0.3164001
Validation loss decreased (0.402841 --> 0.401864).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2444266
	speed: 0.0474s/iter; left time: 145.4870s
	iters: 200, epoch: 8 | loss: 0.2272767
	speed: 0.0039s/iter; left time: 11.5325s
	iters: 300, epoch: 8 | loss: 0.4616340
	speed: 0.0038s/iter; left time: 10.8406s
	iters: 400, epoch: 8 | loss: 0.1999400
	speed: 0.0038s/iter; left time: 10.4368s
	iters: 500, epoch: 8 | loss: 0.4038066
	speed: 0.0040s/iter; left time: 10.6728s
	iters: 600, epoch: 8 | loss: 0.2110195
	speed: 0.0041s/iter; left time: 10.6148s
	iters: 700, epoch: 8 | loss: 0.1604035
	speed: 0.0039s/iter; left time: 9.6496s
	iters: 800, epoch: 8 | loss: 0.3364656
	speed: 0.0038s/iter; left time: 9.0315s
	iters: 900, epoch: 8 | loss: 0.2857717
	speed: 0.0041s/iter; left time: 9.2683s
	iters: 1000, epoch: 8 | loss: 0.3274454
	speed: 0.0039s/iter; left time: 8.5144s
Epoch: 8 cost time: 4.888319253921509
Epoch: 8, Steps: 1056 | Train Loss: 0.2626107 Vali Loss: 0.4047166 Test Loss: 0.3152141
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2147983
	speed: 0.0487s/iter; left time: 98.1317s
	iters: 200, epoch: 9 | loss: 0.3006052
	speed: 0.0039s/iter; left time: 7.5331s
	iters: 300, epoch: 9 | loss: 0.2356832
	speed: 0.0038s/iter; left time: 6.8493s
	iters: 400, epoch: 9 | loss: 0.1455246
	speed: 0.0038s/iter; left time: 6.4386s
	iters: 500, epoch: 9 | loss: 0.2796874
	speed: 0.0038s/iter; left time: 6.0989s
	iters: 600, epoch: 9 | loss: 0.2843266
	speed: 0.0037s/iter; left time: 5.6471s
	iters: 700, epoch: 9 | loss: 0.3469864
	speed: 0.0038s/iter; left time: 5.3342s
	iters: 800, epoch: 9 | loss: 0.2705124
	speed: 0.0037s/iter; left time: 4.8834s
	iters: 900, epoch: 9 | loss: 0.2028647
	speed: 0.0038s/iter; left time: 4.6211s
	iters: 1000, epoch: 9 | loss: 0.1590072
	speed: 0.0040s/iter; left time: 4.5032s
Epoch: 9 cost time: 4.76537823677063
Epoch: 9, Steps: 1056 | Train Loss: 0.2625063 Vali Loss: 0.4040898 Test Loss: 0.3151528
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3025057
	speed: 0.0467s/iter; left time: 44.7345s
	iters: 200, epoch: 10 | loss: 0.2727922
	speed: 0.0041s/iter; left time: 3.4943s
	iters: 300, epoch: 10 | loss: 0.2332790
	speed: 0.0039s/iter; left time: 2.9876s
	iters: 400, epoch: 10 | loss: 0.2192834
	speed: 0.0038s/iter; left time: 2.5054s
	iters: 500, epoch: 10 | loss: 0.2134867
	speed: 0.0038s/iter; left time: 2.1307s
	iters: 600, epoch: 10 | loss: 0.3156277
	speed: 0.0041s/iter; left time: 1.8657s
	iters: 700, epoch: 10 | loss: 0.2336892
	speed: 0.0041s/iter; left time: 1.4619s
	iters: 800, epoch: 10 | loss: 0.1570002
	speed: 0.0041s/iter; left time: 1.0419s
	iters: 900, epoch: 10 | loss: 0.2800179
	speed: 0.0039s/iter; left time: 0.6093s
	iters: 1000, epoch: 10 | loss: 0.3582123
	speed: 0.0039s/iter; left time: 0.2231s
Epoch: 10 cost time: 4.889055013656616
Epoch: 10, Steps: 1056 | Train Loss: 0.2624191 Vali Loss: 0.4036658 Test Loss: 0.3156900
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_168_24_NLinear_ETTh1_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2857
mse:0.3168777525424957, mae:0.35862118005752563
