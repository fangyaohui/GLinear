Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_720_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_720_24_NLinear_ETTh1_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7897
val 2857
test 2857
	iters: 100, epoch: 1 | loss: 0.4120286
	speed: 0.0102s/iter; left time: 99.4902s
	iters: 200, epoch: 1 | loss: 0.3590226
	speed: 0.0041s/iter; left time: 39.5951s
	iters: 300, epoch: 1 | loss: 0.2545369
	speed: 0.0047s/iter; left time: 45.2581s
	iters: 400, epoch: 1 | loss: 0.2679454
	speed: 0.0051s/iter; left time: 48.7561s
	iters: 500, epoch: 1 | loss: 0.2992768
	speed: 0.0042s/iter; left time: 39.8150s
	iters: 600, epoch: 1 | loss: 0.3439580
	speed: 0.0041s/iter; left time: 38.4040s
	iters: 700, epoch: 1 | loss: 0.2843747
	speed: 0.0042s/iter; left time: 38.7733s
	iters: 800, epoch: 1 | loss: 0.3928109
	speed: 0.0040s/iter; left time: 36.1596s
	iters: 900, epoch: 1 | loss: 0.3533091
	speed: 0.0038s/iter; left time: 33.8795s
Epoch: 1 cost time: 5.044229030609131
Epoch: 1, Steps: 987 | Train Loss: 0.3150510 Vali Loss: 0.4747070 Test Loss: 0.3772313
Validation loss decreased (inf --> 0.474707).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2340881
	speed: 0.0558s/iter; left time: 490.5206s
	iters: 200, epoch: 2 | loss: 0.2249892
	speed: 0.0037s/iter; left time: 32.3445s
	iters: 300, epoch: 2 | loss: 0.2372030
	speed: 0.0038s/iter; left time: 32.7031s
	iters: 400, epoch: 2 | loss: 0.2541621
	speed: 0.0039s/iter; left time: 32.8988s
	iters: 500, epoch: 2 | loss: 0.2320834
	speed: 0.0040s/iter; left time: 33.4685s
	iters: 600, epoch: 2 | loss: 0.1924108
	speed: 0.0038s/iter; left time: 31.5241s
	iters: 700, epoch: 2 | loss: 0.3148193
	speed: 0.0042s/iter; left time: 34.1310s
	iters: 800, epoch: 2 | loss: 0.2067664
	speed: 0.0050s/iter; left time: 40.7394s
	iters: 900, epoch: 2 | loss: 0.2918835
	speed: 0.0046s/iter; left time: 36.9640s
Epoch: 2 cost time: 4.9886486530303955
Epoch: 2, Steps: 987 | Train Loss: 0.2916790 Vali Loss: 0.4889376 Test Loss: 0.4095670
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2624165
	speed: 0.0541s/iter; left time: 421.9696s
	iters: 200, epoch: 3 | loss: 0.3377007
	speed: 0.0051s/iter; left time: 39.6327s
	iters: 300, epoch: 3 | loss: 0.2850968
	speed: 0.0042s/iter; left time: 32.1975s
	iters: 400, epoch: 3 | loss: 0.2632070
	speed: 0.0041s/iter; left time: 30.4236s
	iters: 500, epoch: 3 | loss: 0.2087021
	speed: 0.0039s/iter; left time: 29.1250s
	iters: 600, epoch: 3 | loss: 0.1756959
	speed: 0.0047s/iter; left time: 34.2005s
	iters: 700, epoch: 3 | loss: 0.3564165
	speed: 0.0038s/iter; left time: 27.2793s
	iters: 800, epoch: 3 | loss: 0.1873379
	speed: 0.0040s/iter; left time: 28.0526s
	iters: 900, epoch: 3 | loss: 0.2591155
	speed: 0.0039s/iter; left time: 27.5522s
Epoch: 3 cost time: 4.981854438781738
Epoch: 3, Steps: 987 | Train Loss: 0.2712473 Vali Loss: 0.4280151 Test Loss: 0.3435438
Validation loss decreased (0.474707 --> 0.428015).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2331877
	speed: 0.0604s/iter; left time: 411.4336s
	iters: 200, epoch: 4 | loss: 0.3064929
	speed: 0.0044s/iter; left time: 29.2813s
	iters: 300, epoch: 4 | loss: 0.3512414
	speed: 0.0047s/iter; left time: 31.3784s
	iters: 400, epoch: 4 | loss: 0.1843469
	speed: 0.0046s/iter; left time: 29.7850s
	iters: 500, epoch: 4 | loss: 0.2513943
	speed: 0.0042s/iter; left time: 26.8150s
	iters: 600, epoch: 4 | loss: 0.3054626
	speed: 0.0041s/iter; left time: 26.1489s
	iters: 700, epoch: 4 | loss: 0.1996248
	speed: 0.0044s/iter; left time: 27.5455s
	iters: 800, epoch: 4 | loss: 0.3116641
	speed: 0.0047s/iter; left time: 28.6893s
	iters: 900, epoch: 4 | loss: 0.2954955
	speed: 0.0049s/iter; left time: 29.5701s
Epoch: 4 cost time: 5.233745098114014
Epoch: 4, Steps: 987 | Train Loss: 0.2617067 Vali Loss: 0.4173580 Test Loss: 0.3241258
Validation loss decreased (0.428015 --> 0.417358).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3586714
	speed: 0.0583s/iter; left time: 339.6507s
	iters: 200, epoch: 5 | loss: 0.2951233
	speed: 0.0041s/iter; left time: 23.6448s
	iters: 300, epoch: 5 | loss: 0.2096565
	speed: 0.0043s/iter; left time: 23.9450s
	iters: 400, epoch: 5 | loss: 0.3452725
	speed: 0.0042s/iter; left time: 23.2186s
	iters: 500, epoch: 5 | loss: 0.2606303
	speed: 0.0042s/iter; left time: 22.7449s
	iters: 600, epoch: 5 | loss: 0.3006271
	speed: 0.0043s/iter; left time: 22.8313s
	iters: 700, epoch: 5 | loss: 0.2010629
	speed: 0.0039s/iter; left time: 20.3496s
	iters: 800, epoch: 5 | loss: 0.2807684
	speed: 0.0041s/iter; left time: 21.0409s
	iters: 900, epoch: 5 | loss: 0.2261918
	speed: 0.0042s/iter; left time: 21.2426s
Epoch: 5 cost time: 4.944526195526123
Epoch: 5, Steps: 987 | Train Loss: 0.2567143 Vali Loss: 0.4055670 Test Loss: 0.3258065
Validation loss decreased (0.417358 --> 0.405567).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2735802
	speed: 0.0555s/iter; left time: 268.4416s
	iters: 200, epoch: 6 | loss: 0.2221158
	speed: 0.0043s/iter; left time: 20.3203s
	iters: 300, epoch: 6 | loss: 0.2512513
	speed: 0.0043s/iter; left time: 20.0833s
	iters: 400, epoch: 6 | loss: 0.1968519
	speed: 0.0044s/iter; left time: 19.9721s
	iters: 500, epoch: 6 | loss: 0.1762413
	speed: 0.0041s/iter; left time: 17.9980s
	iters: 600, epoch: 6 | loss: 0.2373308
	speed: 0.0044s/iter; left time: 19.0331s
	iters: 700, epoch: 6 | loss: 0.2040359
	speed: 0.0040s/iter; left time: 17.1294s
	iters: 800, epoch: 6 | loss: 0.2591821
	speed: 0.0041s/iter; left time: 16.7516s
	iters: 900, epoch: 6 | loss: 0.1871812
	speed: 0.0042s/iter; left time: 17.0347s
Epoch: 6 cost time: 5.03113579750061
Epoch: 6, Steps: 987 | Train Loss: 0.2534464 Vali Loss: 0.4087906 Test Loss: 0.3260151
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2555419
	speed: 0.0551s/iter; left time: 212.0810s
	iters: 200, epoch: 7 | loss: 0.2533861
	speed: 0.0040s/iter; left time: 14.8978s
	iters: 300, epoch: 7 | loss: 0.1602143
	speed: 0.0043s/iter; left time: 15.6721s
	iters: 400, epoch: 7 | loss: 0.2170166
	speed: 0.0040s/iter; left time: 14.3369s
	iters: 500, epoch: 7 | loss: 0.2650707
	speed: 0.0041s/iter; left time: 14.2643s
	iters: 600, epoch: 7 | loss: 0.2109597
	speed: 0.0043s/iter; left time: 14.3503s
	iters: 700, epoch: 7 | loss: 0.2821586
	speed: 0.0041s/iter; left time: 13.4503s
	iters: 800, epoch: 7 | loss: 0.2264363
	speed: 0.0041s/iter; left time: 12.7993s
	iters: 900, epoch: 7 | loss: 0.2191521
	speed: 0.0039s/iter; left time: 11.7523s
Epoch: 7 cost time: 4.779484748840332
Epoch: 7, Steps: 987 | Train Loss: 0.2523286 Vali Loss: 0.4116702 Test Loss: 0.3192016
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1805346
	speed: 0.0560s/iter; left time: 160.3423s
	iters: 200, epoch: 8 | loss: 0.1751679
	speed: 0.0041s/iter; left time: 11.2200s
	iters: 300, epoch: 8 | loss: 0.1923221
	speed: 0.0040s/iter; left time: 10.6104s
	iters: 400, epoch: 8 | loss: 0.2016468
	speed: 0.0041s/iter; left time: 10.4305s
	iters: 500, epoch: 8 | loss: 0.2551795
	speed: 0.0040s/iter; left time: 9.9455s
	iters: 600, epoch: 8 | loss: 0.2477838
	speed: 0.0039s/iter; left time: 9.2048s
	iters: 700, epoch: 8 | loss: 0.2393605
	speed: 0.0039s/iter; left time: 8.9319s
	iters: 800, epoch: 8 | loss: 0.2067721
	speed: 0.0042s/iter; left time: 8.9752s
	iters: 900, epoch: 8 | loss: 0.2512401
	speed: 0.0040s/iter; left time: 8.2113s
Epoch: 8 cost time: 4.888540506362915
Epoch: 8, Steps: 987 | Train Loss: 0.2513599 Vali Loss: 0.4064834 Test Loss: 0.3201089
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_720_24_NLinear_ETTh1_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2857
mse:0.32619136571884155, mae:0.37320128083229065
