Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_144_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_144_24_NLinear_ETTh1_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8473
val 2857
test 2857
	iters: 100, epoch: 1 | loss: 0.2551554
	speed: 0.0098s/iter; left time: 102.7925s
	iters: 200, epoch: 1 | loss: 0.2562143
	speed: 0.0037s/iter; left time: 38.2309s
	iters: 300, epoch: 1 | loss: 0.1819759
	speed: 0.0037s/iter; left time: 37.7076s
	iters: 400, epoch: 1 | loss: 0.2281902
	speed: 0.0037s/iter; left time: 37.5525s
	iters: 500, epoch: 1 | loss: 0.2754635
	speed: 0.0037s/iter; left time: 37.0854s
	iters: 600, epoch: 1 | loss: 0.1905045
	speed: 0.0037s/iter; left time: 37.3581s
	iters: 700, epoch: 1 | loss: 0.4516843
	speed: 0.0039s/iter; left time: 38.0995s
	iters: 800, epoch: 1 | loss: 0.2752987
	speed: 0.0040s/iter; left time: 39.1958s
	iters: 900, epoch: 1 | loss: 0.2179479
	speed: 0.0048s/iter; left time: 46.2966s
	iters: 1000, epoch: 1 | loss: 0.2167478
	speed: 0.0047s/iter; left time: 45.2278s
Epoch: 1 cost time: 4.881236553192139
Epoch: 1, Steps: 1059 | Train Loss: 0.3026788 Vali Loss: 0.4210397 Test Loss: 0.3261645
Validation loss decreased (inf --> 0.421040).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2147400
	speed: 0.0456s/iter; left time: 429.7017s
	iters: 200, epoch: 2 | loss: 0.2129267
	speed: 0.0040s/iter; left time: 37.7523s
	iters: 300, epoch: 2 | loss: 0.2525762
	speed: 0.0041s/iter; left time: 37.3900s
	iters: 400, epoch: 2 | loss: 0.2668615
	speed: 0.0041s/iter; left time: 37.1323s
	iters: 500, epoch: 2 | loss: 0.2850336
	speed: 0.0041s/iter; left time: 36.6305s
	iters: 600, epoch: 2 | loss: 0.2623580
	speed: 0.0040s/iter; left time: 35.8699s
	iters: 700, epoch: 2 | loss: 0.3104548
	speed: 0.0037s/iter; left time: 32.8389s
	iters: 800, epoch: 2 | loss: 0.4741953
	speed: 0.0037s/iter; left time: 32.5474s
	iters: 900, epoch: 2 | loss: 0.2293715
	speed: 0.0037s/iter; left time: 32.3565s
	iters: 1000, epoch: 2 | loss: 0.2102464
	speed: 0.0038s/iter; left time: 32.5278s
Epoch: 2 cost time: 4.836672067642212
Epoch: 2, Steps: 1059 | Train Loss: 0.2767826 Vali Loss: 0.4140987 Test Loss: 0.3208124
Validation loss decreased (0.421040 --> 0.414099).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1796070
	speed: 0.0458s/iter; left time: 383.3343s
	iters: 200, epoch: 3 | loss: 0.2817498
	speed: 0.0037s/iter; left time: 30.2846s
	iters: 300, epoch: 3 | loss: 0.1659762
	speed: 0.0037s/iter; left time: 29.8863s
	iters: 400, epoch: 3 | loss: 0.1678653
	speed: 0.0036s/iter; left time: 29.3423s
	iters: 500, epoch: 3 | loss: 0.2991303
	speed: 0.0037s/iter; left time: 29.7860s
	iters: 600, epoch: 3 | loss: 0.2146692
	speed: 0.0040s/iter; left time: 31.8271s
	iters: 700, epoch: 3 | loss: 0.1753104
	speed: 0.0040s/iter; left time: 31.4170s
	iters: 800, epoch: 3 | loss: 0.2488232
	speed: 0.0040s/iter; left time: 31.0285s
	iters: 900, epoch: 3 | loss: 0.2039824
	speed: 0.0041s/iter; left time: 31.4085s
	iters: 1000, epoch: 3 | loss: 0.2562056
	speed: 0.0041s/iter; left time: 30.5038s
Epoch: 3 cost time: 4.798916339874268
Epoch: 3, Steps: 1059 | Train Loss: 0.2700158 Vali Loss: 0.3987660 Test Loss: 0.3226710
Validation loss decreased (0.414099 --> 0.398766).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2509511
	speed: 0.0458s/iter; left time: 334.8207s
	iters: 200, epoch: 4 | loss: 0.2271967
	speed: 0.0038s/iter; left time: 27.1599s
	iters: 300, epoch: 4 | loss: 0.3487085
	speed: 0.0038s/iter; left time: 26.8278s
	iters: 400, epoch: 4 | loss: 0.2557312
	speed: 0.0038s/iter; left time: 26.6270s
	iters: 500, epoch: 4 | loss: 0.2199172
	speed: 0.0037s/iter; left time: 25.8753s
	iters: 600, epoch: 4 | loss: 0.1967131
	speed: 0.0038s/iter; left time: 25.7396s
	iters: 700, epoch: 4 | loss: 0.2907744
	speed: 0.0038s/iter; left time: 25.4212s
	iters: 800, epoch: 4 | loss: 0.2499462
	speed: 0.0038s/iter; left time: 24.8789s
	iters: 900, epoch: 4 | loss: 0.2595697
	speed: 0.0038s/iter; left time: 24.7188s
	iters: 1000, epoch: 4 | loss: 0.2347484
	speed: 0.0038s/iter; left time: 24.2921s
Epoch: 4 cost time: 4.737411975860596
Epoch: 4, Steps: 1059 | Train Loss: 0.2674579 Vali Loss: 0.4149089 Test Loss: 0.3156652
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2373495
	speed: 0.0462s/iter; left time: 288.7594s
	iters: 200, epoch: 5 | loss: 0.2706829
	speed: 0.0042s/iter; left time: 25.5922s
	iters: 300, epoch: 5 | loss: 0.2746410
	speed: 0.0040s/iter; left time: 24.3788s
	iters: 400, epoch: 5 | loss: 0.3254304
	speed: 0.0037s/iter; left time: 22.0742s
	iters: 500, epoch: 5 | loss: 0.1852301
	speed: 0.0037s/iter; left time: 21.8289s
	iters: 600, epoch: 5 | loss: 0.1988568
	speed: 0.0037s/iter; left time: 21.3133s
	iters: 700, epoch: 5 | loss: 0.2525459
	speed: 0.0037s/iter; left time: 20.8294s
	iters: 800, epoch: 5 | loss: 0.3726371
	speed: 0.0038s/iter; left time: 21.1764s
	iters: 900, epoch: 5 | loss: 0.2022046
	speed: 0.0047s/iter; left time: 25.6011s
	iters: 1000, epoch: 5 | loss: 0.2426059
	speed: 0.0037s/iter; left time: 20.0557s
Epoch: 5 cost time: 4.842225790023804
Epoch: 5, Steps: 1059 | Train Loss: 0.2659819 Vali Loss: 0.3984894 Test Loss: 0.3223805
Validation loss decreased (0.398766 --> 0.398489).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2460380
	speed: 0.0463s/iter; left time: 240.3949s
	iters: 200, epoch: 6 | loss: 0.2315118
	speed: 0.0038s/iter; left time: 19.4753s
	iters: 300, epoch: 6 | loss: 0.2498882
	speed: 0.0039s/iter; left time: 19.3091s
	iters: 400, epoch: 6 | loss: 0.2418340
	speed: 0.0039s/iter; left time: 19.0578s
	iters: 500, epoch: 6 | loss: 0.6366192
	speed: 0.0039s/iter; left time: 18.6095s
	iters: 600, epoch: 6 | loss: 0.3558017
	speed: 0.0039s/iter; left time: 18.3509s
	iters: 700, epoch: 6 | loss: 0.3413938
	speed: 0.0039s/iter; left time: 17.8430s
	iters: 800, epoch: 6 | loss: 0.3265990
	speed: 0.0039s/iter; left time: 17.5766s
	iters: 900, epoch: 6 | loss: 0.2437422
	speed: 0.0040s/iter; left time: 17.4518s
	iters: 1000, epoch: 6 | loss: 0.3139902
	speed: 0.0038s/iter; left time: 16.4448s
Epoch: 6 cost time: 4.7866621017456055
Epoch: 6, Steps: 1059 | Train Loss: 0.2653384 Vali Loss: 0.4009188 Test Loss: 0.3160975
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2712168
	speed: 0.0459s/iter; left time: 189.7169s
	iters: 200, epoch: 7 | loss: 0.2212195
	speed: 0.0037s/iter; left time: 15.0508s
	iters: 300, epoch: 7 | loss: 0.3264599
	speed: 0.0039s/iter; left time: 15.2448s
	iters: 400, epoch: 7 | loss: 0.1963003
	speed: 0.0038s/iter; left time: 14.5434s
	iters: 500, epoch: 7 | loss: 0.2344957
	speed: 0.0037s/iter; left time: 13.9430s
	iters: 600, epoch: 7 | loss: 0.2315319
	speed: 0.0037s/iter; left time: 13.4838s
	iters: 700, epoch: 7 | loss: 0.2251737
	speed: 0.0037s/iter; left time: 13.0571s
	iters: 800, epoch: 7 | loss: 0.1925627
	speed: 0.0038s/iter; left time: 13.0476s
	iters: 900, epoch: 7 | loss: 0.3237497
	speed: 0.0037s/iter; left time: 12.3499s
	iters: 1000, epoch: 7 | loss: 0.1595776
	speed: 0.0037s/iter; left time: 12.1327s
Epoch: 7 cost time: 4.7125771045684814
Epoch: 7, Steps: 1059 | Train Loss: 0.2649389 Vali Loss: 0.4021819 Test Loss: 0.3149250
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2665636
	speed: 0.0457s/iter; left time: 140.7555s
	iters: 200, epoch: 8 | loss: 0.2722618
	speed: 0.0037s/iter; left time: 11.0565s
	iters: 300, epoch: 8 | loss: 0.2711883
	speed: 0.0037s/iter; left time: 10.6742s
	iters: 400, epoch: 8 | loss: 0.4668919
	speed: 0.0037s/iter; left time: 10.2821s
	iters: 500, epoch: 8 | loss: 0.1958085
	speed: 0.0037s/iter; left time: 9.9715s
	iters: 600, epoch: 8 | loss: 0.2929480
	speed: 0.0037s/iter; left time: 9.4606s
	iters: 700, epoch: 8 | loss: 0.2975511
	speed: 0.0037s/iter; left time: 9.1847s
	iters: 800, epoch: 8 | loss: 0.2577352
	speed: 0.0036s/iter; left time: 8.6015s
	iters: 900, epoch: 8 | loss: 0.2483854
	speed: 0.0036s/iter; left time: 8.2650s
	iters: 1000, epoch: 8 | loss: 0.3174383
	speed: 0.0036s/iter; left time: 7.8782s
Epoch: 8 cost time: 4.56933331489563
Epoch: 8, Steps: 1059 | Train Loss: 0.2647786 Vali Loss: 0.4033810 Test Loss: 0.3136031
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_144_24_NLinear_ETTh1_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2857
mse:0.3229908347129822, mae:0.3626662492752075
