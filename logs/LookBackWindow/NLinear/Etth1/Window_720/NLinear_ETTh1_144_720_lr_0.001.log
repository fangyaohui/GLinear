Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_144_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_144_720_NLinear_ETTh1_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7777
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6974949
	speed: 0.0095s/iter; left time: 91.1573s
	iters: 200, epoch: 1 | loss: 0.7595511
	speed: 0.0039s/iter; left time: 37.3881s
	iters: 300, epoch: 1 | loss: 0.4827403
	speed: 0.0040s/iter; left time: 37.9904s
	iters: 400, epoch: 1 | loss: 0.6094484
	speed: 0.0042s/iter; left time: 38.7795s
	iters: 500, epoch: 1 | loss: 0.5060604
	speed: 0.0039s/iter; left time: 36.1363s
	iters: 600, epoch: 1 | loss: 0.5416554
	speed: 0.0039s/iter; left time: 35.2825s
	iters: 700, epoch: 1 | loss: 0.8698202
	speed: 0.0040s/iter; left time: 36.4851s
	iters: 800, epoch: 1 | loss: 0.5264615
	speed: 0.0042s/iter; left time: 37.2728s
	iters: 900, epoch: 1 | loss: 0.7172349
	speed: 0.0040s/iter; left time: 35.0032s
Epoch: 1 cost time: 4.522064924240112
Epoch: 1, Steps: 972 | Train Loss: 0.6264565 Vali Loss: 1.5317972 Test Loss: 0.4726891
Validation loss decreased (inf --> 1.531797).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4752982
	speed: 0.0487s/iter; left time: 420.8261s
	iters: 200, epoch: 2 | loss: 0.6574326
	speed: 0.0039s/iter; left time: 33.3261s
	iters: 300, epoch: 2 | loss: 0.4904818
	speed: 0.0038s/iter; left time: 32.2029s
	iters: 400, epoch: 2 | loss: 0.6401019
	speed: 0.0036s/iter; left time: 30.0632s
	iters: 500, epoch: 2 | loss: 0.5574319
	speed: 0.0040s/iter; left time: 32.9497s
	iters: 600, epoch: 2 | loss: 0.5537374
	speed: 0.0040s/iter; left time: 32.4532s
	iters: 700, epoch: 2 | loss: 0.6527278
	speed: 0.0042s/iter; left time: 33.7828s
	iters: 800, epoch: 2 | loss: 0.6330543
	speed: 0.0042s/iter; left time: 33.1755s
	iters: 900, epoch: 2 | loss: 0.5814571
	speed: 0.0039s/iter; left time: 30.6920s
Epoch: 2 cost time: 4.651355743408203
Epoch: 2, Steps: 972 | Train Loss: 0.6016645 Vali Loss: 1.5260925 Test Loss: 0.4675703
Validation loss decreased (1.531797 --> 1.526093).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5607865
	speed: 0.0464s/iter; left time: 356.5248s
	iters: 200, epoch: 3 | loss: 0.6378149
	speed: 0.0038s/iter; left time: 28.8997s
	iters: 300, epoch: 3 | loss: 0.7049375
	speed: 0.0041s/iter; left time: 30.3760s
	iters: 400, epoch: 3 | loss: 0.6033277
	speed: 0.0039s/iter; left time: 29.1240s
	iters: 500, epoch: 3 | loss: 0.4014659
	speed: 0.0039s/iter; left time: 28.7001s
	iters: 600, epoch: 3 | loss: 0.5273051
	speed: 0.0039s/iter; left time: 27.7906s
	iters: 700, epoch: 3 | loss: 0.6418748
	speed: 0.0039s/iter; left time: 27.3306s
	iters: 800, epoch: 3 | loss: 0.4113793
	speed: 0.0039s/iter; left time: 27.0584s
	iters: 900, epoch: 3 | loss: 0.8015863
	speed: 0.0040s/iter; left time: 27.2908s
Epoch: 3 cost time: 4.446304082870483
Epoch: 3, Steps: 972 | Train Loss: 0.5941729 Vali Loss: 1.5305815 Test Loss: 0.4600436
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.6922001
	speed: 0.0469s/iter; left time: 314.4474s
	iters: 200, epoch: 4 | loss: 0.6888357
	speed: 0.0038s/iter; left time: 25.2362s
	iters: 300, epoch: 4 | loss: 0.7471910
	speed: 0.0039s/iter; left time: 25.4903s
	iters: 400, epoch: 4 | loss: 0.5189358
	speed: 0.0038s/iter; left time: 24.3520s
	iters: 500, epoch: 4 | loss: 0.5783285
	speed: 0.0038s/iter; left time: 23.9686s
	iters: 600, epoch: 4 | loss: 0.5402504
	speed: 0.0037s/iter; left time: 23.0000s
	iters: 700, epoch: 4 | loss: 0.4650794
	speed: 0.0037s/iter; left time: 22.6739s
	iters: 800, epoch: 4 | loss: 0.6205701
	speed: 0.0037s/iter; left time: 22.5048s
	iters: 900, epoch: 4 | loss: 0.5529277
	speed: 0.0037s/iter; left time: 21.9209s
Epoch: 4 cost time: 4.38961935043335
Epoch: 4, Steps: 972 | Train Loss: 0.5910179 Vali Loss: 1.5269141 Test Loss: 0.4584993
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4185686
	speed: 0.0447s/iter; left time: 256.3674s
	iters: 200, epoch: 5 | loss: 0.5812278
	speed: 0.0042s/iter; left time: 23.6685s
	iters: 300, epoch: 5 | loss: 0.6775700
	speed: 0.0041s/iter; left time: 22.8906s
	iters: 400, epoch: 5 | loss: 0.7862203
	speed: 0.0040s/iter; left time: 21.6782s
	iters: 500, epoch: 5 | loss: 0.7704784
	speed: 0.0039s/iter; left time: 20.6961s
	iters: 600, epoch: 5 | loss: 0.7745051
	speed: 0.0039s/iter; left time: 20.3716s
	iters: 700, epoch: 5 | loss: 0.7677106
	speed: 0.0038s/iter; left time: 19.3937s
	iters: 800, epoch: 5 | loss: 0.5948823
	speed: 0.0037s/iter; left time: 18.6701s
	iters: 900, epoch: 5 | loss: 0.6810020
	speed: 0.0036s/iter; left time: 17.6844s
Epoch: 5 cost time: 4.437158107757568
Epoch: 5, Steps: 972 | Train Loss: 0.5890938 Vali Loss: 1.5158330 Test Loss: 0.4574990
Validation loss decreased (1.526093 --> 1.515833).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4983521
	speed: 0.0441s/iter; left time: 209.9025s
	iters: 200, epoch: 6 | loss: 0.5803061
	speed: 0.0040s/iter; left time: 18.8060s
	iters: 300, epoch: 6 | loss: 0.5096678
	speed: 0.0039s/iter; left time: 17.6910s
	iters: 400, epoch: 6 | loss: 0.7044507
	speed: 0.0038s/iter; left time: 17.1260s
	iters: 500, epoch: 6 | loss: 0.5227980
	speed: 0.0039s/iter; left time: 16.7991s
	iters: 600, epoch: 6 | loss: 0.5427659
	speed: 0.0039s/iter; left time: 16.5465s
	iters: 700, epoch: 6 | loss: 0.4835974
	speed: 0.0039s/iter; left time: 16.3640s
	iters: 800, epoch: 6 | loss: 0.5798334
	speed: 0.0038s/iter; left time: 15.6119s
	iters: 900, epoch: 6 | loss: 0.7133669
	speed: 0.0040s/iter; left time: 15.7533s
Epoch: 6 cost time: 4.4343860149383545
Epoch: 6, Steps: 972 | Train Loss: 0.5882944 Vali Loss: 1.5163420 Test Loss: 0.4569645
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.6530426
	speed: 0.0434s/iter; left time: 164.5384s
	iters: 200, epoch: 7 | loss: 0.6185360
	speed: 0.0040s/iter; left time: 14.6276s
	iters: 300, epoch: 7 | loss: 0.5409777
	speed: 0.0037s/iter; left time: 13.3033s
	iters: 400, epoch: 7 | loss: 0.5909696
	speed: 0.0040s/iter; left time: 13.8699s
	iters: 500, epoch: 7 | loss: 0.5693966
	speed: 0.0039s/iter; left time: 13.1195s
	iters: 600, epoch: 7 | loss: 0.7815799
	speed: 0.0040s/iter; left time: 13.0124s
	iters: 700, epoch: 7 | loss: 0.6250832
	speed: 0.0038s/iter; left time: 12.0435s
	iters: 800, epoch: 7 | loss: 0.5318722
	speed: 0.0040s/iter; left time: 12.3751s
	iters: 900, epoch: 7 | loss: 0.6272542
	speed: 0.0037s/iter; left time: 11.1816s
Epoch: 7 cost time: 4.422682523727417
Epoch: 7, Steps: 972 | Train Loss: 0.5878343 Vali Loss: 1.5168656 Test Loss: 0.4561284
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.6237528
	speed: 0.0438s/iter; left time: 123.5178s
	iters: 200, epoch: 8 | loss: 0.4993609
	speed: 0.0040s/iter; left time: 10.8236s
	iters: 300, epoch: 8 | loss: 0.7621777
	speed: 0.0038s/iter; left time: 9.9295s
	iters: 400, epoch: 8 | loss: 0.4464402
	speed: 0.0039s/iter; left time: 9.8838s
	iters: 500, epoch: 8 | loss: 0.7108818
	speed: 0.0036s/iter; left time: 8.7664s
	iters: 600, epoch: 8 | loss: 0.7679297
	speed: 0.0035s/iter; left time: 8.0711s
	iters: 700, epoch: 8 | loss: 0.4882364
	speed: 0.0038s/iter; left time: 8.5006s
	iters: 800, epoch: 8 | loss: 0.5721833
	speed: 0.0037s/iter; left time: 7.8863s
	iters: 900, epoch: 8 | loss: 0.5174274
	speed: 0.0040s/iter; left time: 7.9962s
Epoch: 8 cost time: 4.36552882194519
Epoch: 8, Steps: 972 | Train Loss: 0.5875396 Vali Loss: 1.5147668 Test Loss: 0.4564908
Validation loss decreased (1.515833 --> 1.514767).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3929246
	speed: 0.0449s/iter; left time: 82.7984s
	iters: 200, epoch: 9 | loss: 0.6216263
	speed: 0.0036s/iter; left time: 6.2648s
	iters: 300, epoch: 9 | loss: 0.5475838
	speed: 0.0036s/iter; left time: 5.8725s
	iters: 400, epoch: 9 | loss: 0.7217728
	speed: 0.0039s/iter; left time: 5.9790s
	iters: 500, epoch: 9 | loss: 0.5883507
	speed: 0.0039s/iter; left time: 5.6258s
	iters: 600, epoch: 9 | loss: 0.6379682
	speed: 0.0039s/iter; left time: 5.2519s
	iters: 700, epoch: 9 | loss: 0.6385224
	speed: 0.0040s/iter; left time: 4.9530s
	iters: 800, epoch: 9 | loss: 0.4844173
	speed: 0.0041s/iter; left time: 4.6585s
	iters: 900, epoch: 9 | loss: 0.6057284
	speed: 0.0040s/iter; left time: 4.1415s
Epoch: 9 cost time: 4.414456367492676
Epoch: 9, Steps: 972 | Train Loss: 0.5874041 Vali Loss: 1.5147024 Test Loss: 0.4565502
Validation loss decreased (1.514767 --> 1.514702).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.6628477
	speed: 0.0440s/iter; left time: 38.4387s
	iters: 200, epoch: 10 | loss: 0.6402190
	speed: 0.0037s/iter; left time: 2.8370s
	iters: 300, epoch: 10 | loss: 0.5411549
	speed: 0.0036s/iter; left time: 2.3917s
	iters: 400, epoch: 10 | loss: 0.6016514
	speed: 0.0035s/iter; left time: 2.0128s
	iters: 500, epoch: 10 | loss: 0.6741415
	speed: 0.0034s/iter; left time: 1.6209s
	iters: 600, epoch: 10 | loss: 0.7287045
	speed: 0.0036s/iter; left time: 1.3301s
	iters: 700, epoch: 10 | loss: 0.5836900
	speed: 0.0038s/iter; left time: 1.0253s
	iters: 800, epoch: 10 | loss: 0.5575095
	speed: 0.0040s/iter; left time: 0.6935s
	iters: 900, epoch: 10 | loss: 0.8462390
	speed: 0.0041s/iter; left time: 0.3017s
Epoch: 10 cost time: 4.378770589828491
Epoch: 10, Steps: 972 | Train Loss: 0.5873933 Vali Loss: 1.5152010 Test Loss: 0.4562837
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : ETTh1_144_720_NLinear_ETTh1_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.45585936307907104, mae:0.45756933093070984
