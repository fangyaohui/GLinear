Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_120_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=120, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_120_720_NLinear_ETTh1_ftM_sl120_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7801
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5407032
	speed: 0.0114s/iter; left time: 110.0031s
	iters: 200, epoch: 1 | loss: 0.7020159
	speed: 0.0041s/iter; left time: 39.5983s
	iters: 300, epoch: 1 | loss: 0.5364958
	speed: 0.0041s/iter; left time: 39.1993s
	iters: 400, epoch: 1 | loss: 0.5545559
	speed: 0.0042s/iter; left time: 38.8718s
	iters: 500, epoch: 1 | loss: 0.7621058
	speed: 0.0038s/iter; left time: 35.4806s
	iters: 600, epoch: 1 | loss: 0.5605183
	speed: 0.0039s/iter; left time: 35.8218s
	iters: 700, epoch: 1 | loss: 0.7280808
	speed: 0.0039s/iter; left time: 35.4981s
	iters: 800, epoch: 1 | loss: 0.5520331
	speed: 0.0040s/iter; left time: 36.1132s
	iters: 900, epoch: 1 | loss: 0.6673867
	speed: 0.0041s/iter; left time: 36.5733s
Epoch: 1 cost time: 4.75873589515686
Epoch: 1, Steps: 975 | Train Loss: 0.6331631 Vali Loss: 1.5873621 Test Loss: 0.4888113
Validation loss decreased (inf --> 1.587362).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4985730
	speed: 0.0457s/iter; left time: 396.4541s
	iters: 200, epoch: 2 | loss: 0.7086570
	speed: 0.0036s/iter; left time: 30.9251s
	iters: 300, epoch: 2 | loss: 0.4856094
	speed: 0.0040s/iter; left time: 33.7530s
	iters: 400, epoch: 2 | loss: 0.4050213
	speed: 0.0038s/iter; left time: 31.7572s
	iters: 500, epoch: 2 | loss: 0.8693451
	speed: 0.0039s/iter; left time: 32.2673s
	iters: 600, epoch: 2 | loss: 0.7391748
	speed: 0.0039s/iter; left time: 31.5860s
	iters: 700, epoch: 2 | loss: 0.4955082
	speed: 0.0039s/iter; left time: 31.2718s
	iters: 800, epoch: 2 | loss: 0.7195080
	speed: 0.0041s/iter; left time: 32.3469s
	iters: 900, epoch: 2 | loss: 0.6223252
	speed: 0.0039s/iter; left time: 30.5998s
Epoch: 2 cost time: 4.480189323425293
Epoch: 2, Steps: 975 | Train Loss: 0.6068810 Vali Loss: 1.5584356 Test Loss: 0.4751843
Validation loss decreased (1.587362 --> 1.558436).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4279940
	speed: 0.0461s/iter; left time: 355.3163s
	iters: 200, epoch: 3 | loss: 0.4239112
	speed: 0.0043s/iter; left time: 32.9842s
	iters: 300, epoch: 3 | loss: 0.8860060
	speed: 0.0043s/iter; left time: 32.0346s
	iters: 400, epoch: 3 | loss: 0.4764498
	speed: 0.0039s/iter; left time: 29.2322s
	iters: 500, epoch: 3 | loss: 0.6749238
	speed: 0.0039s/iter; left time: 28.7632s
	iters: 600, epoch: 3 | loss: 0.7589041
	speed: 0.0038s/iter; left time: 27.2073s
	iters: 700, epoch: 3 | loss: 0.5869200
	speed: 0.0038s/iter; left time: 27.1349s
	iters: 800, epoch: 3 | loss: 0.4741344
	speed: 0.0038s/iter; left time: 26.2928s
	iters: 900, epoch: 3 | loss: 0.6663393
	speed: 0.0039s/iter; left time: 26.7352s
Epoch: 3 cost time: 4.67340087890625
Epoch: 3, Steps: 975 | Train Loss: 0.6001094 Vali Loss: 1.5401191 Test Loss: 0.4679875
Validation loss decreased (1.558436 --> 1.540119).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5288638
	speed: 0.0497s/iter; left time: 334.0703s
	iters: 200, epoch: 4 | loss: 0.4835197
	speed: 0.0037s/iter; left time: 24.7986s
	iters: 300, epoch: 4 | loss: 0.5180306
	speed: 0.0039s/iter; left time: 25.6543s
	iters: 400, epoch: 4 | loss: 0.6085714
	speed: 0.0038s/iter; left time: 24.4586s
	iters: 500, epoch: 4 | loss: 0.6097316
	speed: 0.0039s/iter; left time: 24.4295s
	iters: 600, epoch: 4 | loss: 0.6263939
	speed: 0.0037s/iter; left time: 22.8304s
	iters: 700, epoch: 4 | loss: 0.5290015
	speed: 0.0038s/iter; left time: 23.4539s
	iters: 800, epoch: 4 | loss: 0.4614797
	speed: 0.0037s/iter; left time: 22.0451s
	iters: 900, epoch: 4 | loss: 0.5855322
	speed: 0.0038s/iter; left time: 22.2850s
Epoch: 4 cost time: 4.47277307510376
Epoch: 4, Steps: 975 | Train Loss: 0.5970858 Vali Loss: 1.5403558 Test Loss: 0.4659702
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5313327
	speed: 0.0461s/iter; left time: 265.3685s
	iters: 200, epoch: 5 | loss: 0.7282928
	speed: 0.0037s/iter; left time: 21.0671s
	iters: 300, epoch: 5 | loss: 0.4814828
	speed: 0.0036s/iter; left time: 19.8715s
	iters: 400, epoch: 5 | loss: 0.4950186
	speed: 0.0035s/iter; left time: 19.2853s
	iters: 500, epoch: 5 | loss: 0.6536029
	speed: 0.0038s/iter; left time: 20.1716s
	iters: 600, epoch: 5 | loss: 0.6362291
	speed: 0.0036s/iter; left time: 19.1405s
	iters: 700, epoch: 5 | loss: 0.6055841
	speed: 0.0036s/iter; left time: 18.4622s
	iters: 800, epoch: 5 | loss: 0.7135929
	speed: 0.0036s/iter; left time: 18.1243s
	iters: 900, epoch: 5 | loss: 0.6321072
	speed: 0.0035s/iter; left time: 17.5266s
Epoch: 5 cost time: 4.377736568450928
Epoch: 5, Steps: 975 | Train Loss: 0.5957733 Vali Loss: 1.5405475 Test Loss: 0.4640896
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.6975534
	speed: 0.0465s/iter; left time: 221.9029s
	iters: 200, epoch: 6 | loss: 0.5735514
	speed: 0.0038s/iter; left time: 17.7943s
	iters: 300, epoch: 6 | loss: 0.4153216
	speed: 0.0038s/iter; left time: 17.3597s
	iters: 400, epoch: 6 | loss: 0.5835521
	speed: 0.0040s/iter; left time: 17.8064s
	iters: 500, epoch: 6 | loss: 0.6408207
	speed: 0.0039s/iter; left time: 16.9997s
	iters: 600, epoch: 6 | loss: 0.5332491
	speed: 0.0039s/iter; left time: 16.7879s
	iters: 700, epoch: 6 | loss: 0.6454593
	speed: 0.0038s/iter; left time: 15.7777s
	iters: 800, epoch: 6 | loss: 0.7035363
	speed: 0.0038s/iter; left time: 15.4180s
	iters: 900, epoch: 6 | loss: 0.7413761
	speed: 0.0037s/iter; left time: 14.8921s
Epoch: 6 cost time: 4.482181787490845
Epoch: 6, Steps: 975 | Train Loss: 0.5951119 Vali Loss: 1.5383822 Test Loss: 0.4633080
Validation loss decreased (1.540119 --> 1.538382).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.7391778
	speed: 0.0464s/iter; left time: 176.3285s
	iters: 200, epoch: 7 | loss: 0.6386704
	speed: 0.0039s/iter; left time: 14.3804s
	iters: 300, epoch: 7 | loss: 0.4819435
	speed: 0.0038s/iter; left time: 13.7071s
	iters: 400, epoch: 7 | loss: 0.5743514
	speed: 0.0038s/iter; left time: 13.3696s
	iters: 500, epoch: 7 | loss: 0.6365403
	speed: 0.0038s/iter; left time: 12.9786s
	iters: 600, epoch: 7 | loss: 0.6621006
	speed: 0.0038s/iter; left time: 12.6115s
	iters: 700, epoch: 7 | loss: 0.6657555
	speed: 0.0038s/iter; left time: 12.2232s
	iters: 800, epoch: 7 | loss: 0.7717739
	speed: 0.0038s/iter; left time: 11.8333s
	iters: 900, epoch: 7 | loss: 0.7614222
	speed: 0.0038s/iter; left time: 11.4641s
Epoch: 7 cost time: 4.4577531814575195
Epoch: 7, Steps: 975 | Train Loss: 0.5946108 Vali Loss: 1.5374320 Test Loss: 0.4634722
Validation loss decreased (1.538382 --> 1.537432).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.6194562
	speed: 0.0481s/iter; left time: 135.8908s
	iters: 200, epoch: 8 | loss: 0.8049812
	speed: 0.0041s/iter; left time: 11.1397s
	iters: 300, epoch: 8 | loss: 0.6362111
	speed: 0.0042s/iter; left time: 11.1373s
	iters: 400, epoch: 8 | loss: 0.6847132
	speed: 0.0042s/iter; left time: 10.6377s
	iters: 500, epoch: 8 | loss: 0.5425752
	speed: 0.0038s/iter; left time: 9.3032s
	iters: 600, epoch: 8 | loss: 0.6128117
	speed: 0.0038s/iter; left time: 8.7580s
	iters: 700, epoch: 8 | loss: 0.5519155
	speed: 0.0037s/iter; left time: 8.2743s
	iters: 800, epoch: 8 | loss: 0.4966564
	speed: 0.0037s/iter; left time: 7.9361s
	iters: 900, epoch: 8 | loss: 0.6328906
	speed: 0.0039s/iter; left time: 7.9047s
Epoch: 8 cost time: 4.644065856933594
Epoch: 8, Steps: 975 | Train Loss: 0.5943638 Vali Loss: 1.5362405 Test Loss: 0.4631447
Validation loss decreased (1.537432 --> 1.536240).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.5629079
	speed: 0.0460s/iter; left time: 85.2307s
	iters: 200, epoch: 9 | loss: 0.7220592
	speed: 0.0039s/iter; left time: 6.7859s
	iters: 300, epoch: 9 | loss: 0.5472702
	speed: 0.0040s/iter; left time: 6.5637s
	iters: 400, epoch: 9 | loss: 0.5771551
	speed: 0.0038s/iter; left time: 5.8367s
	iters: 500, epoch: 9 | loss: 0.5825210
	speed: 0.0036s/iter; left time: 5.2790s
	iters: 600, epoch: 9 | loss: 0.5804142
	speed: 0.0036s/iter; left time: 4.8899s
	iters: 700, epoch: 9 | loss: 0.5966786
	speed: 0.0036s/iter; left time: 4.4565s
	iters: 800, epoch: 9 | loss: 0.6721087
	speed: 0.0037s/iter; left time: 4.2720s
	iters: 900, epoch: 9 | loss: 0.5615769
	speed: 0.0037s/iter; left time: 3.8918s
Epoch: 9 cost time: 4.336382627487183
Epoch: 9, Steps: 975 | Train Loss: 0.5942790 Vali Loss: 1.5369227 Test Loss: 0.4634816
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.5194132
	speed: 0.0446s/iter; left time: 39.0675s
	iters: 200, epoch: 10 | loss: 0.7341715
	speed: 0.0037s/iter; left time: 2.9086s
	iters: 300, epoch: 10 | loss: 0.8360049
	speed: 0.0037s/iter; left time: 2.5338s
	iters: 400, epoch: 10 | loss: 0.5619609
	speed: 0.0039s/iter; left time: 2.2694s
	iters: 500, epoch: 10 | loss: 0.5976054
	speed: 0.0038s/iter; left time: 1.8010s
	iters: 600, epoch: 10 | loss: 0.6747016
	speed: 0.0038s/iter; left time: 1.4310s
	iters: 700, epoch: 10 | loss: 0.7227950
	speed: 0.0037s/iter; left time: 1.0282s
	iters: 800, epoch: 10 | loss: 0.6468498
	speed: 0.0040s/iter; left time: 0.7021s
	iters: 900, epoch: 10 | loss: 0.6037322
	speed: 0.0039s/iter; left time: 0.2999s
Epoch: 10 cost time: 4.429785490036011
Epoch: 10, Steps: 975 | Train Loss: 0.5941278 Vali Loss: 1.5369104 Test Loss: 0.4633707
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : ETTh1_120_720_NLinear_ETTh1_ftM_sl120_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.46247777342796326, mae:0.4596919119358063
