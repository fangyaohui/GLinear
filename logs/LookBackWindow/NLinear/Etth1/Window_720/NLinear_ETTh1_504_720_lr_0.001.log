Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_504_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_504_720_NLinear_ETTh1_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7417
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8232713
	speed: 0.0130s/iter; left time: 119.4636s
	iters: 200, epoch: 1 | loss: 0.5837404
	speed: 0.0048s/iter; left time: 43.1153s
	iters: 300, epoch: 1 | loss: 0.5058411
	speed: 0.0046s/iter; left time: 41.4698s
	iters: 400, epoch: 1 | loss: 0.5421477
	speed: 0.0046s/iter; left time: 40.7951s
	iters: 500, epoch: 1 | loss: 0.7416105
	speed: 0.0047s/iter; left time: 41.1605s
	iters: 600, epoch: 1 | loss: 0.5330394
	speed: 0.0047s/iter; left time: 40.5267s
	iters: 700, epoch: 1 | loss: 0.5059395
	speed: 0.0044s/iter; left time: 38.0626s
	iters: 800, epoch: 1 | loss: 0.5576378
	speed: 0.0046s/iter; left time: 38.9818s
	iters: 900, epoch: 1 | loss: 0.7598707
	speed: 0.0044s/iter; left time: 37.0653s
Epoch: 1 cost time: 5.223514795303345
Epoch: 1, Steps: 927 | Train Loss: 0.6141000 Vali Loss: 1.4978977 Test Loss: 0.4737553
Validation loss decreased (inf --> 1.497898).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.7691211
	speed: 0.0529s/iter; left time: 436.2801s
	iters: 200, epoch: 2 | loss: 0.5066643
	speed: 0.0045s/iter; left time: 36.3876s
	iters: 300, epoch: 2 | loss: 0.5587308
	speed: 0.0042s/iter; left time: 34.0020s
	iters: 400, epoch: 2 | loss: 0.7374672
	speed: 0.0044s/iter; left time: 34.6563s
	iters: 500, epoch: 2 | loss: 0.6770290
	speed: 0.0042s/iter; left time: 33.0784s
	iters: 600, epoch: 2 | loss: 0.5329658
	speed: 0.0045s/iter; left time: 34.7596s
	iters: 700, epoch: 2 | loss: 0.5691432
	speed: 0.0044s/iter; left time: 33.7311s
	iters: 800, epoch: 2 | loss: 0.7533237
	speed: 0.0044s/iter; left time: 33.2023s
	iters: 900, epoch: 2 | loss: 0.5273453
	speed: 0.0045s/iter; left time: 33.8262s
Epoch: 2 cost time: 4.957005262374878
Epoch: 2, Steps: 927 | Train Loss: 0.5928573 Vali Loss: 1.4973269 Test Loss: 0.4761626
Validation loss decreased (1.497898 --> 1.497327).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4984325
	speed: 0.0522s/iter; left time: 381.7727s
	iters: 200, epoch: 3 | loss: 0.6162861
	speed: 0.0044s/iter; left time: 31.9696s
	iters: 300, epoch: 3 | loss: 0.7378446
	speed: 0.0043s/iter; left time: 30.6879s
	iters: 400, epoch: 3 | loss: 0.5559694
	speed: 0.0049s/iter; left time: 34.2284s
	iters: 500, epoch: 3 | loss: 0.5328470
	speed: 0.0045s/iter; left time: 30.9382s
	iters: 600, epoch: 3 | loss: 0.4374943
	speed: 0.0041s/iter; left time: 28.2550s
	iters: 700, epoch: 3 | loss: 0.5591193
	speed: 0.0044s/iter; left time: 29.3201s
	iters: 800, epoch: 3 | loss: 0.6017522
	speed: 0.0047s/iter; left time: 31.3831s
	iters: 900, epoch: 3 | loss: 0.6342682
	speed: 0.0045s/iter; left time: 29.0749s
Epoch: 3 cost time: 4.961433172225952
Epoch: 3, Steps: 927 | Train Loss: 0.5721109 Vali Loss: 1.4746294 Test Loss: 0.4610084
Validation loss decreased (1.497327 --> 1.474629).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5353361
	speed: 0.0509s/iter; left time: 325.4974s
	iters: 200, epoch: 4 | loss: 0.4125628
	speed: 0.0046s/iter; left time: 29.0630s
	iters: 300, epoch: 4 | loss: 0.4296722
	speed: 0.0045s/iter; left time: 27.9760s
	iters: 400, epoch: 4 | loss: 0.5765457
	speed: 0.0046s/iter; left time: 28.2934s
	iters: 500, epoch: 4 | loss: 0.5879346
	speed: 0.0042s/iter; left time: 25.4368s
	iters: 600, epoch: 4 | loss: 0.3832166
	speed: 0.0044s/iter; left time: 26.0259s
	iters: 700, epoch: 4 | loss: 0.5276816
	speed: 0.0046s/iter; left time: 26.5042s
	iters: 800, epoch: 4 | loss: 0.6328292
	speed: 0.0048s/iter; left time: 27.2656s
	iters: 900, epoch: 4 | loss: 0.6424342
	speed: 0.0045s/iter; left time: 25.3447s
Epoch: 4 cost time: 5.029720783233643
Epoch: 4, Steps: 927 | Train Loss: 0.5623418 Vali Loss: 1.4544897 Test Loss: 0.4525562
Validation loss decreased (1.474629 --> 1.454490).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4701720
	speed: 0.0544s/iter; left time: 297.3132s
	iters: 200, epoch: 5 | loss: 0.5703235
	speed: 0.0048s/iter; left time: 25.7874s
	iters: 300, epoch: 5 | loss: 0.5363358
	speed: 0.0045s/iter; left time: 23.6892s
	iters: 400, epoch: 5 | loss: 0.5882685
	speed: 0.0045s/iter; left time: 23.3942s
	iters: 500, epoch: 5 | loss: 0.6311551
	speed: 0.0051s/iter; left time: 25.9171s
	iters: 600, epoch: 5 | loss: 0.5555484
	speed: 0.0049s/iter; left time: 24.2986s
	iters: 700, epoch: 5 | loss: 0.3779554
	speed: 0.0048s/iter; left time: 23.3178s
	iters: 800, epoch: 5 | loss: 0.5988745
	speed: 0.0045s/iter; left time: 21.3592s
	iters: 900, epoch: 5 | loss: 0.6304403
	speed: 0.0048s/iter; left time: 22.1722s
Epoch: 5 cost time: 5.317058324813843
Epoch: 5, Steps: 927 | Train Loss: 0.5579165 Vali Loss: 1.4378757 Test Loss: 0.4466105
Validation loss decreased (1.454490 --> 1.437876).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4885195
	speed: 0.0532s/iter; left time: 241.4562s
	iters: 200, epoch: 6 | loss: 0.4307690
	speed: 0.0046s/iter; left time: 20.1919s
	iters: 300, epoch: 6 | loss: 0.5113975
	speed: 0.0046s/iter; left time: 19.8775s
	iters: 400, epoch: 6 | loss: 0.5960226
	speed: 0.0046s/iter; left time: 19.5151s
	iters: 500, epoch: 6 | loss: 0.4806672
	speed: 0.0049s/iter; left time: 20.2969s
	iters: 600, epoch: 6 | loss: 0.5377031
	speed: 0.0048s/iter; left time: 19.3501s
	iters: 700, epoch: 6 | loss: 0.5114365
	speed: 0.0043s/iter; left time: 16.9605s
	iters: 800, epoch: 6 | loss: 0.5332646
	speed: 0.0047s/iter; left time: 18.0332s
	iters: 900, epoch: 6 | loss: 0.6028880
	speed: 0.0046s/iter; left time: 17.3382s
Epoch: 6 cost time: 5.189048528671265
Epoch: 6, Steps: 927 | Train Loss: 0.5550334 Vali Loss: 1.4459531 Test Loss: 0.4429725
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.6314761
	speed: 0.0504s/iter; left time: 181.9964s
	iters: 200, epoch: 7 | loss: 0.4573641
	speed: 0.0043s/iter; left time: 14.9755s
	iters: 300, epoch: 7 | loss: 0.4791268
	speed: 0.0043s/iter; left time: 14.5341s
	iters: 400, epoch: 7 | loss: 0.5287935
	speed: 0.0044s/iter; left time: 14.7222s
	iters: 500, epoch: 7 | loss: 0.7047908
	speed: 0.0046s/iter; left time: 14.8054s
	iters: 600, epoch: 7 | loss: 0.4388316
	speed: 0.0046s/iter; left time: 14.3250s
	iters: 700, epoch: 7 | loss: 0.7392831
	speed: 0.0048s/iter; left time: 14.4105s
	iters: 800, epoch: 7 | loss: 0.6209469
	speed: 0.0044s/iter; left time: 12.6705s
	iters: 900, epoch: 7 | loss: 0.6100775
	speed: 0.0045s/iter; left time: 12.7670s
Epoch: 7 cost time: 4.953107595443726
Epoch: 7, Steps: 927 | Train Loss: 0.5535037 Vali Loss: 1.4323181 Test Loss: 0.4443565
Validation loss decreased (1.437876 --> 1.432318).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4579824
	speed: 0.0506s/iter; left time: 135.6836s
	iters: 200, epoch: 8 | loss: 0.4557772
	speed: 0.0046s/iter; left time: 11.9768s
	iters: 300, epoch: 8 | loss: 0.6296024
	speed: 0.0048s/iter; left time: 11.9591s
	iters: 400, epoch: 8 | loss: 0.5057419
	speed: 0.0046s/iter; left time: 10.8529s
	iters: 500, epoch: 8 | loss: 0.4453950
	speed: 0.0044s/iter; left time: 10.1223s
	iters: 600, epoch: 8 | loss: 0.4802018
	speed: 0.0049s/iter; left time: 10.7004s
	iters: 700, epoch: 8 | loss: 0.5925798
	speed: 0.0046s/iter; left time: 9.5737s
	iters: 800, epoch: 8 | loss: 0.5042168
	speed: 0.0044s/iter; left time: 8.7080s
	iters: 900, epoch: 8 | loss: 0.5271412
	speed: 0.0046s/iter; left time: 8.6169s
Epoch: 8 cost time: 5.179434776306152
Epoch: 8, Steps: 927 | Train Loss: 0.5526593 Vali Loss: 1.4341277 Test Loss: 0.4431252
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.6464876
	speed: 0.0538s/iter; left time: 94.3742s
	iters: 200, epoch: 9 | loss: 0.4788125
	speed: 0.0045s/iter; left time: 7.4321s
	iters: 300, epoch: 9 | loss: 0.5540230
	speed: 0.0049s/iter; left time: 7.5756s
	iters: 400, epoch: 9 | loss: 0.5349287
	speed: 0.0043s/iter; left time: 6.3216s
	iters: 500, epoch: 9 | loss: 0.5595684
	speed: 0.0046s/iter; left time: 6.2218s
	iters: 600, epoch: 9 | loss: 0.5499820
	speed: 0.0048s/iter; left time: 6.0448s
	iters: 700, epoch: 9 | loss: 0.4828455
	speed: 0.0045s/iter; left time: 5.1464s
	iters: 800, epoch: 9 | loss: 0.5438608
	speed: 0.0045s/iter; left time: 4.7694s
	iters: 900, epoch: 9 | loss: 0.6482028
	speed: 0.0044s/iter; left time: 4.1574s
Epoch: 9 cost time: 5.125665664672852
Epoch: 9, Steps: 927 | Train Loss: 0.5523052 Vali Loss: 1.4343224 Test Loss: 0.4431655
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.5089555
	speed: 0.0535s/iter; left time: 44.2689s
	iters: 200, epoch: 10 | loss: 0.4684378
	speed: 0.0050s/iter; left time: 3.6074s
	iters: 300, epoch: 10 | loss: 0.6933281
	speed: 0.0047s/iter; left time: 2.9472s
	iters: 400, epoch: 10 | loss: 0.4259164
	speed: 0.0045s/iter; left time: 2.3747s
	iters: 500, epoch: 10 | loss: 0.5474858
	speed: 0.0048s/iter; left time: 2.0443s
	iters: 600, epoch: 10 | loss: 0.4523690
	speed: 0.0044s/iter; left time: 1.4315s
	iters: 700, epoch: 10 | loss: 0.4867204
	speed: 0.0047s/iter; left time: 1.0684s
	iters: 800, epoch: 10 | loss: 0.4151044
	speed: 0.0054s/iter; left time: 0.6891s
	iters: 900, epoch: 10 | loss: 0.6409449
	speed: 0.0045s/iter; left time: 0.1257s
Epoch: 10 cost time: 5.0931243896484375
Epoch: 10, Steps: 927 | Train Loss: 0.5520971 Vali Loss: 1.4342499 Test Loss: 0.4431363
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_504_720_NLinear_ETTh1_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4439481794834137, mae:0.45756253600120544
