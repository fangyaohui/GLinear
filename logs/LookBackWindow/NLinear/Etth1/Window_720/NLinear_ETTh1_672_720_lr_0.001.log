Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='NLinear', model_id='ETTh1_672_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=672, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_672_720_NLinear_ETTh1_ftM_sl672_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7249
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6314003
	speed: 0.0136s/iter; left time: 121.4551s
	iters: 200, epoch: 1 | loss: 0.7621704
	speed: 0.0056s/iter; left time: 49.4110s
	iters: 300, epoch: 1 | loss: 0.5533205
	speed: 0.0048s/iter; left time: 42.4194s
	iters: 400, epoch: 1 | loss: 0.6198322
	speed: 0.0045s/iter; left time: 39.1036s
	iters: 500, epoch: 1 | loss: 0.7906613
	speed: 0.0047s/iter; left time: 40.1210s
	iters: 600, epoch: 1 | loss: 0.5149577
	speed: 0.0050s/iter; left time: 42.2321s
	iters: 700, epoch: 1 | loss: 0.5118988
	speed: 0.0051s/iter; left time: 42.8641s
	iters: 800, epoch: 1 | loss: 0.6804097
	speed: 0.0047s/iter; left time: 38.8514s
	iters: 900, epoch: 1 | loss: 0.5827779
	speed: 0.0047s/iter; left time: 38.5441s
Epoch: 1 cost time: 5.425714731216431
Epoch: 1, Steps: 906 | Train Loss: 0.6137279 Vali Loss: 1.5342557 Test Loss: 0.4929395
Validation loss decreased (inf --> 1.534256).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5940973
	speed: 0.0585s/iter; left time: 471.5871s
	iters: 200, epoch: 2 | loss: 0.5110306
	speed: 0.0052s/iter; left time: 41.7514s
	iters: 300, epoch: 2 | loss: 0.5964332
	speed: 0.0053s/iter; left time: 41.9286s
	iters: 400, epoch: 2 | loss: 0.6592225
	speed: 0.0052s/iter; left time: 40.2251s
	iters: 500, epoch: 2 | loss: 0.6960148
	speed: 0.0050s/iter; left time: 38.6008s
	iters: 600, epoch: 2 | loss: 0.6140881
	speed: 0.0050s/iter; left time: 37.7812s
	iters: 700, epoch: 2 | loss: 0.6647750
	speed: 0.0052s/iter; left time: 38.8295s
	iters: 800, epoch: 2 | loss: 0.6955740
	speed: 0.0049s/iter; left time: 35.7305s
	iters: 900, epoch: 2 | loss: 0.7304769
	speed: 0.0051s/iter; left time: 36.7249s
Epoch: 2 cost time: 5.676038026809692
Epoch: 2, Steps: 906 | Train Loss: 0.5929789 Vali Loss: 1.5749042 Test Loss: 0.5351614
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4674147
	speed: 0.0571s/iter; left time: 408.2260s
	iters: 200, epoch: 3 | loss: 0.4417739
	speed: 0.0052s/iter; left time: 36.8751s
	iters: 300, epoch: 3 | loss: 0.4769491
	speed: 0.0049s/iter; left time: 34.1585s
	iters: 400, epoch: 3 | loss: 0.5857338
	speed: 0.0051s/iter; left time: 35.0782s
	iters: 500, epoch: 3 | loss: 0.7563923
	speed: 0.0047s/iter; left time: 31.8915s
	iters: 600, epoch: 3 | loss: 0.4981057
	speed: 0.0051s/iter; left time: 34.0164s
	iters: 700, epoch: 3 | loss: 0.4890658
	speed: 0.0049s/iter; left time: 31.7956s
	iters: 800, epoch: 3 | loss: 0.7400053
	speed: 0.0050s/iter; left time: 32.1111s
	iters: 900, epoch: 3 | loss: 0.6139651
	speed: 0.0043s/iter; left time: 27.5991s
Epoch: 3 cost time: 5.497733116149902
Epoch: 3, Steps: 906 | Train Loss: 0.5671928 Vali Loss: 1.4786632 Test Loss: 0.4668841
Validation loss decreased (1.534256 --> 1.478663).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.6218473
	speed: 0.0536s/iter; left time: 334.6285s
	iters: 200, epoch: 4 | loss: 0.6170700
	speed: 0.0049s/iter; left time: 30.3897s
	iters: 300, epoch: 4 | loss: 0.3394279
	speed: 0.0054s/iter; left time: 32.4961s
	iters: 400, epoch: 4 | loss: 0.4996199
	speed: 0.0055s/iter; left time: 32.5682s
	iters: 500, epoch: 4 | loss: 0.6657476
	speed: 0.0052s/iter; left time: 30.5571s
	iters: 600, epoch: 4 | loss: 0.5424360
	speed: 0.0044s/iter; left time: 25.4418s
	iters: 700, epoch: 4 | loss: 0.5797601
	speed: 0.0047s/iter; left time: 26.3292s
	iters: 800, epoch: 4 | loss: 0.5191277
	speed: 0.0052s/iter; left time: 28.7866s
	iters: 900, epoch: 4 | loss: 0.5455009
	speed: 0.0052s/iter; left time: 28.4693s
Epoch: 4 cost time: 5.489658832550049
Epoch: 4, Steps: 906 | Train Loss: 0.5538278 Vali Loss: 1.4608871 Test Loss: 0.4672058
Validation loss decreased (1.478663 --> 1.460887).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.6253439
	speed: 0.0556s/iter; left time: 296.9885s
	iters: 200, epoch: 5 | loss: 0.6468125
	speed: 0.0049s/iter; left time: 25.9123s
	iters: 300, epoch: 5 | loss: 0.4903124
	speed: 0.0050s/iter; left time: 25.6547s
	iters: 400, epoch: 5 | loss: 0.6817377
	speed: 0.0050s/iter; left time: 25.2565s
	iters: 500, epoch: 5 | loss: 0.3704343
	speed: 0.0051s/iter; left time: 24.9575s
	iters: 600, epoch: 5 | loss: 0.5304481
	speed: 0.0051s/iter; left time: 24.8307s
	iters: 700, epoch: 5 | loss: 0.6314805
	speed: 0.0052s/iter; left time: 24.5407s
	iters: 800, epoch: 5 | loss: 0.6750923
	speed: 0.0045s/iter; left time: 20.8964s
	iters: 900, epoch: 5 | loss: 0.5190709
	speed: 0.0050s/iter; left time: 22.5357s
Epoch: 5 cost time: 5.3855907917022705
Epoch: 5, Steps: 906 | Train Loss: 0.5476228 Vali Loss: 1.4607067 Test Loss: 0.4641851
Validation loss decreased (1.460887 --> 1.460707).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.7051689
	speed: 0.0546s/iter; left time: 241.8941s
	iters: 200, epoch: 6 | loss: 0.6161796
	speed: 0.0048s/iter; left time: 20.6521s
	iters: 300, epoch: 6 | loss: 0.5545104
	speed: 0.0045s/iter; left time: 18.9902s
	iters: 400, epoch: 6 | loss: 0.4304585
	speed: 0.0046s/iter; left time: 18.9779s
	iters: 500, epoch: 6 | loss: 0.7654164
	speed: 0.0046s/iter; left time: 18.5595s
	iters: 600, epoch: 6 | loss: 0.4739358
	speed: 0.0052s/iter; left time: 20.3533s
	iters: 700, epoch: 6 | loss: 0.4812521
	speed: 0.0049s/iter; left time: 18.6023s
	iters: 800, epoch: 6 | loss: 0.5736916
	speed: 0.0051s/iter; left time: 18.8744s
	iters: 900, epoch: 6 | loss: 0.5441490
	speed: 0.0055s/iter; left time: 19.7964s
Epoch: 6 cost time: 5.29813551902771
Epoch: 6, Steps: 906 | Train Loss: 0.5443285 Vali Loss: 1.4471490 Test Loss: 0.4585467
Validation loss decreased (1.460707 --> 1.447149).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.5806490
	speed: 0.0559s/iter; left time: 196.9224s
	iters: 200, epoch: 7 | loss: 0.5269635
	speed: 0.0048s/iter; left time: 16.3920s
	iters: 300, epoch: 7 | loss: 0.5582689
	speed: 0.0049s/iter; left time: 16.1577s
	iters: 400, epoch: 7 | loss: 0.5145715
	speed: 0.0048s/iter; left time: 15.3488s
	iters: 500, epoch: 7 | loss: 0.5297391
	speed: 0.0051s/iter; left time: 16.0830s
	iters: 600, epoch: 7 | loss: 0.5770795
	speed: 0.0045s/iter; left time: 13.4820s
	iters: 700, epoch: 7 | loss: 0.6051453
	speed: 0.0046s/iter; left time: 13.5725s
	iters: 800, epoch: 7 | loss: 0.5387686
	speed: 0.0043s/iter; left time: 12.1730s
	iters: 900, epoch: 7 | loss: 0.4829953
	speed: 0.0045s/iter; left time: 12.3801s
Epoch: 7 cost time: 5.174566030502319
Epoch: 7, Steps: 906 | Train Loss: 0.5422739 Vali Loss: 1.4449635 Test Loss: 0.4555342
Validation loss decreased (1.447149 --> 1.444963).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4629019
	speed: 0.0548s/iter; left time: 143.4919s
	iters: 200, epoch: 8 | loss: 0.4129471
	speed: 0.0050s/iter; left time: 12.6481s
	iters: 300, epoch: 8 | loss: 0.6382222
	speed: 0.0048s/iter; left time: 11.6676s
	iters: 400, epoch: 8 | loss: 0.4132858
	speed: 0.0045s/iter; left time: 10.4589s
	iters: 500, epoch: 8 | loss: 0.6803368
	speed: 0.0050s/iter; left time: 11.0163s
	iters: 600, epoch: 8 | loss: 0.4425883
	speed: 0.0044s/iter; left time: 9.3591s
	iters: 700, epoch: 8 | loss: 0.7620404
	speed: 0.0048s/iter; left time: 9.6309s
	iters: 800, epoch: 8 | loss: 0.5730228
	speed: 0.0047s/iter; left time: 8.9303s
	iters: 900, epoch: 8 | loss: 0.5045576
	speed: 0.0052s/iter; left time: 9.5383s
Epoch: 8 cost time: 5.204377889633179
Epoch: 8, Steps: 906 | Train Loss: 0.5413211 Vali Loss: 1.4399811 Test Loss: 0.4555211
Validation loss decreased (1.444963 --> 1.439981).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.6647275
	speed: 0.0561s/iter; left time: 96.0360s
	iters: 200, epoch: 9 | loss: 0.4493851
	speed: 0.0048s/iter; left time: 7.6938s
	iters: 300, epoch: 9 | loss: 0.5444573
	speed: 0.0047s/iter; left time: 7.0521s
	iters: 400, epoch: 9 | loss: 0.6454906
	speed: 0.0052s/iter; left time: 7.3960s
	iters: 500, epoch: 9 | loss: 0.4964767
	speed: 0.0051s/iter; left time: 6.6809s
	iters: 600, epoch: 9 | loss: 0.5230616
	speed: 0.0046s/iter; left time: 5.5429s
	iters: 700, epoch: 9 | loss: 0.5161197
	speed: 0.0045s/iter; left time: 5.0401s
	iters: 800, epoch: 9 | loss: 0.4131556
	speed: 0.0047s/iter; left time: 4.7807s
	iters: 900, epoch: 9 | loss: 0.6459192
	speed: 0.0046s/iter; left time: 4.1629s
Epoch: 9 cost time: 5.233810901641846
Epoch: 9, Steps: 906 | Train Loss: 0.5407466 Vali Loss: 1.4422412 Test Loss: 0.4545176
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4109098
	speed: 0.0541s/iter; left time: 43.6773s
	iters: 200, epoch: 10 | loss: 0.5243567
	speed: 0.0044s/iter; left time: 3.0934s
	iters: 300, epoch: 10 | loss: 0.4438135
	speed: 0.0046s/iter; left time: 2.7891s
	iters: 400, epoch: 10 | loss: 0.5014773
	speed: 0.0046s/iter; left time: 2.3155s
	iters: 500, epoch: 10 | loss: 0.4953426
	speed: 0.0048s/iter; left time: 1.9688s
	iters: 600, epoch: 10 | loss: 0.5320897
	speed: 0.0048s/iter; left time: 1.4827s
	iters: 700, epoch: 10 | loss: 0.4819680
	speed: 0.0049s/iter; left time: 1.0071s
	iters: 800, epoch: 10 | loss: 0.4938990
	speed: 0.0048s/iter; left time: 0.5145s
	iters: 900, epoch: 10 | loss: 0.5847735
	speed: 0.0046s/iter; left time: 0.0322s
Epoch: 10 cost time: 5.142397165298462
Epoch: 10, Steps: 906 | Train Loss: 0.5405173 Vali Loss: 1.4438872 Test Loss: 0.4546301
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : ETTh1_672_720_NLinear_ETTh1_ftM_sl672_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4551332890987396, mae:0.46776247024536133
