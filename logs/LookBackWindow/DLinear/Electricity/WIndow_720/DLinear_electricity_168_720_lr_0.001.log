Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_168_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=168, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_168_720_DLinear_custom_ftM_sl168_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17525
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2542010
	speed: 0.0333s/iter; left time: 360.9064s
	iters: 200, epoch: 1 | loss: 0.2692587
	speed: 0.0236s/iter; left time: 254.0854s
	iters: 300, epoch: 1 | loss: 0.2158344
	speed: 0.0217s/iter; left time: 231.3826s
	iters: 400, epoch: 1 | loss: 0.2165333
	speed: 0.0221s/iter; left time: 232.9793s
	iters: 500, epoch: 1 | loss: 0.2532999
	speed: 0.0220s/iter; left time: 230.0758s
	iters: 600, epoch: 1 | loss: 0.2185651
	speed: 0.0219s/iter; left time: 226.2651s
	iters: 700, epoch: 1 | loss: 0.2519259
	speed: 0.0222s/iter; left time: 227.3063s
	iters: 800, epoch: 1 | loss: 0.2446456
	speed: 0.0238s/iter; left time: 241.8322s
	iters: 900, epoch: 1 | loss: 0.2168298
	speed: 0.0239s/iter; left time: 240.5114s
	iters: 1000, epoch: 1 | loss: 0.2427060
	speed: 0.0245s/iter; left time: 244.1633s
Epoch: 1 cost time: 25.996783018112183
Epoch: 1, Steps: 1095 | Train Loss: 0.2509372 Vali Loss: 0.1891249 Test Loss: 0.2206212
Validation loss decreased (inf --> 0.189125).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2456864
	speed: 0.1901s/iter; left time: 1854.8087s
	iters: 200, epoch: 2 | loss: 0.2473657
	speed: 0.0208s/iter; left time: 200.9783s
	iters: 300, epoch: 2 | loss: 0.2319606
	speed: 0.0209s/iter; left time: 199.3709s
	iters: 400, epoch: 2 | loss: 0.2041524
	speed: 0.0203s/iter; left time: 191.5965s
	iters: 500, epoch: 2 | loss: 0.2550366
	speed: 0.0208s/iter; left time: 194.3818s
	iters: 600, epoch: 2 | loss: 0.2085433
	speed: 0.0208s/iter; left time: 192.8926s
	iters: 700, epoch: 2 | loss: 0.2350570
	speed: 0.0214s/iter; left time: 195.9146s
	iters: 800, epoch: 2 | loss: 0.2375770
	speed: 0.0239s/iter; left time: 216.2452s
	iters: 900, epoch: 2 | loss: 0.2418072
	speed: 0.0212s/iter; left time: 190.2387s
	iters: 1000, epoch: 2 | loss: 0.2098166
	speed: 0.0238s/iter; left time: 210.7953s
Epoch: 2 cost time: 24.702767848968506
Epoch: 2, Steps: 1095 | Train Loss: 0.2298524 Vali Loss: 0.1888743 Test Loss: 0.2209619
Validation loss decreased (0.189125 --> 0.188874).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2247429
	speed: 0.1954s/iter; left time: 1691.9707s
	iters: 200, epoch: 3 | loss: 0.2418603
	speed: 0.0214s/iter; left time: 183.4061s
	iters: 300, epoch: 3 | loss: 0.2330637
	speed: 0.0227s/iter; left time: 192.4593s
	iters: 400, epoch: 3 | loss: 0.2150231
	speed: 0.0222s/iter; left time: 185.3469s
	iters: 500, epoch: 3 | loss: 0.2149260
	speed: 0.0225s/iter; left time: 185.5640s
	iters: 600, epoch: 3 | loss: 0.2838524
	speed: 0.0232s/iter; left time: 189.3979s
	iters: 700, epoch: 3 | loss: 0.2024256
	speed: 0.0247s/iter; left time: 199.4436s
	iters: 800, epoch: 3 | loss: 0.2493587
	speed: 0.0229s/iter; left time: 181.9600s
	iters: 900, epoch: 3 | loss: 0.2076421
	speed: 0.0221s/iter; left time: 173.3752s
	iters: 1000, epoch: 3 | loss: 0.2380132
	speed: 0.0212s/iter; left time: 164.6352s
Epoch: 3 cost time: 25.473080158233643
Epoch: 3, Steps: 1095 | Train Loss: 0.2272239 Vali Loss: 0.1868676 Test Loss: 0.2203318
Validation loss decreased (0.188874 --> 0.186868).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2053358
	speed: 0.1895s/iter; left time: 1434.0467s
	iters: 200, epoch: 4 | loss: 0.2232506
	speed: 0.0210s/iter; left time: 156.6807s
	iters: 300, epoch: 4 | loss: 0.2084444
	speed: 0.0223s/iter; left time: 164.2879s
	iters: 400, epoch: 4 | loss: 0.2528699
	speed: 0.0235s/iter; left time: 170.8666s
	iters: 500, epoch: 4 | loss: 0.2382449
	speed: 0.0221s/iter; left time: 158.1057s
	iters: 600, epoch: 4 | loss: 0.2148667
	speed: 0.0213s/iter; left time: 150.5020s
	iters: 700, epoch: 4 | loss: 0.2289066
	speed: 0.0212s/iter; left time: 147.7960s
	iters: 800, epoch: 4 | loss: 0.2148087
	speed: 0.0230s/iter; left time: 158.0914s
	iters: 900, epoch: 4 | loss: 0.2257608
	speed: 0.0241s/iter; left time: 163.3243s
	iters: 1000, epoch: 4 | loss: 0.2397529
	speed: 0.0249s/iter; left time: 165.9404s
Epoch: 4 cost time: 25.76063370704651
Epoch: 4, Steps: 1095 | Train Loss: 0.2262127 Vali Loss: 0.1844889 Test Loss: 0.2170463
Validation loss decreased (0.186868 --> 0.184489).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2180049
	speed: 0.1880s/iter; left time: 1216.2855s
	iters: 200, epoch: 5 | loss: 0.2381940
	speed: 0.0207s/iter; left time: 132.0850s
	iters: 300, epoch: 5 | loss: 0.2250187
	speed: 0.0215s/iter; left time: 134.8146s
	iters: 400, epoch: 5 | loss: 0.2467055
	speed: 0.0224s/iter; left time: 138.4321s
	iters: 500, epoch: 5 | loss: 0.2681135
	speed: 0.0219s/iter; left time: 132.6789s
	iters: 600, epoch: 5 | loss: 0.2276955
	speed: 0.0215s/iter; left time: 128.4525s
	iters: 700, epoch: 5 | loss: 0.2042981
	speed: 0.0215s/iter; left time: 126.2141s
	iters: 800, epoch: 5 | loss: 0.1884550
	speed: 0.0238s/iter; left time: 137.6173s
	iters: 900, epoch: 5 | loss: 0.2394234
	speed: 0.0245s/iter; left time: 139.1535s
	iters: 1000, epoch: 5 | loss: 0.2354923
	speed: 0.0223s/iter; left time: 124.4479s
Epoch: 5 cost time: 25.126593589782715
Epoch: 5, Steps: 1095 | Train Loss: 0.2256519 Vali Loss: 0.1841207 Test Loss: 0.2162139
Validation loss decreased (0.184489 --> 0.184121).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2485168
	speed: 0.1899s/iter; left time: 1020.7273s
	iters: 200, epoch: 6 | loss: 0.2265994
	speed: 0.0209s/iter; left time: 110.4640s
	iters: 300, epoch: 6 | loss: 0.2189976
	speed: 0.0222s/iter; left time: 114.6578s
	iters: 400, epoch: 6 | loss: 0.2184418
	speed: 0.0228s/iter; left time: 115.4890s
	iters: 500, epoch: 6 | loss: 0.2061543
	speed: 0.0223s/iter; left time: 111.1252s
	iters: 600, epoch: 6 | loss: 0.2138757
	speed: 0.0232s/iter; left time: 113.2813s
	iters: 700, epoch: 6 | loss: 0.2254602
	speed: 0.0222s/iter; left time: 105.9796s
	iters: 800, epoch: 6 | loss: 0.2337141
	speed: 0.0212s/iter; left time: 99.0003s
	iters: 900, epoch: 6 | loss: 0.2263745
	speed: 0.0221s/iter; left time: 101.2407s
	iters: 1000, epoch: 6 | loss: 0.2192291
	speed: 0.0211s/iter; left time: 94.3686s
Epoch: 6 cost time: 25.01051354408264
Epoch: 6, Steps: 1095 | Train Loss: 0.2253893 Vali Loss: 0.1839492 Test Loss: 0.2161728
Validation loss decreased (0.184121 --> 0.183949).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2234571
	speed: 0.1913s/iter; left time: 818.9207s
	iters: 200, epoch: 7 | loss: 0.2030780
	speed: 0.0216s/iter; left time: 90.2482s
	iters: 300, epoch: 7 | loss: 0.1947929
	speed: 0.0216s/iter; left time: 88.0874s
	iters: 400, epoch: 7 | loss: 0.2220354
	speed: 0.0215s/iter; left time: 85.7292s
	iters: 500, epoch: 7 | loss: 0.2280379
	speed: 0.0234s/iter; left time: 90.8503s
	iters: 600, epoch: 7 | loss: 0.2004010
	speed: 0.0221s/iter; left time: 83.7017s
	iters: 700, epoch: 7 | loss: 0.2586312
	speed: 0.0216s/iter; left time: 79.3871s
	iters: 800, epoch: 7 | loss: 0.2181680
	speed: 0.0229s/iter; left time: 82.0462s
	iters: 900, epoch: 7 | loss: 0.2383921
	speed: 0.0211s/iter; left time: 73.5561s
	iters: 1000, epoch: 7 | loss: 0.2242218
	speed: 0.0219s/iter; left time: 74.1102s
Epoch: 7 cost time: 25.14754819869995
Epoch: 7, Steps: 1095 | Train Loss: 0.2252268 Vali Loss: 0.1840870 Test Loss: 0.2163558
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2720819
	speed: 0.1864s/iter; left time: 593.8259s
	iters: 200, epoch: 8 | loss: 0.2262103
	speed: 0.0207s/iter; left time: 63.7507s
	iters: 300, epoch: 8 | loss: 0.2310523
	speed: 0.0216s/iter; left time: 64.3532s
	iters: 400, epoch: 8 | loss: 0.2418102
	speed: 0.0220s/iter; left time: 63.5810s
	iters: 500, epoch: 8 | loss: 0.2119936
	speed: 0.0212s/iter; left time: 59.1166s
	iters: 600, epoch: 8 | loss: 0.2310854
	speed: 0.0215s/iter; left time: 57.7429s
	iters: 700, epoch: 8 | loss: 0.2125532
	speed: 0.0220s/iter; left time: 56.7943s
	iters: 800, epoch: 8 | loss: 0.1934702
	speed: 0.0207s/iter; left time: 51.3663s
	iters: 900, epoch: 8 | loss: 0.2463745
	speed: 0.0210s/iter; left time: 50.1043s
	iters: 1000, epoch: 8 | loss: 0.2674063
	speed: 0.0207s/iter; left time: 47.3769s
Epoch: 8 cost time: 24.282689809799194
Epoch: 8, Steps: 1095 | Train Loss: 0.2251335 Vali Loss: 0.1840049 Test Loss: 0.2164075
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2362598
	speed: 0.1853s/iter; left time: 387.4479s
	iters: 200, epoch: 9 | loss: 0.2443977
	speed: 0.0209s/iter; left time: 41.6968s
	iters: 300, epoch: 9 | loss: 0.2340271
	speed: 0.0215s/iter; left time: 40.6543s
	iters: 400, epoch: 9 | loss: 0.2333651
	speed: 0.0216s/iter; left time: 38.6103s
	iters: 500, epoch: 9 | loss: 0.2090659
	speed: 0.0207s/iter; left time: 35.0607s
	iters: 600, epoch: 9 | loss: 0.2606413
	speed: 0.0212s/iter; left time: 33.7679s
	iters: 700, epoch: 9 | loss: 0.2154340
	speed: 0.0213s/iter; left time: 31.7619s
	iters: 800, epoch: 9 | loss: 0.2075345
	speed: 0.0218s/iter; left time: 30.2664s
	iters: 900, epoch: 9 | loss: 0.2235479
	speed: 0.0208s/iter; left time: 26.8028s
	iters: 1000, epoch: 9 | loss: 0.2097542
	speed: 0.0228s/iter; left time: 27.1900s
Epoch: 9 cost time: 24.44092559814453
Epoch: 9, Steps: 1095 | Train Loss: 0.2251111 Vali Loss: 0.1838215 Test Loss: 0.2161130
Validation loss decreased (0.183949 --> 0.183822).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1965466
	speed: 0.1839s/iter; left time: 183.1523s
	iters: 200, epoch: 10 | loss: 0.2989061
	speed: 0.0219s/iter; left time: 19.6391s
	iters: 300, epoch: 10 | loss: 0.2089279
	speed: 0.0217s/iter; left time: 17.2360s
	iters: 400, epoch: 10 | loss: 0.2355275
	speed: 0.0217s/iter; left time: 15.1187s
	iters: 500, epoch: 10 | loss: 0.2192610
	speed: 0.0207s/iter; left time: 12.3538s
	iters: 600, epoch: 10 | loss: 0.2392107
	speed: 0.0213s/iter; left time: 10.5527s
	iters: 700, epoch: 10 | loss: 0.2329177
	speed: 0.0212s/iter; left time: 8.4007s
	iters: 800, epoch: 10 | loss: 0.2132909
	speed: 0.0218s/iter; left time: 6.4636s
	iters: 900, epoch: 10 | loss: 0.2051584
	speed: 0.0217s/iter; left time: 4.2453s
	iters: 1000, epoch: 10 | loss: 0.2404015
	speed: 0.0204s/iter; left time: 1.9577s
Epoch: 10 cost time: 24.330905199050903
Epoch: 10, Steps: 1095 | Train Loss: 0.2250442 Vali Loss: 0.1837928 Test Loss: 0.2160942
Validation loss decreased (0.183822 --> 0.183793).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_168_720_DLinear_custom_ftM_sl168_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.21600310504436493, mae:0.31102776527404785
