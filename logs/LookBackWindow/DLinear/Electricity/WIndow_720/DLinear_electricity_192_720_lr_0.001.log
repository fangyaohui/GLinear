Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_192_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=192, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_192_720_DLinear_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2427479
	speed: 0.0317s/iter; left time: 342.8708s
	iters: 200, epoch: 1 | loss: 0.2731862
	speed: 0.0203s/iter; left time: 217.4919s
	iters: 300, epoch: 1 | loss: 0.2448366
	speed: 0.0213s/iter; left time: 226.3104s
	iters: 400, epoch: 1 | loss: 0.2406378
	speed: 0.0232s/iter; left time: 244.4128s
	iters: 500, epoch: 1 | loss: 0.2178143
	speed: 0.0219s/iter; left time: 228.6496s
	iters: 600, epoch: 1 | loss: 0.2623663
	speed: 0.0225s/iter; left time: 232.0065s
	iters: 700, epoch: 1 | loss: 0.2164014
	speed: 0.0226s/iter; left time: 230.7699s
	iters: 800, epoch: 1 | loss: 0.2282137
	speed: 0.0219s/iter; left time: 221.4640s
	iters: 900, epoch: 1 | loss: 0.2508737
	speed: 0.0210s/iter; left time: 210.6790s
	iters: 1000, epoch: 1 | loss: 0.2470686
	speed: 0.0228s/iter; left time: 226.3343s
Epoch: 1 cost time: 25.222835540771484
Epoch: 1, Steps: 1093 | Train Loss: 0.2480195 Vali Loss: 0.1920237 Test Loss: 0.2245731
Validation loss decreased (inf --> 0.192024).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2365966
	speed: 0.1794s/iter; left time: 1746.7484s
	iters: 200, epoch: 2 | loss: 0.2179221
	speed: 0.0209s/iter; left time: 201.3687s
	iters: 300, epoch: 2 | loss: 0.2208281
	speed: 0.0213s/iter; left time: 203.5805s
	iters: 400, epoch: 2 | loss: 0.2447063
	speed: 0.0218s/iter; left time: 205.4223s
	iters: 500, epoch: 2 | loss: 0.2529086
	speed: 0.0214s/iter; left time: 199.6366s
	iters: 600, epoch: 2 | loss: 0.2509528
	speed: 0.0209s/iter; left time: 193.0313s
	iters: 700, epoch: 2 | loss: 0.2478466
	speed: 0.0211s/iter; left time: 192.9962s
	iters: 800, epoch: 2 | loss: 0.2276374
	speed: 0.0204s/iter; left time: 184.7614s
	iters: 900, epoch: 2 | loss: 0.1974142
	speed: 0.0224s/iter; left time: 199.8754s
	iters: 1000, epoch: 2 | loss: 0.2200006
	speed: 0.0209s/iter; left time: 185.0955s
Epoch: 2 cost time: 23.965855598449707
Epoch: 2, Steps: 1093 | Train Loss: 0.2279928 Vali Loss: 0.1852775 Test Loss: 0.2178012
Validation loss decreased (0.192024 --> 0.185277).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2732678
	speed: 0.1879s/iter; left time: 1624.6093s
	iters: 200, epoch: 3 | loss: 0.2110432
	speed: 0.0195s/iter; left time: 166.8039s
	iters: 300, epoch: 3 | loss: 0.2131478
	speed: 0.0231s/iter; left time: 194.6578s
	iters: 400, epoch: 3 | loss: 0.2258048
	speed: 0.0216s/iter; left time: 179.8517s
	iters: 500, epoch: 3 | loss: 0.2453415
	speed: 0.0218s/iter; left time: 179.9751s
	iters: 600, epoch: 3 | loss: 0.2052304
	speed: 0.0202s/iter; left time: 164.5783s
	iters: 700, epoch: 3 | loss: 0.2218931
	speed: 0.0204s/iter; left time: 164.2782s
	iters: 800, epoch: 3 | loss: 0.2638790
	speed: 0.0206s/iter; left time: 164.0238s
	iters: 900, epoch: 3 | loss: 0.2212412
	speed: 0.0208s/iter; left time: 163.0451s
	iters: 1000, epoch: 3 | loss: 0.2137011
	speed: 0.0220s/iter; left time: 170.4725s
Epoch: 3 cost time: 23.97711968421936
Epoch: 3, Steps: 1093 | Train Loss: 0.2253971 Vali Loss: 0.1833746 Test Loss: 0.2146494
Validation loss decreased (0.185277 --> 0.183375).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2030718
	speed: 0.2124s/iter; left time: 1603.7634s
	iters: 200, epoch: 4 | loss: 0.2142598
	speed: 0.0202s/iter; left time: 150.2180s
	iters: 300, epoch: 4 | loss: 0.2470035
	speed: 0.0207s/iter; left time: 151.8748s
	iters: 400, epoch: 4 | loss: 0.2216959
	speed: 0.0213s/iter; left time: 154.6122s
	iters: 500, epoch: 4 | loss: 0.2141961
	speed: 0.0204s/iter; left time: 145.7566s
	iters: 600, epoch: 4 | loss: 0.2195944
	speed: 0.0202s/iter; left time: 142.1073s
	iters: 700, epoch: 4 | loss: 0.1884729
	speed: 0.0207s/iter; left time: 144.0005s
	iters: 800, epoch: 4 | loss: 0.2765936
	speed: 0.0206s/iter; left time: 141.1647s
	iters: 900, epoch: 4 | loss: 0.2319538
	speed: 0.0215s/iter; left time: 145.1073s
	iters: 1000, epoch: 4 | loss: 0.2007980
	speed: 0.0202s/iter; left time: 134.6025s
Epoch: 4 cost time: 23.529397010803223
Epoch: 4, Steps: 1093 | Train Loss: 0.2241267 Vali Loss: 0.1840251 Test Loss: 0.2159843
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2385664
	speed: 0.1746s/iter; left time: 1127.6207s
	iters: 200, epoch: 5 | loss: 0.2088910
	speed: 0.0204s/iter; left time: 129.9375s
	iters: 300, epoch: 5 | loss: 0.2405920
	speed: 0.0206s/iter; left time: 129.1532s
	iters: 400, epoch: 5 | loss: 0.2481710
	speed: 0.0217s/iter; left time: 133.6552s
	iters: 500, epoch: 5 | loss: 0.2276845
	speed: 0.0213s/iter; left time: 129.3066s
	iters: 600, epoch: 5 | loss: 0.2221289
	speed: 0.0216s/iter; left time: 128.7008s
	iters: 700, epoch: 5 | loss: 0.2265134
	speed: 0.0213s/iter; left time: 124.7259s
	iters: 800, epoch: 5 | loss: 0.2080893
	speed: 0.0205s/iter; left time: 117.9354s
	iters: 900, epoch: 5 | loss: 0.2024306
	speed: 0.0206s/iter; left time: 116.4027s
	iters: 1000, epoch: 5 | loss: 0.2088196
	speed: 0.0209s/iter; left time: 116.2357s
Epoch: 5 cost time: 23.916484832763672
Epoch: 5, Steps: 1093 | Train Loss: 0.2235091 Vali Loss: 0.1818947 Test Loss: 0.2138968
Validation loss decreased (0.183375 --> 0.181895).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2048062
	speed: 0.1901s/iter; left time: 1020.0344s
	iters: 200, epoch: 6 | loss: 0.2086412
	speed: 0.0221s/iter; left time: 116.6222s
	iters: 300, epoch: 6 | loss: 0.2659038
	speed: 0.0221s/iter; left time: 114.3256s
	iters: 400, epoch: 6 | loss: 0.2197140
	speed: 0.0213s/iter; left time: 107.8673s
	iters: 500, epoch: 6 | loss: 0.2442424
	speed: 0.0212s/iter; left time: 105.0736s
	iters: 600, epoch: 6 | loss: 0.2689474
	speed: 0.0214s/iter; left time: 104.1127s
	iters: 700, epoch: 6 | loss: 0.2456958
	speed: 0.0222s/iter; left time: 106.0074s
	iters: 800, epoch: 6 | loss: 0.1781725
	speed: 0.0208s/iter; left time: 97.2684s
	iters: 900, epoch: 6 | loss: 0.1817849
	speed: 0.0219s/iter; left time: 100.1523s
	iters: 1000, epoch: 6 | loss: 0.2140912
	speed: 0.0221s/iter; left time: 98.4778s
Epoch: 6 cost time: 24.77781367301941
Epoch: 6, Steps: 1093 | Train Loss: 0.2232080 Vali Loss: 0.1824684 Test Loss: 0.2148854
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2306985
	speed: 0.1789s/iter; left time: 764.2650s
	iters: 200, epoch: 7 | loss: 0.2191200
	speed: 0.0202s/iter; left time: 84.2213s
	iters: 300, epoch: 7 | loss: 0.1899198
	speed: 0.0208s/iter; left time: 84.6737s
	iters: 400, epoch: 7 | loss: 0.2337358
	speed: 0.0206s/iter; left time: 82.0104s
	iters: 500, epoch: 7 | loss: 0.2301574
	speed: 0.0203s/iter; left time: 78.6712s
	iters: 600, epoch: 7 | loss: 0.2020321
	speed: 0.0206s/iter; left time: 77.6593s
	iters: 700, epoch: 7 | loss: 0.1913371
	speed: 0.0200s/iter; left time: 73.6354s
	iters: 800, epoch: 7 | loss: 0.2240810
	speed: 0.0214s/iter; left time: 76.3580s
	iters: 900, epoch: 7 | loss: 0.2513219
	speed: 0.0207s/iter; left time: 71.8824s
	iters: 1000, epoch: 7 | loss: 0.2652523
	speed: 0.0199s/iter; left time: 67.0256s
Epoch: 7 cost time: 23.282149076461792
Epoch: 7, Steps: 1093 | Train Loss: 0.2230266 Vali Loss: 0.1816694 Test Loss: 0.2139587
Validation loss decreased (0.181895 --> 0.181669).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2191161
	speed: 0.1779s/iter; left time: 565.8045s
	iters: 200, epoch: 8 | loss: 0.1824946
	speed: 0.0214s/iter; left time: 65.8148s
	iters: 300, epoch: 8 | loss: 0.2283660
	speed: 0.0222s/iter; left time: 66.1750s
	iters: 400, epoch: 8 | loss: 0.2433169
	speed: 0.0213s/iter; left time: 61.3494s
	iters: 500, epoch: 8 | loss: 0.2503333
	speed: 0.0219s/iter; left time: 60.8608s
	iters: 600, epoch: 8 | loss: 0.2011481
	speed: 0.0217s/iter; left time: 58.1680s
	iters: 700, epoch: 8 | loss: 0.2132545
	speed: 0.0216s/iter; left time: 55.6578s
	iters: 800, epoch: 8 | loss: 0.1951334
	speed: 0.0223s/iter; left time: 55.1934s
	iters: 900, epoch: 8 | loss: 0.2275656
	speed: 0.0221s/iter; left time: 52.6056s
	iters: 1000, epoch: 8 | loss: 0.2069683
	speed: 0.0229s/iter; left time: 52.3240s
Epoch: 8 cost time: 25.020479440689087
Epoch: 8, Steps: 1093 | Train Loss: 0.2229794 Vali Loss: 0.1816437 Test Loss: 0.2137966
Validation loss decreased (0.181669 --> 0.181644).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2363055
	speed: 0.1850s/iter; left time: 386.0963s
	iters: 200, epoch: 9 | loss: 0.2476591
	speed: 0.0205s/iter; left time: 40.7212s
	iters: 300, epoch: 9 | loss: 0.2658717
	speed: 0.0206s/iter; left time: 38.9512s
	iters: 400, epoch: 9 | loss: 0.2264949
	speed: 0.0204s/iter; left time: 36.5198s
	iters: 500, epoch: 9 | loss: 0.2149675
	speed: 0.0207s/iter; left time: 34.9636s
	iters: 600, epoch: 9 | loss: 0.2001818
	speed: 0.0209s/iter; left time: 33.1765s
	iters: 700, epoch: 9 | loss: 0.2222891
	speed: 0.0215s/iter; left time: 31.9449s
	iters: 800, epoch: 9 | loss: 0.1891434
	speed: 0.0213s/iter; left time: 29.5130s
	iters: 900, epoch: 9 | loss: 0.2287829
	speed: 0.0207s/iter; left time: 26.6363s
	iters: 1000, epoch: 9 | loss: 0.1983202
	speed: 0.0215s/iter; left time: 25.5316s
Epoch: 9 cost time: 23.681435108184814
Epoch: 9, Steps: 1093 | Train Loss: 0.2229395 Vali Loss: 0.1816935 Test Loss: 0.2140411
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2522175
	speed: 0.1809s/iter; left time: 179.8040s
	iters: 200, epoch: 10 | loss: 0.2103478
	speed: 0.0203s/iter; left time: 18.1660s
	iters: 300, epoch: 10 | loss: 0.1932672
	speed: 0.0223s/iter; left time: 17.6811s
	iters: 400, epoch: 10 | loss: 0.2269237
	speed: 0.0204s/iter; left time: 14.1714s
	iters: 500, epoch: 10 | loss: 0.2072470
	speed: 0.0215s/iter; left time: 12.7986s
	iters: 600, epoch: 10 | loss: 0.2433203
	speed: 0.0211s/iter; left time: 10.4178s
	iters: 700, epoch: 10 | loss: 0.2380833
	speed: 0.0205s/iter; left time: 8.0878s
	iters: 800, epoch: 10 | loss: 0.2223354
	speed: 0.0202s/iter; left time: 5.9402s
	iters: 900, epoch: 10 | loss: 0.2053968
	speed: 0.0209s/iter; left time: 4.0596s
	iters: 1000, epoch: 10 | loss: 0.2271060
	speed: 0.0232s/iter; left time: 2.1807s
Epoch: 10 cost time: 23.941145181655884
Epoch: 10, Steps: 1093 | Train Loss: 0.2228820 Vali Loss: 0.1814967 Test Loss: 0.2137412
Validation loss decreased (0.181644 --> 0.181497).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_192_720_DLinear_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.21364957094192505, mae:0.30905818939208984
