Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2744448
	speed: 0.0314s/iter; left time: 337.0479s
	iters: 200, epoch: 1 | loss: 0.2586887
	speed: 0.0215s/iter; left time: 228.6670s
	iters: 300, epoch: 1 | loss: 0.2018441
	speed: 0.0207s/iter; left time: 218.2595s
	iters: 400, epoch: 1 | loss: 0.2082389
	speed: 0.0212s/iter; left time: 221.8035s
	iters: 500, epoch: 1 | loss: 0.2894730
	speed: 0.0226s/iter; left time: 233.2841s
	iters: 600, epoch: 1 | loss: 0.2066353
	speed: 0.0203s/iter; left time: 207.5893s
	iters: 700, epoch: 1 | loss: 0.2416746
	speed: 0.0213s/iter; left time: 215.5345s
	iters: 800, epoch: 1 | loss: 0.2444583
	speed: 0.0211s/iter; left time: 211.8631s
	iters: 900, epoch: 1 | loss: 0.2434834
	speed: 0.0217s/iter; left time: 215.8580s
	iters: 1000, epoch: 1 | loss: 0.2420012
	speed: 0.0212s/iter; left time: 208.6468s
Epoch: 1 cost time: 24.126805782318115
Epoch: 1, Steps: 1084 | Train Loss: 0.2378909 Vali Loss: 0.1811139 Test Loss: 0.2121696
Validation loss decreased (inf --> 0.181114).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2330038
	speed: 0.1870s/iter; left time: 1805.6928s
	iters: 200, epoch: 2 | loss: 0.2197639
	speed: 0.0219s/iter; left time: 209.1938s
	iters: 300, epoch: 2 | loss: 0.2317783
	speed: 0.0209s/iter; left time: 197.6191s
	iters: 400, epoch: 2 | loss: 0.2140980
	speed: 0.0215s/iter; left time: 201.0686s
	iters: 500, epoch: 2 | loss: 0.2104065
	speed: 0.0221s/iter; left time: 204.9145s
	iters: 600, epoch: 2 | loss: 0.2566913
	speed: 0.0223s/iter; left time: 204.1023s
	iters: 700, epoch: 2 | loss: 0.2135934
	speed: 0.0217s/iter; left time: 196.1425s
	iters: 800, epoch: 2 | loss: 0.2342722
	speed: 0.0224s/iter; left time: 200.5606s
	iters: 900, epoch: 2 | loss: 0.2357696
	speed: 0.0212s/iter; left time: 187.9737s
	iters: 1000, epoch: 2 | loss: 0.2252119
	speed: 0.0225s/iter; left time: 197.2364s
Epoch: 2 cost time: 24.68174386024475
Epoch: 2, Steps: 1084 | Train Loss: 0.2218178 Vali Loss: 0.1767024 Test Loss: 0.2090596
Validation loss decreased (0.181114 --> 0.176702).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2576621
	speed: 0.1852s/iter; left time: 1587.3126s
	iters: 200, epoch: 3 | loss: 0.1968541
	speed: 0.0219s/iter; left time: 185.4920s
	iters: 300, epoch: 3 | loss: 0.2021222
	speed: 0.0213s/iter; left time: 178.2675s
	iters: 400, epoch: 3 | loss: 0.2086315
	speed: 0.0213s/iter; left time: 176.1507s
	iters: 500, epoch: 3 | loss: 0.1868197
	speed: 0.0219s/iter; left time: 179.3167s
	iters: 600, epoch: 3 | loss: 0.2130412
	speed: 0.0215s/iter; left time: 173.4611s
	iters: 700, epoch: 3 | loss: 0.2002101
	speed: 0.0208s/iter; left time: 166.0341s
	iters: 800, epoch: 3 | loss: 0.2131144
	speed: 0.0216s/iter; left time: 170.0695s
	iters: 900, epoch: 3 | loss: 0.2186134
	speed: 0.0228s/iter; left time: 177.2550s
	iters: 1000, epoch: 3 | loss: 0.2074486
	speed: 0.0212s/iter; left time: 162.5194s
Epoch: 3 cost time: 24.377436876296997
Epoch: 3, Steps: 1084 | Train Loss: 0.2174631 Vali Loss: 0.1768249 Test Loss: 0.2075816
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1946626
	speed: 0.1872s/iter; left time: 1402.2586s
	iters: 200, epoch: 4 | loss: 0.2346689
	speed: 0.0217s/iter; left time: 160.4582s
	iters: 300, epoch: 4 | loss: 0.2229389
	speed: 0.0221s/iter; left time: 161.0720s
	iters: 400, epoch: 4 | loss: 0.2212362
	speed: 0.0231s/iter; left time: 165.9420s
	iters: 500, epoch: 4 | loss: 0.2221973
	speed: 0.0234s/iter; left time: 165.8172s
	iters: 600, epoch: 4 | loss: 0.2108852
	speed: 0.0220s/iter; left time: 153.5636s
	iters: 700, epoch: 4 | loss: 0.2081058
	speed: 0.0217s/iter; left time: 149.2810s
	iters: 800, epoch: 4 | loss: 0.2020999
	speed: 0.0213s/iter; left time: 144.7026s
	iters: 900, epoch: 4 | loss: 0.2218940
	speed: 0.0213s/iter; left time: 142.3036s
	iters: 1000, epoch: 4 | loss: 0.2311287
	speed: 0.0223s/iter; left time: 147.2076s
Epoch: 4 cost time: 24.635130167007446
Epoch: 4, Steps: 1084 | Train Loss: 0.2157644 Vali Loss: 0.1723604 Test Loss: 0.2043557
Validation loss decreased (0.176702 --> 0.172360).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2682507
	speed: 0.1871s/iter; left time: 1198.2420s
	iters: 200, epoch: 5 | loss: 0.2038100
	speed: 0.0217s/iter; left time: 136.6102s
	iters: 300, epoch: 5 | loss: 0.1942066
	speed: 0.0229s/iter; left time: 141.8073s
	iters: 400, epoch: 5 | loss: 0.2046271
	speed: 0.0227s/iter; left time: 138.4814s
	iters: 500, epoch: 5 | loss: 0.1990889
	speed: 0.0206s/iter; left time: 123.6213s
	iters: 600, epoch: 5 | loss: 0.2401812
	speed: 0.0226s/iter; left time: 133.5491s
	iters: 700, epoch: 5 | loss: 0.2302469
	speed: 0.0221s/iter; left time: 128.0985s
	iters: 800, epoch: 5 | loss: 0.2213179
	speed: 0.0226s/iter; left time: 128.6586s
	iters: 900, epoch: 5 | loss: 0.2222828
	speed: 0.0215s/iter; left time: 120.3388s
	iters: 1000, epoch: 5 | loss: 0.1893378
	speed: 0.0218s/iter; left time: 119.7948s
Epoch: 5 cost time: 24.71320652961731
Epoch: 5, Steps: 1084 | Train Loss: 0.2148378 Vali Loss: 0.1732283 Test Loss: 0.2056037
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2238937
	speed: 0.1864s/iter; left time: 991.8603s
	iters: 200, epoch: 6 | loss: 0.1888304
	speed: 0.0230s/iter; left time: 120.0305s
	iters: 300, epoch: 6 | loss: 0.2260992
	speed: 0.0220s/iter; left time: 112.8153s
	iters: 400, epoch: 6 | loss: 0.2192310
	speed: 0.0212s/iter; left time: 106.5053s
	iters: 500, epoch: 6 | loss: 0.2452989
	speed: 0.0221s/iter; left time: 108.7345s
	iters: 600, epoch: 6 | loss: 0.2493394
	speed: 0.0232s/iter; left time: 111.9332s
	iters: 700, epoch: 6 | loss: 0.2213839
	speed: 0.0238s/iter; left time: 112.3678s
	iters: 800, epoch: 6 | loss: 0.2204447
	speed: 0.0217s/iter; left time: 100.0798s
	iters: 900, epoch: 6 | loss: 0.2226448
	speed: 0.0238s/iter; left time: 107.5632s
	iters: 1000, epoch: 6 | loss: 0.2053587
	speed: 0.0241s/iter; left time: 106.5407s
Epoch: 6 cost time: 25.626880884170532
Epoch: 6, Steps: 1084 | Train Loss: 0.2143450 Vali Loss: 0.1725520 Test Loss: 0.2035674
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2327347
	speed: 0.1929s/iter; left time: 817.3377s
	iters: 200, epoch: 7 | loss: 0.2284542
	speed: 0.0221s/iter; left time: 91.4984s
	iters: 300, epoch: 7 | loss: 0.2039651
	speed: 0.0223s/iter; left time: 89.9638s
	iters: 400, epoch: 7 | loss: 0.2616265
	speed: 0.0222s/iter; left time: 87.5381s
	iters: 500, epoch: 7 | loss: 0.1827707
	speed: 0.0220s/iter; left time: 84.3459s
	iters: 600, epoch: 7 | loss: 0.2232878
	speed: 0.0216s/iter; left time: 80.6032s
	iters: 700, epoch: 7 | loss: 0.2298750
	speed: 0.0218s/iter; left time: 79.1220s
	iters: 800, epoch: 7 | loss: 0.2203191
	speed: 0.0221s/iter; left time: 78.1981s
	iters: 900, epoch: 7 | loss: 0.2150341
	speed: 0.0225s/iter; left time: 77.4220s
	iters: 1000, epoch: 7 | loss: 0.2017694
	speed: 0.0221s/iter; left time: 73.6152s
Epoch: 7 cost time: 25.07788348197937
Epoch: 7, Steps: 1084 | Train Loss: 0.2140607 Vali Loss: 0.1726573 Test Loss: 0.2049464
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.20426318049430847, mae:0.3004797697067261
