Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_672_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=672, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_672_720_DLinear_custom_ftM_sl672_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17021
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2591457
	speed: 0.0355s/iter; left time: 373.5908s
	iters: 200, epoch: 1 | loss: 0.2312762
	speed: 0.0262s/iter; left time: 273.2601s
	iters: 300, epoch: 1 | loss: 0.2177626
	speed: 0.0280s/iter; left time: 289.6515s
	iters: 400, epoch: 1 | loss: 0.2281937
	speed: 0.0282s/iter; left time: 288.7537s
	iters: 500, epoch: 1 | loss: 0.2084937
	speed: 0.0280s/iter; left time: 283.3940s
	iters: 600, epoch: 1 | loss: 0.2639949
	speed: 0.0275s/iter; left time: 275.3845s
	iters: 700, epoch: 1 | loss: 0.2146198
	speed: 0.0258s/iter; left time: 256.5630s
	iters: 800, epoch: 1 | loss: 0.2246747
	speed: 0.0275s/iter; left time: 270.6830s
	iters: 900, epoch: 1 | loss: 0.2124200
	speed: 0.0276s/iter; left time: 268.7445s
	iters: 1000, epoch: 1 | loss: 0.1892066
	speed: 0.0263s/iter; left time: 253.5283s
Epoch: 1 cost time: 29.895819425582886
Epoch: 1, Steps: 1063 | Train Loss: 0.2331682 Vali Loss: 0.1779139 Test Loss: 0.2086228
Validation loss decreased (inf --> 0.177914).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2269003
	speed: 0.2161s/iter; left time: 2046.0154s
	iters: 200, epoch: 2 | loss: 0.2337071
	speed: 0.0275s/iter; left time: 257.5659s
	iters: 300, epoch: 2 | loss: 0.2097145
	speed: 0.0274s/iter; left time: 254.2824s
	iters: 400, epoch: 2 | loss: 0.2039147
	speed: 0.0267s/iter; left time: 244.8336s
	iters: 500, epoch: 2 | loss: 0.2245327
	speed: 0.0262s/iter; left time: 237.9843s
	iters: 600, epoch: 2 | loss: 0.2074434
	speed: 0.0254s/iter; left time: 227.7408s
	iters: 700, epoch: 2 | loss: 0.2051618
	speed: 0.0267s/iter; left time: 236.4864s
	iters: 800, epoch: 2 | loss: 0.1997740
	speed: 0.0270s/iter; left time: 236.6318s
	iters: 900, epoch: 2 | loss: 0.2004127
	speed: 0.0291s/iter; left time: 252.0393s
	iters: 1000, epoch: 2 | loss: 0.2172863
	speed: 0.0271s/iter; left time: 232.0482s
Epoch: 2 cost time: 29.68630361557007
Epoch: 2, Steps: 1063 | Train Loss: 0.2195569 Vali Loss: 0.1778469 Test Loss: 0.2091129
Validation loss decreased (0.177914 --> 0.177847).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1936902
	speed: 0.2135s/iter; left time: 1794.2680s
	iters: 200, epoch: 3 | loss: 0.1988213
	speed: 0.0264s/iter; left time: 219.2438s
	iters: 300, epoch: 3 | loss: 0.1929515
	speed: 0.0263s/iter; left time: 216.1264s
	iters: 400, epoch: 3 | loss: 0.2293587
	speed: 0.0259s/iter; left time: 210.1215s
	iters: 500, epoch: 3 | loss: 0.2580681
	speed: 0.0269s/iter; left time: 215.6169s
	iters: 600, epoch: 3 | loss: 0.1979157
	speed: 0.0263s/iter; left time: 207.7436s
	iters: 700, epoch: 3 | loss: 0.2210208
	speed: 0.0256s/iter; left time: 200.0789s
	iters: 800, epoch: 3 | loss: 0.2351039
	speed: 0.0282s/iter; left time: 216.9004s
	iters: 900, epoch: 3 | loss: 0.2102659
	speed: 0.0270s/iter; left time: 205.1275s
	iters: 1000, epoch: 3 | loss: 0.1752417
	speed: 0.0258s/iter; left time: 193.9632s
Epoch: 3 cost time: 29.26499581336975
Epoch: 3, Steps: 1063 | Train Loss: 0.2122169 Vali Loss: 0.1691303 Test Loss: 0.2011133
Validation loss decreased (0.177847 --> 0.169130).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1999633
	speed: 0.2141s/iter; left time: 1571.5820s
	iters: 200, epoch: 4 | loss: 0.1949070
	speed: 0.0265s/iter; left time: 191.8306s
	iters: 300, epoch: 4 | loss: 0.2183430
	speed: 0.0266s/iter; left time: 189.6493s
	iters: 400, epoch: 4 | loss: 0.1805034
	speed: 0.0274s/iter; left time: 192.9711s
	iters: 500, epoch: 4 | loss: 0.2218872
	speed: 0.0278s/iter; left time: 193.1564s
	iters: 600, epoch: 4 | loss: 0.2012528
	speed: 0.0262s/iter; left time: 179.2029s
	iters: 700, epoch: 4 | loss: 0.1950891
	speed: 0.0274s/iter; left time: 184.5770s
	iters: 800, epoch: 4 | loss: 0.2101104
	speed: 0.0257s/iter; left time: 171.0065s
	iters: 900, epoch: 4 | loss: 0.2079697
	speed: 0.0271s/iter; left time: 177.3653s
	iters: 1000, epoch: 4 | loss: 0.1895413
	speed: 0.0256s/iter; left time: 164.7609s
Epoch: 4 cost time: 29.30670928955078
Epoch: 4, Steps: 1063 | Train Loss: 0.2092223 Vali Loss: 0.1705784 Test Loss: 0.2023822
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2034927
	speed: 0.2109s/iter; left time: 1324.1376s
	iters: 200, epoch: 5 | loss: 0.1975571
	speed: 0.0268s/iter; left time: 165.7412s
	iters: 300, epoch: 5 | loss: 0.1972358
	speed: 0.0263s/iter; left time: 159.7908s
	iters: 400, epoch: 5 | loss: 0.1936505
	speed: 0.0267s/iter; left time: 159.8037s
	iters: 500, epoch: 5 | loss: 0.1863943
	speed: 0.0264s/iter; left time: 155.0299s
	iters: 600, epoch: 5 | loss: 0.2023650
	speed: 0.0267s/iter; left time: 154.4469s
	iters: 700, epoch: 5 | loss: 0.2517057
	speed: 0.0267s/iter; left time: 151.3622s
	iters: 800, epoch: 5 | loss: 0.2479670
	speed: 0.0271s/iter; left time: 151.1168s
	iters: 900, epoch: 5 | loss: 0.2032373
	speed: 0.0272s/iter; left time: 148.9701s
	iters: 1000, epoch: 5 | loss: 0.2096526
	speed: 0.0269s/iter; left time: 144.5075s
Epoch: 5 cost time: 29.228965520858765
Epoch: 5, Steps: 1063 | Train Loss: 0.2075837 Vali Loss: 0.1667023 Test Loss: 0.1989906
Validation loss decreased (0.169130 --> 0.166702).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2042818
	speed: 0.2121s/iter; left time: 1106.3019s
	iters: 200, epoch: 6 | loss: 0.2221600
	speed: 0.0282s/iter; left time: 144.3589s
	iters: 300, epoch: 6 | loss: 0.1823869
	speed: 0.0264s/iter; left time: 132.4008s
	iters: 400, epoch: 6 | loss: 0.1949589
	speed: 0.0270s/iter; left time: 132.9210s
	iters: 500, epoch: 6 | loss: 0.1792044
	speed: 0.0272s/iter; left time: 131.1345s
	iters: 600, epoch: 6 | loss: 0.1846760
	speed: 0.0276s/iter; left time: 130.2919s
	iters: 700, epoch: 6 | loss: 0.2044494
	speed: 0.0268s/iter; left time: 123.8316s
	iters: 800, epoch: 6 | loss: 0.1792718
	speed: 0.0278s/iter; left time: 125.4405s
	iters: 900, epoch: 6 | loss: 0.1911523
	speed: 0.0274s/iter; left time: 120.8501s
	iters: 1000, epoch: 6 | loss: 0.1895974
	speed: 0.0283s/iter; left time: 122.0197s
Epoch: 6 cost time: 29.86395812034607
Epoch: 6, Steps: 1063 | Train Loss: 0.2067516 Vali Loss: 0.1660179 Test Loss: 0.1978409
Validation loss decreased (0.166702 --> 0.166018).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2201679
	speed: 0.2093s/iter; left time: 869.2838s
	iters: 200, epoch: 7 | loss: 0.2144992
	speed: 0.0283s/iter; left time: 114.5657s
	iters: 300, epoch: 7 | loss: 0.2479053
	speed: 0.0281s/iter; left time: 111.0701s
	iters: 400, epoch: 7 | loss: 0.2351427
	speed: 0.0295s/iter; left time: 113.4833s
	iters: 500, epoch: 7 | loss: 0.1803236
	speed: 0.0291s/iter; left time: 109.1751s
	iters: 600, epoch: 7 | loss: 0.1862580
	speed: 0.0269s/iter; left time: 98.0837s
	iters: 700, epoch: 7 | loss: 0.2425403
	speed: 0.0278s/iter; left time: 98.7357s
	iters: 800, epoch: 7 | loss: 0.1845987
	speed: 0.0290s/iter; left time: 100.2899s
	iters: 900, epoch: 7 | loss: 0.2534072
	speed: 0.0280s/iter; left time: 93.7788s
	iters: 1000, epoch: 7 | loss: 0.1999155
	speed: 0.0293s/iter; left time: 95.2375s
Epoch: 7 cost time: 30.97721242904663
Epoch: 7, Steps: 1063 | Train Loss: 0.2062610 Vali Loss: 0.1669627 Test Loss: 0.1987021
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1902189
	speed: 0.2156s/iter; left time: 666.0828s
	iters: 200, epoch: 8 | loss: 0.1725772
	speed: 0.0265s/iter; left time: 79.3385s
	iters: 300, epoch: 8 | loss: 0.2027541
	speed: 0.0261s/iter; left time: 75.3400s
	iters: 400, epoch: 8 | loss: 0.1921109
	speed: 0.0266s/iter; left time: 74.3287s
	iters: 500, epoch: 8 | loss: 0.2336861
	speed: 0.0263s/iter; left time: 70.7857s
	iters: 600, epoch: 8 | loss: 0.1886327
	speed: 0.0280s/iter; left time: 72.4776s
	iters: 700, epoch: 8 | loss: 0.1803099
	speed: 0.0271s/iter; left time: 67.4172s
	iters: 800, epoch: 8 | loss: 0.2128005
	speed: 0.0269s/iter; left time: 64.1927s
	iters: 900, epoch: 8 | loss: 0.1890408
	speed: 0.0261s/iter; left time: 59.8204s
	iters: 1000, epoch: 8 | loss: 0.2183810
	speed: 0.0296s/iter; left time: 64.8057s
Epoch: 8 cost time: 29.730987310409546
Epoch: 8, Steps: 1063 | Train Loss: 0.2060023 Vali Loss: 0.1665786 Test Loss: 0.1984011
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2015825
	speed: 0.2213s/iter; left time: 448.5227s
	iters: 200, epoch: 9 | loss: 0.2194912
	speed: 0.0281s/iter; left time: 54.1511s
	iters: 300, epoch: 9 | loss: 0.1956181
	speed: 0.0283s/iter; left time: 51.6172s
	iters: 400, epoch: 9 | loss: 0.1811828
	speed: 0.0269s/iter; left time: 46.4038s
	iters: 500, epoch: 9 | loss: 0.1874511
	speed: 0.0276s/iter; left time: 44.8857s
	iters: 600, epoch: 9 | loss: 0.1758232
	speed: 0.0269s/iter; left time: 41.0084s
	iters: 700, epoch: 9 | loss: 0.2089508
	speed: 0.0267s/iter; left time: 38.1663s
	iters: 800, epoch: 9 | loss: 0.2036885
	speed: 0.0275s/iter; left time: 36.4712s
	iters: 900, epoch: 9 | loss: 0.1886711
	speed: 0.0263s/iter; left time: 32.2978s
	iters: 1000, epoch: 9 | loss: 0.2388592
	speed: 0.0277s/iter; left time: 31.1684s
Epoch: 9 cost time: 30.046875715255737
Epoch: 9, Steps: 1063 | Train Loss: 0.2058328 Vali Loss: 0.1662246 Test Loss: 0.1979435
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_672_720_DLinear_custom_ftM_sl672_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.19774875044822693, mae:0.29511693120002747
