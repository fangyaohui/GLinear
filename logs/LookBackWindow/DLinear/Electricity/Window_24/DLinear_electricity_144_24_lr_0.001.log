Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_144_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_144_24_DLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18245
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1877665
	speed: 0.0207s/iter; left time: 234.1969s
	iters: 200, epoch: 1 | loss: 0.1454290
	speed: 0.0142s/iter; left time: 159.5337s
	iters: 300, epoch: 1 | loss: 0.1482529
	speed: 0.0131s/iter; left time: 145.2664s
	iters: 400, epoch: 1 | loss: 0.1686756
	speed: 0.0141s/iter; left time: 155.1883s
	iters: 500, epoch: 1 | loss: 0.1441817
	speed: 0.0130s/iter; left time: 141.5745s
	iters: 600, epoch: 1 | loss: 0.1983750
	speed: 0.0141s/iter; left time: 152.1778s
	iters: 700, epoch: 1 | loss: 0.1419983
	speed: 0.0133s/iter; left time: 142.7654s
	iters: 800, epoch: 1 | loss: 0.1506823
	speed: 0.0142s/iter; left time: 150.9108s
	iters: 900, epoch: 1 | loss: 0.1336634
	speed: 0.0136s/iter; left time: 143.2013s
	iters: 1000, epoch: 1 | loss: 0.1638693
	speed: 0.0137s/iter; left time: 142.8699s
	iters: 1100, epoch: 1 | loss: 0.1381049
	speed: 0.0135s/iter; left time: 139.3789s
Epoch: 1 cost time: 16.398391008377075
Epoch: 1, Steps: 1140 | Train Loss: 0.1716359 Vali Loss: 0.1353184 Test Loss: 0.1482246
Validation loss decreased (inf --> 0.135318).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1474120
	speed: 0.1053s/iter; left time: 1069.8796s
	iters: 200, epoch: 2 | loss: 0.1465300
	speed: 0.0127s/iter; left time: 128.2484s
	iters: 300, epoch: 2 | loss: 0.1277712
	speed: 0.0139s/iter; left time: 138.0396s
	iters: 400, epoch: 2 | loss: 0.1155500
	speed: 0.0137s/iter; left time: 135.0702s
	iters: 500, epoch: 2 | loss: 0.1122296
	speed: 0.0136s/iter; left time: 132.7877s
	iters: 600, epoch: 2 | loss: 0.1355093
	speed: 0.0138s/iter; left time: 133.0774s
	iters: 700, epoch: 2 | loss: 0.1293490
	speed: 0.0138s/iter; left time: 131.8004s
	iters: 800, epoch: 2 | loss: 0.2038836
	speed: 0.0136s/iter; left time: 128.7969s
	iters: 900, epoch: 2 | loss: 0.1541726
	speed: 0.0133s/iter; left time: 124.9487s
	iters: 1000, epoch: 2 | loss: 0.1216170
	speed: 0.0140s/iter; left time: 129.9265s
	iters: 1100, epoch: 2 | loss: 0.1390328
	speed: 0.0127s/iter; left time: 116.5578s
Epoch: 2 cost time: 16.47655701637268
Epoch: 2, Steps: 1140 | Train Loss: 0.1478160 Vali Loss: 0.1330412 Test Loss: 0.1458789
Validation loss decreased (0.135318 --> 0.133041).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1360457
	speed: 0.1025s/iter; left time: 924.7225s
	iters: 200, epoch: 3 | loss: 0.1267839
	speed: 0.0136s/iter; left time: 121.1006s
	iters: 300, epoch: 3 | loss: 0.1489284
	speed: 0.0141s/iter; left time: 124.2720s
	iters: 400, epoch: 3 | loss: 0.1333173
	speed: 0.0125s/iter; left time: 108.6970s
	iters: 500, epoch: 3 | loss: 0.1460462
	speed: 0.0140s/iter; left time: 120.3769s
	iters: 600, epoch: 3 | loss: 0.1536541
	speed: 0.0128s/iter; left time: 108.8926s
	iters: 700, epoch: 3 | loss: 0.1222254
	speed: 0.0141s/iter; left time: 118.3310s
	iters: 800, epoch: 3 | loss: 0.1285065
	speed: 0.0134s/iter; left time: 111.4933s
	iters: 900, epoch: 3 | loss: 0.1925786
	speed: 0.0135s/iter; left time: 110.8712s
	iters: 1000, epoch: 3 | loss: 0.1288676
	speed: 0.0134s/iter; left time: 108.8892s
	iters: 1100, epoch: 3 | loss: 0.1432609
	speed: 0.0136s/iter; left time: 108.7457s
Epoch: 3 cost time: 16.21965765953064
Epoch: 3, Steps: 1140 | Train Loss: 0.1462892 Vali Loss: 0.1319541 Test Loss: 0.1449124
Validation loss decreased (0.133041 --> 0.131954).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1416282
	speed: 0.1033s/iter; left time: 813.7133s
	iters: 200, epoch: 4 | loss: 0.1328359
	speed: 0.0134s/iter; left time: 104.5159s
	iters: 300, epoch: 4 | loss: 0.1453094
	speed: 0.0125s/iter; left time: 96.1751s
	iters: 400, epoch: 4 | loss: 0.1228603
	speed: 0.0131s/iter; left time: 99.1517s
	iters: 500, epoch: 4 | loss: 0.2191973
	speed: 0.0139s/iter; left time: 103.7020s
	iters: 600, epoch: 4 | loss: 0.1515662
	speed: 0.0131s/iter; left time: 97.0425s
	iters: 700, epoch: 4 | loss: 0.2051305
	speed: 0.0141s/iter; left time: 102.7648s
	iters: 800, epoch: 4 | loss: 0.1847032
	speed: 0.0136s/iter; left time: 97.8225s
	iters: 900, epoch: 4 | loss: 0.1429476
	speed: 0.0138s/iter; left time: 98.0569s
	iters: 1000, epoch: 4 | loss: 0.1325235
	speed: 0.0137s/iter; left time: 95.9590s
	iters: 1100, epoch: 4 | loss: 0.1279246
	speed: 0.0134s/iter; left time: 92.5186s
Epoch: 4 cost time: 16.395503044128418
Epoch: 4, Steps: 1140 | Train Loss: 0.1456959 Vali Loss: 0.1318623 Test Loss: 0.1449020
Validation loss decreased (0.131954 --> 0.131862).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1270049
	speed: 0.1038s/iter; left time: 699.5800s
	iters: 200, epoch: 5 | loss: 0.1461677
	speed: 0.0138s/iter; left time: 91.8221s
	iters: 300, epoch: 5 | loss: 0.1651580
	speed: 0.0122s/iter; left time: 79.7293s
	iters: 400, epoch: 5 | loss: 0.1388058
	speed: 0.0130s/iter; left time: 83.7506s
	iters: 500, epoch: 5 | loss: 0.1266524
	speed: 0.0139s/iter; left time: 87.9278s
	iters: 600, epoch: 5 | loss: 0.1449335
	speed: 0.0128s/iter; left time: 80.1634s
	iters: 700, epoch: 5 | loss: 0.1176119
	speed: 0.0136s/iter; left time: 83.4363s
	iters: 800, epoch: 5 | loss: 0.1796134
	speed: 0.0138s/iter; left time: 83.1991s
	iters: 900, epoch: 5 | loss: 0.1281179
	speed: 0.0138s/iter; left time: 82.1732s
	iters: 1000, epoch: 5 | loss: 0.1407296
	speed: 0.0138s/iter; left time: 80.4147s
	iters: 1100, epoch: 5 | loss: 0.1721641
	speed: 0.0130s/iter; left time: 74.8133s
Epoch: 5 cost time: 16.24048924446106
Epoch: 5, Steps: 1140 | Train Loss: 0.1453593 Vali Loss: 0.1314985 Test Loss: 0.1442499
Validation loss decreased (0.131862 --> 0.131499).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1350176
	speed: 0.1037s/iter; left time: 580.8699s
	iters: 200, epoch: 6 | loss: 0.1496531
	speed: 0.0141s/iter; left time: 77.7736s
	iters: 300, epoch: 6 | loss: 0.1308748
	speed: 0.0123s/iter; left time: 66.4717s
	iters: 400, epoch: 6 | loss: 0.1609386
	speed: 0.0134s/iter; left time: 71.1831s
	iters: 500, epoch: 6 | loss: 0.1516645
	speed: 0.0133s/iter; left time: 69.4140s
	iters: 600, epoch: 6 | loss: 0.1318040
	speed: 0.0133s/iter; left time: 68.0683s
	iters: 700, epoch: 6 | loss: 0.1952133
	speed: 0.0140s/iter; left time: 70.1133s
	iters: 800, epoch: 6 | loss: 0.1330919
	speed: 0.0131s/iter; left time: 64.0672s
	iters: 900, epoch: 6 | loss: 0.1433525
	speed: 0.0137s/iter; left time: 65.6399s
	iters: 1000, epoch: 6 | loss: 0.1316437
	speed: 0.0129s/iter; left time: 60.7875s
	iters: 1100, epoch: 6 | loss: 0.1189328
	speed: 0.0141s/iter; left time: 64.6478s
Epoch: 6 cost time: 16.32832360267639
Epoch: 6, Steps: 1140 | Train Loss: 0.1452057 Vali Loss: 0.1315689 Test Loss: 0.1447141
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1270451
	speed: 0.1022s/iter; left time: 456.0282s
	iters: 200, epoch: 7 | loss: 0.1131358
	speed: 0.0140s/iter; left time: 61.0273s
	iters: 300, epoch: 7 | loss: 0.1924863
	speed: 0.0138s/iter; left time: 58.6073s
	iters: 400, epoch: 7 | loss: 0.1364516
	speed: 0.0144s/iter; left time: 59.8312s
	iters: 500, epoch: 7 | loss: 0.1193470
	speed: 0.0137s/iter; left time: 55.5090s
	iters: 600, epoch: 7 | loss: 0.2292977
	speed: 0.0138s/iter; left time: 54.8233s
	iters: 700, epoch: 7 | loss: 0.1554919
	speed: 0.0134s/iter; left time: 51.8460s
	iters: 800, epoch: 7 | loss: 0.1281293
	speed: 0.0137s/iter; left time: 51.5083s
	iters: 900, epoch: 7 | loss: 0.1295675
	speed: 0.0136s/iter; left time: 49.9432s
	iters: 1000, epoch: 7 | loss: 0.2117301
	speed: 0.0134s/iter; left time: 47.5471s
	iters: 1100, epoch: 7 | loss: 0.1454613
	speed: 0.0139s/iter; left time: 48.0184s
Epoch: 7 cost time: 16.41275191307068
Epoch: 7, Steps: 1140 | Train Loss: 0.1451297 Vali Loss: 0.1312831 Test Loss: 0.1442025
Validation loss decreased (0.131499 --> 0.131283).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1103361
	speed: 0.1038s/iter; left time: 344.6741s
	iters: 200, epoch: 8 | loss: 0.1501419
	speed: 0.0136s/iter; left time: 43.7397s
	iters: 300, epoch: 8 | loss: 0.1214385
	speed: 0.0134s/iter; left time: 41.7535s
	iters: 400, epoch: 8 | loss: 0.1545217
	speed: 0.0135s/iter; left time: 40.9023s
	iters: 500, epoch: 8 | loss: 0.1217092
	speed: 0.0132s/iter; left time: 38.4398s
	iters: 600, epoch: 8 | loss: 0.1350254
	speed: 0.0136s/iter; left time: 38.4243s
	iters: 700, epoch: 8 | loss: 0.1327181
	speed: 0.0130s/iter; left time: 35.3870s
	iters: 800, epoch: 8 | loss: 0.1433505
	speed: 0.0137s/iter; left time: 35.9225s
	iters: 900, epoch: 8 | loss: 0.1384043
	speed: 0.0134s/iter; left time: 33.7202s
	iters: 1000, epoch: 8 | loss: 0.1382608
	speed: 0.0137s/iter; left time: 33.0875s
	iters: 1100, epoch: 8 | loss: 0.1812140
	speed: 0.0134s/iter; left time: 31.0554s
Epoch: 8 cost time: 16.07448935508728
Epoch: 8, Steps: 1140 | Train Loss: 0.1450341 Vali Loss: 0.1312381 Test Loss: 0.1441686
Validation loss decreased (0.131283 --> 0.131238).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1323386
	speed: 0.0995s/iter; left time: 216.9730s
	iters: 200, epoch: 9 | loss: 0.1591741
	speed: 0.0129s/iter; left time: 26.7452s
	iters: 300, epoch: 9 | loss: 0.1396710
	speed: 0.0133s/iter; left time: 26.3850s
	iters: 400, epoch: 9 | loss: 0.1451612
	speed: 0.0134s/iter; left time: 25.2089s
	iters: 500, epoch: 9 | loss: 0.2126318
	speed: 0.0133s/iter; left time: 23.6080s
	iters: 600, epoch: 9 | loss: 0.1185828
	speed: 0.0137s/iter; left time: 22.9886s
	iters: 700, epoch: 9 | loss: 0.1594007
	speed: 0.0129s/iter; left time: 20.3463s
	iters: 800, epoch: 9 | loss: 0.1360652
	speed: 0.0138s/iter; left time: 20.4471s
	iters: 900, epoch: 9 | loss: 0.1576081
	speed: 0.0130s/iter; left time: 17.9155s
	iters: 1000, epoch: 9 | loss: 0.1315106
	speed: 0.0135s/iter; left time: 17.2867s
	iters: 1100, epoch: 9 | loss: 0.1577292
	speed: 0.0130s/iter; left time: 15.3730s
Epoch: 9 cost time: 15.958598136901855
Epoch: 9, Steps: 1140 | Train Loss: 0.1450456 Vali Loss: 0.1312433 Test Loss: 0.1441854
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1472315
	speed: 0.0952s/iter; left time: 99.0702s
	iters: 200, epoch: 10 | loss: 0.1138552
	speed: 0.0080s/iter; left time: 7.5390s
	iters: 300, epoch: 10 | loss: 0.1065730
	speed: 0.0078s/iter; left time: 6.5866s
	iters: 400, epoch: 10 | loss: 0.1529233
	speed: 0.0096s/iter; left time: 7.1023s
	iters: 500, epoch: 10 | loss: 0.1391953
	speed: 0.0075s/iter; left time: 4.8153s
	iters: 600, epoch: 10 | loss: 0.1242933
	speed: 0.0090s/iter; left time: 4.8838s
	iters: 700, epoch: 10 | loss: 0.1351477
	speed: 0.0082s/iter; left time: 3.5976s
	iters: 800, epoch: 10 | loss: 0.1214324
	speed: 0.0106s/iter; left time: 3.6266s
	iters: 900, epoch: 10 | loss: 0.1159053
	speed: 0.0079s/iter; left time: 1.9021s
	iters: 1000, epoch: 10 | loss: 0.1259238
	speed: 0.0087s/iter; left time: 1.2236s
	iters: 1100, epoch: 10 | loss: 0.1538937
	speed: 0.0095s/iter; left time: 0.3904s
Epoch: 10 cost time: 10.79787278175354
Epoch: 10, Steps: 1140 | Train Loss: 0.1450428 Vali Loss: 0.1312288 Test Loss: 0.1441578
Validation loss decreased (0.131238 --> 0.131229).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_144_24_DLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.1436498463153839, mae:0.23537765443325043
