Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_120_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=120, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_120_24_DLinear_custom_ftM_sl120_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18269
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2339492
	speed: 0.0205s/iter; left time: 232.2054s
	iters: 200, epoch: 1 | loss: 0.1572722
	speed: 0.0129s/iter; left time: 144.5627s
	iters: 300, epoch: 1 | loss: 0.1620998
	speed: 0.0126s/iter; left time: 139.5599s
	iters: 400, epoch: 1 | loss: 0.2040917
	speed: 0.0127s/iter; left time: 140.1598s
	iters: 500, epoch: 1 | loss: 0.1693785
	speed: 0.0135s/iter; left time: 146.9503s
	iters: 600, epoch: 1 | loss: 0.1426379
	speed: 0.0124s/iter; left time: 133.6223s
	iters: 700, epoch: 1 | loss: 0.1994736
	speed: 0.0126s/iter; left time: 135.0022s
	iters: 800, epoch: 1 | loss: 0.2085093
	speed: 0.0125s/iter; left time: 133.0291s
	iters: 900, epoch: 1 | loss: 0.1542016
	speed: 0.0130s/iter; left time: 136.2181s
	iters: 1000, epoch: 1 | loss: 0.2045193
	speed: 0.0134s/iter; left time: 139.2394s
	iters: 1100, epoch: 1 | loss: 0.1841779
	speed: 0.0123s/iter; left time: 127.3384s
Epoch: 1 cost time: 15.429767847061157
Epoch: 1, Steps: 1141 | Train Loss: 0.1878803 Vali Loss: 0.1505192 Test Loss: 0.1617574
Validation loss decreased (inf --> 0.150519).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1352747
	speed: 0.0994s/iter; left time: 1010.8305s
	iters: 200, epoch: 2 | loss: 0.1316343
	speed: 0.0128s/iter; left time: 128.8736s
	iters: 300, epoch: 2 | loss: 0.1559466
	speed: 0.0137s/iter; left time: 136.5472s
	iters: 400, epoch: 2 | loss: 0.1568165
	speed: 0.0128s/iter; left time: 126.1818s
	iters: 500, epoch: 2 | loss: 0.1858390
	speed: 0.0130s/iter; left time: 126.9297s
	iters: 600, epoch: 2 | loss: 0.1851221
	speed: 0.0135s/iter; left time: 130.4129s
	iters: 700, epoch: 2 | loss: 0.1556888
	speed: 0.0129s/iter; left time: 123.4854s
	iters: 800, epoch: 2 | loss: 0.1620124
	speed: 0.0134s/iter; left time: 126.4603s
	iters: 900, epoch: 2 | loss: 0.1647105
	speed: 0.0130s/iter; left time: 121.7720s
	iters: 1000, epoch: 2 | loss: 0.1621388
	speed: 0.0135s/iter; left time: 125.3615s
	iters: 1100, epoch: 2 | loss: 0.1535122
	speed: 0.0130s/iter; left time: 119.2994s
Epoch: 2 cost time: 15.9687020778656
Epoch: 2, Steps: 1141 | Train Loss: 0.1630276 Vali Loss: 0.1490855 Test Loss: 0.1607704
Validation loss decreased (0.150519 --> 0.149085).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1673683
	speed: 0.1044s/iter; left time: 942.8954s
	iters: 200, epoch: 3 | loss: 0.1583979
	speed: 0.0122s/iter; left time: 109.3508s
	iters: 300, epoch: 3 | loss: 0.1593666
	speed: 0.0129s/iter; left time: 113.4983s
	iters: 400, epoch: 3 | loss: 0.1652320
	speed: 0.0126s/iter; left time: 109.7191s
	iters: 500, epoch: 3 | loss: 0.1280038
	speed: 0.0117s/iter; left time: 101.3325s
	iters: 600, epoch: 3 | loss: 0.1458138
	speed: 0.0127s/iter; left time: 108.2883s
	iters: 700, epoch: 3 | loss: 0.1393991
	speed: 0.0114s/iter; left time: 96.4784s
	iters: 800, epoch: 3 | loss: 0.1642867
	speed: 0.0121s/iter; left time: 100.4072s
	iters: 900, epoch: 3 | loss: 0.1527604
	speed: 0.0131s/iter; left time: 108.0910s
	iters: 1000, epoch: 3 | loss: 0.1912587
	speed: 0.0111s/iter; left time: 90.4946s
	iters: 1100, epoch: 3 | loss: 0.1333121
	speed: 0.0134s/iter; left time: 107.6663s
Epoch: 3 cost time: 15.290122509002686
Epoch: 3, Steps: 1141 | Train Loss: 0.1614980 Vali Loss: 0.1476638 Test Loss: 0.1593136
Validation loss decreased (0.149085 --> 0.147664).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1517362
	speed: 0.1047s/iter; left time: 826.1905s
	iters: 200, epoch: 4 | loss: 0.1175160
	speed: 0.0131s/iter; left time: 102.0021s
	iters: 300, epoch: 4 | loss: 0.1573848
	speed: 0.0123s/iter; left time: 94.6812s
	iters: 400, epoch: 4 | loss: 0.1594157
	speed: 0.0134s/iter; left time: 101.5497s
	iters: 500, epoch: 4 | loss: 0.1458283
	speed: 0.0137s/iter; left time: 102.6681s
	iters: 600, epoch: 4 | loss: 0.1543633
	speed: 0.0106s/iter; left time: 78.5629s
	iters: 700, epoch: 4 | loss: 0.1388321
	speed: 0.0127s/iter; left time: 92.2989s
	iters: 800, epoch: 4 | loss: 0.1888139
	speed: 0.0129s/iter; left time: 92.8664s
	iters: 900, epoch: 4 | loss: 0.1754027
	speed: 0.0138s/iter; left time: 97.6419s
	iters: 1000, epoch: 4 | loss: 0.1405289
	speed: 0.0137s/iter; left time: 96.0432s
	iters: 1100, epoch: 4 | loss: 0.1655057
	speed: 0.0120s/iter; left time: 82.9483s
Epoch: 4 cost time: 15.536721229553223
Epoch: 4, Steps: 1141 | Train Loss: 0.1609871 Vali Loss: 0.1476945 Test Loss: 0.1591625
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1411995
	speed: 0.1030s/iter; left time: 695.2762s
	iters: 200, epoch: 5 | loss: 0.1511338
	speed: 0.0128s/iter; left time: 85.0802s
	iters: 300, epoch: 5 | loss: 0.1602273
	speed: 0.0136s/iter; left time: 88.9283s
	iters: 400, epoch: 5 | loss: 0.1445804
	speed: 0.0133s/iter; left time: 85.5497s
	iters: 500, epoch: 5 | loss: 0.1797609
	speed: 0.0135s/iter; left time: 85.8843s
	iters: 600, epoch: 5 | loss: 0.1702233
	speed: 0.0136s/iter; left time: 84.9051s
	iters: 700, epoch: 5 | loss: 0.1646755
	speed: 0.0123s/iter; left time: 75.4074s
	iters: 800, epoch: 5 | loss: 0.2227604
	speed: 0.0132s/iter; left time: 79.7818s
	iters: 900, epoch: 5 | loss: 0.1751529
	speed: 0.0128s/iter; left time: 76.0505s
	iters: 1000, epoch: 5 | loss: 0.1443585
	speed: 0.0131s/iter; left time: 76.4103s
	iters: 1100, epoch: 5 | loss: 0.2286748
	speed: 0.0128s/iter; left time: 73.7434s
Epoch: 5 cost time: 15.828464031219482
Epoch: 5, Steps: 1141 | Train Loss: 0.1606943 Vali Loss: 0.1472313 Test Loss: 0.1586914
Validation loss decreased (0.147664 --> 0.147231).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2008116
	speed: 0.0969s/iter; left time: 543.3954s
	iters: 200, epoch: 6 | loss: 0.1236573
	speed: 0.0135s/iter; left time: 74.1574s
	iters: 300, epoch: 6 | loss: 0.1558626
	speed: 0.0125s/iter; left time: 67.7618s
	iters: 400, epoch: 6 | loss: 0.2078944
	speed: 0.0134s/iter; left time: 70.8396s
	iters: 500, epoch: 6 | loss: 0.1316229
	speed: 0.0124s/iter; left time: 64.4019s
	iters: 600, epoch: 6 | loss: 0.1511560
	speed: 0.0134s/iter; left time: 68.2649s
	iters: 700, epoch: 6 | loss: 0.2219429
	speed: 0.0123s/iter; left time: 61.4077s
	iters: 800, epoch: 6 | loss: 0.1457426
	speed: 0.0125s/iter; left time: 61.4930s
	iters: 900, epoch: 6 | loss: 0.1504276
	speed: 0.0129s/iter; left time: 62.0897s
	iters: 1000, epoch: 6 | loss: 0.1423587
	speed: 0.0121s/iter; left time: 57.0905s
	iters: 1100, epoch: 6 | loss: 0.1753475
	speed: 0.0129s/iter; left time: 59.2714s
Epoch: 6 cost time: 15.348680973052979
Epoch: 6, Steps: 1141 | Train Loss: 0.1605655 Vali Loss: 0.1469654 Test Loss: 0.1585444
Validation loss decreased (0.147231 --> 0.146965).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2608134
	speed: 0.0974s/iter; left time: 434.9986s
	iters: 200, epoch: 7 | loss: 0.1456718
	speed: 0.0127s/iter; left time: 55.2264s
	iters: 300, epoch: 7 | loss: 0.2585314
	speed: 0.0130s/iter; left time: 55.5001s
	iters: 400, epoch: 7 | loss: 0.1432847
	speed: 0.0127s/iter; left time: 53.0940s
	iters: 500, epoch: 7 | loss: 0.2014539
	speed: 0.0133s/iter; left time: 54.2438s
	iters: 600, epoch: 7 | loss: 0.1492310
	speed: 0.0127s/iter; left time: 50.2974s
	iters: 700, epoch: 7 | loss: 0.1564180
	speed: 0.0133s/iter; left time: 51.4267s
	iters: 800, epoch: 7 | loss: 0.1397615
	speed: 0.0136s/iter; left time: 51.0807s
	iters: 900, epoch: 7 | loss: 0.1584201
	speed: 0.0130s/iter; left time: 47.5273s
	iters: 1000, epoch: 7 | loss: 0.1729651
	speed: 0.0141s/iter; left time: 50.2382s
	iters: 1100, epoch: 7 | loss: 0.1413579
	speed: 0.0126s/iter; left time: 43.7179s
Epoch: 7 cost time: 15.716410160064697
Epoch: 7, Steps: 1141 | Train Loss: 0.1604559 Vali Loss: 0.1469546 Test Loss: 0.1585437
Validation loss decreased (0.146965 --> 0.146955).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1694843
	speed: 0.0965s/iter; left time: 320.8596s
	iters: 200, epoch: 8 | loss: 0.1517301
	speed: 0.0127s/iter; left time: 40.9866s
	iters: 300, epoch: 8 | loss: 0.1358829
	speed: 0.0134s/iter; left time: 41.7652s
	iters: 400, epoch: 8 | loss: 0.1629331
	speed: 0.0130s/iter; left time: 39.2680s
	iters: 500, epoch: 8 | loss: 0.1656459
	speed: 0.0125s/iter; left time: 36.6403s
	iters: 600, epoch: 8 | loss: 0.1607307
	speed: 0.0129s/iter; left time: 36.3492s
	iters: 700, epoch: 8 | loss: 0.1604320
	speed: 0.0127s/iter; left time: 34.5573s
	iters: 800, epoch: 8 | loss: 0.2077497
	speed: 0.0129s/iter; left time: 33.8819s
	iters: 900, epoch: 8 | loss: 0.1644282
	speed: 0.0128s/iter; left time: 32.2415s
	iters: 1000, epoch: 8 | loss: 0.1636601
	speed: 0.0129s/iter; left time: 31.1530s
	iters: 1100, epoch: 8 | loss: 0.1671528
	speed: 0.0134s/iter; left time: 31.1181s
Epoch: 8 cost time: 15.477818727493286
Epoch: 8, Steps: 1141 | Train Loss: 0.1604250 Vali Loss: 0.1468739 Test Loss: 0.1584326
Validation loss decreased (0.146955 --> 0.146874).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1874667
	speed: 0.0985s/iter; left time: 214.9821s
	iters: 200, epoch: 9 | loss: 0.1777088
	speed: 0.0131s/iter; left time: 27.2966s
	iters: 300, epoch: 9 | loss: 0.1605747
	speed: 0.0128s/iter; left time: 25.4178s
	iters: 400, epoch: 9 | loss: 0.1420223
	speed: 0.0132s/iter; left time: 24.8497s
	iters: 500, epoch: 9 | loss: 0.1731557
	speed: 0.0130s/iter; left time: 23.1207s
	iters: 600, epoch: 9 | loss: 0.1799574
	speed: 0.0129s/iter; left time: 21.7777s
	iters: 700, epoch: 9 | loss: 0.1516304
	speed: 0.0133s/iter; left time: 21.0317s
	iters: 800, epoch: 9 | loss: 0.1213709
	speed: 0.0126s/iter; left time: 18.7174s
	iters: 900, epoch: 9 | loss: 0.1288338
	speed: 0.0132s/iter; left time: 18.1925s
	iters: 1000, epoch: 9 | loss: 0.1702939
	speed: 0.0130s/iter; left time: 16.7369s
	iters: 1100, epoch: 9 | loss: 0.1304024
	speed: 0.0133s/iter; left time: 15.7221s
Epoch: 9 cost time: 15.589432716369629
Epoch: 9, Steps: 1141 | Train Loss: 0.1604517 Vali Loss: 0.1469582 Test Loss: 0.1584785
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1849154
	speed: 0.0971s/iter; left time: 101.1424s
	iters: 200, epoch: 10 | loss: 0.1947985
	speed: 0.0128s/iter; left time: 12.0905s
	iters: 300, epoch: 10 | loss: 0.1409828
	speed: 0.0131s/iter; left time: 10.9904s
	iters: 400, epoch: 10 | loss: 0.1214452
	speed: 0.0124s/iter; left time: 9.2136s
	iters: 500, epoch: 10 | loss: 0.1685079
	speed: 0.0132s/iter; left time: 8.4783s
	iters: 600, epoch: 10 | loss: 0.1896824
	speed: 0.0128s/iter; left time: 6.9589s
	iters: 700, epoch: 10 | loss: 0.1212922
	speed: 0.0127s/iter; left time: 5.5980s
	iters: 800, epoch: 10 | loss: 0.2126893
	speed: 0.0132s/iter; left time: 4.5052s
	iters: 900, epoch: 10 | loss: 0.1618730
	speed: 0.0126s/iter; left time: 3.0423s
	iters: 1000, epoch: 10 | loss: 0.1781733
	speed: 0.0133s/iter; left time: 1.8929s
	iters: 1100, epoch: 10 | loss: 0.1541263
	speed: 0.0132s/iter; left time: 0.5542s
Epoch: 10 cost time: 15.638492345809937
Epoch: 10, Steps: 1141 | Train Loss: 0.1603658 Vali Loss: 0.1469069 Test Loss: 0.1584399
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_120_24_DLinear_custom_ftM_sl120_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.15809594094753265, mae:0.24470354616641998
