Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_72_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=72, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_72_24_DLinear_custom_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2560726
	speed: 0.0196s/iter; left time: 222.6350s
	iters: 200, epoch: 1 | loss: 0.2031770
	speed: 0.0116s/iter; left time: 130.0940s
	iters: 300, epoch: 1 | loss: 0.1815104
	speed: 0.0121s/iter; left time: 135.3504s
	iters: 400, epoch: 1 | loss: 0.2397870
	speed: 0.0120s/iter; left time: 132.7709s
	iters: 500, epoch: 1 | loss: 0.1628131
	speed: 0.0118s/iter; left time: 129.5594s
	iters: 600, epoch: 1 | loss: 0.1646434
	speed: 0.0117s/iter; left time: 127.1004s
	iters: 700, epoch: 1 | loss: 0.1814181
	speed: 0.0116s/iter; left time: 124.2103s
	iters: 800, epoch: 1 | loss: 0.1950750
	speed: 0.0123s/iter; left time: 130.4549s
	iters: 900, epoch: 1 | loss: 0.1687887
	speed: 0.0121s/iter; left time: 127.8645s
	iters: 1000, epoch: 1 | loss: 0.1417110
	speed: 0.0111s/iter; left time: 116.0767s
	iters: 1100, epoch: 1 | loss: 0.1732811
	speed: 0.0121s/iter; left time: 125.3049s
Epoch: 1 cost time: 14.441888093948364
Epoch: 1, Steps: 1144 | Train Loss: 0.2075375 Vali Loss: 0.1605076 Test Loss: 0.1730515
Validation loss decreased (inf --> 0.160508).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1947598
	speed: 0.0937s/iter; left time: 955.2282s
	iters: 200, epoch: 2 | loss: 0.1285912
	speed: 0.0115s/iter; left time: 115.7772s
	iters: 300, epoch: 2 | loss: 0.1561317
	speed: 0.0118s/iter; left time: 117.9298s
	iters: 400, epoch: 2 | loss: 0.1961903
	speed: 0.0119s/iter; left time: 117.7576s
	iters: 500, epoch: 2 | loss: 0.2554173
	speed: 0.0123s/iter; left time: 120.2584s
	iters: 600, epoch: 2 | loss: 0.2121948
	speed: 0.0123s/iter; left time: 119.1066s
	iters: 700, epoch: 2 | loss: 0.1413595
	speed: 0.0117s/iter; left time: 112.0582s
	iters: 800, epoch: 2 | loss: 0.1890876
	speed: 0.0121s/iter; left time: 114.6386s
	iters: 900, epoch: 2 | loss: 0.1742524
	speed: 0.0123s/iter; left time: 115.6140s
	iters: 1000, epoch: 2 | loss: 0.1787328
	speed: 0.0114s/iter; left time: 106.2343s
	iters: 1100, epoch: 2 | loss: 0.1983611
	speed: 0.0120s/iter; left time: 110.0979s
Epoch: 2 cost time: 14.434993743896484
Epoch: 2, Steps: 1144 | Train Loss: 0.1729572 Vali Loss: 0.1583060 Test Loss: 0.1709667
Validation loss decreased (0.160508 --> 0.158306).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1521204
	speed: 0.0939s/iter; left time: 849.8262s
	iters: 200, epoch: 3 | loss: 0.1939823
	speed: 0.0115s/iter; left time: 102.8939s
	iters: 300, epoch: 3 | loss: 0.1435775
	speed: 0.0120s/iter; left time: 106.6690s
	iters: 400, epoch: 3 | loss: 0.1445311
	speed: 0.0119s/iter; left time: 104.4894s
	iters: 500, epoch: 3 | loss: 0.1745999
	speed: 0.0120s/iter; left time: 103.4573s
	iters: 600, epoch: 3 | loss: 0.1569263
	speed: 0.0122s/iter; left time: 104.5803s
	iters: 700, epoch: 3 | loss: 0.1706869
	speed: 0.0117s/iter; left time: 98.9139s
	iters: 800, epoch: 3 | loss: 0.1919250
	speed: 0.0121s/iter; left time: 100.7605s
	iters: 900, epoch: 3 | loss: 0.1543627
	speed: 0.0121s/iter; left time: 99.4767s
	iters: 1000, epoch: 3 | loss: 0.1643515
	speed: 0.0125s/iter; left time: 101.6005s
	iters: 1100, epoch: 3 | loss: 0.1874181
	speed: 0.0125s/iter; left time: 100.9180s
Epoch: 3 cost time: 14.54928183555603
Epoch: 3, Steps: 1144 | Train Loss: 0.1714910 Vali Loss: 0.1579461 Test Loss: 0.1700888
Validation loss decreased (0.158306 --> 0.157946).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1944672
	speed: 0.0926s/iter; left time: 732.3573s
	iters: 200, epoch: 4 | loss: 0.1434786
	speed: 0.0121s/iter; left time: 94.6192s
	iters: 300, epoch: 4 | loss: 0.1623360
	speed: 0.0122s/iter; left time: 94.0980s
	iters: 400, epoch: 4 | loss: 0.1753308
	speed: 0.0121s/iter; left time: 91.7340s
	iters: 500, epoch: 4 | loss: 0.1648569
	speed: 0.0120s/iter; left time: 90.2269s
	iters: 600, epoch: 4 | loss: 0.2337840
	speed: 0.0124s/iter; left time: 92.0660s
	iters: 700, epoch: 4 | loss: 0.1430177
	speed: 0.0115s/iter; left time: 84.2931s
	iters: 800, epoch: 4 | loss: 0.1794057
	speed: 0.0120s/iter; left time: 86.3391s
	iters: 900, epoch: 4 | loss: 0.1732752
	speed: 0.0119s/iter; left time: 84.4593s
	iters: 1000, epoch: 4 | loss: 0.1784533
	speed: 0.0121s/iter; left time: 84.7108s
	iters: 1100, epoch: 4 | loss: 0.1977387
	speed: 0.0125s/iter; left time: 86.2592s
Epoch: 4 cost time: 14.473554372787476
Epoch: 4, Steps: 1144 | Train Loss: 0.1710964 Vali Loss: 0.1569183 Test Loss: 0.1692110
Validation loss decreased (0.157946 --> 0.156918).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1327541
	speed: 0.0928s/iter; left time: 627.6949s
	iters: 200, epoch: 5 | loss: 0.1880229
	speed: 0.0119s/iter; left time: 79.0312s
	iters: 300, epoch: 5 | loss: 0.1533413
	speed: 0.0122s/iter; left time: 79.8147s
	iters: 400, epoch: 5 | loss: 0.1590773
	speed: 0.0115s/iter; left time: 74.0527s
	iters: 500, epoch: 5 | loss: 0.1512367
	speed: 0.0121s/iter; left time: 77.0724s
	iters: 600, epoch: 5 | loss: 0.1943319
	speed: 0.0117s/iter; left time: 73.3200s
	iters: 700, epoch: 5 | loss: 0.1351697
	speed: 0.0118s/iter; left time: 72.7688s
	iters: 800, epoch: 5 | loss: 0.1544387
	speed: 0.0121s/iter; left time: 73.2429s
	iters: 900, epoch: 5 | loss: 0.1842805
	speed: 0.0118s/iter; left time: 70.1629s
	iters: 1000, epoch: 5 | loss: 0.1625767
	speed: 0.0120s/iter; left time: 70.2615s
	iters: 1100, epoch: 5 | loss: 0.1717244
	speed: 0.0122s/iter; left time: 70.2781s
Epoch: 5 cost time: 14.32142186164856
Epoch: 5, Steps: 1144 | Train Loss: 0.1709066 Vali Loss: 0.1570384 Test Loss: 0.1691782
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1580095
	speed: 0.0933s/iter; left time: 524.4701s
	iters: 200, epoch: 6 | loss: 0.1475343
	speed: 0.0120s/iter; left time: 66.0830s
	iters: 300, epoch: 6 | loss: 0.1774002
	speed: 0.0123s/iter; left time: 66.7400s
	iters: 400, epoch: 6 | loss: 0.2083506
	speed: 0.0116s/iter; left time: 61.7514s
	iters: 500, epoch: 6 | loss: 0.1860141
	speed: 0.0121s/iter; left time: 63.2164s
	iters: 600, epoch: 6 | loss: 0.2113047
	speed: 0.0120s/iter; left time: 61.6090s
	iters: 700, epoch: 6 | loss: 0.1312137
	speed: 0.0119s/iter; left time: 59.8622s
	iters: 800, epoch: 6 | loss: 0.1514411
	speed: 0.0122s/iter; left time: 59.9314s
	iters: 900, epoch: 6 | loss: 0.1494364
	speed: 0.0114s/iter; left time: 55.1357s
	iters: 1000, epoch: 6 | loss: 0.1485510
	speed: 0.0118s/iter; left time: 55.6402s
	iters: 1100, epoch: 6 | loss: 0.1652045
	speed: 0.0117s/iter; left time: 54.0097s
Epoch: 6 cost time: 14.372320890426636
Epoch: 6, Steps: 1144 | Train Loss: 0.1708303 Vali Loss: 0.1569449 Test Loss: 0.1692692
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1908818
	speed: 0.0937s/iter; left time: 419.6900s
	iters: 200, epoch: 7 | loss: 0.1755493
	speed: 0.0130s/iter; left time: 57.0788s
	iters: 300, epoch: 7 | loss: 0.1656337
	speed: 0.0120s/iter; left time: 51.1346s
	iters: 400, epoch: 7 | loss: 0.1796374
	speed: 0.0122s/iter; left time: 50.8363s
	iters: 500, epoch: 7 | loss: 0.1712979
	speed: 0.0122s/iter; left time: 49.6046s
	iters: 600, epoch: 7 | loss: 0.1655920
	speed: 0.0114s/iter; left time: 45.2182s
	iters: 700, epoch: 7 | loss: 0.1482792
	speed: 0.0121s/iter; left time: 47.0438s
	iters: 800, epoch: 7 | loss: 0.1697893
	speed: 0.0123s/iter; left time: 46.4148s
	iters: 900, epoch: 7 | loss: 0.1885808
	speed: 0.0123s/iter; left time: 45.2677s
	iters: 1000, epoch: 7 | loss: 0.1534377
	speed: 0.0128s/iter; left time: 45.6235s
	iters: 1100, epoch: 7 | loss: 0.1701672
	speed: 0.0121s/iter; left time: 41.9582s
Epoch: 7 cost time: 14.77352261543274
Epoch: 7, Steps: 1144 | Train Loss: 0.1707579 Vali Loss: 0.1568893 Test Loss: 0.1691673
Validation loss decreased (0.156918 --> 0.156889).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1933452
	speed: 0.0914s/iter; left time: 304.5945s
	iters: 200, epoch: 8 | loss: 0.1911418
	speed: 0.0121s/iter; left time: 38.9614s
	iters: 300, epoch: 8 | loss: 0.1318888
	speed: 0.0117s/iter; left time: 36.5725s
	iters: 400, epoch: 8 | loss: 0.1301432
	speed: 0.0121s/iter; left time: 36.7763s
	iters: 500, epoch: 8 | loss: 0.1531631
	speed: 0.0124s/iter; left time: 36.4383s
	iters: 600, epoch: 8 | loss: 0.1642535
	speed: 0.0114s/iter; left time: 32.3430s
	iters: 700, epoch: 8 | loss: 0.1537729
	speed: 0.0120s/iter; left time: 32.7054s
	iters: 800, epoch: 8 | loss: 0.1919027
	speed: 0.0116s/iter; left time: 30.6736s
	iters: 900, epoch: 8 | loss: 0.2190182
	speed: 0.0117s/iter; left time: 29.6648s
	iters: 1000, epoch: 8 | loss: 0.1578953
	speed: 0.0123s/iter; left time: 29.8889s
	iters: 1100, epoch: 8 | loss: 0.1675789
	speed: 0.0117s/iter; left time: 27.4079s
Epoch: 8 cost time: 14.356027841567993
Epoch: 8, Steps: 1144 | Train Loss: 0.1707339 Vali Loss: 0.1568476 Test Loss: 0.1691027
Validation loss decreased (0.156889 --> 0.156848).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2023041
	speed: 0.0922s/iter; left time: 201.8237s
	iters: 200, epoch: 9 | loss: 0.2338903
	speed: 0.0123s/iter; left time: 25.7899s
	iters: 300, epoch: 9 | loss: 0.1738557
	speed: 0.0116s/iter; left time: 23.0395s
	iters: 400, epoch: 9 | loss: 0.1606711
	speed: 0.0125s/iter; left time: 23.6504s
	iters: 500, epoch: 9 | loss: 0.2183002
	speed: 0.0122s/iter; left time: 21.7512s
	iters: 600, epoch: 9 | loss: 0.1504975
	speed: 0.0120s/iter; left time: 20.2027s
	iters: 700, epoch: 9 | loss: 0.1573133
	speed: 0.0120s/iter; left time: 19.0921s
	iters: 800, epoch: 9 | loss: 0.1426525
	speed: 0.0116s/iter; left time: 17.3461s
	iters: 900, epoch: 9 | loss: 0.1735720
	speed: 0.0119s/iter; left time: 16.5564s
	iters: 1000, epoch: 9 | loss: 0.1682209
	speed: 0.0124s/iter; left time: 16.0042s
	iters: 1100, epoch: 9 | loss: 0.1885820
	speed: 0.0119s/iter; left time: 14.1306s
Epoch: 9 cost time: 14.503315687179565
Epoch: 9, Steps: 1144 | Train Loss: 0.1707438 Vali Loss: 0.1568512 Test Loss: 0.1691148
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1853260
	speed: 0.0929s/iter; left time: 97.0855s
	iters: 200, epoch: 10 | loss: 0.1844146
	speed: 0.0126s/iter; left time: 11.8741s
	iters: 300, epoch: 10 | loss: 0.2087345
	speed: 0.0117s/iter; left time: 9.9279s
	iters: 400, epoch: 10 | loss: 0.1594938
	speed: 0.0123s/iter; left time: 9.1797s
	iters: 500, epoch: 10 | loss: 0.1571901
	speed: 0.0119s/iter; left time: 7.6843s
	iters: 600, epoch: 10 | loss: 0.1509825
	speed: 0.0123s/iter; left time: 6.7276s
	iters: 700, epoch: 10 | loss: 0.1652085
	speed: 0.0125s/iter; left time: 5.5819s
	iters: 800, epoch: 10 | loss: 0.1642025
	speed: 0.0115s/iter; left time: 3.9744s
	iters: 900, epoch: 10 | loss: 0.2251449
	speed: 0.0122s/iter; left time: 2.9845s
	iters: 1000, epoch: 10 | loss: 0.1671584
	speed: 0.0118s/iter; left time: 1.7133s
	iters: 1100, epoch: 10 | loss: 0.1642035
	speed: 0.0120s/iter; left time: 0.5412s
Epoch: 10 cost time: 14.635920524597168
Epoch: 10, Steps: 1144 | Train Loss: 0.1706920 Vali Loss: 0.1568778 Test Loss: 0.1691047
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_72_24_DLinear_custom_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.16870678961277008, mae:0.2521442472934723
