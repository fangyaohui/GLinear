Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_720_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_24_DLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17669
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1388623
	speed: 0.0266s/iter; left time: 291.3944s
	iters: 200, epoch: 1 | loss: 0.1114925
	speed: 0.0167s/iter; left time: 181.3781s
	iters: 300, epoch: 1 | loss: 0.1101103
	speed: 0.0175s/iter; left time: 188.1534s
	iters: 400, epoch: 1 | loss: 0.1011789
	speed: 0.0169s/iter; left time: 179.8776s
	iters: 500, epoch: 1 | loss: 0.1041699
	speed: 0.0163s/iter; left time: 171.6308s
	iters: 600, epoch: 1 | loss: 0.1951859
	speed: 0.0173s/iter; left time: 180.7723s
	iters: 700, epoch: 1 | loss: 0.1059664
	speed: 0.0177s/iter; left time: 182.6029s
	iters: 800, epoch: 1 | loss: 0.1001579
	speed: 0.0168s/iter; left time: 172.3274s
	iters: 900, epoch: 1 | loss: 0.1023507
	speed: 0.0180s/iter; left time: 182.6565s
	iters: 1000, epoch: 1 | loss: 0.1003546
	speed: 0.0174s/iter; left time: 174.6636s
	iters: 1100, epoch: 1 | loss: 0.1222764
	speed: 0.0172s/iter; left time: 171.3690s
Epoch: 1 cost time: 20.011622190475464
Epoch: 1, Steps: 1104 | Train Loss: 0.1290199 Vali Loss: 0.1000129 Test Loss: 0.1121542
Validation loss decreased (inf --> 0.100013).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1835654
	speed: 0.1272s/iter; left time: 1251.1103s
	iters: 200, epoch: 2 | loss: 0.1058045
	speed: 0.0166s/iter; left time: 161.2091s
	iters: 300, epoch: 2 | loss: 0.1127278
	speed: 0.0161s/iter; left time: 154.8496s
	iters: 400, epoch: 2 | loss: 0.1258686
	speed: 0.0187s/iter; left time: 178.0326s
	iters: 500, epoch: 2 | loss: 0.1262021
	speed: 0.0157s/iter; left time: 148.4834s
	iters: 600, epoch: 2 | loss: 0.1405281
	speed: 0.0175s/iter; left time: 163.2113s
	iters: 700, epoch: 2 | loss: 0.0949003
	speed: 0.0180s/iter; left time: 165.8806s
	iters: 800, epoch: 2 | loss: 0.1685285
	speed: 0.0173s/iter; left time: 157.7164s
	iters: 900, epoch: 2 | loss: 0.1048949
	speed: 0.0179s/iter; left time: 161.8107s
	iters: 1000, epoch: 2 | loss: 0.0895112
	speed: 0.0176s/iter; left time: 156.9166s
	iters: 1100, epoch: 2 | loss: 0.0846516
	speed: 0.0171s/iter; left time: 151.3308s
Epoch: 2 cost time: 20.03701877593994
Epoch: 2, Steps: 1104 | Train Loss: 0.1134280 Vali Loss: 0.0965738 Test Loss: 0.1090986
Validation loss decreased (0.100013 --> 0.096574).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0925716
	speed: 0.1284s/iter; left time: 1120.8984s
	iters: 200, epoch: 3 | loss: 0.1040291
	speed: 0.0166s/iter; left time: 143.1756s
	iters: 300, epoch: 3 | loss: 0.0962467
	speed: 0.0164s/iter; left time: 140.3648s
	iters: 400, epoch: 3 | loss: 0.1012484
	speed: 0.0171s/iter; left time: 143.8516s
	iters: 500, epoch: 3 | loss: 0.1194279
	speed: 0.0162s/iter; left time: 135.2337s
	iters: 600, epoch: 3 | loss: 0.0994096
	speed: 0.0166s/iter; left time: 137.0602s
	iters: 700, epoch: 3 | loss: 0.1352684
	speed: 0.0173s/iter; left time: 140.6398s
	iters: 800, epoch: 3 | loss: 0.0948165
	speed: 0.0167s/iter; left time: 133.9246s
	iters: 900, epoch: 3 | loss: 0.0961148
	speed: 0.0166s/iter; left time: 131.7186s
	iters: 1000, epoch: 3 | loss: 0.1001929
	speed: 0.0170s/iter; left time: 133.1324s
	iters: 1100, epoch: 3 | loss: 0.0886746
	speed: 0.0175s/iter; left time: 135.4814s
Epoch: 3 cost time: 19.586656093597412
Epoch: 3, Steps: 1104 | Train Loss: 0.1086944 Vali Loss: 0.0945438 Test Loss: 0.1066249
Validation loss decreased (0.096574 --> 0.094544).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1115997
	speed: 0.1252s/iter; left time: 954.8824s
	iters: 200, epoch: 4 | loss: 0.1035834
	speed: 0.0169s/iter; left time: 127.2129s
	iters: 300, epoch: 4 | loss: 0.1003115
	speed: 0.0172s/iter; left time: 127.8961s
	iters: 400, epoch: 4 | loss: 0.0783218
	speed: 0.0166s/iter; left time: 121.5762s
	iters: 500, epoch: 4 | loss: 0.0877895
	speed: 0.0174s/iter; left time: 125.9279s
	iters: 600, epoch: 4 | loss: 0.1195573
	speed: 0.0165s/iter; left time: 117.9115s
	iters: 700, epoch: 4 | loss: 0.0961402
	speed: 0.0172s/iter; left time: 121.0869s
	iters: 800, epoch: 4 | loss: 0.0920212
	speed: 0.0180s/iter; left time: 124.4970s
	iters: 900, epoch: 4 | loss: 0.0960710
	speed: 0.0169s/iter; left time: 115.0904s
	iters: 1000, epoch: 4 | loss: 0.1014201
	speed: 0.0169s/iter; left time: 114.0287s
	iters: 1100, epoch: 4 | loss: 0.0946824
	speed: 0.0167s/iter; left time: 110.6021s
Epoch: 4 cost time: 19.733043432235718
Epoch: 4, Steps: 1104 | Train Loss: 0.1068698 Vali Loss: 0.0936906 Test Loss: 0.1059041
Validation loss decreased (0.094544 --> 0.093691).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0886062
	speed: 0.1289s/iter; left time: 841.2754s
	iters: 200, epoch: 5 | loss: 0.1200196
	speed: 0.0179s/iter; left time: 114.8249s
	iters: 300, epoch: 5 | loss: 0.1680823
	speed: 0.0166s/iter; left time: 104.6992s
	iters: 400, epoch: 5 | loss: 0.1065113
	speed: 0.0175s/iter; left time: 108.9296s
	iters: 500, epoch: 5 | loss: 0.0911798
	speed: 0.0173s/iter; left time: 105.7698s
	iters: 600, epoch: 5 | loss: 0.1089890
	speed: 0.0167s/iter; left time: 100.6857s
	iters: 700, epoch: 5 | loss: 0.1003759
	speed: 0.0182s/iter; left time: 107.5982s
	iters: 800, epoch: 5 | loss: 0.1088122
	speed: 0.0175s/iter; left time: 102.0121s
	iters: 900, epoch: 5 | loss: 0.1058454
	speed: 0.0170s/iter; left time: 97.4175s
	iters: 1000, epoch: 5 | loss: 0.1121828
	speed: 0.0178s/iter; left time: 100.2367s
	iters: 1100, epoch: 5 | loss: 0.0933055
	speed: 0.0167s/iter; left time: 92.0412s
Epoch: 5 cost time: 19.954700708389282
Epoch: 5, Steps: 1104 | Train Loss: 0.1059284 Vali Loss: 0.0920681 Test Loss: 0.1041870
Validation loss decreased (0.093691 --> 0.092068).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0928863
	speed: 0.1288s/iter; left time: 698.1025s
	iters: 200, epoch: 6 | loss: 0.0988250
	speed: 0.0162s/iter; left time: 86.2995s
	iters: 300, epoch: 6 | loss: 0.0886501
	speed: 0.0170s/iter; left time: 88.7038s
	iters: 400, epoch: 6 | loss: 0.1167680
	speed: 0.0171s/iter; left time: 87.7567s
	iters: 500, epoch: 6 | loss: 0.1068883
	speed: 0.0164s/iter; left time: 82.1350s
	iters: 600, epoch: 6 | loss: 0.1440937
	speed: 0.0167s/iter; left time: 81.9520s
	iters: 700, epoch: 6 | loss: 0.0933415
	speed: 0.0173s/iter; left time: 83.1960s
	iters: 800, epoch: 6 | loss: 0.1065115
	speed: 0.0176s/iter; left time: 83.1290s
	iters: 900, epoch: 6 | loss: 0.0853047
	speed: 0.0176s/iter; left time: 81.3486s
	iters: 1000, epoch: 6 | loss: 0.0927310
	speed: 0.0176s/iter; left time: 79.7356s
	iters: 1100, epoch: 6 | loss: 0.1146606
	speed: 0.0163s/iter; left time: 72.2710s
Epoch: 6 cost time: 19.6058406829834
Epoch: 6, Steps: 1104 | Train Loss: 0.1054347 Vali Loss: 0.0926174 Test Loss: 0.1045864
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0952474
	speed: 0.1277s/iter; left time: 551.3319s
	iters: 200, epoch: 7 | loss: 0.1047323
	speed: 0.0169s/iter; left time: 71.1660s
	iters: 300, epoch: 7 | loss: 0.0826838
	speed: 0.0166s/iter; left time: 68.4410s
	iters: 400, epoch: 7 | loss: 0.1061129
	speed: 0.0169s/iter; left time: 68.0058s
	iters: 500, epoch: 7 | loss: 0.1256125
	speed: 0.0175s/iter; left time: 68.3823s
	iters: 600, epoch: 7 | loss: 0.0805822
	speed: 0.0168s/iter; left time: 64.2451s
	iters: 700, epoch: 7 | loss: 0.0810459
	speed: 0.0171s/iter; left time: 63.4600s
	iters: 800, epoch: 7 | loss: 0.1260017
	speed: 0.0177s/iter; left time: 63.9538s
	iters: 900, epoch: 7 | loss: 0.1021061
	speed: 0.0173s/iter; left time: 60.7368s
	iters: 1000, epoch: 7 | loss: 0.1137364
	speed: 0.0180s/iter; left time: 61.6598s
	iters: 1100, epoch: 7 | loss: 0.0946056
	speed: 0.0164s/iter; left time: 54.4800s
Epoch: 7 cost time: 19.89578342437744
Epoch: 7, Steps: 1104 | Train Loss: 0.1051934 Vali Loss: 0.0918152 Test Loss: 0.1035462
Validation loss decreased (0.092068 --> 0.091815).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1119437
	speed: 0.1229s/iter; left time: 394.7429s
	iters: 200, epoch: 8 | loss: 0.1230551
	speed: 0.0178s/iter; left time: 55.2862s
	iters: 300, epoch: 8 | loss: 0.0939870
	speed: 0.0174s/iter; left time: 52.4574s
	iters: 400, epoch: 8 | loss: 0.0793069
	speed: 0.0182s/iter; left time: 52.8766s
	iters: 500, epoch: 8 | loss: 0.1004557
	speed: 0.0184s/iter; left time: 51.6757s
	iters: 600, epoch: 8 | loss: 0.0841586
	speed: 0.0175s/iter; left time: 47.3867s
	iters: 700, epoch: 8 | loss: 0.0838469
	speed: 0.0174s/iter; left time: 45.3912s
	iters: 800, epoch: 8 | loss: 0.0922161
	speed: 0.0163s/iter; left time: 40.9461s
	iters: 900, epoch: 8 | loss: 0.1241368
	speed: 0.0164s/iter; left time: 39.6515s
	iters: 1000, epoch: 8 | loss: 0.1011018
	speed: 0.0172s/iter; left time: 39.7169s
	iters: 1100, epoch: 8 | loss: 0.1115271
	speed: 0.0171s/iter; left time: 37.8335s
Epoch: 8 cost time: 20.029340267181396
Epoch: 8, Steps: 1104 | Train Loss: 0.1049917 Vali Loss: 0.0915163 Test Loss: 0.1034287
Validation loss decreased (0.091815 --> 0.091516).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1538128
	speed: 0.1241s/iter; left time: 261.8082s
	iters: 200, epoch: 9 | loss: 0.0849578
	speed: 0.0175s/iter; left time: 35.2490s
	iters: 300, epoch: 9 | loss: 0.1040708
	speed: 0.0176s/iter; left time: 33.6264s
	iters: 400, epoch: 9 | loss: 0.0851424
	speed: 0.0167s/iter; left time: 30.2645s
	iters: 500, epoch: 9 | loss: 0.1013868
	speed: 0.0169s/iter; left time: 28.8498s
	iters: 600, epoch: 9 | loss: 0.0952912
	speed: 0.0171s/iter; left time: 27.4471s
	iters: 700, epoch: 9 | loss: 0.0954572
	speed: 0.0166s/iter; left time: 24.9995s
	iters: 800, epoch: 9 | loss: 0.0996186
	speed: 0.0168s/iter; left time: 23.6908s
	iters: 900, epoch: 9 | loss: 0.1308785
	speed: 0.0164s/iter; left time: 21.4804s
	iters: 1000, epoch: 9 | loss: 0.0953384
	speed: 0.0171s/iter; left time: 20.6454s
	iters: 1100, epoch: 9 | loss: 0.1145294
	speed: 0.0175s/iter; left time: 19.4595s
Epoch: 9 cost time: 19.724573135375977
Epoch: 9, Steps: 1104 | Train Loss: 0.1049273 Vali Loss: 0.0914509 Test Loss: 0.1032786
Validation loss decreased (0.091516 --> 0.091451).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0860301
	speed: 0.1254s/iter; left time: 126.0613s
	iters: 200, epoch: 10 | loss: 0.1250088
	speed: 0.0168s/iter; left time: 15.2067s
	iters: 300, epoch: 10 | loss: 0.1020396
	speed: 0.0165s/iter; left time: 13.2874s
	iters: 400, epoch: 10 | loss: 0.0986504
	speed: 0.0171s/iter; left time: 12.0827s
	iters: 500, epoch: 10 | loss: 0.0900410
	speed: 0.0173s/iter; left time: 10.4684s
	iters: 600, epoch: 10 | loss: 0.0948268
	speed: 0.0172s/iter; left time: 8.6882s
	iters: 700, epoch: 10 | loss: 0.1094534
	speed: 0.0167s/iter; left time: 6.7789s
	iters: 800, epoch: 10 | loss: 0.0895821
	speed: 0.0167s/iter; left time: 5.0783s
	iters: 900, epoch: 10 | loss: 0.1114128
	speed: 0.0175s/iter; left time: 3.5950s
	iters: 1000, epoch: 10 | loss: 0.0888390
	speed: 0.0175s/iter; left time: 1.8368s
	iters: 1100, epoch: 10 | loss: 0.0912485
	speed: 0.0163s/iter; left time: 0.0817s
Epoch: 10 cost time: 19.59013605117798
Epoch: 10, Steps: 1104 | Train Loss: 0.1048820 Vali Loss: 0.0914557 Test Loss: 0.1032825
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_720_24_DLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10295069962739944, mae:0.20109818875789642
