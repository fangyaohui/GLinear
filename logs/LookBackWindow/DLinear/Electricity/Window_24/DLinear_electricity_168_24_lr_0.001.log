Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_168_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=168, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_168_24_DLinear_custom_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1948898
	speed: 0.0214s/iter; left time: 241.9501s
	iters: 200, epoch: 1 | loss: 0.1703739
	speed: 0.0141s/iter; left time: 157.3387s
	iters: 300, epoch: 1 | loss: 0.1220837
	speed: 0.0135s/iter; left time: 149.9783s
	iters: 400, epoch: 1 | loss: 0.1297616
	speed: 0.0143s/iter; left time: 156.8957s
	iters: 500, epoch: 1 | loss: 0.1334751
	speed: 0.0128s/iter; left time: 139.2917s
	iters: 600, epoch: 1 | loss: 0.1225000
	speed: 0.0139s/iter; left time: 149.6010s
	iters: 700, epoch: 1 | loss: 0.1321697
	speed: 0.0127s/iter; left time: 135.5470s
	iters: 800, epoch: 1 | loss: 0.1108319
	speed: 0.0141s/iter; left time: 148.9861s
	iters: 900, epoch: 1 | loss: 0.1236272
	speed: 0.0134s/iter; left time: 140.2572s
	iters: 1000, epoch: 1 | loss: 0.1033622
	speed: 0.0138s/iter; left time: 143.0797s
	iters: 1100, epoch: 1 | loss: 0.1600192
	speed: 0.0136s/iter; left time: 140.1640s
Epoch: 1 cost time: 16.344212293624878
Epoch: 1, Steps: 1138 | Train Loss: 0.1500342 Vali Loss: 0.1138652 Test Loss: 0.1260941
Validation loss decreased (inf --> 0.113865).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1300713
	speed: 0.1004s/iter; left time: 1018.0083s
	iters: 200, epoch: 2 | loss: 0.1229345
	speed: 0.0139s/iter; left time: 139.1614s
	iters: 300, epoch: 2 | loss: 0.1179266
	speed: 0.0135s/iter; left time: 134.5991s
	iters: 400, epoch: 2 | loss: 0.1379086
	speed: 0.0144s/iter; left time: 141.5884s
	iters: 500, epoch: 2 | loss: 0.2070185
	speed: 0.0131s/iter; left time: 127.7717s
	iters: 600, epoch: 2 | loss: 0.0973574
	speed: 0.0139s/iter; left time: 134.3660s
	iters: 700, epoch: 2 | loss: 0.1238687
	speed: 0.0127s/iter; left time: 121.4745s
	iters: 800, epoch: 2 | loss: 0.1673274
	speed: 0.0141s/iter; left time: 132.8362s
	iters: 900, epoch: 2 | loss: 0.1114924
	speed: 0.0125s/iter; left time: 117.1610s
	iters: 1000, epoch: 2 | loss: 0.1468817
	speed: 0.0135s/iter; left time: 124.4366s
	iters: 1100, epoch: 2 | loss: 0.1171779
	speed: 0.0136s/iter; left time: 123.9059s
Epoch: 2 cost time: 16.08749556541443
Epoch: 2, Steps: 1138 | Train Loss: 0.1259621 Vali Loss: 0.1120088 Test Loss: 0.1242665
Validation loss decreased (0.113865 --> 0.112009).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0964300
	speed: 0.1036s/iter; left time: 932.9815s
	iters: 200, epoch: 3 | loss: 0.1132138
	speed: 0.0141s/iter; left time: 125.2684s
	iters: 300, epoch: 3 | loss: 0.1428882
	speed: 0.0109s/iter; left time: 95.8847s
	iters: 400, epoch: 3 | loss: 0.1135585
	speed: 0.0136s/iter; left time: 118.7585s
	iters: 500, epoch: 3 | loss: 0.1449519
	speed: 0.0127s/iter; left time: 109.2663s
	iters: 600, epoch: 3 | loss: 0.1390924
	speed: 0.0130s/iter; left time: 110.3770s
	iters: 700, epoch: 3 | loss: 0.1493475
	speed: 0.0142s/iter; left time: 118.9578s
	iters: 800, epoch: 3 | loss: 0.1219696
	speed: 0.0139s/iter; left time: 115.2120s
	iters: 900, epoch: 3 | loss: 0.1148680
	speed: 0.0149s/iter; left time: 122.0608s
	iters: 1000, epoch: 3 | loss: 0.1210980
	speed: 0.0138s/iter; left time: 111.8373s
	iters: 1100, epoch: 3 | loss: 0.1219849
	speed: 0.0141s/iter; left time: 112.8553s
Epoch: 3 cost time: 16.20834469795227
Epoch: 3, Steps: 1138 | Train Loss: 0.1243124 Vali Loss: 0.1112872 Test Loss: 0.1236221
Validation loss decreased (0.112009 --> 0.111287).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1099234
	speed: 0.1041s/iter; left time: 819.1229s
	iters: 200, epoch: 4 | loss: 0.1168037
	speed: 0.0136s/iter; left time: 105.6146s
	iters: 300, epoch: 4 | loss: 0.1220136
	speed: 0.0139s/iter; left time: 106.6878s
	iters: 400, epoch: 4 | loss: 0.1094367
	speed: 0.0134s/iter; left time: 101.1531s
	iters: 500, epoch: 4 | loss: 0.1195049
	speed: 0.0132s/iter; left time: 98.4813s
	iters: 600, epoch: 4 | loss: 0.1382361
	speed: 0.0138s/iter; left time: 101.7899s
	iters: 700, epoch: 4 | loss: 0.1024238
	speed: 0.0113s/iter; left time: 81.8550s
	iters: 800, epoch: 4 | loss: 0.1019550
	speed: 0.0134s/iter; left time: 96.3620s
	iters: 900, epoch: 4 | loss: 0.1046994
	speed: 0.0138s/iter; left time: 97.3139s
	iters: 1000, epoch: 4 | loss: 0.1008371
	speed: 0.0137s/iter; left time: 95.7082s
	iters: 1100, epoch: 4 | loss: 0.1098837
	speed: 0.0139s/iter; left time: 95.6163s
Epoch: 4 cost time: 16.31365132331848
Epoch: 4, Steps: 1138 | Train Loss: 0.1236313 Vali Loss: 0.1106079 Test Loss: 0.1230526
Validation loss decreased (0.111287 --> 0.110608).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1533981
	speed: 0.1018s/iter; left time: 684.7611s
	iters: 200, epoch: 5 | loss: 0.1183725
	speed: 0.0128s/iter; left time: 85.0540s
	iters: 300, epoch: 5 | loss: 0.1198122
	speed: 0.0133s/iter; left time: 86.9434s
	iters: 400, epoch: 5 | loss: 0.0951108
	speed: 0.0144s/iter; left time: 92.4497s
	iters: 500, epoch: 5 | loss: 0.1330796
	speed: 0.0135s/iter; left time: 85.5259s
	iters: 600, epoch: 5 | loss: 0.1076436
	speed: 0.0140s/iter; left time: 87.4623s
	iters: 700, epoch: 5 | loss: 0.1340702
	speed: 0.0135s/iter; left time: 82.6034s
	iters: 800, epoch: 5 | loss: 0.1092350
	speed: 0.0141s/iter; left time: 85.3048s
	iters: 900, epoch: 5 | loss: 0.1095553
	speed: 0.0138s/iter; left time: 81.8076s
	iters: 1000, epoch: 5 | loss: 0.1089864
	speed: 0.0142s/iter; left time: 82.7094s
	iters: 1100, epoch: 5 | loss: 0.1170555
	speed: 0.0138s/iter; left time: 79.2076s
Epoch: 5 cost time: 16.552420616149902
Epoch: 5, Steps: 1138 | Train Loss: 0.1234119 Vali Loss: 0.1106368 Test Loss: 0.1228017
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1196353
	speed: 0.1006s/iter; left time: 562.4566s
	iters: 200, epoch: 6 | loss: 0.1337185
	speed: 0.0135s/iter; left time: 74.2462s
	iters: 300, epoch: 6 | loss: 0.1371755
	speed: 0.0141s/iter; left time: 76.1062s
	iters: 400, epoch: 6 | loss: 0.1112974
	speed: 0.0127s/iter; left time: 67.1633s
	iters: 500, epoch: 6 | loss: 0.1180068
	speed: 0.0135s/iter; left time: 70.0078s
	iters: 600, epoch: 6 | loss: 0.1239139
	speed: 0.0130s/iter; left time: 66.2270s
	iters: 700, epoch: 6 | loss: 0.1597815
	speed: 0.0121s/iter; left time: 60.5777s
	iters: 800, epoch: 6 | loss: 0.1473130
	speed: 0.0139s/iter; left time: 68.0970s
	iters: 900, epoch: 6 | loss: 0.1144849
	speed: 0.0120s/iter; left time: 57.3370s
	iters: 1000, epoch: 6 | loss: 0.1123383
	speed: 0.0135s/iter; left time: 63.4972s
	iters: 1100, epoch: 6 | loss: 0.1186375
	speed: 0.0134s/iter; left time: 61.2939s
Epoch: 6 cost time: 15.912526369094849
Epoch: 6, Steps: 1138 | Train Loss: 0.1231824 Vali Loss: 0.1104000 Test Loss: 0.1226841
Validation loss decreased (0.110608 --> 0.110400).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1292993
	speed: 0.1010s/iter; left time: 449.5657s
	iters: 200, epoch: 7 | loss: 0.1226812
	speed: 0.0132s/iter; left time: 57.6193s
	iters: 300, epoch: 7 | loss: 0.1816496
	speed: 0.0141s/iter; left time: 60.0202s
	iters: 400, epoch: 7 | loss: 0.1087812
	speed: 0.0140s/iter; left time: 58.2384s
	iters: 500, epoch: 7 | loss: 0.1077743
	speed: 0.0128s/iter; left time: 51.9231s
	iters: 600, epoch: 7 | loss: 0.1037581
	speed: 0.0140s/iter; left time: 55.2516s
	iters: 700, epoch: 7 | loss: 0.1839679
	speed: 0.0122s/iter; left time: 47.0261s
	iters: 800, epoch: 7 | loss: 0.1007634
	speed: 0.0135s/iter; left time: 50.7976s
	iters: 900, epoch: 7 | loss: 0.1161373
	speed: 0.0139s/iter; left time: 50.9260s
	iters: 1000, epoch: 7 | loss: 0.1299623
	speed: 0.0135s/iter; left time: 47.8313s
	iters: 1100, epoch: 7 | loss: 0.2232223
	speed: 0.0146s/iter; left time: 50.4206s
Epoch: 7 cost time: 16.21965789794922
Epoch: 7, Steps: 1138 | Train Loss: 0.1231437 Vali Loss: 0.1104674 Test Loss: 0.1226409
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1181744
	speed: 0.1032s/iter; left time: 342.2510s
	iters: 200, epoch: 8 | loss: 0.1426364
	speed: 0.0141s/iter; left time: 45.3074s
	iters: 300, epoch: 8 | loss: 0.1200536
	speed: 0.0135s/iter; left time: 41.9482s
	iters: 400, epoch: 8 | loss: 0.1128044
	speed: 0.0145s/iter; left time: 43.7437s
	iters: 500, epoch: 8 | loss: 0.1403452
	speed: 0.0126s/iter; left time: 36.7403s
	iters: 600, epoch: 8 | loss: 0.1087393
	speed: 0.0134s/iter; left time: 37.7985s
	iters: 700, epoch: 8 | loss: 0.1196927
	speed: 0.0132s/iter; left time: 35.7048s
	iters: 800, epoch: 8 | loss: 0.1059786
	speed: 0.0140s/iter; left time: 36.5888s
	iters: 900, epoch: 8 | loss: 0.1051624
	speed: 0.0143s/iter; left time: 36.0688s
	iters: 1000, epoch: 8 | loss: 0.1091047
	speed: 0.0114s/iter; left time: 27.5869s
	iters: 1100, epoch: 8 | loss: 0.1174614
	speed: 0.0139s/iter; left time: 32.1232s
Epoch: 8 cost time: 16.099204778671265
Epoch: 8, Steps: 1138 | Train Loss: 0.1231040 Vali Loss: 0.1103668 Test Loss: 0.1225536
Validation loss decreased (0.110400 --> 0.110367).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1125355
	speed: 0.1012s/iter; left time: 220.3490s
	iters: 200, epoch: 9 | loss: 0.1232504
	speed: 0.0142s/iter; left time: 29.5867s
	iters: 300, epoch: 9 | loss: 0.1111638
	speed: 0.0136s/iter; left time: 26.8486s
	iters: 400, epoch: 9 | loss: 0.1064816
	speed: 0.0141s/iter; left time: 26.4500s
	iters: 500, epoch: 9 | loss: 0.1462854
	speed: 0.0135s/iter; left time: 24.0117s
	iters: 600, epoch: 9 | loss: 0.1351485
	speed: 0.0144s/iter; left time: 24.1601s
	iters: 700, epoch: 9 | loss: 0.1162974
	speed: 0.0134s/iter; left time: 21.1741s
	iters: 800, epoch: 9 | loss: 0.1156503
	speed: 0.0142s/iter; left time: 20.9761s
	iters: 900, epoch: 9 | loss: 0.1340899
	speed: 0.0136s/iter; left time: 18.7047s
	iters: 1000, epoch: 9 | loss: 0.1455819
	speed: 0.0139s/iter; left time: 17.7069s
	iters: 1100, epoch: 9 | loss: 0.1248223
	speed: 0.0127s/iter; left time: 14.9682s
Epoch: 9 cost time: 16.37934899330139
Epoch: 9, Steps: 1138 | Train Loss: 0.1230728 Vali Loss: 0.1103475 Test Loss: 0.1225119
Validation loss decreased (0.110367 --> 0.110347).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1362503
	speed: 0.1037s/iter; left time: 107.7596s
	iters: 200, epoch: 10 | loss: 0.1093139
	speed: 0.0138s/iter; left time: 12.9777s
	iters: 300, epoch: 10 | loss: 0.1482968
	speed: 0.0138s/iter; left time: 11.6186s
	iters: 400, epoch: 10 | loss: 0.0957529
	speed: 0.0135s/iter; left time: 10.0032s
	iters: 500, epoch: 10 | loss: 0.0942586
	speed: 0.0136s/iter; left time: 8.6909s
	iters: 600, epoch: 10 | loss: 0.1254635
	speed: 0.0140s/iter; left time: 7.5620s
	iters: 700, epoch: 10 | loss: 0.1021657
	speed: 0.0133s/iter; left time: 5.8559s
	iters: 800, epoch: 10 | loss: 0.1158569
	speed: 0.0141s/iter; left time: 4.7786s
	iters: 900, epoch: 10 | loss: 0.1009404
	speed: 0.0132s/iter; left time: 3.1628s
	iters: 1000, epoch: 10 | loss: 0.1445691
	speed: 0.0142s/iter; left time: 1.9703s
	iters: 1100, epoch: 10 | loss: 0.1056827
	speed: 0.0135s/iter; left time: 0.5265s
Epoch: 10 cost time: 16.46905827522278
Epoch: 10, Steps: 1138 | Train Loss: 0.1230185 Vali Loss: 0.1103525 Test Loss: 0.1225068
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_168_24_DLinear_custom_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.12227950990200043, mae:0.22020070254802704
