Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_192_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=192, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_192_24_DLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18197
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1809069
	speed: 0.0212s/iter; left time: 239.5012s
	iters: 200, epoch: 1 | loss: 0.1504544
	speed: 0.0135s/iter; left time: 150.7802s
	iters: 300, epoch: 1 | loss: 0.1324715
	speed: 0.0142s/iter; left time: 156.8280s
	iters: 400, epoch: 1 | loss: 0.1246305
	speed: 0.0131s/iter; left time: 143.6827s
	iters: 500, epoch: 1 | loss: 0.1354750
	speed: 0.0140s/iter; left time: 151.6677s
	iters: 600, epoch: 1 | loss: 0.1199776
	speed: 0.0124s/iter; left time: 133.5356s
	iters: 700, epoch: 1 | loss: 0.1256329
	speed: 0.0134s/iter; left time: 143.5120s
	iters: 800, epoch: 1 | loss: 0.1034398
	speed: 0.0142s/iter; left time: 150.5521s
	iters: 900, epoch: 1 | loss: 0.1169723
	speed: 0.0135s/iter; left time: 141.6669s
	iters: 1000, epoch: 1 | loss: 0.1248539
	speed: 0.0147s/iter; left time: 152.7158s
	iters: 1100, epoch: 1 | loss: 0.1100856
	speed: 0.0137s/iter; left time: 140.3727s
Epoch: 1 cost time: 16.402255535125732
Epoch: 1, Steps: 1137 | Train Loss: 0.1461931 Vali Loss: 0.1084772 Test Loss: 0.1204964
Validation loss decreased (inf --> 0.108477).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1105336
	speed: 0.1057s/iter; left time: 1071.3269s
	iters: 200, epoch: 2 | loss: 0.1284077
	speed: 0.0139s/iter; left time: 139.3082s
	iters: 300, epoch: 2 | loss: 0.1111905
	speed: 0.0141s/iter; left time: 139.9956s
	iters: 400, epoch: 2 | loss: 0.1774756
	speed: 0.0142s/iter; left time: 139.7695s
	iters: 500, epoch: 2 | loss: 0.1170902
	speed: 0.0139s/iter; left time: 135.2618s
	iters: 600, epoch: 2 | loss: 0.1090554
	speed: 0.0144s/iter; left time: 138.3244s
	iters: 700, epoch: 2 | loss: 0.1173044
	speed: 0.0141s/iter; left time: 134.5657s
	iters: 800, epoch: 2 | loss: 0.1118713
	speed: 0.0136s/iter; left time: 128.6333s
	iters: 900, epoch: 2 | loss: 0.1273726
	speed: 0.0145s/iter; left time: 135.4781s
	iters: 1000, epoch: 2 | loss: 0.1011090
	speed: 0.0138s/iter; left time: 127.5927s
	iters: 1100, epoch: 2 | loss: 0.1105082
	speed: 0.0149s/iter; left time: 135.7896s
Epoch: 2 cost time: 16.976598978042603
Epoch: 2, Steps: 1137 | Train Loss: 0.1214364 Vali Loss: 0.1069339 Test Loss: 0.1190087
Validation loss decreased (0.108477 --> 0.106934).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1102777
	speed: 0.1072s/iter; left time: 964.0427s
	iters: 200, epoch: 3 | loss: 0.1413597
	speed: 0.0144s/iter; left time: 128.1915s
	iters: 300, epoch: 3 | loss: 0.1571019
	speed: 0.0160s/iter; left time: 141.0463s
	iters: 400, epoch: 3 | loss: 0.1248597
	speed: 0.0167s/iter; left time: 144.9715s
	iters: 500, epoch: 3 | loss: 0.1097836
	speed: 0.0146s/iter; left time: 125.1206s
	iters: 600, epoch: 3 | loss: 0.1082190
	speed: 0.0139s/iter; left time: 117.9553s
	iters: 700, epoch: 3 | loss: 0.1072705
	speed: 0.0148s/iter; left time: 123.9000s
	iters: 800, epoch: 3 | loss: 0.1161840
	speed: 0.0149s/iter; left time: 123.6153s
	iters: 900, epoch: 3 | loss: 0.1006312
	speed: 0.0148s/iter; left time: 121.1927s
	iters: 1000, epoch: 3 | loss: 0.1087302
	speed: 0.0144s/iter; left time: 116.2914s
	iters: 1100, epoch: 3 | loss: 0.1976755
	speed: 0.0144s/iter; left time: 114.9780s
Epoch: 3 cost time: 17.7819721698761
Epoch: 3, Steps: 1137 | Train Loss: 0.1198565 Vali Loss: 0.1068962 Test Loss: 0.1187176
Validation loss decreased (0.106934 --> 0.106896).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1055338
	speed: 0.1070s/iter; left time: 841.0567s
	iters: 200, epoch: 4 | loss: 0.0996312
	speed: 0.0142s/iter; left time: 110.5489s
	iters: 300, epoch: 4 | loss: 0.1413049
	speed: 0.0144s/iter; left time: 109.9620s
	iters: 400, epoch: 4 | loss: 0.0985312
	speed: 0.0141s/iter; left time: 106.6193s
	iters: 500, epoch: 4 | loss: 0.1291260
	speed: 0.0140s/iter; left time: 104.3438s
	iters: 600, epoch: 4 | loss: 0.1291050
	speed: 0.0142s/iter; left time: 104.6568s
	iters: 700, epoch: 4 | loss: 0.1275162
	speed: 0.0142s/iter; left time: 103.2331s
	iters: 800, epoch: 4 | loss: 0.1449796
	speed: 0.0143s/iter; left time: 102.7309s
	iters: 900, epoch: 4 | loss: 0.0985779
	speed: 0.0139s/iter; left time: 98.3009s
	iters: 1000, epoch: 4 | loss: 0.1239927
	speed: 0.0146s/iter; left time: 101.8172s
	iters: 1100, epoch: 4 | loss: 0.1153283
	speed: 0.0136s/iter; left time: 93.1661s
Epoch: 4 cost time: 17.019518613815308
Epoch: 4, Steps: 1137 | Train Loss: 0.1191299 Vali Loss: 0.1059004 Test Loss: 0.1179199
Validation loss decreased (0.106896 --> 0.105900).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1798016
	speed: 0.1056s/iter; left time: 709.6164s
	iters: 200, epoch: 5 | loss: 0.1370291
	speed: 0.0144s/iter; left time: 95.6656s
	iters: 300, epoch: 5 | loss: 0.1031945
	speed: 0.0136s/iter; left time: 88.8107s
	iters: 400, epoch: 5 | loss: 0.1010306
	speed: 0.0139s/iter; left time: 89.0628s
	iters: 500, epoch: 5 | loss: 0.1023990
	speed: 0.0139s/iter; left time: 88.0761s
	iters: 600, epoch: 5 | loss: 0.1166984
	speed: 0.0143s/iter; left time: 89.1119s
	iters: 700, epoch: 5 | loss: 0.0971999
	speed: 0.0139s/iter; left time: 84.9865s
	iters: 800, epoch: 5 | loss: 0.1088601
	speed: 0.0139s/iter; left time: 83.6610s
	iters: 900, epoch: 5 | loss: 0.1016547
	speed: 0.0145s/iter; left time: 85.7255s
	iters: 1000, epoch: 5 | loss: 0.1158791
	speed: 0.0139s/iter; left time: 80.8625s
	iters: 1100, epoch: 5 | loss: 0.0968821
	speed: 0.0149s/iter; left time: 85.0495s
Epoch: 5 cost time: 16.893012523651123
Epoch: 5, Steps: 1137 | Train Loss: 0.1188134 Vali Loss: 0.1061533 Test Loss: 0.1182026
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1077231
	speed: 0.1107s/iter; left time: 618.4229s
	iters: 200, epoch: 6 | loss: 0.1287725
	speed: 0.0145s/iter; left time: 79.4220s
	iters: 300, epoch: 6 | loss: 0.1240556
	speed: 0.0142s/iter; left time: 76.3064s
	iters: 400, epoch: 6 | loss: 0.1133440
	speed: 0.0142s/iter; left time: 74.8106s
	iters: 500, epoch: 6 | loss: 0.0958371
	speed: 0.0141s/iter; left time: 72.8802s
	iters: 600, epoch: 6 | loss: 0.1093893
	speed: 0.0142s/iter; left time: 72.1774s
	iters: 700, epoch: 6 | loss: 0.1151762
	speed: 0.0141s/iter; left time: 70.1071s
	iters: 800, epoch: 6 | loss: 0.1060128
	speed: 0.0141s/iter; left time: 68.9668s
	iters: 900, epoch: 6 | loss: 0.1109969
	speed: 0.0143s/iter; left time: 68.2289s
	iters: 1000, epoch: 6 | loss: 0.1248019
	speed: 0.0149s/iter; left time: 69.7158s
	iters: 1100, epoch: 6 | loss: 0.1426334
	speed: 0.0147s/iter; left time: 67.2304s
Epoch: 6 cost time: 17.086254596710205
Epoch: 6, Steps: 1137 | Train Loss: 0.1186264 Vali Loss: 0.1056722 Test Loss: 0.1176432
Validation loss decreased (0.105900 --> 0.105672).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1051422
	speed: 0.1057s/iter; left time: 470.0839s
	iters: 200, epoch: 7 | loss: 0.0924134
	speed: 0.0143s/iter; left time: 62.3705s
	iters: 300, epoch: 7 | loss: 0.1205434
	speed: 0.0145s/iter; left time: 61.7860s
	iters: 400, epoch: 7 | loss: 0.1407067
	speed: 0.0146s/iter; left time: 60.4874s
	iters: 500, epoch: 7 | loss: 0.0962440
	speed: 0.0143s/iter; left time: 57.8419s
	iters: 600, epoch: 7 | loss: 0.1181385
	speed: 0.0140s/iter; left time: 55.3929s
	iters: 700, epoch: 7 | loss: 0.1218010
	speed: 0.0137s/iter; left time: 52.9114s
	iters: 800, epoch: 7 | loss: 0.1239253
	speed: 0.0140s/iter; left time: 52.5720s
	iters: 900, epoch: 7 | loss: 0.1056482
	speed: 0.0142s/iter; left time: 51.8360s
	iters: 1000, epoch: 7 | loss: 0.1192187
	speed: 0.0143s/iter; left time: 50.7863s
	iters: 1100, epoch: 7 | loss: 0.1109852
	speed: 0.0144s/iter; left time: 49.5180s
Epoch: 7 cost time: 17.006452322006226
Epoch: 7, Steps: 1137 | Train Loss: 0.1185013 Vali Loss: 0.1056213 Test Loss: 0.1176337
Validation loss decreased (0.105672 --> 0.105621).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1304841
	speed: 0.1061s/iter; left time: 351.5429s
	iters: 200, epoch: 8 | loss: 0.1059201
	speed: 0.0144s/iter; left time: 46.1028s
	iters: 300, epoch: 8 | loss: 0.1012980
	speed: 0.0149s/iter; left time: 46.4189s
	iters: 400, epoch: 8 | loss: 0.1180197
	speed: 0.0148s/iter; left time: 44.6001s
	iters: 500, epoch: 8 | loss: 0.1204333
	speed: 0.0144s/iter; left time: 41.8477s
	iters: 600, epoch: 8 | loss: 0.1163060
	speed: 0.0141s/iter; left time: 39.6186s
	iters: 700, epoch: 8 | loss: 0.1070470
	speed: 0.0142s/iter; left time: 38.4513s
	iters: 800, epoch: 8 | loss: 0.1139884
	speed: 0.0141s/iter; left time: 36.7619s
	iters: 900, epoch: 8 | loss: 0.1021752
	speed: 0.0141s/iter; left time: 35.5409s
	iters: 1000, epoch: 8 | loss: 0.1131290
	speed: 0.0138s/iter; left time: 33.3784s
	iters: 1100, epoch: 8 | loss: 0.1134457
	speed: 0.0145s/iter; left time: 33.5897s
Epoch: 8 cost time: 17.189745664596558
Epoch: 8, Steps: 1137 | Train Loss: 0.1184505 Vali Loss: 0.1056279 Test Loss: 0.1175701
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1179185
	speed: 0.1123s/iter; left time: 244.3216s
	iters: 200, epoch: 9 | loss: 0.1196363
	speed: 0.0139s/iter; left time: 28.8258s
	iters: 300, epoch: 9 | loss: 0.1090182
	speed: 0.0146s/iter; left time: 28.8245s
	iters: 400, epoch: 9 | loss: 0.1346959
	speed: 0.0137s/iter; left time: 25.7308s
	iters: 500, epoch: 9 | loss: 0.1100265
	speed: 0.0143s/iter; left time: 25.3988s
	iters: 600, epoch: 9 | loss: 0.1167421
	speed: 0.0147s/iter; left time: 24.5716s
	iters: 700, epoch: 9 | loss: 0.1036787
	speed: 0.0144s/iter; left time: 22.7169s
	iters: 800, epoch: 9 | loss: 0.0916723
	speed: 0.0139s/iter; left time: 20.5085s
	iters: 900, epoch: 9 | loss: 0.0928858
	speed: 0.0144s/iter; left time: 19.7674s
	iters: 1000, epoch: 9 | loss: 0.1148427
	speed: 0.0135s/iter; left time: 17.2588s
	iters: 1100, epoch: 9 | loss: 0.1913691
	speed: 0.0146s/iter; left time: 17.1172s
Epoch: 9 cost time: 17.05204749107361
Epoch: 9, Steps: 1137 | Train Loss: 0.1184317 Vali Loss: 0.1056084 Test Loss: 0.1175599
Validation loss decreased (0.105621 --> 0.105608).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1018011
	speed: 0.1078s/iter; left time: 111.8596s
	iters: 200, epoch: 10 | loss: 0.0961723
	speed: 0.0144s/iter; left time: 13.4927s
	iters: 300, epoch: 10 | loss: 0.1151267
	speed: 0.0140s/iter; left time: 11.7220s
	iters: 400, epoch: 10 | loss: 0.1016473
	speed: 0.0141s/iter; left time: 10.3960s
	iters: 500, epoch: 10 | loss: 0.0969309
	speed: 0.0137s/iter; left time: 8.7554s
	iters: 600, epoch: 10 | loss: 0.1227370
	speed: 0.0142s/iter; left time: 7.6462s
	iters: 700, epoch: 10 | loss: 0.0977409
	speed: 0.0145s/iter; left time: 6.3388s
	iters: 800, epoch: 10 | loss: 0.1243903
	speed: 0.0142s/iter; left time: 4.7932s
	iters: 900, epoch: 10 | loss: 0.1035270
	speed: 0.0140s/iter; left time: 3.3426s
	iters: 1000, epoch: 10 | loss: 0.1028560
	speed: 0.0140s/iter; left time: 1.9327s
	iters: 1100, epoch: 10 | loss: 0.1028337
	speed: 0.0139s/iter; left time: 0.5288s
Epoch: 10 cost time: 16.78905487060547
Epoch: 10, Steps: 1137 | Train Loss: 0.1184270 Vali Loss: 0.1055871 Test Loss: 0.1175446
Validation loss decreased (0.105608 --> 0.105587).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_192_24_DLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.11729511618614197, mae:0.21562020480632782
