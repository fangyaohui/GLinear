Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_96_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_96_24_DLinear_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18293
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2068288
	speed: 0.0212s/iter; left time: 240.3522s
	iters: 200, epoch: 1 | loss: 0.1848336
	speed: 0.0128s/iter; left time: 143.8884s
	iters: 300, epoch: 1 | loss: 0.1859802
	speed: 0.0123s/iter; left time: 137.1640s
	iters: 400, epoch: 1 | loss: 0.2065525
	speed: 0.0129s/iter; left time: 142.7892s
	iters: 500, epoch: 1 | loss: 0.1668131
	speed: 0.0126s/iter; left time: 137.7179s
	iters: 600, epoch: 1 | loss: 0.1710608
	speed: 0.0129s/iter; left time: 140.0970s
	iters: 700, epoch: 1 | loss: 0.1602247
	speed: 0.0133s/iter; left time: 142.7379s
	iters: 800, epoch: 1 | loss: 0.1568981
	speed: 0.0128s/iter; left time: 136.1232s
	iters: 900, epoch: 1 | loss: 0.2077461
	speed: 0.0128s/iter; left time: 134.4039s
	iters: 1000, epoch: 1 | loss: 0.1657052
	speed: 0.0122s/iter; left time: 127.2924s
	iters: 1100, epoch: 1 | loss: 0.1896291
	speed: 0.0137s/iter; left time: 141.3295s
Epoch: 1 cost time: 15.60764479637146
Epoch: 1, Steps: 1143 | Train Loss: 0.1962806 Vali Loss: 0.1564864 Test Loss: 0.1679342
Validation loss decreased (inf --> 0.156486).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1757712
	speed: 0.0981s/iter; left time: 999.3531s
	iters: 200, epoch: 2 | loss: 0.1310435
	speed: 0.0132s/iter; left time: 133.0385s
	iters: 300, epoch: 2 | loss: 0.2103853
	speed: 0.0126s/iter; left time: 125.8535s
	iters: 400, epoch: 2 | loss: 0.1362373
	speed: 0.0128s/iter; left time: 126.6565s
	iters: 500, epoch: 2 | loss: 0.1319421
	speed: 0.0132s/iter; left time: 129.5264s
	iters: 600, epoch: 2 | loss: 0.1630805
	speed: 0.0125s/iter; left time: 121.0605s
	iters: 700, epoch: 2 | loss: 0.1711950
	speed: 0.0130s/iter; left time: 125.1074s
	iters: 800, epoch: 2 | loss: 0.1430810
	speed: 0.0126s/iter; left time: 119.7543s
	iters: 900, epoch: 2 | loss: 0.1271095
	speed: 0.0131s/iter; left time: 123.3838s
	iters: 1000, epoch: 2 | loss: 0.1630692
	speed: 0.0134s/iter; left time: 124.7258s
	iters: 1100, epoch: 2 | loss: 0.1657474
	speed: 0.0124s/iter; left time: 113.9641s
Epoch: 2 cost time: 15.481596231460571
Epoch: 2, Steps: 1143 | Train Loss: 0.1680453 Vali Loss: 0.1534237 Test Loss: 0.1650853
Validation loss decreased (0.156486 --> 0.153424).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1548978
	speed: 0.0957s/iter; left time: 865.2084s
	iters: 200, epoch: 3 | loss: 0.2756570
	speed: 0.0129s/iter; left time: 115.1577s
	iters: 300, epoch: 3 | loss: 0.1677213
	speed: 0.0123s/iter; left time: 109.0932s
	iters: 400, epoch: 3 | loss: 0.2353549
	speed: 0.0128s/iter; left time: 111.9768s
	iters: 500, epoch: 3 | loss: 0.1466589
	speed: 0.0129s/iter; left time: 111.6630s
	iters: 600, epoch: 3 | loss: 0.1215139
	speed: 0.0136s/iter; left time: 116.0274s
	iters: 700, epoch: 3 | loss: 0.1622968
	speed: 0.0125s/iter; left time: 105.2455s
	iters: 800, epoch: 3 | loss: 0.1374686
	speed: 0.0135s/iter; left time: 112.4452s
	iters: 900, epoch: 3 | loss: 0.1728434
	speed: 0.0133s/iter; left time: 109.3018s
	iters: 1000, epoch: 3 | loss: 0.1833805
	speed: 0.0125s/iter; left time: 101.6931s
	iters: 1100, epoch: 3 | loss: 0.1523940
	speed: 0.0125s/iter; left time: 100.3480s
Epoch: 3 cost time: 15.428935289382935
Epoch: 3, Steps: 1143 | Train Loss: 0.1666671 Vali Loss: 0.1534967 Test Loss: 0.1651110
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1810339
	speed: 0.0920s/iter; left time: 726.6877s
	iters: 200, epoch: 4 | loss: 0.2022649
	speed: 0.0121s/iter; left time: 94.3628s
	iters: 300, epoch: 4 | loss: 0.1652525
	speed: 0.0123s/iter; left time: 95.1136s
	iters: 400, epoch: 4 | loss: 0.2112588
	speed: 0.0110s/iter; left time: 83.5529s
	iters: 500, epoch: 4 | loss: 0.1329576
	speed: 0.0120s/iter; left time: 90.1550s
	iters: 600, epoch: 4 | loss: 0.1717320
	speed: 0.0120s/iter; left time: 89.1890s
	iters: 700, epoch: 4 | loss: 0.1486996
	speed: 0.0122s/iter; left time: 88.9320s
	iters: 800, epoch: 4 | loss: 0.1355781
	speed: 0.0124s/iter; left time: 89.2661s
	iters: 900, epoch: 4 | loss: 0.1524703
	speed: 0.0119s/iter; left time: 84.2614s
	iters: 1000, epoch: 4 | loss: 0.1677337
	speed: 0.0125s/iter; left time: 87.4692s
	iters: 1100, epoch: 4 | loss: 0.1832482
	speed: 0.0125s/iter; left time: 86.4353s
Epoch: 4 cost time: 14.414581060409546
Epoch: 4, Steps: 1143 | Train Loss: 0.1661596 Vali Loss: 0.1525636 Test Loss: 0.1642163
Validation loss decreased (0.153424 --> 0.152564).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1761796
	speed: 0.0943s/iter; left time: 637.2933s
	iters: 200, epoch: 5 | loss: 0.1685354
	speed: 0.0125s/iter; left time: 83.4426s
	iters: 300, epoch: 5 | loss: 0.1851915
	speed: 0.0123s/iter; left time: 80.7139s
	iters: 400, epoch: 5 | loss: 0.1492879
	speed: 0.0127s/iter; left time: 81.9465s
	iters: 500, epoch: 5 | loss: 0.1779753
	speed: 0.0127s/iter; left time: 80.6325s
	iters: 600, epoch: 5 | loss: 0.1335528
	speed: 0.0115s/iter; left time: 72.2845s
	iters: 700, epoch: 5 | loss: 0.2041437
	speed: 0.0121s/iter; left time: 74.4972s
	iters: 800, epoch: 5 | loss: 0.1370588
	speed: 0.0117s/iter; left time: 70.6409s
	iters: 900, epoch: 5 | loss: 0.1295708
	speed: 0.0121s/iter; left time: 71.8159s
	iters: 1000, epoch: 5 | loss: 0.1458607
	speed: 0.0126s/iter; left time: 73.8175s
	iters: 1100, epoch: 5 | loss: 0.1764834
	speed: 0.0117s/iter; left time: 67.2932s
Epoch: 5 cost time: 14.590951442718506
Epoch: 5, Steps: 1143 | Train Loss: 0.1658941 Vali Loss: 0.1525151 Test Loss: 0.1642887
Validation loss decreased (0.152564 --> 0.152515).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1568895
	speed: 0.0814s/iter; left time: 457.4009s
	iters: 200, epoch: 6 | loss: 0.1650011
	speed: 0.0088s/iter; left time: 48.7908s
	iters: 300, epoch: 6 | loss: 0.1608471
	speed: 0.0069s/iter; left time: 37.4487s
	iters: 400, epoch: 6 | loss: 0.1768305
	speed: 0.0085s/iter; left time: 45.4369s
	iters: 500, epoch: 6 | loss: 0.1690446
	speed: 0.0072s/iter; left time: 37.4306s
	iters: 600, epoch: 6 | loss: 0.1929077
	speed: 0.0090s/iter; left time: 45.8085s
	iters: 700, epoch: 6 | loss: 0.1712840
	speed: 0.0070s/iter; left time: 34.8654s
	iters: 800, epoch: 6 | loss: 0.1590511
	speed: 0.0086s/iter; left time: 42.4886s
	iters: 900, epoch: 6 | loss: 0.1446082
	speed: 0.0068s/iter; left time: 32.8687s
	iters: 1000, epoch: 6 | loss: 0.1668279
	speed: 0.0090s/iter; left time: 42.5229s
	iters: 1100, epoch: 6 | loss: 0.1793786
	speed: 0.0080s/iter; left time: 36.9938s
Epoch: 6 cost time: 9.838874816894531
Epoch: 6, Steps: 1143 | Train Loss: 0.1657997 Vali Loss: 0.1526224 Test Loss: 0.1642211
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1659293
	speed: 0.0684s/iter; left time: 306.0193s
	iters: 200, epoch: 7 | loss: 0.1234312
	speed: 0.0074s/iter; left time: 32.1592s
	iters: 300, epoch: 7 | loss: 0.1784534
	speed: 0.0081s/iter; left time: 34.5942s
	iters: 400, epoch: 7 | loss: 0.1898332
	speed: 0.0075s/iter; left time: 31.1341s
	iters: 500, epoch: 7 | loss: 0.1750208
	speed: 0.0090s/iter; left time: 36.5949s
	iters: 600, epoch: 7 | loss: 0.1712941
	speed: 0.0072s/iter; left time: 28.6418s
	iters: 700, epoch: 7 | loss: 0.1446820
	speed: 0.0084s/iter; left time: 32.7239s
	iters: 800, epoch: 7 | loss: 0.1518416
	speed: 0.0084s/iter; left time: 31.6589s
	iters: 900, epoch: 7 | loss: 0.1444029
	speed: 0.0090s/iter; left time: 33.0592s
	iters: 1000, epoch: 7 | loss: 0.1828678
	speed: 0.0074s/iter; left time: 26.2773s
	iters: 1100, epoch: 7 | loss: 0.1550831
	speed: 0.0080s/iter; left time: 27.6564s
Epoch: 7 cost time: 9.959955930709839
Epoch: 7, Steps: 1143 | Train Loss: 0.1656982 Vali Loss: 0.1524782 Test Loss: 0.1641351
Validation loss decreased (0.152515 --> 0.152478).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1271854
	speed: 0.1322s/iter; left time: 440.1139s
	iters: 200, epoch: 8 | loss: 0.1812742
	speed: 0.0131s/iter; left time: 42.3061s
	iters: 300, epoch: 8 | loss: 0.1710466
	speed: 0.0129s/iter; left time: 40.3068s
	iters: 400, epoch: 8 | loss: 0.1535517
	speed: 0.0120s/iter; left time: 36.3279s
	iters: 500, epoch: 8 | loss: 0.1600295
	speed: 0.0123s/iter; left time: 36.0569s
	iters: 600, epoch: 8 | loss: 0.2167763
	speed: 0.0117s/iter; left time: 33.0671s
	iters: 700, epoch: 8 | loss: 0.1745356
	speed: 0.0125s/iter; left time: 34.0763s
	iters: 800, epoch: 8 | loss: 0.1596151
	speed: 0.0128s/iter; left time: 33.6883s
	iters: 900, epoch: 8 | loss: 0.1561961
	speed: 0.0140s/iter; left time: 35.5343s
	iters: 1000, epoch: 8 | loss: 0.2171152
	speed: 0.0135s/iter; left time: 32.7038s
	iters: 1100, epoch: 8 | loss: 0.1679301
	speed: 0.0123s/iter; left time: 28.6912s
Epoch: 8 cost time: 15.253798246383667
Epoch: 8, Steps: 1143 | Train Loss: 0.1656648 Vali Loss: 0.1524226 Test Loss: 0.1640209
Validation loss decreased (0.152478 --> 0.152423).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1483005
	speed: 0.0949s/iter; left time: 207.4523s
	iters: 200, epoch: 9 | loss: 0.1503990
	speed: 0.0126s/iter; left time: 26.2182s
	iters: 300, epoch: 9 | loss: 0.1598856
	speed: 0.0125s/iter; left time: 24.9088s
	iters: 400, epoch: 9 | loss: 0.1613360
	speed: 0.0127s/iter; left time: 24.0530s
	iters: 500, epoch: 9 | loss: 0.1613035
	speed: 0.0115s/iter; left time: 20.5743s
	iters: 600, epoch: 9 | loss: 0.1996469
	speed: 0.0124s/iter; left time: 20.8887s
	iters: 700, epoch: 9 | loss: 0.2175946
	speed: 0.0119s/iter; left time: 18.8995s
	iters: 800, epoch: 9 | loss: 0.1553396
	speed: 0.0124s/iter; left time: 18.4454s
	iters: 900, epoch: 9 | loss: 0.1562244
	speed: 0.0123s/iter; left time: 17.0586s
	iters: 1000, epoch: 9 | loss: 0.1702591
	speed: 0.0116s/iter; left time: 14.9428s
	iters: 1100, epoch: 9 | loss: 0.1217995
	speed: 0.0129s/iter; left time: 15.2890s
Epoch: 9 cost time: 14.860100269317627
Epoch: 9, Steps: 1143 | Train Loss: 0.1656726 Vali Loss: 0.1523843 Test Loss: 0.1640129
Validation loss decreased (0.152423 --> 0.152384).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1605366
	speed: 0.0978s/iter; left time: 102.0913s
	iters: 200, epoch: 10 | loss: 0.1921949
	speed: 0.0124s/iter; left time: 11.6772s
	iters: 300, epoch: 10 | loss: 0.1666774
	speed: 0.0116s/iter; left time: 9.8102s
	iters: 400, epoch: 10 | loss: 0.1680969
	speed: 0.0129s/iter; left time: 9.6184s
	iters: 500, epoch: 10 | loss: 0.1652927
	speed: 0.0131s/iter; left time: 8.4150s
	iters: 600, epoch: 10 | loss: 0.1599145
	speed: 0.0121s/iter; left time: 6.6022s
	iters: 700, epoch: 10 | loss: 0.1482521
	speed: 0.0126s/iter; left time: 5.6128s
	iters: 800, epoch: 10 | loss: 0.1852645
	speed: 0.0118s/iter; left time: 4.0693s
	iters: 900, epoch: 10 | loss: 0.1473107
	speed: 0.0124s/iter; left time: 3.0153s
	iters: 1000, epoch: 10 | loss: 0.1503689
	speed: 0.0127s/iter; left time: 1.8290s
	iters: 1100, epoch: 10 | loss: 0.2066721
	speed: 0.0113s/iter; left time: 0.4953s
Epoch: 10 cost time: 14.75425124168396
Epoch: 10, Steps: 1143 | Train Loss: 0.1656690 Vali Loss: 0.1524008 Test Loss: 0.1640301
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_96_24_DLinear_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.16363093256950378, mae:0.24831315875053406
