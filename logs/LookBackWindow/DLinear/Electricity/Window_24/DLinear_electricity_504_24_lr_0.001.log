Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_504_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_504_24_DLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1386750
	speed: 0.0223s/iter; left time: 247.1016s
	iters: 200, epoch: 1 | loss: 0.1245979
	speed: 0.0130s/iter; left time: 143.0474s
	iters: 300, epoch: 1 | loss: 0.1175845
	speed: 0.0137s/iter; left time: 148.9723s
	iters: 400, epoch: 1 | loss: 0.1205566
	speed: 0.0134s/iter; left time: 144.6273s
	iters: 500, epoch: 1 | loss: 0.1158674
	speed: 0.0139s/iter; left time: 148.0966s
	iters: 600, epoch: 1 | loss: 0.2166827
	speed: 0.0130s/iter; left time: 136.9434s
	iters: 700, epoch: 1 | loss: 0.1114013
	speed: 0.0136s/iter; left time: 142.4553s
	iters: 800, epoch: 1 | loss: 0.1199257
	speed: 0.0140s/iter; left time: 144.7480s
	iters: 900, epoch: 1 | loss: 0.0906687
	speed: 0.0135s/iter; left time: 138.7245s
	iters: 1000, epoch: 1 | loss: 0.1846607
	speed: 0.0143s/iter; left time: 145.2514s
	iters: 1100, epoch: 1 | loss: 0.0940189
	speed: 0.0134s/iter; left time: 134.9451s
Epoch: 1 cost time: 16.105056047439575
Epoch: 1, Steps: 1117 | Train Loss: 0.1302253 Vali Loss: 0.0984116 Test Loss: 0.1106788
Validation loss decreased (inf --> 0.098412).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.0939514
	speed: 0.1074s/iter; left time: 1069.2221s
	iters: 200, epoch: 2 | loss: 0.1169466
	speed: 0.0140s/iter; left time: 138.3878s
	iters: 300, epoch: 2 | loss: 0.1020253
	speed: 0.0137s/iter; left time: 133.7355s
	iters: 400, epoch: 2 | loss: 0.1179790
	speed: 0.0131s/iter; left time: 126.2043s
	iters: 500, epoch: 2 | loss: 0.1164682
	speed: 0.0142s/iter; left time: 135.6808s
	iters: 600, epoch: 2 | loss: 0.0945804
	speed: 0.0140s/iter; left time: 132.0917s
	iters: 700, epoch: 2 | loss: 0.1205779
	speed: 0.0137s/iter; left time: 128.3011s
	iters: 800, epoch: 2 | loss: 0.1013961
	speed: 0.0135s/iter; left time: 124.8035s
	iters: 900, epoch: 2 | loss: 0.1725454
	speed: 0.0139s/iter; left time: 127.0115s
	iters: 1000, epoch: 2 | loss: 0.0888366
	speed: 0.0139s/iter; left time: 125.9405s
	iters: 1100, epoch: 2 | loss: 0.0891410
	speed: 0.0142s/iter; left time: 126.9488s
Epoch: 2 cost time: 16.38303780555725
Epoch: 2, Steps: 1117 | Train Loss: 0.1141409 Vali Loss: 0.1008148 Test Loss: 0.1137149
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1100914
	speed: 0.1068s/iter; left time: 943.4853s
	iters: 200, epoch: 3 | loss: 0.1207797
	speed: 0.0137s/iter; left time: 119.9919s
	iters: 300, epoch: 3 | loss: 0.0808816
	speed: 0.0133s/iter; left time: 115.1892s
	iters: 400, epoch: 3 | loss: 0.1016721
	speed: 0.0135s/iter; left time: 115.0766s
	iters: 500, epoch: 3 | loss: 0.1041433
	speed: 0.0145s/iter; left time: 122.3989s
	iters: 600, epoch: 3 | loss: 0.1026707
	speed: 0.0140s/iter; left time: 116.3734s
	iters: 700, epoch: 3 | loss: 0.0999416
	speed: 0.0150s/iter; left time: 123.5104s
	iters: 800, epoch: 3 | loss: 0.1080463
	speed: 0.0147s/iter; left time: 120.0076s
	iters: 900, epoch: 3 | loss: 0.0999479
	speed: 0.0143s/iter; left time: 114.8413s
	iters: 1000, epoch: 3 | loss: 0.0745233
	speed: 0.0149s/iter; left time: 118.3844s
	iters: 1100, epoch: 3 | loss: 0.1328462
	speed: 0.0140s/iter; left time: 110.0239s
Epoch: 3 cost time: 16.71456789970398
Epoch: 3, Steps: 1117 | Train Loss: 0.1107580 Vali Loss: 0.0976696 Test Loss: 0.1096160
Validation loss decreased (0.098412 --> 0.097670).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1279759
	speed: 0.1105s/iter; left time: 853.3223s
	iters: 200, epoch: 4 | loss: 0.1096910
	speed: 0.0146s/iter; left time: 111.5229s
	iters: 300, epoch: 4 | loss: 0.1333025
	speed: 0.0142s/iter; left time: 107.0088s
	iters: 400, epoch: 4 | loss: 0.1025954
	speed: 0.0141s/iter; left time: 104.7105s
	iters: 500, epoch: 4 | loss: 0.0883644
	speed: 0.0137s/iter; left time: 100.5324s
	iters: 600, epoch: 4 | loss: 0.1777533
	speed: 0.0146s/iter; left time: 105.6279s
	iters: 700, epoch: 4 | loss: 0.0912232
	speed: 0.0150s/iter; left time: 106.6428s
	iters: 800, epoch: 4 | loss: 0.1098282
	speed: 0.0138s/iter; left time: 96.5526s
	iters: 900, epoch: 4 | loss: 0.1116197
	speed: 0.0151s/iter; left time: 104.2153s
	iters: 1000, epoch: 4 | loss: 0.1303275
	speed: 0.0141s/iter; left time: 95.8970s
	iters: 1100, epoch: 4 | loss: 0.1039921
	speed: 0.0144s/iter; left time: 96.6741s
Epoch: 4 cost time: 16.8483624458313
Epoch: 4, Steps: 1117 | Train Loss: 0.1093497 Vali Loss: 0.0958886 Test Loss: 0.1077169
Validation loss decreased (0.097670 --> 0.095889).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0965338
	speed: 0.1059s/iter; left time: 699.3034s
	iters: 200, epoch: 5 | loss: 0.1202976
	speed: 0.0144s/iter; left time: 93.8994s
	iters: 300, epoch: 5 | loss: 0.1013533
	speed: 0.0139s/iter; left time: 88.9682s
	iters: 400, epoch: 5 | loss: 0.0885705
	speed: 0.0144s/iter; left time: 90.5798s
	iters: 500, epoch: 5 | loss: 0.0945240
	speed: 0.0133s/iter; left time: 82.3518s
	iters: 600, epoch: 5 | loss: 0.1118899
	speed: 0.0141s/iter; left time: 85.9296s
	iters: 700, epoch: 5 | loss: 0.0855474
	speed: 0.0137s/iter; left time: 82.3366s
	iters: 800, epoch: 5 | loss: 0.1088498
	speed: 0.0136s/iter; left time: 80.1359s
	iters: 900, epoch: 5 | loss: 0.0965327
	speed: 0.0151s/iter; left time: 87.8046s
	iters: 1000, epoch: 5 | loss: 0.1380076
	speed: 0.0144s/iter; left time: 82.2807s
	iters: 1100, epoch: 5 | loss: 0.1035943
	speed: 0.0142s/iter; left time: 79.4759s
Epoch: 5 cost time: 16.482986450195312
Epoch: 5, Steps: 1117 | Train Loss: 0.1086067 Vali Loss: 0.0944813 Test Loss: 0.1064837
Validation loss decreased (0.095889 --> 0.094481).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1831328
	speed: 0.1096s/iter; left time: 601.0516s
	iters: 200, epoch: 6 | loss: 0.0967040
	speed: 0.0139s/iter; left time: 74.6369s
	iters: 300, epoch: 6 | loss: 0.0922992
	speed: 0.0138s/iter; left time: 72.7600s
	iters: 400, epoch: 6 | loss: 0.0986641
	speed: 0.0136s/iter; left time: 70.7056s
	iters: 500, epoch: 6 | loss: 0.1176322
	speed: 0.0138s/iter; left time: 70.4217s
	iters: 600, epoch: 6 | loss: 0.0990847
	speed: 0.0146s/iter; left time: 72.8931s
	iters: 700, epoch: 6 | loss: 0.0879351
	speed: 0.0138s/iter; left time: 67.2472s
	iters: 800, epoch: 6 | loss: 0.0938521
	speed: 0.0143s/iter; left time: 68.5800s
	iters: 900, epoch: 6 | loss: 0.0921122
	speed: 0.0132s/iter; left time: 61.7829s
	iters: 1000, epoch: 6 | loss: 0.0972921
	speed: 0.0148s/iter; left time: 67.9617s
	iters: 1100, epoch: 6 | loss: 0.1189870
	speed: 0.0132s/iter; left time: 59.3164s
Epoch: 6 cost time: 16.37327742576599
Epoch: 6, Steps: 1117 | Train Loss: 0.1081984 Vali Loss: 0.0943403 Test Loss: 0.1062611
Validation loss decreased (0.094481 --> 0.094340).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1032259
	speed: 0.1105s/iter; left time: 482.9060s
	iters: 200, epoch: 7 | loss: 0.0972418
	speed: 0.0137s/iter; left time: 58.4895s
	iters: 300, epoch: 7 | loss: 0.0820625
	speed: 0.0141s/iter; left time: 58.6585s
	iters: 400, epoch: 7 | loss: 0.1095842
	speed: 0.0135s/iter; left time: 54.8903s
	iters: 500, epoch: 7 | loss: 0.1178555
	speed: 0.0133s/iter; left time: 52.5965s
	iters: 600, epoch: 7 | loss: 0.0916804
	speed: 0.0141s/iter; left time: 54.7012s
	iters: 700, epoch: 7 | loss: 0.1200272
	speed: 0.0139s/iter; left time: 52.3215s
	iters: 800, epoch: 7 | loss: 0.1017071
	speed: 0.0145s/iter; left time: 53.0471s
	iters: 900, epoch: 7 | loss: 0.0992527
	speed: 0.0136s/iter; left time: 48.5410s
	iters: 1000, epoch: 7 | loss: 0.1362338
	speed: 0.0129s/iter; left time: 44.8469s
	iters: 1100, epoch: 7 | loss: 0.0905836
	speed: 0.0139s/iter; left time: 46.7698s
Epoch: 7 cost time: 16.269803762435913
Epoch: 7, Steps: 1117 | Train Loss: 0.1080269 Vali Loss: 0.0940814 Test Loss: 0.1061050
Validation loss decreased (0.094340 --> 0.094081).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0988822
	speed: 0.1077s/iter; left time: 350.1701s
	iters: 200, epoch: 8 | loss: 0.1110437
	speed: 0.0144s/iter; left time: 45.2632s
	iters: 300, epoch: 8 | loss: 0.1159672
	speed: 0.0135s/iter; left time: 41.2852s
	iters: 400, epoch: 8 | loss: 0.1037520
	speed: 0.0137s/iter; left time: 40.3903s
	iters: 500, epoch: 8 | loss: 0.1064985
	speed: 0.0147s/iter; left time: 41.9443s
	iters: 600, epoch: 8 | loss: 0.1052775
	speed: 0.0140s/iter; left time: 38.5857s
	iters: 700, epoch: 8 | loss: 0.0972728
	speed: 0.0138s/iter; left time: 36.6129s
	iters: 800, epoch: 8 | loss: 0.0932206
	speed: 0.0137s/iter; left time: 34.8773s
	iters: 900, epoch: 8 | loss: 0.0930742
	speed: 0.0147s/iter; left time: 36.0727s
	iters: 1000, epoch: 8 | loss: 0.1123503
	speed: 0.0140s/iter; left time: 33.0289s
	iters: 1100, epoch: 8 | loss: 0.1363370
	speed: 0.0139s/iter; left time: 31.3908s
Epoch: 8 cost time: 16.64546513557434
Epoch: 8, Steps: 1117 | Train Loss: 0.1079122 Vali Loss: 0.0940864 Test Loss: 0.1060820
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1018275
	speed: 0.1094s/iter; left time: 233.5598s
	iters: 200, epoch: 9 | loss: 0.0940860
	speed: 0.0138s/iter; left time: 28.0632s
	iters: 300, epoch: 9 | loss: 0.1110585
	speed: 0.0134s/iter; left time: 25.8962s
	iters: 400, epoch: 9 | loss: 0.1019227
	speed: 0.0138s/iter; left time: 25.2771s
	iters: 500, epoch: 9 | loss: 0.1017352
	speed: 0.0150s/iter; left time: 25.9427s
	iters: 600, epoch: 9 | loss: 0.1208157
	speed: 0.0147s/iter; left time: 23.9600s
	iters: 700, epoch: 9 | loss: 0.0962560
	speed: 0.0140s/iter; left time: 21.4861s
	iters: 800, epoch: 9 | loss: 0.0986156
	speed: 0.0143s/iter; left time: 20.5714s
	iters: 900, epoch: 9 | loss: 0.1127912
	speed: 0.0141s/iter; left time: 18.7685s
	iters: 1000, epoch: 9 | loss: 0.0837313
	speed: 0.0153s/iter; left time: 18.9308s
	iters: 1100, epoch: 9 | loss: 0.1233015
	speed: 0.0137s/iter; left time: 15.5463s
Epoch: 9 cost time: 16.641884326934814
Epoch: 9, Steps: 1117 | Train Loss: 0.1078421 Vali Loss: 0.0940152 Test Loss: 0.1060662
Validation loss decreased (0.094081 --> 0.094015).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0895648
	speed: 0.1085s/iter; left time: 110.5002s
	iters: 200, epoch: 10 | loss: 0.1070761
	speed: 0.0141s/iter; left time: 12.9578s
	iters: 300, epoch: 10 | loss: 0.0956738
	speed: 0.0143s/iter; left time: 11.7170s
	iters: 400, epoch: 10 | loss: 0.0941200
	speed: 0.0144s/iter; left time: 10.3136s
	iters: 500, epoch: 10 | loss: 0.1516443
	speed: 0.0149s/iter; left time: 9.1934s
	iters: 600, epoch: 10 | loss: 0.1259537
	speed: 0.0139s/iter; left time: 7.1986s
	iters: 700, epoch: 10 | loss: 0.1283907
	speed: 0.0136s/iter; left time: 5.6932s
	iters: 800, epoch: 10 | loss: 0.0929260
	speed: 0.0139s/iter; left time: 4.4178s
	iters: 900, epoch: 10 | loss: 0.1110730
	speed: 0.0135s/iter; left time: 2.9444s
	iters: 1000, epoch: 10 | loss: 0.1139859
	speed: 0.0132s/iter; left time: 1.5604s
	iters: 1100, epoch: 10 | loss: 0.0872797
	speed: 0.0133s/iter; left time: 0.2387s
Epoch: 10 cost time: 16.475412845611572
Epoch: 10, Steps: 1117 | Train Loss: 0.1078041 Vali Loss: 0.0939845 Test Loss: 0.1060093
Validation loss decreased (0.094015 --> 0.093985).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_504_24_DLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10569600760936737, mae:0.2044035643339157
