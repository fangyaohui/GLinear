Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='weather_48_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=48, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_48_720_DLinear_custom_ftM_sl48_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36120
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7730429
	speed: 0.0164s/iter; left time: 367.5008s
	iters: 200, epoch: 1 | loss: 1.0056014
	speed: 0.0104s/iter; left time: 231.6569s
	iters: 300, epoch: 1 | loss: 0.5206469
	speed: 0.0099s/iter; left time: 219.4941s
	iters: 400, epoch: 1 | loss: 0.9448441
	speed: 0.0091s/iter; left time: 202.7328s
	iters: 500, epoch: 1 | loss: 0.6400154
	speed: 0.0097s/iter; left time: 213.5575s
	iters: 600, epoch: 1 | loss: 0.9226065
	speed: 0.0099s/iter; left time: 217.6889s
	iters: 700, epoch: 1 | loss: 0.7541799
	speed: 0.0093s/iter; left time: 203.6001s
	iters: 800, epoch: 1 | loss: 0.5064560
	speed: 0.0098s/iter; left time: 212.3211s
	iters: 900, epoch: 1 | loss: 0.5790665
	speed: 0.0098s/iter; left time: 211.3297s
	iters: 1000, epoch: 1 | loss: 0.8626926
	speed: 0.0094s/iter; left time: 203.4774s
	iters: 1100, epoch: 1 | loss: 0.5713722
	speed: 0.0098s/iter; left time: 210.7787s
	iters: 1200, epoch: 1 | loss: 0.5643892
	speed: 0.0102s/iter; left time: 217.7959s
	iters: 1300, epoch: 1 | loss: 0.6459892
	speed: 0.0094s/iter; left time: 199.3724s
	iters: 1400, epoch: 1 | loss: 0.5844388
	speed: 0.0099s/iter; left time: 209.1329s
	iters: 1500, epoch: 1 | loss: 0.5974697
	speed: 0.0098s/iter; left time: 207.4852s
	iters: 1600, epoch: 1 | loss: 0.6210812
	speed: 0.0099s/iter; left time: 208.1212s
	iters: 1700, epoch: 1 | loss: 0.8898517
	speed: 0.0092s/iter; left time: 191.9549s
	iters: 1800, epoch: 1 | loss: 0.5496820
	speed: 0.0098s/iter; left time: 204.2703s
	iters: 1900, epoch: 1 | loss: 0.5543116
	speed: 0.0116s/iter; left time: 238.7976s
	iters: 2000, epoch: 1 | loss: 0.5723603
	speed: 0.0095s/iter; left time: 194.9686s
	iters: 2100, epoch: 1 | loss: 0.5939161
	speed: 0.0101s/iter; left time: 206.0580s
	iters: 2200, epoch: 1 | loss: 0.6311442
	speed: 0.0104s/iter; left time: 211.8446s
Epoch: 1 cost time: 22.932065963745117
Epoch: 1, Steps: 2257 | Train Loss: 0.7486949 Vali Loss: 0.7064786 Test Loss: 0.3752593
Validation loss decreased (inf --> 0.706479).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5558170
	speed: 0.1198s/iter; left time: 2420.6857s
	iters: 200, epoch: 2 | loss: 0.5736710
	speed: 0.0099s/iter; left time: 199.4773s
	iters: 300, epoch: 2 | loss: 0.6848978
	speed: 0.0103s/iter; left time: 206.5351s
	iters: 400, epoch: 2 | loss: 0.7366061
	speed: 0.0100s/iter; left time: 199.7161s
	iters: 500, epoch: 2 | loss: 0.7321785
	speed: 0.0107s/iter; left time: 211.0923s
	iters: 600, epoch: 2 | loss: 0.7036018
	speed: 0.0109s/iter; left time: 214.8207s
	iters: 700, epoch: 2 | loss: 0.6002945
	speed: 0.0101s/iter; left time: 197.6314s
	iters: 800, epoch: 2 | loss: 0.6438797
	speed: 0.0100s/iter; left time: 195.2524s
	iters: 900, epoch: 2 | loss: 0.5151129
	speed: 0.0098s/iter; left time: 189.5659s
	iters: 1000, epoch: 2 | loss: 0.6785525
	speed: 0.0095s/iter; left time: 184.2405s
	iters: 1100, epoch: 2 | loss: 0.8680570
	speed: 0.0099s/iter; left time: 190.8986s
	iters: 1200, epoch: 2 | loss: 0.6016571
	speed: 0.0101s/iter; left time: 193.2083s
	iters: 1300, epoch: 2 | loss: 0.6107201
	speed: 0.0101s/iter; left time: 192.2845s
	iters: 1400, epoch: 2 | loss: 0.6248423
	speed: 0.0093s/iter; left time: 175.0598s
	iters: 1500, epoch: 2 | loss: 0.5917395
	speed: 0.0099s/iter; left time: 185.7988s
	iters: 1600, epoch: 2 | loss: 0.8066600
	speed: 0.0102s/iter; left time: 191.6990s
	iters: 1700, epoch: 2 | loss: 0.6864042
	speed: 0.0094s/iter; left time: 174.2567s
	iters: 1800, epoch: 2 | loss: 0.8778465
	speed: 0.0099s/iter; left time: 182.4912s
	iters: 1900, epoch: 2 | loss: 1.0456425
	speed: 0.0099s/iter; left time: 182.5821s
	iters: 2000, epoch: 2 | loss: 0.7224116
	speed: 0.0090s/iter; left time: 164.6380s
	iters: 2100, epoch: 2 | loss: 0.7257079
	speed: 0.0097s/iter; left time: 176.3487s
	iters: 2200, epoch: 2 | loss: 0.6844854
	speed: 0.0099s/iter; left time: 179.2154s
Epoch: 2 cost time: 23.156830549240112
Epoch: 2, Steps: 2257 | Train Loss: 0.7357877 Vali Loss: 0.7040534 Test Loss: 0.3782051
Validation loss decreased (0.706479 --> 0.704053).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.9019718
	speed: 0.1216s/iter; left time: 2182.8038s
	iters: 200, epoch: 3 | loss: 0.8694824
	speed: 0.0092s/iter; left time: 164.8741s
	iters: 300, epoch: 3 | loss: 0.8322767
	speed: 0.0098s/iter; left time: 173.2517s
	iters: 400, epoch: 3 | loss: 0.6758409
	speed: 0.0100s/iter; left time: 175.7138s
	iters: 500, epoch: 3 | loss: 0.6248626
	speed: 0.0092s/iter; left time: 162.3596s
	iters: 600, epoch: 3 | loss: 0.8829628
	speed: 0.0095s/iter; left time: 166.5633s
	iters: 700, epoch: 3 | loss: 0.7088228
	speed: 0.0097s/iter; left time: 168.9400s
	iters: 800, epoch: 3 | loss: 1.0965027
	speed: 0.0091s/iter; left time: 157.6744s
	iters: 900, epoch: 3 | loss: 0.8600196
	speed: 0.0097s/iter; left time: 166.2837s
	iters: 1000, epoch: 3 | loss: 0.6111419
	speed: 0.0099s/iter; left time: 169.4688s
	iters: 1100, epoch: 3 | loss: 0.7958713
	speed: 0.0102s/iter; left time: 172.5696s
	iters: 1200, epoch: 3 | loss: 0.6632333
	speed: 0.0100s/iter; left time: 168.5741s
	iters: 1300, epoch: 3 | loss: 0.5688044
	speed: 0.0096s/iter; left time: 161.6653s
	iters: 1400, epoch: 3 | loss: 0.6529965
	speed: 0.0100s/iter; left time: 166.4501s
	iters: 1500, epoch: 3 | loss: 0.5468650
	speed: 0.0091s/iter; left time: 149.8660s
	iters: 1600, epoch: 3 | loss: 0.8334185
	speed: 0.0098s/iter; left time: 160.9361s
	iters: 1700, epoch: 3 | loss: 0.5179574
	speed: 0.0099s/iter; left time: 162.6756s
	iters: 1800, epoch: 3 | loss: 0.6587611
	speed: 0.0094s/iter; left time: 153.4754s
	iters: 1900, epoch: 3 | loss: 0.7458699
	speed: 0.0097s/iter; left time: 155.9514s
	iters: 2000, epoch: 3 | loss: 0.8538928
	speed: 0.0098s/iter; left time: 157.5217s
	iters: 2100, epoch: 3 | loss: 0.6127834
	speed: 0.0093s/iter; left time: 148.1822s
	iters: 2200, epoch: 3 | loss: 0.6267198
	speed: 0.0097s/iter; left time: 153.0343s
Epoch: 3 cost time: 22.575119495391846
Epoch: 3, Steps: 2257 | Train Loss: 0.7329907 Vali Loss: 0.7115540 Test Loss: 0.3722519
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.8504488
	speed: 0.1242s/iter; left time: 1950.5139s
	iters: 200, epoch: 4 | loss: 0.8077582
	speed: 0.0101s/iter; left time: 157.3116s
	iters: 300, epoch: 4 | loss: 0.4905897
	speed: 0.0101s/iter; left time: 156.3819s
	iters: 400, epoch: 4 | loss: 0.6980017
	speed: 0.0101s/iter; left time: 155.9043s
	iters: 500, epoch: 4 | loss: 0.6006730
	speed: 0.0096s/iter; left time: 146.3702s
	iters: 600, epoch: 4 | loss: 0.6069989
	speed: 0.0096s/iter; left time: 145.6218s
	iters: 700, epoch: 4 | loss: 0.7185438
	speed: 0.0098s/iter; left time: 148.5357s
	iters: 800, epoch: 4 | loss: 0.8760046
	speed: 0.0099s/iter; left time: 147.7928s
	iters: 900, epoch: 4 | loss: 0.8754019
	speed: 0.0091s/iter; left time: 134.9579s
	iters: 1000, epoch: 4 | loss: 0.6322581
	speed: 0.0098s/iter; left time: 145.0762s
	iters: 1100, epoch: 4 | loss: 0.6709077
	speed: 0.0099s/iter; left time: 146.0637s
	iters: 1200, epoch: 4 | loss: 0.7721872
	speed: 0.0094s/iter; left time: 137.8790s
	iters: 1300, epoch: 4 | loss: 0.6693804
	speed: 0.0097s/iter; left time: 141.3320s
	iters: 1400, epoch: 4 | loss: 0.6307451
	speed: 0.0098s/iter; left time: 141.1846s
	iters: 1500, epoch: 4 | loss: 0.5401298
	speed: 0.0095s/iter; left time: 135.8760s
	iters: 1600, epoch: 4 | loss: 0.8048735
	speed: 0.0095s/iter; left time: 135.5151s
	iters: 1700, epoch: 4 | loss: 0.5634879
	speed: 0.0097s/iter; left time: 136.5596s
	iters: 1800, epoch: 4 | loss: 0.5499377
	speed: 0.0095s/iter; left time: 132.5582s
	iters: 1900, epoch: 4 | loss: 0.6442348
	speed: 0.0097s/iter; left time: 134.6173s
	iters: 2000, epoch: 4 | loss: 0.5436184
	speed: 0.0096s/iter; left time: 133.1149s
	iters: 2100, epoch: 4 | loss: 0.5431330
	speed: 0.0101s/iter; left time: 139.0290s
	iters: 2200, epoch: 4 | loss: 0.7195815
	speed: 0.0093s/iter; left time: 126.0067s
Epoch: 4 cost time: 22.756996870040894
Epoch: 4, Steps: 2257 | Train Loss: 0.7315317 Vali Loss: 0.7071996 Test Loss: 0.3720401
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.8278481
	speed: 0.1219s/iter; left time: 1638.8395s
	iters: 200, epoch: 5 | loss: 0.6380107
	speed: 0.0098s/iter; left time: 130.9191s
	iters: 300, epoch: 5 | loss: 0.5234050
	speed: 0.0095s/iter; left time: 125.6055s
	iters: 400, epoch: 5 | loss: 1.0590886
	speed: 0.0100s/iter; left time: 130.7886s
	iters: 500, epoch: 5 | loss: 0.5275027
	speed: 0.0097s/iter; left time: 126.5591s
	iters: 600, epoch: 5 | loss: 0.6375077
	speed: 0.0092s/iter; left time: 119.1186s
	iters: 700, epoch: 5 | loss: 0.7901344
	speed: 0.0101s/iter; left time: 129.4970s
	iters: 800, epoch: 5 | loss: 0.7859958
	speed: 0.0098s/iter; left time: 124.3837s
	iters: 900, epoch: 5 | loss: 0.6934635
	speed: 0.0098s/iter; left time: 123.6843s
	iters: 1000, epoch: 5 | loss: 0.6664646
	speed: 0.0092s/iter; left time: 115.3423s
	iters: 1100, epoch: 5 | loss: 0.6117273
	speed: 0.0099s/iter; left time: 123.3905s
	iters: 1200, epoch: 5 | loss: 0.5747813
	speed: 0.0099s/iter; left time: 121.6751s
	iters: 1300, epoch: 5 | loss: 0.9141820
	speed: 0.0092s/iter; left time: 112.7119s
	iters: 1400, epoch: 5 | loss: 0.9358569
	speed: 0.0096s/iter; left time: 116.9179s
	iters: 1500, epoch: 5 | loss: 0.5585710
	speed: 0.0098s/iter; left time: 117.8423s
	iters: 1600, epoch: 5 | loss: 0.9772523
	speed: 0.0092s/iter; left time: 110.3246s
	iters: 1700, epoch: 5 | loss: 1.0686221
	speed: 0.0097s/iter; left time: 114.4717s
	iters: 1800, epoch: 5 | loss: 0.9260476
	speed: 0.0099s/iter; left time: 116.3825s
	iters: 1900, epoch: 5 | loss: 0.5689108
	speed: 0.0096s/iter; left time: 111.9452s
	iters: 2000, epoch: 5 | loss: 0.5773346
	speed: 0.0097s/iter; left time: 112.2647s
	iters: 2100, epoch: 5 | loss: 0.7714909
	speed: 0.0096s/iter; left time: 110.2444s
	iters: 2200, epoch: 5 | loss: 0.8607832
	speed: 0.0099s/iter; left time: 111.8857s
Epoch: 5 cost time: 22.615169286727905
Epoch: 5, Steps: 2257 | Train Loss: 0.7306431 Vali Loss: 0.7047248 Test Loss: 0.3735069
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_48_720_DLinear_custom_ftM_sl48_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3780914843082428, mae:0.4156694710254669
