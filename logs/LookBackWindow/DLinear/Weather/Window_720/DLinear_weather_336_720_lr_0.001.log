Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 1.0099601
	speed: 0.0149s/iter; left time: 332.2767s
	iters: 200, epoch: 1 | loss: 0.6175230
	speed: 0.0075s/iter; left time: 166.1781s
	iters: 300, epoch: 1 | loss: 0.5595600
	speed: 0.0075s/iter; left time: 166.6566s
	iters: 400, epoch: 1 | loss: 0.6001911
	speed: 0.0074s/iter; left time: 163.0684s
	iters: 500, epoch: 1 | loss: 0.5262965
	speed: 0.0074s/iter; left time: 162.5151s
	iters: 600, epoch: 1 | loss: 0.5741083
	speed: 0.0076s/iter; left time: 164.6260s
	iters: 700, epoch: 1 | loss: 0.5623198
	speed: 0.0075s/iter; left time: 163.6417s
	iters: 800, epoch: 1 | loss: 0.4725835
	speed: 0.0074s/iter; left time: 159.9620s
	iters: 900, epoch: 1 | loss: 0.4521853
	speed: 0.0076s/iter; left time: 162.4161s
	iters: 1000, epoch: 1 | loss: 0.4351138
	speed: 0.0075s/iter; left time: 160.8674s
	iters: 1100, epoch: 1 | loss: 0.5533389
	speed: 0.0075s/iter; left time: 159.7919s
	iters: 1200, epoch: 1 | loss: 0.4322768
	speed: 0.0074s/iter; left time: 157.8384s
	iters: 1300, epoch: 1 | loss: 0.6750253
	speed: 0.0076s/iter; left time: 161.1619s
	iters: 1400, epoch: 1 | loss: 0.4999076
	speed: 0.0076s/iter; left time: 160.3824s
	iters: 1500, epoch: 1 | loss: 0.8339781
	speed: 0.0076s/iter; left time: 158.4855s
	iters: 1600, epoch: 1 | loss: 0.4605738
	speed: 0.0094s/iter; left time: 194.7514s
	iters: 1700, epoch: 1 | loss: 0.8706231
	speed: 0.0075s/iter; left time: 154.7430s
	iters: 1800, epoch: 1 | loss: 0.8243064
	speed: 0.0075s/iter; left time: 154.0933s
	iters: 1900, epoch: 1 | loss: 0.6113538
	speed: 0.0076s/iter; left time: 155.8311s
	iters: 2000, epoch: 1 | loss: 0.4719389
	speed: 0.0074s/iter; left time: 150.4736s
	iters: 2100, epoch: 1 | loss: 0.7478178
	speed: 0.0076s/iter; left time: 153.6881s
	iters: 2200, epoch: 1 | loss: 0.6187021
	speed: 0.0076s/iter; left time: 153.8751s
Epoch: 1 cost time: 17.850939989089966
Epoch: 1, Steps: 2239 | Train Loss: 0.6208499 Vali Loss: 0.6297420 Test Loss: 0.3301831
Validation loss decreased (inf --> 0.629742).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5565972
	speed: 0.0938s/iter; left time: 1880.6828s
	iters: 200, epoch: 2 | loss: 0.5001708
	speed: 0.0076s/iter; left time: 152.1565s
	iters: 300, epoch: 2 | loss: 0.5040619
	speed: 0.0076s/iter; left time: 150.4082s
	iters: 400, epoch: 2 | loss: 0.4603165
	speed: 0.0077s/iter; left time: 151.3836s
	iters: 500, epoch: 2 | loss: 0.5939075
	speed: 0.0074s/iter; left time: 146.1395s
	iters: 600, epoch: 2 | loss: 0.5744038
	speed: 0.0076s/iter; left time: 148.4180s
	iters: 700, epoch: 2 | loss: 0.4706065
	speed: 0.0076s/iter; left time: 146.9921s
	iters: 800, epoch: 2 | loss: 0.7364320
	speed: 0.0077s/iter; left time: 148.5436s
	iters: 900, epoch: 2 | loss: 0.5749165
	speed: 0.0075s/iter; left time: 143.8838s
	iters: 1000, epoch: 2 | loss: 0.7172738
	speed: 0.0076s/iter; left time: 145.2980s
	iters: 1100, epoch: 2 | loss: 0.8191829
	speed: 0.0076s/iter; left time: 144.8438s
	iters: 1200, epoch: 2 | loss: 0.5339099
	speed: 0.0076s/iter; left time: 143.9775s
	iters: 1300, epoch: 2 | loss: 0.6187561
	speed: 0.0074s/iter; left time: 139.6140s
	iters: 1400, epoch: 2 | loss: 0.6733612
	speed: 0.0075s/iter; left time: 141.1409s
	iters: 1500, epoch: 2 | loss: 0.9175475
	speed: 0.0075s/iter; left time: 140.1278s
	iters: 1600, epoch: 2 | loss: 0.5526732
	speed: 0.0077s/iter; left time: 143.1852s
	iters: 1700, epoch: 2 | loss: 0.5690846
	speed: 0.0078s/iter; left time: 143.7558s
	iters: 1800, epoch: 2 | loss: 0.5301617
	speed: 0.0077s/iter; left time: 141.0602s
	iters: 1900, epoch: 2 | loss: 0.7775930
	speed: 0.0076s/iter; left time: 137.9785s
	iters: 2000, epoch: 2 | loss: 0.6698131
	speed: 0.0075s/iter; left time: 136.3365s
	iters: 2100, epoch: 2 | loss: 0.7445398
	speed: 0.0074s/iter; left time: 133.1167s
	iters: 2200, epoch: 2 | loss: 0.7133099
	speed: 0.0076s/iter; left time: 136.5135s
Epoch: 2 cost time: 17.7187283039093
Epoch: 2, Steps: 2239 | Train Loss: 0.6161117 Vali Loss: 0.6297804 Test Loss: 0.3273315
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4432385
	speed: 0.0973s/iter; left time: 1732.4488s
	iters: 200, epoch: 3 | loss: 1.0394568
	speed: 0.0075s/iter; left time: 132.5483s
	iters: 300, epoch: 3 | loss: 0.5491681
	speed: 0.0076s/iter; left time: 133.9690s
	iters: 400, epoch: 3 | loss: 0.5421815
	speed: 0.0077s/iter; left time: 134.4727s
	iters: 500, epoch: 3 | loss: 0.8767909
	speed: 0.0075s/iter; left time: 130.5685s
	iters: 600, epoch: 3 | loss: 1.0534931
	speed: 0.0075s/iter; left time: 129.6452s
	iters: 700, epoch: 3 | loss: 0.6159419
	speed: 0.0074s/iter; left time: 127.4549s
	iters: 800, epoch: 3 | loss: 0.7761652
	speed: 0.0075s/iter; left time: 129.1791s
	iters: 900, epoch: 3 | loss: 0.9626564
	speed: 0.0076s/iter; left time: 129.7468s
	iters: 1000, epoch: 3 | loss: 0.4222044
	speed: 0.0075s/iter; left time: 126.7496s
	iters: 1100, epoch: 3 | loss: 0.5743819
	speed: 0.0075s/iter; left time: 125.4583s
	iters: 1200, epoch: 3 | loss: 0.6037633
	speed: 0.0079s/iter; left time: 132.3657s
	iters: 1300, epoch: 3 | loss: 0.4917002
	speed: 0.0078s/iter; left time: 128.8048s
	iters: 1400, epoch: 3 | loss: 0.3444428
	speed: 0.0074s/iter; left time: 122.8981s
	iters: 1500, epoch: 3 | loss: 0.7568781
	speed: 0.0082s/iter; left time: 134.4999s
	iters: 1600, epoch: 3 | loss: 0.9426055
	speed: 0.0076s/iter; left time: 124.1920s
	iters: 1700, epoch: 3 | loss: 0.8159549
	speed: 0.0075s/iter; left time: 122.1632s
	iters: 1800, epoch: 3 | loss: 0.4324053
	speed: 0.0075s/iter; left time: 120.1279s
	iters: 1900, epoch: 3 | loss: 0.5339153
	speed: 0.0076s/iter; left time: 121.0973s
	iters: 2000, epoch: 3 | loss: 0.5614979
	speed: 0.0076s/iter; left time: 121.4548s
	iters: 2100, epoch: 3 | loss: 0.4438017
	speed: 0.0078s/iter; left time: 123.3700s
	iters: 2200, epoch: 3 | loss: 0.5930153
	speed: 0.0074s/iter; left time: 115.9484s
Epoch: 3 cost time: 17.829031467437744
Epoch: 3, Steps: 2239 | Train Loss: 0.6075376 Vali Loss: 0.6319646 Test Loss: 0.3295132
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.1509358
	speed: 0.0955s/iter; left time: 1487.6164s
	iters: 200, epoch: 4 | loss: 0.7981529
	speed: 0.0076s/iter; left time: 117.0690s
	iters: 300, epoch: 4 | loss: 0.5320066
	speed: 0.0076s/iter; left time: 116.3834s
	iters: 400, epoch: 4 | loss: 0.6046640
	speed: 0.0078s/iter; left time: 119.3445s
	iters: 500, epoch: 4 | loss: 0.4691012
	speed: 0.0077s/iter; left time: 116.2982s
	iters: 600, epoch: 4 | loss: 0.4430906
	speed: 0.0077s/iter; left time: 115.7031s
	iters: 700, epoch: 4 | loss: 0.4728519
	speed: 0.0076s/iter; left time: 113.1457s
	iters: 800, epoch: 4 | loss: 0.4716684
	speed: 0.0076s/iter; left time: 112.3136s
	iters: 900, epoch: 4 | loss: 0.5264701
	speed: 0.0076s/iter; left time: 112.5040s
	iters: 1000, epoch: 4 | loss: 0.6673018
	speed: 0.0076s/iter; left time: 110.9526s
	iters: 1100, epoch: 4 | loss: 0.4431695
	speed: 0.0076s/iter; left time: 110.2196s
	iters: 1200, epoch: 4 | loss: 0.4666209
	speed: 0.0079s/iter; left time: 114.6484s
	iters: 1300, epoch: 4 | loss: 0.5374711
	speed: 0.0077s/iter; left time: 110.6537s
	iters: 1400, epoch: 4 | loss: 0.7177666
	speed: 0.0078s/iter; left time: 111.6453s
	iters: 1500, epoch: 4 | loss: 0.5935104
	speed: 0.0075s/iter; left time: 106.2218s
	iters: 1600, epoch: 4 | loss: 0.4281144
	speed: 0.0075s/iter; left time: 104.8820s
	iters: 1700, epoch: 4 | loss: 0.4623679
	speed: 0.0075s/iter; left time: 105.4274s
	iters: 1800, epoch: 4 | loss: 0.6734013
	speed: 0.0076s/iter; left time: 105.6748s
	iters: 1900, epoch: 4 | loss: 0.5097007
	speed: 0.0077s/iter; left time: 106.1965s
	iters: 2000, epoch: 4 | loss: 0.5427291
	speed: 0.0076s/iter; left time: 103.7719s
	iters: 2100, epoch: 4 | loss: 0.4498969
	speed: 0.0079s/iter; left time: 107.2465s
	iters: 2200, epoch: 4 | loss: 0.5650077
	speed: 0.0078s/iter; left time: 105.3166s
Epoch: 4 cost time: 17.938153982162476
Epoch: 4, Steps: 2239 | Train Loss: 0.6035001 Vali Loss: 0.6202205 Test Loss: 0.3276358
Validation loss decreased (0.629742 --> 0.620220).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.8042339
	speed: 0.0958s/iter; left time: 1277.8678s
	iters: 200, epoch: 5 | loss: 0.5579098
	speed: 0.0076s/iter; left time: 100.3990s
	iters: 300, epoch: 5 | loss: 0.4746761
	speed: 0.0076s/iter; left time: 99.2277s
	iters: 400, epoch: 5 | loss: 0.7720566
	speed: 0.0075s/iter; left time: 97.3249s
	iters: 500, epoch: 5 | loss: 0.5014257
	speed: 0.0075s/iter; left time: 97.5641s
	iters: 600, epoch: 5 | loss: 0.7123166
	speed: 0.0076s/iter; left time: 98.0783s
	iters: 700, epoch: 5 | loss: 0.7925355
	speed: 0.0076s/iter; left time: 97.1432s
	iters: 800, epoch: 5 | loss: 0.5319162
	speed: 0.0076s/iter; left time: 95.7514s
	iters: 900, epoch: 5 | loss: 0.7071118
	speed: 0.0077s/iter; left time: 96.3328s
	iters: 1000, epoch: 5 | loss: 0.5636189
	speed: 0.0075s/iter; left time: 93.7051s
	iters: 1100, epoch: 5 | loss: 1.1829104
	speed: 0.0076s/iter; left time: 93.2259s
	iters: 1200, epoch: 5 | loss: 0.5028132
	speed: 0.0073s/iter; left time: 89.8956s
	iters: 1300, epoch: 5 | loss: 0.8403365
	speed: 0.0075s/iter; left time: 90.4222s
	iters: 1400, epoch: 5 | loss: 0.7961661
	speed: 0.0075s/iter; left time: 90.3636s
	iters: 1500, epoch: 5 | loss: 0.5150428
	speed: 0.0077s/iter; left time: 91.6555s
	iters: 1600, epoch: 5 | loss: 1.0492010
	speed: 0.0074s/iter; left time: 87.1584s
	iters: 1700, epoch: 5 | loss: 0.5062194
	speed: 0.0077s/iter; left time: 90.4047s
	iters: 1800, epoch: 5 | loss: 0.6933109
	speed: 0.0075s/iter; left time: 87.4537s
	iters: 1900, epoch: 5 | loss: 0.4740606
	speed: 0.0075s/iter; left time: 86.2253s
	iters: 2000, epoch: 5 | loss: 0.7620253
	speed: 0.0074s/iter; left time: 84.4661s
	iters: 2100, epoch: 5 | loss: 0.3987319
	speed: 0.0074s/iter; left time: 83.5921s
	iters: 2200, epoch: 5 | loss: 0.5154596
	speed: 0.0075s/iter; left time: 84.2931s
Epoch: 5 cost time: 17.65226697921753
Epoch: 5, Steps: 2239 | Train Loss: 0.6009872 Vali Loss: 0.6219345 Test Loss: 0.3256814
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4524077
	speed: 0.0925s/iter; left time: 1026.0535s
	iters: 200, epoch: 6 | loss: 0.5707615
	speed: 0.0074s/iter; left time: 81.9165s
	iters: 300, epoch: 6 | loss: 0.5416592
	speed: 0.0076s/iter; left time: 82.9801s
	iters: 400, epoch: 6 | loss: 0.4468122
	speed: 0.0076s/iter; left time: 81.9549s
	iters: 500, epoch: 6 | loss: 0.4823639
	speed: 0.0075s/iter; left time: 80.5577s
	iters: 600, epoch: 6 | loss: 0.5191660
	speed: 0.0073s/iter; left time: 76.8523s
	iters: 700, epoch: 6 | loss: 1.0274802
	speed: 0.0075s/iter; left time: 78.6580s
	iters: 800, epoch: 6 | loss: 0.6011503
	speed: 0.0075s/iter; left time: 77.6108s
	iters: 900, epoch: 6 | loss: 0.5885704
	speed: 0.0075s/iter; left time: 77.6404s
	iters: 1000, epoch: 6 | loss: 0.5474585
	speed: 0.0074s/iter; left time: 75.4993s
	iters: 1100, epoch: 6 | loss: 0.7038794
	speed: 0.0076s/iter; left time: 76.6010s
	iters: 1200, epoch: 6 | loss: 0.4775045
	speed: 0.0079s/iter; left time: 78.6646s
	iters: 1300, epoch: 6 | loss: 0.7109560
	speed: 0.0076s/iter; left time: 75.4475s
	iters: 1400, epoch: 6 | loss: 0.8495331
	speed: 0.0074s/iter; left time: 72.3761s
	iters: 1500, epoch: 6 | loss: 0.7797338
	speed: 0.0076s/iter; left time: 73.8421s
	iters: 1600, epoch: 6 | loss: 0.4883750
	speed: 0.0075s/iter; left time: 71.6991s
	iters: 1700, epoch: 6 | loss: 0.4677552
	speed: 0.0076s/iter; left time: 71.8216s
	iters: 1800, epoch: 6 | loss: 0.4552404
	speed: 0.0074s/iter; left time: 69.7517s
	iters: 1900, epoch: 6 | loss: 0.5873636
	speed: 0.0074s/iter; left time: 68.9035s
	iters: 2000, epoch: 6 | loss: 0.7145410
	speed: 0.0075s/iter; left time: 68.6489s
	iters: 2100, epoch: 6 | loss: 0.8977512
	speed: 0.0075s/iter; left time: 67.9656s
	iters: 2200, epoch: 6 | loss: 0.5119337
	speed: 0.0075s/iter; left time: 67.8200s
Epoch: 6 cost time: 17.574730157852173
Epoch: 6, Steps: 2239 | Train Loss: 0.5997538 Vali Loss: 0.6219968 Test Loss: 0.3245996
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.4685992
	speed: 0.0951s/iter; left time: 842.0378s
	iters: 200, epoch: 7 | loss: 0.5518355
	speed: 0.0076s/iter; left time: 66.8754s
	iters: 300, epoch: 7 | loss: 0.5596967
	speed: 0.0073s/iter; left time: 63.3213s
	iters: 400, epoch: 7 | loss: 0.5949925
	speed: 0.0077s/iter; left time: 65.7007s
	iters: 500, epoch: 7 | loss: 0.4624000
	speed: 0.0077s/iter; left time: 64.7550s
	iters: 600, epoch: 7 | loss: 0.4631024
	speed: 0.0076s/iter; left time: 63.7628s
	iters: 700, epoch: 7 | loss: 0.6659684
	speed: 0.0074s/iter; left time: 61.1124s
	iters: 800, epoch: 7 | loss: 0.4947259
	speed: 0.0077s/iter; left time: 62.6985s
	iters: 900, epoch: 7 | loss: 0.4834612
	speed: 0.0075s/iter; left time: 60.6738s
	iters: 1000, epoch: 7 | loss: 0.5827930
	speed: 0.0076s/iter; left time: 60.4572s
	iters: 1100, epoch: 7 | loss: 0.3987013
	speed: 0.0076s/iter; left time: 59.4259s
	iters: 1200, epoch: 7 | loss: 0.4963340
	speed: 0.0076s/iter; left time: 59.0914s
	iters: 1300, epoch: 7 | loss: 0.4509434
	speed: 0.0075s/iter; left time: 57.6887s
	iters: 1400, epoch: 7 | loss: 0.5758064
	speed: 0.0077s/iter; left time: 58.2153s
	iters: 1500, epoch: 7 | loss: 0.4106854
	speed: 0.0076s/iter; left time: 56.6258s
	iters: 1600, epoch: 7 | loss: 0.4522363
	speed: 0.0075s/iter; left time: 55.2981s
	iters: 1700, epoch: 7 | loss: 0.5959303
	speed: 0.0076s/iter; left time: 55.2741s
	iters: 1800, epoch: 7 | loss: 0.7022142
	speed: 0.0076s/iter; left time: 54.5426s
	iters: 1900, epoch: 7 | loss: 0.4617359
	speed: 0.0075s/iter; left time: 53.1807s
	iters: 2000, epoch: 7 | loss: 0.7845641
	speed: 0.0074s/iter; left time: 51.7154s
	iters: 2100, epoch: 7 | loss: 0.8492762
	speed: 0.0076s/iter; left time: 51.8850s
	iters: 2200, epoch: 7 | loss: 0.8024003
	speed: 0.0076s/iter; left time: 51.6567s
Epoch: 7 cost time: 17.756020069122314
Epoch: 7, Steps: 2239 | Train Loss: 0.5992210 Vali Loss: 0.6226808 Test Loss: 0.3230191
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32754233479499817, mae:0.3667038381099701
