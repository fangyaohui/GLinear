Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='weather_720_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35448
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8157496
	speed: 0.0142s/iter; left time: 312.9339s
	iters: 200, epoch: 1 | loss: 0.7273841
	speed: 0.0069s/iter; left time: 152.4215s
	iters: 300, epoch: 1 | loss: 0.6646935
	speed: 0.0071s/iter; left time: 155.2067s
	iters: 400, epoch: 1 | loss: 0.4249986
	speed: 0.0071s/iter; left time: 154.4341s
	iters: 500, epoch: 1 | loss: 0.7109296
	speed: 0.0073s/iter; left time: 157.1567s
	iters: 600, epoch: 1 | loss: 0.4763200
	speed: 0.0070s/iter; left time: 150.5170s
	iters: 700, epoch: 1 | loss: 0.7955661
	speed: 0.0066s/iter; left time: 142.5178s
	iters: 800, epoch: 1 | loss: 0.5069902
	speed: 0.0065s/iter; left time: 139.4468s
	iters: 900, epoch: 1 | loss: 0.4551618
	speed: 0.0066s/iter; left time: 140.6852s
	iters: 1000, epoch: 1 | loss: 0.6215161
	speed: 0.0066s/iter; left time: 140.6491s
	iters: 1100, epoch: 1 | loss: 0.6063498
	speed: 0.0067s/iter; left time: 140.7173s
	iters: 1200, epoch: 1 | loss: 0.5321937
	speed: 0.0063s/iter; left time: 132.4262s
	iters: 1300, epoch: 1 | loss: 0.4975037
	speed: 0.0071s/iter; left time: 148.6356s
	iters: 1400, epoch: 1 | loss: 0.6123770
	speed: 0.0069s/iter; left time: 142.4541s
	iters: 1500, epoch: 1 | loss: 0.4481799
	speed: 0.0066s/iter; left time: 136.8536s
	iters: 1600, epoch: 1 | loss: 0.4309604
	speed: 0.0080s/iter; left time: 164.6359s
	iters: 1700, epoch: 1 | loss: 0.7125792
	speed: 0.0076s/iter; left time: 154.9796s
	iters: 1800, epoch: 1 | loss: 0.5902791
	speed: 0.0065s/iter; left time: 132.0269s
	iters: 1900, epoch: 1 | loss: 0.7022960
	speed: 0.0065s/iter; left time: 132.2641s
	iters: 2000, epoch: 1 | loss: 0.5775954
	speed: 0.0066s/iter; left time: 133.6532s
	iters: 2100, epoch: 1 | loss: 0.6931592
	speed: 0.0076s/iter; left time: 151.4797s
	iters: 2200, epoch: 1 | loss: 0.4178703
	speed: 0.0080s/iter; left time: 160.1532s
Epoch: 1 cost time: 16.22433590888977
Epoch: 1, Steps: 2215 | Train Loss: 0.6044361 Vali Loss: 0.6109654 Test Loss: 0.3213894
Validation loss decreased (inf --> 0.610965).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5716383
	speed: 0.0954s/iter; left time: 1892.5121s
	iters: 200, epoch: 2 | loss: 0.5647351
	speed: 0.0069s/iter; left time: 135.8420s
	iters: 300, epoch: 2 | loss: 0.6273028
	speed: 0.0066s/iter; left time: 129.6181s
	iters: 400, epoch: 2 | loss: 0.4783836
	speed: 0.0075s/iter; left time: 145.7882s
	iters: 500, epoch: 2 | loss: 0.5727953
	speed: 0.0068s/iter; left time: 131.4665s
	iters: 600, epoch: 2 | loss: 0.4997158
	speed: 0.0075s/iter; left time: 145.3299s
	iters: 700, epoch: 2 | loss: 0.5440087
	speed: 0.0068s/iter; left time: 130.9940s
	iters: 800, epoch: 2 | loss: 0.5015564
	speed: 0.0066s/iter; left time: 126.0589s
	iters: 900, epoch: 2 | loss: 0.6939907
	speed: 0.0065s/iter; left time: 123.0451s
	iters: 1000, epoch: 2 | loss: 1.0250627
	speed: 0.0070s/iter; left time: 131.7174s
	iters: 1100, epoch: 2 | loss: 0.5481523
	speed: 0.0069s/iter; left time: 129.7858s
	iters: 1200, epoch: 2 | loss: 0.5290083
	speed: 0.0071s/iter; left time: 133.5042s
	iters: 1300, epoch: 2 | loss: 0.6315466
	speed: 0.0066s/iter; left time: 123.8558s
	iters: 1400, epoch: 2 | loss: 0.5822473
	speed: 0.0072s/iter; left time: 132.5864s
	iters: 1500, epoch: 2 | loss: 0.5588788
	speed: 0.0074s/iter; left time: 136.5699s
	iters: 1600, epoch: 2 | loss: 0.4172693
	speed: 0.0071s/iter; left time: 129.7543s
	iters: 1700, epoch: 2 | loss: 0.4070095
	speed: 0.0074s/iter; left time: 134.4441s
	iters: 1800, epoch: 2 | loss: 0.5467345
	speed: 0.0082s/iter; left time: 149.3943s
	iters: 1900, epoch: 2 | loss: 0.5600876
	speed: 0.0081s/iter; left time: 145.5908s
	iters: 2000, epoch: 2 | loss: 0.5593433
	speed: 0.0071s/iter; left time: 128.0268s
	iters: 2100, epoch: 2 | loss: 0.6091264
	speed: 0.0080s/iter; left time: 142.4010s
	iters: 2200, epoch: 2 | loss: 0.6151317
	speed: 0.0071s/iter; left time: 125.8930s
Epoch: 2 cost time: 16.682448387145996
Epoch: 2, Steps: 2215 | Train Loss: 0.6006991 Vali Loss: 0.6053203 Test Loss: 0.3314750
Validation loss decreased (0.610965 --> 0.605320).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4825241
	speed: 0.0950s/iter; left time: 1673.6129s
	iters: 200, epoch: 3 | loss: 0.6509373
	speed: 0.0072s/iter; left time: 126.1379s
	iters: 300, epoch: 3 | loss: 0.5726404
	speed: 0.0065s/iter; left time: 113.6153s
	iters: 400, epoch: 3 | loss: 0.7129217
	speed: 0.0066s/iter; left time: 114.2559s
	iters: 500, epoch: 3 | loss: 0.5691053
	speed: 0.0063s/iter; left time: 107.7249s
	iters: 600, epoch: 3 | loss: 0.4340933
	speed: 0.0064s/iter; left time: 109.6040s
	iters: 700, epoch: 3 | loss: 0.5600648
	speed: 0.0067s/iter; left time: 114.4413s
	iters: 800, epoch: 3 | loss: 0.4510942
	speed: 0.0066s/iter; left time: 112.4150s
	iters: 900, epoch: 3 | loss: 0.6216760
	speed: 0.0068s/iter; left time: 113.8284s
	iters: 1000, epoch: 3 | loss: 0.7606280
	speed: 0.0068s/iter; left time: 113.9206s
	iters: 1100, epoch: 3 | loss: 0.4749767
	speed: 0.0079s/iter; left time: 131.5871s
	iters: 1200, epoch: 3 | loss: 0.7008421
	speed: 0.0071s/iter; left time: 117.2811s
	iters: 1300, epoch: 3 | loss: 0.9784740
	speed: 0.0070s/iter; left time: 115.0766s
	iters: 1400, epoch: 3 | loss: 0.5205292
	speed: 0.0073s/iter; left time: 119.6545s
	iters: 1500, epoch: 3 | loss: 0.4981072
	speed: 0.0066s/iter; left time: 106.7677s
	iters: 1600, epoch: 3 | loss: 0.7161040
	speed: 0.0065s/iter; left time: 104.0664s
	iters: 1700, epoch: 3 | loss: 0.8046400
	speed: 0.0067s/iter; left time: 106.7317s
	iters: 1800, epoch: 3 | loss: 0.5488884
	speed: 0.0066s/iter; left time: 104.4618s
	iters: 1900, epoch: 3 | loss: 0.5681430
	speed: 0.0066s/iter; left time: 104.0030s
	iters: 2000, epoch: 3 | loss: 0.4705523
	speed: 0.0068s/iter; left time: 106.4753s
	iters: 2100, epoch: 3 | loss: 0.4250868
	speed: 0.0069s/iter; left time: 107.6946s
	iters: 2200, epoch: 3 | loss: 0.4083493
	speed: 0.0077s/iter; left time: 118.8919s
Epoch: 3 cost time: 16.08834147453308
Epoch: 3, Steps: 2215 | Train Loss: 0.5863398 Vali Loss: 0.6023600 Test Loss: 0.3182591
Validation loss decreased (0.605320 --> 0.602360).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.6160007
	speed: 0.0950s/iter; left time: 1464.1854s
	iters: 200, epoch: 4 | loss: 0.6156881
	speed: 0.0063s/iter; left time: 96.8362s
	iters: 300, epoch: 4 | loss: 0.4759562
	speed: 0.0071s/iter; left time: 107.5203s
	iters: 400, epoch: 4 | loss: 0.4537823
	speed: 0.0068s/iter; left time: 102.2422s
	iters: 500, epoch: 4 | loss: 0.4176346
	speed: 0.0066s/iter; left time: 99.4772s
	iters: 600, epoch: 4 | loss: 0.5640892
	speed: 0.0070s/iter; left time: 104.1122s
	iters: 700, epoch: 4 | loss: 0.4275466
	speed: 0.0065s/iter; left time: 96.4297s
	iters: 800, epoch: 4 | loss: 0.5392313
	speed: 0.0067s/iter; left time: 99.2543s
	iters: 900, epoch: 4 | loss: 0.7057682
	speed: 0.0073s/iter; left time: 106.7859s
	iters: 1000, epoch: 4 | loss: 0.5097885
	speed: 0.0066s/iter; left time: 95.5647s
	iters: 1100, epoch: 4 | loss: 0.4559281
	speed: 0.0073s/iter; left time: 105.5337s
	iters: 1200, epoch: 4 | loss: 0.6454163
	speed: 0.0081s/iter; left time: 115.5879s
	iters: 1300, epoch: 4 | loss: 0.5415042
	speed: 0.0067s/iter; left time: 94.4962s
	iters: 1400, epoch: 4 | loss: 0.5982063
	speed: 0.0067s/iter; left time: 94.4273s
	iters: 1500, epoch: 4 | loss: 0.4786002
	speed: 0.0067s/iter; left time: 93.7909s
	iters: 1600, epoch: 4 | loss: 0.4617831
	speed: 0.0065s/iter; left time: 90.5371s
	iters: 1700, epoch: 4 | loss: 0.6017577
	speed: 0.0068s/iter; left time: 94.2283s
	iters: 1800, epoch: 4 | loss: 0.6433632
	speed: 0.0067s/iter; left time: 91.9484s
	iters: 1900, epoch: 4 | loss: 0.5767125
	speed: 0.0070s/iter; left time: 95.1464s
	iters: 2000, epoch: 4 | loss: 0.4895155
	speed: 0.0069s/iter; left time: 93.5318s
	iters: 2100, epoch: 4 | loss: 0.4684924
	speed: 0.0072s/iter; left time: 96.3052s
	iters: 2200, epoch: 4 | loss: 0.4601357
	speed: 0.0070s/iter; left time: 93.1040s
Epoch: 4 cost time: 16.166648626327515
Epoch: 4, Steps: 2215 | Train Loss: 0.5786552 Vali Loss: 0.5892434 Test Loss: 0.3181623
Validation loss decreased (0.602360 --> 0.589243).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5377644
	speed: 0.0960s/iter; left time: 1266.9826s
	iters: 200, epoch: 5 | loss: 0.4690476
	speed: 0.0068s/iter; left time: 88.9143s
	iters: 300, epoch: 5 | loss: 0.5178715
	speed: 0.0067s/iter; left time: 86.7480s
	iters: 400, epoch: 5 | loss: 0.4901218
	speed: 0.0065s/iter; left time: 83.8596s
	iters: 500, epoch: 5 | loss: 0.7366347
	speed: 0.0073s/iter; left time: 93.4967s
	iters: 600, epoch: 5 | loss: 0.5984588
	speed: 0.0071s/iter; left time: 89.6690s
	iters: 700, epoch: 5 | loss: 0.7671896
	speed: 0.0064s/iter; left time: 80.5145s
	iters: 800, epoch: 5 | loss: 0.7697054
	speed: 0.0070s/iter; left time: 86.8881s
	iters: 900, epoch: 5 | loss: 0.6050838
	speed: 0.0069s/iter; left time: 85.9503s
	iters: 1000, epoch: 5 | loss: 0.4705578
	speed: 0.0066s/iter; left time: 81.3811s
	iters: 1100, epoch: 5 | loss: 0.4350573
	speed: 0.0067s/iter; left time: 81.6274s
	iters: 1200, epoch: 5 | loss: 0.4943243
	speed: 0.0074s/iter; left time: 88.9279s
	iters: 1300, epoch: 5 | loss: 0.7469996
	speed: 0.0066s/iter; left time: 79.2988s
	iters: 1400, epoch: 5 | loss: 0.5722935
	speed: 0.0069s/iter; left time: 82.4680s
	iters: 1500, epoch: 5 | loss: 0.7498848
	speed: 0.0063s/iter; left time: 74.5969s
	iters: 1600, epoch: 5 | loss: 0.4723972
	speed: 0.0068s/iter; left time: 79.0336s
	iters: 1700, epoch: 5 | loss: 0.4780497
	speed: 0.0069s/iter; left time: 79.6174s
	iters: 1800, epoch: 5 | loss: 0.3993194
	speed: 0.0069s/iter; left time: 79.4095s
	iters: 1900, epoch: 5 | loss: 0.5254331
	speed: 0.0070s/iter; left time: 79.4558s
	iters: 2000, epoch: 5 | loss: 0.4674293
	speed: 0.0067s/iter; left time: 75.7010s
	iters: 2100, epoch: 5 | loss: 0.8710729
	speed: 0.0067s/iter; left time: 75.2879s
	iters: 2200, epoch: 5 | loss: 0.5364207
	speed: 0.0069s/iter; left time: 76.5020s
Epoch: 5 cost time: 15.920336961746216
Epoch: 5, Steps: 2215 | Train Loss: 0.5748140 Vali Loss: 0.5896596 Test Loss: 0.3159449
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4206820
	speed: 0.0978s/iter; left time: 1073.7182s
	iters: 200, epoch: 6 | loss: 0.6608646
	speed: 0.0073s/iter; left time: 79.7826s
	iters: 300, epoch: 6 | loss: 0.4978790
	speed: 0.0072s/iter; left time: 77.3007s
	iters: 400, epoch: 6 | loss: 0.9923354
	speed: 0.0068s/iter; left time: 72.8478s
	iters: 500, epoch: 6 | loss: 0.5251370
	speed: 0.0067s/iter; left time: 71.1053s
	iters: 600, epoch: 6 | loss: 0.4051827
	speed: 0.0067s/iter; left time: 70.0984s
	iters: 700, epoch: 6 | loss: 0.6086245
	speed: 0.0066s/iter; left time: 68.5742s
	iters: 800, epoch: 6 | loss: 0.7812845
	speed: 0.0068s/iter; left time: 70.3334s
	iters: 900, epoch: 6 | loss: 0.4321789
	speed: 0.0069s/iter; left time: 70.1209s
	iters: 1000, epoch: 6 | loss: 0.6530202
	speed: 0.0070s/iter; left time: 70.1222s
	iters: 1100, epoch: 6 | loss: 0.7015924
	speed: 0.0072s/iter; left time: 71.3986s
	iters: 1200, epoch: 6 | loss: 0.4258350
	speed: 0.0066s/iter; left time: 65.2258s
	iters: 1300, epoch: 6 | loss: 0.9225578
	speed: 0.0070s/iter; left time: 68.3131s
	iters: 1400, epoch: 6 | loss: 0.6576198
	speed: 0.0068s/iter; left time: 65.7812s
	iters: 1500, epoch: 6 | loss: 0.3970519
	speed: 0.0068s/iter; left time: 64.7678s
	iters: 1600, epoch: 6 | loss: 0.4827806
	speed: 0.0068s/iter; left time: 64.7592s
	iters: 1700, epoch: 6 | loss: 0.6851138
	speed: 0.0067s/iter; left time: 62.8871s
	iters: 1800, epoch: 6 | loss: 0.4701584
	speed: 0.0065s/iter; left time: 60.4405s
	iters: 1900, epoch: 6 | loss: 0.3749292
	speed: 0.0070s/iter; left time: 63.7805s
	iters: 2000, epoch: 6 | loss: 0.5458878
	speed: 0.0069s/iter; left time: 62.4807s
	iters: 2100, epoch: 6 | loss: 0.4378352
	speed: 0.0070s/iter; left time: 62.4038s
	iters: 2200, epoch: 6 | loss: 0.5504255
	speed: 0.0068s/iter; left time: 60.5133s
Epoch: 6 cost time: 16.116570711135864
Epoch: 6, Steps: 2215 | Train Loss: 0.5727301 Vali Loss: 0.5925533 Test Loss: 0.3133807
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.8543141
	speed: 0.0931s/iter; left time: 815.4944s
	iters: 200, epoch: 7 | loss: 0.4248176
	speed: 0.0069s/iter; left time: 59.7018s
	iters: 300, epoch: 7 | loss: 0.6734448
	speed: 0.0069s/iter; left time: 59.1757s
	iters: 400, epoch: 7 | loss: 0.4118779
	speed: 0.0068s/iter; left time: 57.4927s
	iters: 500, epoch: 7 | loss: 0.5917200
	speed: 0.0065s/iter; left time: 54.4165s
	iters: 600, epoch: 7 | loss: 0.7486483
	speed: 0.0071s/iter; left time: 58.4510s
	iters: 700, epoch: 7 | loss: 0.4460531
	speed: 0.0072s/iter; left time: 58.6112s
	iters: 800, epoch: 7 | loss: 0.3875429
	speed: 0.0071s/iter; left time: 56.8516s
	iters: 900, epoch: 7 | loss: 0.5098186
	speed: 0.0067s/iter; left time: 53.1312s
	iters: 1000, epoch: 7 | loss: 0.5760816
	speed: 0.0069s/iter; left time: 54.1349s
	iters: 1100, epoch: 7 | loss: 0.4857771
	speed: 0.0070s/iter; left time: 54.0890s
	iters: 1200, epoch: 7 | loss: 0.8130703
	speed: 0.0073s/iter; left time: 55.6184s
	iters: 1300, epoch: 7 | loss: 0.4091870
	speed: 0.0069s/iter; left time: 52.0470s
	iters: 1400, epoch: 7 | loss: 0.4868408
	speed: 0.0065s/iter; left time: 48.6958s
	iters: 1500, epoch: 7 | loss: 0.4343930
	speed: 0.0062s/iter; left time: 45.9998s
	iters: 1600, epoch: 7 | loss: 0.9701467
	speed: 0.0068s/iter; left time: 49.0343s
	iters: 1700, epoch: 7 | loss: 0.4222742
	speed: 0.0068s/iter; left time: 48.5351s
	iters: 1800, epoch: 7 | loss: 0.7417051
	speed: 0.0071s/iter; left time: 50.4228s
	iters: 1900, epoch: 7 | loss: 0.7677845
	speed: 0.0065s/iter; left time: 45.0962s
	iters: 2000, epoch: 7 | loss: 0.9782929
	speed: 0.0066s/iter; left time: 45.3449s
	iters: 2100, epoch: 7 | loss: 0.5320147
	speed: 0.0071s/iter; left time: 47.7017s
	iters: 2200, epoch: 7 | loss: 0.5408437
	speed: 0.0073s/iter; left time: 48.8342s
Epoch: 7 cost time: 16.046886920928955
Epoch: 7, Steps: 2215 | Train Loss: 0.5715958 Vali Loss: 0.5894806 Test Loss: 0.3140495
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.31805893778800964, mae:0.3552964925765991
