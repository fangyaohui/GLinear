Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='weather_120_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=120, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_120_24_DLinear_custom_ftM_sl120_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36744
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.1492748
	speed: 0.0169s/iter; left time: 387.2278s
	iters: 200, epoch: 1 | loss: 0.1493025
	speed: 0.0115s/iter; left time: 261.7300s
	iters: 300, epoch: 1 | loss: 0.1417137
	speed: 0.0118s/iter; left time: 266.7218s
	iters: 400, epoch: 1 | loss: 0.1982674
	speed: 0.0103s/iter; left time: 233.1854s
	iters: 500, epoch: 1 | loss: 0.1498182
	speed: 0.0118s/iter; left time: 264.9317s
	iters: 600, epoch: 1 | loss: 0.1451264
	speed: 0.0110s/iter; left time: 246.4041s
	iters: 700, epoch: 1 | loss: 0.2175930
	speed: 0.0111s/iter; left time: 247.0209s
	iters: 800, epoch: 1 | loss: 0.1723660
	speed: 0.0116s/iter; left time: 256.0566s
	iters: 900, epoch: 1 | loss: 0.3013848
	speed: 0.0115s/iter; left time: 254.6934s
	iters: 1000, epoch: 1 | loss: 0.1330677
	speed: 0.0112s/iter; left time: 245.7410s
	iters: 1100, epoch: 1 | loss: 0.1373584
	speed: 0.0118s/iter; left time: 257.4404s
	iters: 1200, epoch: 1 | loss: 0.1166731
	speed: 0.0104s/iter; left time: 226.7604s
	iters: 1300, epoch: 1 | loss: 0.1614920
	speed: 0.0116s/iter; left time: 251.9677s
	iters: 1400, epoch: 1 | loss: 0.2394733
	speed: 0.0119s/iter; left time: 257.5555s
	iters: 1500, epoch: 1 | loss: 0.2170896
	speed: 0.0104s/iter; left time: 222.8482s
	iters: 1600, epoch: 1 | loss: 0.1679052
	speed: 0.0115s/iter; left time: 246.4592s
	iters: 1700, epoch: 1 | loss: 0.1816105
	speed: 0.0109s/iter; left time: 232.3535s
	iters: 1800, epoch: 1 | loss: 0.1601933
	speed: 0.0114s/iter; left time: 242.2332s
	iters: 1900, epoch: 1 | loss: 0.2193515
	speed: 0.0118s/iter; left time: 249.5265s
	iters: 2000, epoch: 1 | loss: 1.5899799
	speed: 0.0106s/iter; left time: 223.0816s
	iters: 2100, epoch: 1 | loss: 0.1882201
	speed: 0.0110s/iter; left time: 229.9299s
	iters: 2200, epoch: 1 | loss: 0.1954940
	speed: 0.0117s/iter; left time: 243.9056s
Epoch: 1 cost time: 26.509087324142456
Epoch: 1, Steps: 2296 | Train Loss: 0.3582909 Vali Loss: 0.3110853 Test Loss: 0.1167477
Validation loss decreased (inf --> 0.311085).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1689595
	speed: 0.1278s/iter; left time: 2627.3420s
	iters: 200, epoch: 2 | loss: 0.3761293
	speed: 0.0116s/iter; left time: 237.9793s
	iters: 300, epoch: 2 | loss: 0.2099789
	speed: 0.0111s/iter; left time: 226.1704s
	iters: 400, epoch: 2 | loss: 0.8203806
	speed: 0.0115s/iter; left time: 233.3522s
	iters: 500, epoch: 2 | loss: 0.2153951
	speed: 0.0115s/iter; left time: 232.2303s
	iters: 600, epoch: 2 | loss: 0.1754478
	speed: 0.0110s/iter; left time: 220.8067s
	iters: 700, epoch: 2 | loss: 0.1654283
	speed: 0.0113s/iter; left time: 224.9514s
	iters: 800, epoch: 2 | loss: 0.1841189
	speed: 0.0118s/iter; left time: 234.8510s
	iters: 900, epoch: 2 | loss: 0.2401896
	speed: 0.0109s/iter; left time: 215.9077s
	iters: 1000, epoch: 2 | loss: 0.3068963
	speed: 0.0118s/iter; left time: 231.2139s
	iters: 1100, epoch: 2 | loss: 0.2225939
	speed: 0.0118s/iter; left time: 231.8380s
	iters: 1200, epoch: 2 | loss: 0.1881689
	speed: 0.0104s/iter; left time: 203.0161s
	iters: 1300, epoch: 2 | loss: 0.1486328
	speed: 0.0116s/iter; left time: 225.6009s
	iters: 1400, epoch: 2 | loss: 0.1351064
	speed: 0.0112s/iter; left time: 214.8251s
	iters: 1500, epoch: 2 | loss: 0.1959124
	speed: 0.0110s/iter; left time: 211.6979s
	iters: 1600, epoch: 2 | loss: 0.2613218
	speed: 0.0116s/iter; left time: 220.4389s
	iters: 1700, epoch: 2 | loss: 2.0619946
	speed: 0.0110s/iter; left time: 209.2832s
	iters: 1800, epoch: 2 | loss: 0.3340681
	speed: 0.0112s/iter; left time: 210.3816s
	iters: 1900, epoch: 2 | loss: 0.2961838
	speed: 0.0119s/iter; left time: 222.6021s
	iters: 2000, epoch: 2 | loss: 0.3365972
	speed: 0.0105s/iter; left time: 196.4444s
	iters: 2100, epoch: 2 | loss: 0.1663027
	speed: 0.0116s/iter; left time: 214.4670s
	iters: 2200, epoch: 2 | loss: 0.1182553
	speed: 0.0119s/iter; left time: 220.3185s
Epoch: 2 cost time: 26.59892225265503
Epoch: 2, Steps: 2296 | Train Loss: 0.3457017 Vali Loss: 0.3002881 Test Loss: 0.1141851
Validation loss decreased (0.311085 --> 0.300288).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2210688
	speed: 0.1270s/iter; left time: 2320.5150s
	iters: 200, epoch: 3 | loss: 0.1563709
	speed: 0.0116s/iter; left time: 211.1913s
	iters: 300, epoch: 3 | loss: 0.1415932
	speed: 0.0109s/iter; left time: 197.7872s
	iters: 400, epoch: 3 | loss: 0.0977562
	speed: 0.0114s/iter; left time: 204.2333s
	iters: 500, epoch: 3 | loss: 0.1631949
	speed: 0.0118s/iter; left time: 210.5970s
	iters: 600, epoch: 3 | loss: 0.1933947
	speed: 0.0103s/iter; left time: 183.1499s
	iters: 700, epoch: 3 | loss: 0.3804872
	speed: 0.0117s/iter; left time: 205.9665s
	iters: 800, epoch: 3 | loss: 0.2192100
	speed: 0.0120s/iter; left time: 210.3695s
	iters: 900, epoch: 3 | loss: 0.3749132
	speed: 0.0101s/iter; left time: 176.9707s
	iters: 1000, epoch: 3 | loss: 0.1679349
	speed: 0.0116s/iter; left time: 200.8953s
	iters: 1100, epoch: 3 | loss: 0.2080662
	speed: 0.0108s/iter; left time: 187.3233s
	iters: 1200, epoch: 3 | loss: 0.1370911
	speed: 0.0114s/iter; left time: 194.9741s
	iters: 1300, epoch: 3 | loss: 0.3435262
	speed: 0.0116s/iter; left time: 197.7972s
	iters: 1400, epoch: 3 | loss: 0.2985464
	speed: 0.0112s/iter; left time: 189.3567s
	iters: 1500, epoch: 3 | loss: 0.2157828
	speed: 0.0112s/iter; left time: 188.8298s
	iters: 1600, epoch: 3 | loss: 0.2807107
	speed: 0.0116s/iter; left time: 195.3445s
	iters: 1700, epoch: 3 | loss: 0.2478400
	speed: 0.0105s/iter; left time: 174.7982s
	iters: 1800, epoch: 3 | loss: 0.4483515
	speed: 0.0114s/iter; left time: 188.9201s
	iters: 1900, epoch: 3 | loss: 0.2149367
	speed: 0.0118s/iter; left time: 194.8144s
	iters: 2000, epoch: 3 | loss: 0.2139126
	speed: 0.0103s/iter; left time: 169.0250s
	iters: 2100, epoch: 3 | loss: 0.1866873
	speed: 0.0117s/iter; left time: 190.1047s
	iters: 2200, epoch: 3 | loss: 0.1955212
	speed: 0.0114s/iter; left time: 184.6295s
Epoch: 3 cost time: 26.492302656173706
Epoch: 3, Steps: 2296 | Train Loss: 0.3421294 Vali Loss: 0.3062394 Test Loss: 0.1135697
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1368534
	speed: 0.1298s/iter; left time: 2072.8255s
	iters: 200, epoch: 4 | loss: 0.1148987
	speed: 0.0120s/iter; left time: 190.0779s
	iters: 300, epoch: 4 | loss: 0.1678809
	speed: 0.0101s/iter; left time: 159.4552s
	iters: 400, epoch: 4 | loss: 0.2259192
	speed: 0.0116s/iter; left time: 182.5437s
	iters: 500, epoch: 4 | loss: 1.3036972
	speed: 0.0119s/iter; left time: 185.6306s
	iters: 600, epoch: 4 | loss: 0.1172979
	speed: 0.0103s/iter; left time: 159.4261s
	iters: 700, epoch: 4 | loss: 0.1301860
	speed: 0.0118s/iter; left time: 181.1451s
	iters: 800, epoch: 4 | loss: 0.2382292
	speed: 0.0110s/iter; left time: 167.6325s
	iters: 900, epoch: 4 | loss: 0.1501207
	speed: 0.0115s/iter; left time: 173.8116s
	iters: 1000, epoch: 4 | loss: 0.0993072
	speed: 0.0118s/iter; left time: 178.4443s
	iters: 1100, epoch: 4 | loss: 0.2077428
	speed: 0.0105s/iter; left time: 157.5975s
	iters: 1200, epoch: 4 | loss: 0.2098781
	speed: 0.0113s/iter; left time: 167.5658s
	iters: 1300, epoch: 4 | loss: 0.1680746
	speed: 0.0120s/iter; left time: 176.6962s
	iters: 1400, epoch: 4 | loss: 0.1256379
	speed: 0.0104s/iter; left time: 152.8718s
	iters: 1500, epoch: 4 | loss: 0.2279404
	speed: 0.0118s/iter; left time: 172.2279s
	iters: 1600, epoch: 4 | loss: 0.2113297
	speed: 0.0116s/iter; left time: 168.2637s
	iters: 1700, epoch: 4 | loss: 0.1907627
	speed: 0.0107s/iter; left time: 154.0179s
	iters: 1800, epoch: 4 | loss: 0.2409940
	speed: 0.0115s/iter; left time: 164.2735s
	iters: 1900, epoch: 4 | loss: 0.2591761
	speed: 0.0108s/iter; left time: 153.6491s
	iters: 2000, epoch: 4 | loss: 0.1351607
	speed: 0.0114s/iter; left time: 160.5380s
	iters: 2100, epoch: 4 | loss: 0.7093128
	speed: 0.0118s/iter; left time: 164.3165s
	iters: 2200, epoch: 4 | loss: 0.1956023
	speed: 0.0107s/iter; left time: 148.3512s
Epoch: 4 cost time: 26.658472299575806
Epoch: 4, Steps: 2296 | Train Loss: 0.3396773 Vali Loss: 0.3041357 Test Loss: 0.1128515
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1443491
	speed: 0.1319s/iter; left time: 1803.5534s
	iters: 200, epoch: 5 | loss: 0.1393630
	speed: 0.0113s/iter; left time: 153.0838s
	iters: 300, epoch: 5 | loss: 0.3621767
	speed: 0.0112s/iter; left time: 150.7202s
	iters: 400, epoch: 5 | loss: 0.3183717
	speed: 0.0118s/iter; left time: 157.6939s
	iters: 500, epoch: 5 | loss: 0.1985151
	speed: 0.0105s/iter; left time: 139.0942s
	iters: 600, epoch: 5 | loss: 0.1201380
	speed: 0.0116s/iter; left time: 152.5410s
	iters: 700, epoch: 5 | loss: 0.1716759
	speed: 0.0120s/iter; left time: 156.4135s
	iters: 800, epoch: 5 | loss: 0.2163403
	speed: 0.0104s/iter; left time: 134.7370s
	iters: 900, epoch: 5 | loss: 0.2134992
	speed: 0.0115s/iter; left time: 147.5514s
	iters: 1000, epoch: 5 | loss: 0.1730792
	speed: 0.0106s/iter; left time: 135.8203s
	iters: 1100, epoch: 5 | loss: 0.4125403
	speed: 0.0112s/iter; left time: 141.5773s
	iters: 1200, epoch: 5 | loss: 0.2653900
	speed: 0.0116s/iter; left time: 146.0187s
	iters: 1300, epoch: 5 | loss: 0.3804071
	speed: 0.0108s/iter; left time: 134.7879s
	iters: 1400, epoch: 5 | loss: 0.1571537
	speed: 0.0110s/iter; left time: 135.9821s
	iters: 1500, epoch: 5 | loss: 0.1304740
	speed: 0.0117s/iter; left time: 144.2230s
	iters: 1600, epoch: 5 | loss: 0.5377277
	speed: 0.0106s/iter; left time: 129.1907s
	iters: 1700, epoch: 5 | loss: 0.1220034
	speed: 0.0114s/iter; left time: 138.0304s
	iters: 1800, epoch: 5 | loss: 1.7451100
	speed: 0.0119s/iter; left time: 142.0682s
	iters: 1900, epoch: 5 | loss: 0.1881567
	speed: 0.0098s/iter; left time: 116.9448s
	iters: 2000, epoch: 5 | loss: 0.1456331
	speed: 0.0117s/iter; left time: 138.3266s
	iters: 2100, epoch: 5 | loss: 0.2179188
	speed: 0.0114s/iter; left time: 132.7306s
	iters: 2200, epoch: 5 | loss: 0.1329833
	speed: 0.0111s/iter; left time: 128.4996s
Epoch: 5 cost time: 26.674248695373535
Epoch: 5, Steps: 2296 | Train Loss: 0.3384314 Vali Loss: 0.3044039 Test Loss: 0.1122052
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_120_24_DLinear_custom_ftM_sl120_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.11429566144943237, mae:0.1671866625547409
