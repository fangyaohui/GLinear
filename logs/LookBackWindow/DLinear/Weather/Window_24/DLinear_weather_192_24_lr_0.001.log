Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='weather_192_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=192, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_192_24_DLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36672
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.2125868
	speed: 0.0193s/iter; left time: 440.0053s
	iters: 200, epoch: 1 | loss: 0.2349748
	speed: 0.0110s/iter; left time: 249.9426s
	iters: 300, epoch: 1 | loss: 0.6182787
	speed: 0.0112s/iter; left time: 253.0154s
	iters: 400, epoch: 1 | loss: 0.2867365
	speed: 0.0119s/iter; left time: 267.5501s
	iters: 500, epoch: 1 | loss: 0.1637099
	speed: 0.0106s/iter; left time: 237.7464s
	iters: 600, epoch: 1 | loss: 0.2328959
	speed: 0.0115s/iter; left time: 257.6948s
	iters: 700, epoch: 1 | loss: 0.1221750
	speed: 0.0113s/iter; left time: 250.7128s
	iters: 800, epoch: 1 | loss: 0.3524871
	speed: 0.0113s/iter; left time: 250.4362s
	iters: 900, epoch: 1 | loss: 0.4325897
	speed: 0.0117s/iter; left time: 258.1343s
	iters: 1000, epoch: 1 | loss: 0.2163341
	speed: 0.0109s/iter; left time: 239.9835s
	iters: 1100, epoch: 1 | loss: 0.2552429
	speed: 0.0114s/iter; left time: 249.7399s
	iters: 1200, epoch: 1 | loss: 0.2038259
	speed: 0.0119s/iter; left time: 259.5029s
	iters: 1300, epoch: 1 | loss: 0.4978707
	speed: 0.0106s/iter; left time: 229.4806s
	iters: 1400, epoch: 1 | loss: 0.2191041
	speed: 0.0115s/iter; left time: 246.9489s
	iters: 1500, epoch: 1 | loss: 0.1364090
	speed: 0.0112s/iter; left time: 240.8899s
	iters: 1600, epoch: 1 | loss: 1.3888358
	speed: 0.0115s/iter; left time: 244.5596s
	iters: 1700, epoch: 1 | loss: 0.4195069
	speed: 0.0117s/iter; left time: 247.8547s
	iters: 1800, epoch: 1 | loss: 0.1811993
	speed: 0.0111s/iter; left time: 233.8591s
	iters: 1900, epoch: 1 | loss: 0.3989706
	speed: 0.0114s/iter; left time: 240.5565s
	iters: 2000, epoch: 1 | loss: 0.1138730
	speed: 0.0118s/iter; left time: 247.0567s
	iters: 2100, epoch: 1 | loss: 0.1421022
	speed: 0.0106s/iter; left time: 220.4925s
	iters: 2200, epoch: 1 | loss: 0.1627939
	speed: 0.0114s/iter; left time: 237.1808s
Epoch: 1 cost time: 26.775607347488403
Epoch: 1, Steps: 2292 | Train Loss: 0.3532885 Vali Loss: 0.3100798 Test Loss: 0.1123630
Validation loss decreased (inf --> 0.310080).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4411055
	speed: 0.1314s/iter; left time: 2698.3247s
	iters: 200, epoch: 2 | loss: 0.2730006
	speed: 0.0115s/iter; left time: 235.8206s
	iters: 300, epoch: 2 | loss: 0.2041119
	speed: 0.0115s/iter; left time: 233.5920s
	iters: 400, epoch: 2 | loss: 0.2125911
	speed: 0.0114s/iter; left time: 229.8172s
	iters: 500, epoch: 2 | loss: 0.3891152
	speed: 0.0118s/iter; left time: 237.0922s
	iters: 600, epoch: 2 | loss: 0.1984264
	speed: 0.0108s/iter; left time: 215.6848s
	iters: 700, epoch: 2 | loss: 0.1944298
	speed: 0.0116s/iter; left time: 230.8980s
	iters: 800, epoch: 2 | loss: 1.4015498
	speed: 0.0111s/iter; left time: 220.7818s
	iters: 900, epoch: 2 | loss: 0.1951832
	speed: 0.0113s/iter; left time: 223.0871s
	iters: 1000, epoch: 2 | loss: 0.1893185
	speed: 0.0116s/iter; left time: 227.8752s
	iters: 1100, epoch: 2 | loss: 0.1412154
	speed: 0.0114s/iter; left time: 222.6516s
	iters: 1200, epoch: 2 | loss: 0.2613279
	speed: 0.0113s/iter; left time: 219.9287s
	iters: 1300, epoch: 2 | loss: 0.4632006
	speed: 0.0118s/iter; left time: 228.6940s
	iters: 1400, epoch: 2 | loss: 0.1415048
	speed: 0.0109s/iter; left time: 209.2076s
	iters: 1500, epoch: 2 | loss: 0.1653782
	speed: 0.0115s/iter; left time: 219.8277s
	iters: 1600, epoch: 2 | loss: 0.2549571
	speed: 0.0112s/iter; left time: 213.4292s
	iters: 1700, epoch: 2 | loss: 0.1174710
	speed: 0.0115s/iter; left time: 217.1376s
	iters: 1800, epoch: 2 | loss: 0.1418757
	speed: 0.0117s/iter; left time: 219.6271s
	iters: 1900, epoch: 2 | loss: 0.2798978
	speed: 0.0109s/iter; left time: 203.6306s
	iters: 2000, epoch: 2 | loss: 1.3612248
	speed: 0.0118s/iter; left time: 219.0306s
	iters: 2100, epoch: 2 | loss: 0.2683934
	speed: 0.0119s/iter; left time: 220.6056s
	iters: 2200, epoch: 2 | loss: 0.0967031
	speed: 0.0108s/iter; left time: 199.1781s
Epoch: 2 cost time: 26.88090682029724
Epoch: 2, Steps: 2292 | Train Loss: 0.3423550 Vali Loss: 0.3062330 Test Loss: 0.1102361
Validation loss decreased (0.310080 --> 0.306233).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3896914
	speed: 0.1359s/iter; left time: 2478.3798s
	iters: 200, epoch: 3 | loss: 0.1315458
	speed: 0.0111s/iter; left time: 202.1096s
	iters: 300, epoch: 3 | loss: 0.1739128
	speed: 0.0118s/iter; left time: 213.5343s
	iters: 400, epoch: 3 | loss: 0.2184187
	speed: 0.0108s/iter; left time: 193.3709s
	iters: 500, epoch: 3 | loss: 0.3323632
	speed: 0.0118s/iter; left time: 209.7347s
	iters: 600, epoch: 3 | loss: 0.1305758
	speed: 0.0113s/iter; left time: 200.9190s
	iters: 700, epoch: 3 | loss: 0.1482639
	speed: 0.0116s/iter; left time: 204.5080s
	iters: 800, epoch: 3 | loss: 0.1465891
	speed: 0.0118s/iter; left time: 206.8380s
	iters: 900, epoch: 3 | loss: 0.1309583
	speed: 0.0114s/iter; left time: 198.5985s
	iters: 1000, epoch: 3 | loss: 0.1488104
	speed: 0.0118s/iter; left time: 204.8003s
	iters: 1100, epoch: 3 | loss: 0.1709922
	speed: 0.0119s/iter; left time: 205.0873s
	iters: 1200, epoch: 3 | loss: 0.1143661
	speed: 0.0113s/iter; left time: 194.1312s
	iters: 1300, epoch: 3 | loss: 0.2585417
	speed: 0.0116s/iter; left time: 198.3052s
	iters: 1400, epoch: 3 | loss: 0.2279548
	speed: 0.0112s/iter; left time: 189.5243s
	iters: 1500, epoch: 3 | loss: 0.3266770
	speed: 0.0115s/iter; left time: 192.8442s
	iters: 1600, epoch: 3 | loss: 0.1740561
	speed: 0.0119s/iter; left time: 198.3403s
	iters: 1700, epoch: 3 | loss: 0.2634118
	speed: 0.0108s/iter; left time: 179.8987s
	iters: 1800, epoch: 3 | loss: 0.5813950
	speed: 0.0119s/iter; left time: 196.5593s
	iters: 1900, epoch: 3 | loss: 0.1444307
	speed: 0.0117s/iter; left time: 192.9700s
	iters: 2000, epoch: 3 | loss: 0.1516608
	speed: 0.0114s/iter; left time: 186.6396s
	iters: 2100, epoch: 3 | loss: 0.3686046
	speed: 0.0117s/iter; left time: 190.6379s
	iters: 2200, epoch: 3 | loss: 0.1996575
	speed: 0.0113s/iter; left time: 182.2325s
Epoch: 3 cost time: 27.17692232131958
Epoch: 3, Steps: 2292 | Train Loss: 0.3370854 Vali Loss: 0.2997048 Test Loss: 0.1111434
Validation loss decreased (0.306233 --> 0.299705).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1834819
	speed: 0.1354s/iter; left time: 2159.2465s
	iters: 200, epoch: 4 | loss: 0.1549696
	speed: 0.0098s/iter; left time: 155.8635s
	iters: 300, epoch: 4 | loss: 0.0629344
	speed: 0.0116s/iter; left time: 182.2964s
	iters: 400, epoch: 4 | loss: 0.2194285
	speed: 0.0113s/iter; left time: 177.4025s
	iters: 500, epoch: 4 | loss: 0.1012985
	speed: 0.0101s/iter; left time: 157.6559s
	iters: 600, epoch: 4 | loss: 0.1242251
	speed: 0.0117s/iter; left time: 181.4687s
	iters: 700, epoch: 4 | loss: 0.1640379
	speed: 0.0114s/iter; left time: 175.3927s
	iters: 800, epoch: 4 | loss: 1.1920342
	speed: 0.0116s/iter; left time: 176.5915s
	iters: 900, epoch: 4 | loss: 0.2282322
	speed: 0.0117s/iter; left time: 177.6387s
	iters: 1000, epoch: 4 | loss: 0.1836828
	speed: 0.0110s/iter; left time: 165.5848s
	iters: 1100, epoch: 4 | loss: 0.1458210
	speed: 0.0114s/iter; left time: 170.6348s
	iters: 1200, epoch: 4 | loss: 0.1968535
	speed: 0.0117s/iter; left time: 173.3462s
	iters: 1300, epoch: 4 | loss: 0.4612517
	speed: 0.0095s/iter; left time: 140.2795s
	iters: 1400, epoch: 4 | loss: 1.1622374
	speed: 0.0114s/iter; left time: 167.6799s
	iters: 1500, epoch: 4 | loss: 0.1497970
	speed: 0.0113s/iter; left time: 164.5708s
	iters: 1600, epoch: 4 | loss: 0.3629852
	speed: 0.0111s/iter; left time: 159.9556s
	iters: 1700, epoch: 4 | loss: 0.1192406
	speed: 0.0118s/iter; left time: 169.0057s
	iters: 1800, epoch: 4 | loss: 0.1071797
	speed: 0.0096s/iter; left time: 136.4471s
	iters: 1900, epoch: 4 | loss: 0.2945088
	speed: 0.0111s/iter; left time: 157.6511s
	iters: 2000, epoch: 4 | loss: 0.1837701
	speed: 0.0117s/iter; left time: 164.8497s
	iters: 2100, epoch: 4 | loss: 0.1644625
	speed: 0.0111s/iter; left time: 155.0465s
	iters: 2200, epoch: 4 | loss: 0.2616446
	speed: 0.0112s/iter; left time: 154.9223s
Epoch: 4 cost time: 26.411596536636353
Epoch: 4, Steps: 2292 | Train Loss: 0.3342101 Vali Loss: 0.2946442 Test Loss: 0.1081283
Validation loss decreased (0.299705 --> 0.294644).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1229818
	speed: 0.1379s/iter; left time: 1882.1429s
	iters: 200, epoch: 5 | loss: 0.2235705
	speed: 0.0121s/iter; left time: 163.6752s
	iters: 300, epoch: 5 | loss: 0.1337776
	speed: 0.0111s/iter; left time: 149.3397s
	iters: 400, epoch: 5 | loss: 0.1563878
	speed: 0.0113s/iter; left time: 151.5535s
	iters: 500, epoch: 5 | loss: 0.2603905
	speed: 0.0120s/iter; left time: 159.3017s
	iters: 600, epoch: 5 | loss: 0.2633231
	speed: 0.0111s/iter; left time: 145.6752s
	iters: 700, epoch: 5 | loss: 0.1783044
	speed: 0.0121s/iter; left time: 157.6357s
	iters: 800, epoch: 5 | loss: 0.1810533
	speed: 0.0112s/iter; left time: 145.3361s
	iters: 900, epoch: 5 | loss: 0.2703882
	speed: 0.0116s/iter; left time: 149.4674s
	iters: 1000, epoch: 5 | loss: 0.2394009
	speed: 0.0122s/iter; left time: 154.9688s
	iters: 1100, epoch: 5 | loss: 0.1902754
	speed: 0.0118s/iter; left time: 149.3399s
	iters: 1200, epoch: 5 | loss: 0.4572468
	speed: 0.0118s/iter; left time: 148.0934s
	iters: 1300, epoch: 5 | loss: 0.2861986
	speed: 0.0114s/iter; left time: 142.0544s
	iters: 1400, epoch: 5 | loss: 0.2453648
	speed: 0.0116s/iter; left time: 143.6692s
	iters: 1500, epoch: 5 | loss: 0.1673509
	speed: 0.0118s/iter; left time: 144.3055s
	iters: 1600, epoch: 5 | loss: 0.1997997
	speed: 0.0114s/iter; left time: 138.5763s
	iters: 1700, epoch: 5 | loss: 1.2956822
	speed: 0.0117s/iter; left time: 141.5601s
	iters: 1800, epoch: 5 | loss: 0.2235736
	speed: 0.0117s/iter; left time: 139.5785s
	iters: 1900, epoch: 5 | loss: 0.3709357
	speed: 0.0116s/iter; left time: 137.1083s
	iters: 2000, epoch: 5 | loss: 0.1678997
	speed: 0.0120s/iter; left time: 141.1397s
	iters: 2100, epoch: 5 | loss: 0.2242475
	speed: 0.0109s/iter; left time: 126.9447s
	iters: 2200, epoch: 5 | loss: 0.1187987
	speed: 0.0114s/iter; left time: 131.3513s
Epoch: 5 cost time: 27.43540096282959
Epoch: 5, Steps: 2292 | Train Loss: 0.3327637 Vali Loss: 0.2960152 Test Loss: 0.1082151
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3400084
	speed: 0.1414s/iter; left time: 1606.9735s
	iters: 200, epoch: 6 | loss: 0.1876874
	speed: 0.0119s/iter; left time: 133.8240s
	iters: 300, epoch: 6 | loss: 0.2856252
	speed: 0.0104s/iter; left time: 115.8111s
	iters: 400, epoch: 6 | loss: 0.5088099
	speed: 0.0117s/iter; left time: 129.1403s
	iters: 500, epoch: 6 | loss: 0.2083228
	speed: 0.0116s/iter; left time: 127.3925s
	iters: 600, epoch: 6 | loss: 0.2248339
	speed: 0.0106s/iter; left time: 115.1001s
	iters: 700, epoch: 6 | loss: 0.1863838
	speed: 0.0117s/iter; left time: 126.1525s
	iters: 800, epoch: 6 | loss: 0.3383643
	speed: 0.0112s/iter; left time: 118.8891s
	iters: 900, epoch: 6 | loss: 0.0909342
	speed: 0.0112s/iter; left time: 118.5761s
	iters: 1000, epoch: 6 | loss: 0.1822780
	speed: 0.0119s/iter; left time: 124.5835s
	iters: 1100, epoch: 6 | loss: 0.2169174
	speed: 0.0112s/iter; left time: 115.8806s
	iters: 1200, epoch: 6 | loss: 0.1795365
	speed: 0.0119s/iter; left time: 121.8240s
	iters: 1300, epoch: 6 | loss: 0.1997986
	speed: 0.0118s/iter; left time: 119.9298s
	iters: 1400, epoch: 6 | loss: 0.1450734
	speed: 0.0112s/iter; left time: 112.8477s
	iters: 1500, epoch: 6 | loss: 0.2255671
	speed: 0.0118s/iter; left time: 117.9088s
	iters: 1600, epoch: 6 | loss: 0.1856212
	speed: 0.0114s/iter; left time: 112.1084s
	iters: 1700, epoch: 6 | loss: 0.1452103
	speed: 0.0113s/iter; left time: 109.9194s
	iters: 1800, epoch: 6 | loss: 0.1065130
	speed: 0.0121s/iter; left time: 117.1896s
	iters: 1900, epoch: 6 | loss: 0.2745834
	speed: 0.0108s/iter; left time: 103.2628s
	iters: 2000, epoch: 6 | loss: 0.1806270
	speed: 0.0118s/iter; left time: 111.5207s
	iters: 2100, epoch: 6 | loss: 0.3357109
	speed: 0.0114s/iter; left time: 106.7097s
	iters: 2200, epoch: 6 | loss: 0.1341311
	speed: 0.0112s/iter; left time: 103.3373s
Epoch: 6 cost time: 27.133374214172363
Epoch: 6, Steps: 2292 | Train Loss: 0.3321997 Vali Loss: 0.2962123 Test Loss: 0.1089434
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.5731580
	speed: 0.1350s/iter; left time: 1223.9995s
	iters: 200, epoch: 7 | loss: 0.2547643
	speed: 0.0115s/iter; left time: 103.2178s
	iters: 300, epoch: 7 | loss: 0.1142575
	speed: 0.0120s/iter; left time: 106.7270s
	iters: 400, epoch: 7 | loss: 0.6913682
	speed: 0.0106s/iter; left time: 93.2289s
	iters: 500, epoch: 7 | loss: 0.3275394
	speed: 0.0117s/iter; left time: 101.4162s
	iters: 600, epoch: 7 | loss: 0.3644329
	speed: 0.0112s/iter; left time: 95.6580s
	iters: 700, epoch: 7 | loss: 0.1266416
	speed: 0.0114s/iter; left time: 96.5979s
	iters: 800, epoch: 7 | loss: 0.6760707
	speed: 0.0118s/iter; left time: 99.0765s
	iters: 900, epoch: 7 | loss: 0.1749014
	speed: 0.0111s/iter; left time: 91.8375s
	iters: 1000, epoch: 7 | loss: 0.2293244
	speed: 0.0115s/iter; left time: 94.2984s
	iters: 1100, epoch: 7 | loss: 0.2174520
	speed: 0.0121s/iter; left time: 97.4317s
	iters: 1200, epoch: 7 | loss: 0.9601671
	speed: 0.0109s/iter; left time: 86.8902s
	iters: 1300, epoch: 7 | loss: 0.1259633
	speed: 0.0120s/iter; left time: 94.2401s
	iters: 1400, epoch: 7 | loss: 0.2824056
	speed: 0.0113s/iter; left time: 88.0525s
	iters: 1500, epoch: 7 | loss: 0.1998020
	speed: 0.0116s/iter; left time: 88.8243s
	iters: 1600, epoch: 7 | loss: 0.2516471
	speed: 0.0120s/iter; left time: 91.1967s
	iters: 1700, epoch: 7 | loss: 0.2795957
	speed: 0.0108s/iter; left time: 80.9859s
	iters: 1800, epoch: 7 | loss: 0.3973145
	speed: 0.0118s/iter; left time: 86.5882s
	iters: 1900, epoch: 7 | loss: 0.2877097
	speed: 0.0114s/iter; left time: 82.7782s
	iters: 2000, epoch: 7 | loss: 0.1188187
	speed: 0.0116s/iter; left time: 82.9796s
	iters: 2100, epoch: 7 | loss: 0.1701556
	speed: 0.0121s/iter; left time: 85.7860s
	iters: 2200, epoch: 7 | loss: 0.1690256
	speed: 0.0110s/iter; left time: 76.8886s
Epoch: 7 cost time: 27.116290807724
Epoch: 7, Steps: 2292 | Train Loss: 0.3316255 Vali Loss: 0.2960033 Test Loss: 0.1088423
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_24_DLinear_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.10823655873537064, mae:0.15809403359889984
