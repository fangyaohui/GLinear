Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='ETTh1_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_24_DLinear_ETTh1_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8281
val 2857
test 2857
	iters: 100, epoch: 1 | loss: 0.2905687
	speed: 0.0199s/iter; left time: 203.8295s
	iters: 200, epoch: 1 | loss: 0.2996364
	speed: 0.0139s/iter; left time: 140.8382s
	iters: 300, epoch: 1 | loss: 0.3083658
	speed: 0.0115s/iter; left time: 115.2402s
	iters: 400, epoch: 1 | loss: 0.2952051
	speed: 0.0136s/iter; left time: 135.7090s
	iters: 500, epoch: 1 | loss: 0.2761865
	speed: 0.0119s/iter; left time: 117.4933s
	iters: 600, epoch: 1 | loss: 0.4122441
	speed: 0.0131s/iter; left time: 127.2964s
	iters: 700, epoch: 1 | loss: 0.4023083
	speed: 0.0133s/iter; left time: 128.7399s
	iters: 800, epoch: 1 | loss: 0.3562284
	speed: 0.0120s/iter; left time: 114.6800s
	iters: 900, epoch: 1 | loss: 0.2471420
	speed: 0.0137s/iter; left time: 129.2674s
	iters: 1000, epoch: 1 | loss: 0.3138840
	speed: 0.0114s/iter; left time: 106.2078s
Epoch: 1 cost time: 13.970356225967407
Epoch: 1, Steps: 1035 | Train Loss: 0.2984617 Vali Loss: 0.4153064 Test Loss: 0.3483331
Validation loss decreased (inf --> 0.415306).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5256317
	speed: 0.1115s/iter; left time: 1027.6400s
	iters: 200, epoch: 2 | loss: 0.2805998
	speed: 0.0129s/iter; left time: 117.8948s
	iters: 300, epoch: 2 | loss: 0.3049373
	speed: 0.0140s/iter; left time: 126.2613s
	iters: 400, epoch: 2 | loss: 0.2871181
	speed: 0.0113s/iter; left time: 101.1885s
	iters: 500, epoch: 2 | loss: 0.2809272
	speed: 0.0138s/iter; left time: 121.4467s
	iters: 600, epoch: 2 | loss: 0.3213567
	speed: 0.0119s/iter; left time: 104.1405s
	iters: 700, epoch: 2 | loss: 0.2426066
	speed: 0.0134s/iter; left time: 115.4869s
	iters: 800, epoch: 2 | loss: 0.2552758
	speed: 0.0123s/iter; left time: 104.8151s
	iters: 900, epoch: 2 | loss: 0.2375545
	speed: 0.0131s/iter; left time: 110.4516s
	iters: 1000, epoch: 2 | loss: 0.2844324
	speed: 0.0139s/iter; left time: 115.4604s
Epoch: 2 cost time: 13.983577013015747
Epoch: 2, Steps: 1035 | Train Loss: 0.2788537 Vali Loss: 0.4212486 Test Loss: 0.3402313
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3659500
	speed: 0.1096s/iter; left time: 896.7235s
	iters: 200, epoch: 3 | loss: 0.3928891
	speed: 0.0119s/iter; left time: 95.8856s
	iters: 300, epoch: 3 | loss: 0.2227884
	speed: 0.0131s/iter; left time: 104.5387s
	iters: 400, epoch: 3 | loss: 0.2432383
	speed: 0.0127s/iter; left time: 99.8413s
	iters: 500, epoch: 3 | loss: 0.1746321
	speed: 0.0126s/iter; left time: 98.0861s
	iters: 600, epoch: 3 | loss: 0.2206899
	speed: 0.0140s/iter; left time: 107.4618s
	iters: 700, epoch: 3 | loss: 0.1670066
	speed: 0.0113s/iter; left time: 85.4612s
	iters: 800, epoch: 3 | loss: 0.2266977
	speed: 0.0137s/iter; left time: 102.2167s
	iters: 900, epoch: 3 | loss: 0.2669483
	speed: 0.0120s/iter; left time: 88.7369s
	iters: 1000, epoch: 3 | loss: 0.1737765
	speed: 0.0132s/iter; left time: 96.0862s
Epoch: 3 cost time: 14.069771766662598
Epoch: 3, Steps: 1035 | Train Loss: 0.2668218 Vali Loss: 0.4157159 Test Loss: 0.3309906
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2213621
	speed: 0.1128s/iter; left time: 805.8596s
	iters: 200, epoch: 4 | loss: 0.2959313
	speed: 0.0141s/iter; left time: 99.6305s
	iters: 300, epoch: 4 | loss: 0.2431211
	speed: 0.0122s/iter; left time: 84.7765s
	iters: 400, epoch: 4 | loss: 0.4844145
	speed: 0.0139s/iter; left time: 95.1557s
	iters: 500, epoch: 4 | loss: 0.2398557
	speed: 0.0123s/iter; left time: 82.7114s
	iters: 600, epoch: 4 | loss: 0.2002197
	speed: 0.0137s/iter; left time: 91.0820s
	iters: 700, epoch: 4 | loss: 0.2961558
	speed: 0.0129s/iter; left time: 84.6601s
	iters: 800, epoch: 4 | loss: 0.2914912
	speed: 0.0134s/iter; left time: 86.4632s
	iters: 900, epoch: 4 | loss: 0.2246759
	speed: 0.0131s/iter; left time: 82.8969s
	iters: 1000, epoch: 4 | loss: 0.2967251
	speed: 0.0133s/iter; left time: 82.8529s
Epoch: 4 cost time: 14.45913553237915
Epoch: 4, Steps: 1035 | Train Loss: 0.2608422 Vali Loss: 0.3954355 Test Loss: 0.3238764
Validation loss decreased (0.415306 --> 0.395435).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3280506
	speed: 0.1148s/iter; left time: 701.2435s
	iters: 200, epoch: 5 | loss: 0.2802919
	speed: 0.0138s/iter; left time: 82.7357s
	iters: 300, epoch: 5 | loss: 0.2207212
	speed: 0.0124s/iter; left time: 73.3913s
	iters: 400, epoch: 5 | loss: 0.2098364
	speed: 0.0140s/iter; left time: 81.2077s
	iters: 500, epoch: 5 | loss: 0.2534650
	speed: 0.0127s/iter; left time: 72.7402s
	iters: 600, epoch: 5 | loss: 0.3156062
	speed: 0.0138s/iter; left time: 77.5474s
	iters: 700, epoch: 5 | loss: 0.2471384
	speed: 0.0127s/iter; left time: 69.9068s
	iters: 800, epoch: 5 | loss: 0.2958502
	speed: 0.0138s/iter; left time: 74.4024s
	iters: 900, epoch: 5 | loss: 0.2796539
	speed: 0.0134s/iter; left time: 71.3616s
	iters: 1000, epoch: 5 | loss: 0.1822560
	speed: 0.0134s/iter; left time: 69.5893s
Epoch: 5 cost time: 14.548646450042725
Epoch: 5, Steps: 1035 | Train Loss: 0.2573515 Vali Loss: 0.4038213 Test Loss: 0.3204952
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2198676
	speed: 0.1162s/iter; left time: 589.8665s
	iters: 200, epoch: 6 | loss: 0.2378659
	speed: 0.0132s/iter; left time: 65.4788s
	iters: 300, epoch: 6 | loss: 0.2873877
	speed: 0.0132s/iter; left time: 64.4228s
	iters: 400, epoch: 6 | loss: 0.3440837
	speed: 0.0136s/iter; left time: 65.0684s
	iters: 500, epoch: 6 | loss: 0.1853020
	speed: 0.0129s/iter; left time: 60.3384s
	iters: 600, epoch: 6 | loss: 0.3648976
	speed: 0.0140s/iter; left time: 64.1818s
	iters: 700, epoch: 6 | loss: 0.2051941
	speed: 0.0121s/iter; left time: 54.3781s
	iters: 800, epoch: 6 | loss: 0.3334808
	speed: 0.0138s/iter; left time: 60.2718s
	iters: 900, epoch: 6 | loss: 0.1920244
	speed: 0.0128s/iter; left time: 54.8820s
	iters: 1000, epoch: 6 | loss: 0.2447890
	speed: 0.0136s/iter; left time: 56.6436s
Epoch: 6 cost time: 14.563255786895752
Epoch: 6, Steps: 1035 | Train Loss: 0.2556652 Vali Loss: 0.3897780 Test Loss: 0.3189738
Validation loss decreased (0.395435 --> 0.389778).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1648622
	speed: 0.1160s/iter; left time: 468.6795s
	iters: 200, epoch: 7 | loss: 0.3101214
	speed: 0.0129s/iter; left time: 50.6626s
	iters: 300, epoch: 7 | loss: 0.2365064
	speed: 0.0135s/iter; left time: 51.8004s
	iters: 400, epoch: 7 | loss: 0.5162349
	speed: 0.0127s/iter; left time: 47.5085s
	iters: 500, epoch: 7 | loss: 0.3399202
	speed: 0.0133s/iter; left time: 48.3354s
	iters: 600, epoch: 7 | loss: 0.3090844
	speed: 0.0141s/iter; left time: 49.7641s
	iters: 700, epoch: 7 | loss: 0.2186496
	speed: 0.0124s/iter; left time: 42.5377s
	iters: 800, epoch: 7 | loss: 0.1980109
	speed: 0.0138s/iter; left time: 46.1402s
	iters: 900, epoch: 7 | loss: 0.2222546
	speed: 0.0124s/iter; left time: 40.1687s
	iters: 1000, epoch: 7 | loss: 0.2173789
	speed: 0.0137s/iter; left time: 42.8989s
Epoch: 7 cost time: 14.526956558227539
Epoch: 7, Steps: 1035 | Train Loss: 0.2548200 Vali Loss: 0.3915762 Test Loss: 0.3189499
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3380303
	speed: 0.1160s/iter; left time: 348.5571s
	iters: 200, epoch: 8 | loss: 0.1420428
	speed: 0.0125s/iter; left time: 36.2792s
	iters: 300, epoch: 8 | loss: 0.2351371
	speed: 0.0137s/iter; left time: 38.5275s
	iters: 400, epoch: 8 | loss: 0.2075566
	speed: 0.0127s/iter; left time: 34.4732s
	iters: 500, epoch: 8 | loss: 0.2064955
	speed: 0.0134s/iter; left time: 34.8478s
	iters: 600, epoch: 8 | loss: 0.2785315
	speed: 0.0138s/iter; left time: 34.4614s
	iters: 700, epoch: 8 | loss: 0.2744444
	speed: 0.0124s/iter; left time: 29.8183s
	iters: 800, epoch: 8 | loss: 0.2469789
	speed: 0.0138s/iter; left time: 31.7210s
	iters: 900, epoch: 8 | loss: 0.2650345
	speed: 0.0121s/iter; left time: 26.6408s
	iters: 1000, epoch: 8 | loss: 0.1943586
	speed: 0.0138s/iter; left time: 29.1636s
Epoch: 8 cost time: 14.535935640335083
Epoch: 8, Steps: 1035 | Train Loss: 0.2543487 Vali Loss: 0.3940909 Test Loss: 0.3178527
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2327564
	speed: 0.1161s/iter; left time: 228.8185s
	iters: 200, epoch: 9 | loss: 0.2175115
	speed: 0.0124s/iter; left time: 23.2149s
	iters: 300, epoch: 9 | loss: 0.3143459
	speed: 0.0136s/iter; left time: 24.0403s
	iters: 400, epoch: 9 | loss: 0.2316966
	speed: 0.0132s/iter; left time: 21.9881s
	iters: 500, epoch: 9 | loss: 0.2029062
	speed: 0.0136s/iter; left time: 21.3269s
	iters: 600, epoch: 9 | loss: 0.2991580
	speed: 0.0141s/iter; left time: 20.6909s
	iters: 700, epoch: 9 | loss: 0.1693097
	speed: 0.0121s/iter; left time: 16.5352s
	iters: 800, epoch: 9 | loss: 0.3418537
	speed: 0.0141s/iter; left time: 17.9786s
	iters: 900, epoch: 9 | loss: 0.3797829
	speed: 0.0124s/iter; left time: 14.4669s
	iters: 1000, epoch: 9 | loss: 0.2084557
	speed: 0.0138s/iter; left time: 14.8315s
Epoch: 9 cost time: 14.605323791503906
Epoch: 9, Steps: 1035 | Train Loss: 0.2540664 Vali Loss: 0.3926551 Test Loss: 0.3177673
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_24_DLinear_ETTh1_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2857
mse:0.3193800747394562, mae:0.3627316355705261
