Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='traffic_504_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_504_720_DLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11057
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.3088369
	speed: 0.0680s/iter; left time: 462.9629s
	iters: 200, epoch: 1 | loss: 0.2990267
	speed: 0.0590s/iter; left time: 395.8668s
	iters: 300, epoch: 1 | loss: 0.2985351
	speed: 0.0592s/iter; left time: 391.3357s
	iters: 400, epoch: 1 | loss: 0.2964113
	speed: 0.0597s/iter; left time: 388.6004s
	iters: 500, epoch: 1 | loss: 0.3013310
	speed: 0.0602s/iter; left time: 386.0560s
	iters: 600, epoch: 1 | loss: 0.2661117
	speed: 0.0599s/iter; left time: 378.0375s
Epoch: 1 cost time: 42.02369976043701
Epoch: 1, Steps: 691 | Train Loss: 0.3121573 Vali Loss: 0.4129735 Test Loss: 0.4733302
Validation loss decreased (inf --> 0.412973).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2689581
	speed: 0.5145s/iter; left time: 3148.5480s
	iters: 200, epoch: 2 | loss: 0.2993193
	speed: 0.0585s/iter; left time: 352.3710s
	iters: 300, epoch: 2 | loss: 0.3064456
	speed: 0.0582s/iter; left time: 344.5592s
	iters: 400, epoch: 2 | loss: 0.2714111
	speed: 0.0581s/iter; left time: 337.9066s
	iters: 500, epoch: 2 | loss: 0.2848049
	speed: 0.0601s/iter; left time: 344.0418s
	iters: 600, epoch: 2 | loss: 0.2823202
	speed: 0.0632s/iter; left time: 355.0063s
Epoch: 2 cost time: 42.22802758216858
Epoch: 2, Steps: 691 | Train Loss: 0.2834156 Vali Loss: 0.4098569 Test Loss: 0.4705639
Validation loss decreased (0.412973 --> 0.409857).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2664455
	speed: 0.5126s/iter; left time: 2783.1433s
	iters: 200, epoch: 3 | loss: 0.2780114
	speed: 0.0594s/iter; left time: 316.4222s
	iters: 300, epoch: 3 | loss: 0.2960680
	speed: 0.0591s/iter; left time: 309.2554s
	iters: 400, epoch: 3 | loss: 0.2795609
	speed: 0.0579s/iter; left time: 297.0922s
	iters: 500, epoch: 3 | loss: 0.2552401
	speed: 0.0591s/iter; left time: 297.2541s
	iters: 600, epoch: 3 | loss: 0.2832399
	speed: 0.0587s/iter; left time: 289.5153s
Epoch: 3 cost time: 41.56642770767212
Epoch: 3, Steps: 691 | Train Loss: 0.2765635 Vali Loss: 0.4022676 Test Loss: 0.4637434
Validation loss decreased (0.409857 --> 0.402268).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2691135
	speed: 0.5163s/iter; left time: 2446.0565s
	iters: 200, epoch: 4 | loss: 0.2491066
	speed: 0.0598s/iter; left time: 277.2896s
	iters: 300, epoch: 4 | loss: 0.2564840
	speed: 0.0598s/iter; left time: 271.2763s
	iters: 400, epoch: 4 | loss: 0.2599209
	speed: 0.0609s/iter; left time: 270.1536s
	iters: 500, epoch: 4 | loss: 0.2476559
	speed: 0.0611s/iter; left time: 265.2138s
	iters: 600, epoch: 4 | loss: 0.2826762
	speed: 0.0599s/iter; left time: 253.9325s
Epoch: 4 cost time: 42.734697341918945
Epoch: 4, Steps: 691 | Train Loss: 0.2737184 Vali Loss: 0.3987501 Test Loss: 0.4578677
Validation loss decreased (0.402268 --> 0.398750).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2506090
	speed: 0.5212s/iter; left time: 2109.1765s
	iters: 200, epoch: 5 | loss: 0.2934913
	speed: 0.0596s/iter; left time: 235.1416s
	iters: 300, epoch: 5 | loss: 0.2666977
	speed: 0.0603s/iter; left time: 231.9678s
	iters: 400, epoch: 5 | loss: 0.2611280
	speed: 0.0583s/iter; left time: 218.6007s
	iters: 500, epoch: 5 | loss: 0.2685133
	speed: 0.0600s/iter; left time: 218.7728s
	iters: 600, epoch: 5 | loss: 0.2829564
	speed: 0.0610s/iter; left time: 216.2585s
Epoch: 5 cost time: 42.294339656829834
Epoch: 5, Steps: 691 | Train Loss: 0.2721449 Vali Loss: 0.3980675 Test Loss: 0.4575007
Validation loss decreased (0.398750 --> 0.398067).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2568102
	speed: 0.5164s/iter; left time: 1732.9224s
	iters: 200, epoch: 6 | loss: 0.2779475
	speed: 0.0593s/iter; left time: 193.0990s
	iters: 300, epoch: 6 | loss: 0.2707620
	speed: 0.0593s/iter; left time: 187.0609s
	iters: 400, epoch: 6 | loss: 0.2680705
	speed: 0.0600s/iter; left time: 183.4525s
	iters: 500, epoch: 6 | loss: 0.2730121
	speed: 0.0614s/iter; left time: 181.3533s
	iters: 600, epoch: 6 | loss: 0.2742949
	speed: 0.0616s/iter; left time: 176.0108s
Epoch: 6 cost time: 42.71736240386963
Epoch: 6, Steps: 691 | Train Loss: 0.2713599 Vali Loss: 0.3962197 Test Loss: 0.4561350
Validation loss decreased (0.398067 --> 0.396220).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2809290
	speed: 0.5253s/iter; left time: 1399.9113s
	iters: 200, epoch: 7 | loss: 0.2753423
	speed: 0.0612s/iter; left time: 156.9571s
	iters: 300, epoch: 7 | loss: 0.2638700
	speed: 0.0598s/iter; left time: 147.3588s
	iters: 400, epoch: 7 | loss: 0.2813710
	speed: 0.0612s/iter; left time: 144.6499s
	iters: 500, epoch: 7 | loss: 0.2656749
	speed: 0.0620s/iter; left time: 140.3890s
	iters: 600, epoch: 7 | loss: 0.2716433
	speed: 0.0622s/iter; left time: 134.5927s
Epoch: 7 cost time: 43.14074683189392
Epoch: 7, Steps: 691 | Train Loss: 0.2709483 Vali Loss: 0.3956767 Test Loss: 0.4548995
Validation loss decreased (0.396220 --> 0.395677).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2669784
	speed: 0.5174s/iter; left time: 1021.3091s
	iters: 200, epoch: 8 | loss: 0.2632261
	speed: 0.0591s/iter; left time: 110.6707s
	iters: 300, epoch: 8 | loss: 0.2763752
	speed: 0.0595s/iter; left time: 105.5277s
	iters: 400, epoch: 8 | loss: 0.2854140
	speed: 0.0600s/iter; left time: 100.4321s
	iters: 500, epoch: 8 | loss: 0.2743706
	speed: 0.0598s/iter; left time: 94.1361s
	iters: 600, epoch: 8 | loss: 0.2649378
	speed: 0.0584s/iter; left time: 86.0611s
Epoch: 8 cost time: 42.09847688674927
Epoch: 8, Steps: 691 | Train Loss: 0.2707255 Vali Loss: 0.3958375 Test Loss: 0.4545684
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2824344
	speed: 0.5224s/iter; left time: 670.2923s
	iters: 200, epoch: 9 | loss: 0.2624782
	speed: 0.0596s/iter; left time: 70.4514s
	iters: 300, epoch: 9 | loss: 0.2671795
	speed: 0.0607s/iter; left time: 65.7446s
	iters: 400, epoch: 9 | loss: 0.2647131
	speed: 0.0625s/iter; left time: 61.4190s
	iters: 500, epoch: 9 | loss: 0.2878908
	speed: 0.0592s/iter; left time: 52.2909s
	iters: 600, epoch: 9 | loss: 0.2581562
	speed: 0.0606s/iter; left time: 47.4395s
Epoch: 9 cost time: 42.61799192428589
Epoch: 9, Steps: 691 | Train Loss: 0.2705966 Vali Loss: 0.3957598 Test Loss: 0.4545949
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2591355
	speed: 0.5168s/iter; left time: 305.9519s
	iters: 200, epoch: 10 | loss: 0.2628673
	speed: 0.0596s/iter; left time: 29.3409s
	iters: 300, epoch: 10 | loss: 0.2549753
	speed: 0.0612s/iter; left time: 23.9812s
	iters: 400, epoch: 10 | loss: 0.2641920
	speed: 0.0608s/iter; left time: 17.7675s
	iters: 500, epoch: 10 | loss: 0.2633287
	speed: 0.0601s/iter; left time: 11.5311s
	iters: 600, epoch: 10 | loss: 0.2941089
	speed: 0.0612s/iter; left time: 5.6285s
Epoch: 10 cost time: 42.456231355667114
Epoch: 10, Steps: 691 | Train Loss: 0.2705265 Vali Loss: 0.3956004 Test Loss: 0.4544252
Validation loss decreased (0.395677 --> 0.395600).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_504_720_DLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.45427054166793823, mae:0.30871474742889404
