Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='traffic_48_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=48, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_48_24_GRevagLinear_custom_ftM_sl48_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12209
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.5519598
	speed: 0.0271s/iter; left time: 203.9757s
	iters: 200, epoch: 1 | loss: 0.4072408
	speed: 0.0171s/iter; left time: 126.9885s
	iters: 300, epoch: 1 | loss: 0.4493368
	speed: 0.0176s/iter; left time: 129.2828s
	iters: 400, epoch: 1 | loss: 0.4543507
	speed: 0.0167s/iter; left time: 120.9753s
	iters: 500, epoch: 1 | loss: 0.4254544
	speed: 0.0167s/iter; left time: 119.1776s
	iters: 600, epoch: 1 | loss: 0.3684151
	speed: 0.0168s/iter; left time: 118.1296s
	iters: 700, epoch: 1 | loss: 0.4314197
	speed: 0.0172s/iter; left time: 119.1880s
Epoch: 1 cost time: 14.17134714126587
Epoch: 1, Steps: 763 | Train Loss: 0.4482472 Vali Loss: 0.5344487 Test Loss: 0.6102816
Validation loss decreased (inf --> 0.534449).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3357002
	speed: 0.1109s/iter; left time: 750.5015s
	iters: 200, epoch: 2 | loss: 0.4140904
	speed: 0.0166s/iter; left time: 110.8821s
	iters: 300, epoch: 2 | loss: 0.3330678
	speed: 0.0179s/iter; left time: 117.4398s
	iters: 400, epoch: 2 | loss: 0.4086547
	speed: 0.0181s/iter; left time: 117.0387s
	iters: 500, epoch: 2 | loss: 0.3462566
	speed: 0.0186s/iter; left time: 118.1639s
	iters: 600, epoch: 2 | loss: 0.3840945
	speed: 0.0174s/iter; left time: 109.0875s
	iters: 700, epoch: 2 | loss: 0.3565241
	speed: 0.0173s/iter; left time: 106.4008s
Epoch: 2 cost time: 14.346765518188477
Epoch: 2, Steps: 763 | Train Loss: 0.3938185 Vali Loss: 0.5257880 Test Loss: 0.5997429
Validation loss decreased (0.534449 --> 0.525788).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3953517
	speed: 0.1123s/iter; left time: 674.3533s
	iters: 200, epoch: 3 | loss: 0.4834960
	speed: 0.0177s/iter; left time: 104.7290s
	iters: 300, epoch: 3 | loss: 0.4486171
	speed: 0.0174s/iter; left time: 101.0882s
	iters: 400, epoch: 3 | loss: 0.3471676
	speed: 0.0180s/iter; left time: 102.4560s
	iters: 500, epoch: 3 | loss: 0.3084269
	speed: 0.0175s/iter; left time: 98.2493s
	iters: 600, epoch: 3 | loss: 0.3612296
	speed: 0.0169s/iter; left time: 92.9033s
	iters: 700, epoch: 3 | loss: 0.3550371
	speed: 0.0192s/iter; left time: 103.6127s
Epoch: 3 cost time: 14.450918674468994
Epoch: 3, Steps: 763 | Train Loss: 0.3857098 Vali Loss: 0.5218535 Test Loss: 0.5952872
Validation loss decreased (0.525788 --> 0.521854).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3987289
	speed: 0.1116s/iter; left time: 585.0304s
	iters: 200, epoch: 4 | loss: 0.4272307
	speed: 0.0174s/iter; left time: 89.4014s
	iters: 300, epoch: 4 | loss: 0.3632821
	speed: 0.0171s/iter; left time: 86.3130s
	iters: 400, epoch: 4 | loss: 0.2987608
	speed: 0.0186s/iter; left time: 92.0911s
	iters: 500, epoch: 4 | loss: 0.3190438
	speed: 0.0175s/iter; left time: 84.4934s
	iters: 600, epoch: 4 | loss: 0.3319750
	speed: 0.0175s/iter; left time: 82.9475s
	iters: 700, epoch: 4 | loss: 0.3019152
	speed: 0.0178s/iter; left time: 82.6765s
Epoch: 4 cost time: 14.469619750976562
Epoch: 4, Steps: 763 | Train Loss: 0.3822963 Vali Loss: 0.5217412 Test Loss: 0.5925936
Validation loss decreased (0.521854 --> 0.521741).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5034646
	speed: 0.1128s/iter; left time: 505.4023s
	iters: 200, epoch: 5 | loss: 0.3655315
	speed: 0.0170s/iter; left time: 74.5995s
	iters: 300, epoch: 5 | loss: 0.3697176
	speed: 0.0189s/iter; left time: 80.9774s
	iters: 400, epoch: 5 | loss: 0.4189417
	speed: 0.0187s/iter; left time: 78.2893s
	iters: 500, epoch: 5 | loss: 0.3379698
	speed: 0.0171s/iter; left time: 69.6035s
	iters: 600, epoch: 5 | loss: 0.3386247
	speed: 0.0169s/iter; left time: 67.0869s
	iters: 700, epoch: 5 | loss: 0.4510594
	speed: 0.0165s/iter; left time: 63.9927s
Epoch: 5 cost time: 14.234514951705933
Epoch: 5, Steps: 763 | Train Loss: 0.3807521 Vali Loss: 0.5195603 Test Loss: 0.5922180
Validation loss decreased (0.521741 --> 0.519560).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3437178
	speed: 0.1081s/iter; left time: 401.7504s
	iters: 200, epoch: 6 | loss: 0.3902722
	speed: 0.0183s/iter; left time: 66.3491s
	iters: 300, epoch: 6 | loss: 0.3448631
	speed: 0.0176s/iter; left time: 61.8142s
	iters: 400, epoch: 6 | loss: 0.5155602
	speed: 0.0174s/iter; left time: 59.3087s
	iters: 500, epoch: 6 | loss: 0.5000238
	speed: 0.0180s/iter; left time: 59.7034s
	iters: 600, epoch: 6 | loss: 0.3740569
	speed: 0.0172s/iter; left time: 55.3534s
	iters: 700, epoch: 6 | loss: 0.3638743
	speed: 0.0172s/iter; left time: 53.6123s
Epoch: 6 cost time: 14.325844526290894
Epoch: 6, Steps: 763 | Train Loss: 0.3799659 Vali Loss: 0.5189191 Test Loss: 0.5914155
Validation loss decreased (0.519560 --> 0.518919).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3565764
	speed: 0.1094s/iter; left time: 322.9982s
	iters: 200, epoch: 7 | loss: 0.4829787
	speed: 0.0168s/iter; left time: 47.9899s
	iters: 300, epoch: 7 | loss: 0.3534632
	speed: 0.0174s/iter; left time: 47.8883s
	iters: 400, epoch: 7 | loss: 0.3790704
	speed: 0.0172s/iter; left time: 45.5644s
	iters: 500, epoch: 7 | loss: 0.3851123
	speed: 0.0171s/iter; left time: 43.7731s
	iters: 600, epoch: 7 | loss: 0.3995346
	speed: 0.0175s/iter; left time: 43.0220s
	iters: 700, epoch: 7 | loss: 0.3577206
	speed: 0.0172s/iter; left time: 40.4509s
Epoch: 7 cost time: 14.116288185119629
Epoch: 7, Steps: 763 | Train Loss: 0.3795415 Vali Loss: 0.5180644 Test Loss: 0.5910639
Validation loss decreased (0.518919 --> 0.518064).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.4115288
	speed: 0.1088s/iter; left time: 238.3384s
	iters: 200, epoch: 8 | loss: 0.3900152
	speed: 0.0168s/iter; left time: 35.1016s
	iters: 300, epoch: 8 | loss: 0.3384818
	speed: 0.0166s/iter; left time: 33.0327s
	iters: 400, epoch: 8 | loss: 0.4441010
	speed: 0.0172s/iter; left time: 32.5443s
	iters: 500, epoch: 8 | loss: 0.4369676
	speed: 0.0168s/iter; left time: 30.0677s
	iters: 600, epoch: 8 | loss: 0.4268369
	speed: 0.0178s/iter; left time: 30.0528s
	iters: 700, epoch: 8 | loss: 0.4363002
	speed: 0.0167s/iter; left time: 26.6286s
Epoch: 8 cost time: 13.958159446716309
Epoch: 8, Steps: 763 | Train Loss: 0.3793403 Vali Loss: 0.5185845 Test Loss: 0.5910129
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2968413
	speed: 0.1093s/iter; left time: 155.9971s
	iters: 200, epoch: 9 | loss: 0.3686090
	speed: 0.0171s/iter; left time: 22.7447s
	iters: 300, epoch: 9 | loss: 0.3954056
	speed: 0.0172s/iter; left time: 21.1052s
	iters: 400, epoch: 9 | loss: 0.3887725
	speed: 0.0170s/iter; left time: 19.1483s
	iters: 500, epoch: 9 | loss: 0.4533334
	speed: 0.0171s/iter; left time: 17.5726s
	iters: 600, epoch: 9 | loss: 0.3328754
	speed: 0.0170s/iter; left time: 15.7262s
	iters: 700, epoch: 9 | loss: 0.3420399
	speed: 0.0173s/iter; left time: 14.2916s
Epoch: 9 cost time: 13.960841417312622
Epoch: 9, Steps: 763 | Train Loss: 0.3792603 Vali Loss: 0.5187439 Test Loss: 0.5909182
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.4405875
	speed: 0.1061s/iter; left time: 70.4172s
	iters: 200, epoch: 10 | loss: 0.3790342
	speed: 0.0169s/iter; left time: 9.5560s
	iters: 300, epoch: 10 | loss: 0.3397951
	speed: 0.0170s/iter; left time: 7.8732s
	iters: 400, epoch: 10 | loss: 0.3891701
	speed: 0.0171s/iter; left time: 6.2311s
	iters: 500, epoch: 10 | loss: 0.4413374
	speed: 0.0173s/iter; left time: 4.5687s
	iters: 600, epoch: 10 | loss: 0.3752358
	speed: 0.0168s/iter; left time: 2.7546s
	iters: 700, epoch: 10 | loss: 0.3627448
	speed: 0.0171s/iter; left time: 1.0940s
Epoch: 10 cost time: 13.919466972351074
Epoch: 10, Steps: 763 | Train Loss: 0.3791877 Vali Loss: 0.5186757 Test Loss: 0.5908802
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_48_24_GRevagLinear_custom_ftM_sl48_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.5912767648696899, mae:0.36957505345344543
