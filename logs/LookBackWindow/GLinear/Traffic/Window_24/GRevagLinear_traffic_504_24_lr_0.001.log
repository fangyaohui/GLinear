Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='traffic_504_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_504_24_GRevagLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.2181927
	speed: 0.0361s/iter; left time: 261.0595s
	iters: 200, epoch: 1 | loss: 0.1971544
	speed: 0.0268s/iter; left time: 191.0234s
	iters: 300, epoch: 1 | loss: 0.1878109
	speed: 0.0266s/iter; left time: 187.2420s
	iters: 400, epoch: 1 | loss: 0.2423431
	speed: 0.0262s/iter; left time: 181.7576s
	iters: 500, epoch: 1 | loss: 0.2127263
	speed: 0.0271s/iter; left time: 185.0763s
	iters: 600, epoch: 1 | loss: 0.1836068
	speed: 0.0271s/iter; left time: 182.5036s
	iters: 700, epoch: 1 | loss: 0.2988721
	speed: 0.0265s/iter; left time: 176.0909s
Epoch: 1 cost time: 20.57980465888977
Epoch: 1, Steps: 734 | Train Loss: 0.2352102 Vali Loss: 0.3141241 Test Loss: 0.3522599
Validation loss decreased (inf --> 0.314124).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2015755
	speed: 0.1434s/iter; left time: 933.0386s
	iters: 200, epoch: 2 | loss: 0.2498932
	speed: 0.0259s/iter; left time: 166.0126s
	iters: 300, epoch: 2 | loss: 0.2167222
	speed: 0.0262s/iter; left time: 165.5056s
	iters: 400, epoch: 2 | loss: 0.2338993
	speed: 0.0257s/iter; left time: 159.6000s
	iters: 500, epoch: 2 | loss: 0.2130384
	speed: 0.0261s/iter; left time: 159.2617s
	iters: 600, epoch: 2 | loss: 0.2156570
	speed: 0.0267s/iter; left time: 160.2877s
	iters: 700, epoch: 2 | loss: 0.2123232
	speed: 0.0263s/iter; left time: 155.4317s
Epoch: 2 cost time: 20.080439805984497
Epoch: 2, Steps: 734 | Train Loss: 0.2158098 Vali Loss: 0.3103974 Test Loss: 0.3451989
Validation loss decreased (0.314124 --> 0.310397).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2048996
	speed: 0.1477s/iter; left time: 852.4234s
	iters: 200, epoch: 3 | loss: 0.1905451
	speed: 0.0262s/iter; left time: 148.5042s
	iters: 300, epoch: 3 | loss: 0.1627648
	speed: 0.0259s/iter; left time: 144.5740s
	iters: 400, epoch: 3 | loss: 0.1674546
	speed: 0.0265s/iter; left time: 145.0596s
	iters: 500, epoch: 3 | loss: 0.2183150
	speed: 0.0269s/iter; left time: 144.7585s
	iters: 600, epoch: 3 | loss: 0.2113395
	speed: 0.0269s/iter; left time: 141.6243s
	iters: 700, epoch: 3 | loss: 0.2079747
	speed: 0.0264s/iter; left time: 136.7428s
Epoch: 3 cost time: 20.467652320861816
Epoch: 3, Steps: 734 | Train Loss: 0.2072605 Vali Loss: 0.3048774 Test Loss: 0.3376067
Validation loss decreased (0.310397 --> 0.304877).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2094538
	speed: 0.1452s/iter; left time: 731.5330s
	iters: 200, epoch: 4 | loss: 0.2411606
	speed: 0.0256s/iter; left time: 126.2102s
	iters: 300, epoch: 4 | loss: 0.1723888
	speed: 0.0259s/iter; left time: 125.1608s
	iters: 400, epoch: 4 | loss: 0.1823154
	speed: 0.0269s/iter; left time: 127.4000s
	iters: 500, epoch: 4 | loss: 0.1740176
	speed: 0.0263s/iter; left time: 122.0583s
	iters: 600, epoch: 4 | loss: 0.1890665
	speed: 0.0264s/iter; left time: 119.7739s
	iters: 700, epoch: 4 | loss: 0.1984384
	speed: 0.0258s/iter; left time: 114.6820s
Epoch: 4 cost time: 20.139588117599487
Epoch: 4, Steps: 734 | Train Loss: 0.2032053 Vali Loss: 0.3013984 Test Loss: 0.3316528
Validation loss decreased (0.304877 --> 0.301398).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2202143
	speed: 0.1502s/iter; left time: 646.6170s
	iters: 200, epoch: 5 | loss: 0.1767786
	speed: 0.0262s/iter; left time: 110.3247s
	iters: 300, epoch: 5 | loss: 0.1865961
	speed: 0.0267s/iter; left time: 109.6959s
	iters: 400, epoch: 5 | loss: 0.1587659
	speed: 0.0259s/iter; left time: 103.6931s
	iters: 500, epoch: 5 | loss: 0.2056483
	speed: 0.0261s/iter; left time: 101.7723s
	iters: 600, epoch: 5 | loss: 0.1816204
	speed: 0.0264s/iter; left time: 100.2865s
	iters: 700, epoch: 5 | loss: 0.2019524
	speed: 0.0262s/iter; left time: 96.9892s
Epoch: 5 cost time: 20.39137864112854
Epoch: 5, Steps: 734 | Train Loss: 0.2012668 Vali Loss: 0.2997630 Test Loss: 0.3297145
Validation loss decreased (0.301398 --> 0.299763).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2479722
	speed: 0.1475s/iter; left time: 526.6867s
	iters: 200, epoch: 6 | loss: 0.1926713
	speed: 0.0270s/iter; left time: 93.8173s
	iters: 300, epoch: 6 | loss: 0.1592138
	speed: 0.0263s/iter; left time: 88.7747s
	iters: 400, epoch: 6 | loss: 0.1932666
	speed: 0.0265s/iter; left time: 86.5526s
	iters: 500, epoch: 6 | loss: 0.2275868
	speed: 0.0257s/iter; left time: 81.4893s
	iters: 600, epoch: 6 | loss: 0.2960711
	speed: 0.0263s/iter; left time: 80.7969s
	iters: 700, epoch: 6 | loss: 0.1682332
	speed: 0.0255s/iter; left time: 75.8398s
Epoch: 6 cost time: 20.290173530578613
Epoch: 6, Steps: 734 | Train Loss: 0.2001323 Vali Loss: 0.2986800 Test Loss: 0.3279575
Validation loss decreased (0.299763 --> 0.298680).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1699966
	speed: 0.1458s/iter; left time: 413.6765s
	iters: 200, epoch: 7 | loss: 0.3282108
	speed: 0.0264s/iter; left time: 72.2938s
	iters: 300, epoch: 7 | loss: 0.2051923
	speed: 0.0257s/iter; left time: 67.6605s
	iters: 400, epoch: 7 | loss: 0.1961718
	speed: 0.0268s/iter; left time: 68.0620s
	iters: 500, epoch: 7 | loss: 0.1781384
	speed: 0.0267s/iter; left time: 65.0688s
	iters: 600, epoch: 7 | loss: 0.1991149
	speed: 0.0260s/iter; left time: 60.8413s
	iters: 700, epoch: 7 | loss: 0.2114671
	speed: 0.0260s/iter; left time: 58.2573s
Epoch: 7 cost time: 20.262698650360107
Epoch: 7, Steps: 734 | Train Loss: 0.1994509 Vali Loss: 0.2982669 Test Loss: 0.3274473
Validation loss decreased (0.298680 --> 0.298267).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1955682
	speed: 0.1469s/iter; left time: 308.9291s
	iters: 200, epoch: 8 | loss: 0.2506040
	speed: 0.0266s/iter; left time: 53.2619s
	iters: 300, epoch: 8 | loss: 0.2252256
	speed: 0.0265s/iter; left time: 50.4977s
	iters: 400, epoch: 8 | loss: 0.2155561
	speed: 0.0262s/iter; left time: 47.1887s
	iters: 500, epoch: 8 | loss: 0.1799169
	speed: 0.0263s/iter; left time: 44.7724s
	iters: 600, epoch: 8 | loss: 0.2153715
	speed: 0.0264s/iter; left time: 42.2723s
	iters: 700, epoch: 8 | loss: 0.1839314
	speed: 0.0262s/iter; left time: 39.3675s
Epoch: 8 cost time: 20.35199737548828
Epoch: 8, Steps: 734 | Train Loss: 0.1991977 Vali Loss: 0.2987006 Test Loss: 0.3273481
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1680770
	speed: 0.1473s/iter; left time: 201.6342s
	iters: 200, epoch: 9 | loss: 0.1640276
	speed: 0.0262s/iter; left time: 33.2897s
	iters: 300, epoch: 9 | loss: 0.2045677
	speed: 0.0266s/iter; left time: 31.1033s
	iters: 400, epoch: 9 | loss: 0.1726249
	speed: 0.0261s/iter; left time: 27.9121s
	iters: 500, epoch: 9 | loss: 0.1465822
	speed: 0.0268s/iter; left time: 26.0100s
	iters: 600, epoch: 9 | loss: 0.2117674
	speed: 0.0262s/iter; left time: 22.7882s
	iters: 700, epoch: 9 | loss: 0.1788357
	speed: 0.0270s/iter; left time: 20.7271s
Epoch: 9 cost time: 20.4523983001709
Epoch: 9, Steps: 734 | Train Loss: 0.1989548 Vali Loss: 0.2982786 Test Loss: 0.3271936
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2416969
	speed: 0.1461s/iter; left time: 92.7936s
	iters: 200, epoch: 10 | loss: 0.1676406
	speed: 0.0258s/iter; left time: 13.7846s
	iters: 300, epoch: 10 | loss: 0.1783970
	speed: 0.0267s/iter; left time: 11.5997s
	iters: 400, epoch: 10 | loss: 0.2030249
	speed: 0.0263s/iter; left time: 8.8267s
	iters: 500, epoch: 10 | loss: 0.2051992
	speed: 0.0260s/iter; left time: 6.1054s
	iters: 600, epoch: 10 | loss: 0.2401940
	speed: 0.0268s/iter; left time: 3.6193s
	iters: 700, epoch: 10 | loss: 0.2283331
	speed: 0.0266s/iter; left time: 0.9327s
Epoch: 10 cost time: 20.25786328315735
Epoch: 10, Steps: 734 | Train Loss: 0.1988575 Vali Loss: 0.2981341 Test Loss: 0.3271037
Validation loss decreased (0.298267 --> 0.298134).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_504_24_GRevagLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.32723236083984375, mae:0.24131567776203156
