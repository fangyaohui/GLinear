Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='traffic_504_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_504_720_GRevagLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11057
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.3020060
	speed: 0.0635s/iter; left time: 432.3857s
	iters: 200, epoch: 1 | loss: 0.2811568
	speed: 0.0545s/iter; left time: 365.5874s
	iters: 300, epoch: 1 | loss: 0.3176018
	speed: 0.0551s/iter; left time: 364.3705s
	iters: 400, epoch: 1 | loss: 0.2861451
	speed: 0.0554s/iter; left time: 360.7063s
	iters: 500, epoch: 1 | loss: 0.2967744
	speed: 0.0567s/iter; left time: 363.6296s
	iters: 600, epoch: 1 | loss: 0.2622258
	speed: 0.0562s/iter; left time: 354.8854s
Epoch: 1 cost time: 39.4194221496582
Epoch: 1, Steps: 691 | Train Loss: 0.3040588 Vali Loss: 0.4038428 Test Loss: 0.4626216
Validation loss decreased (inf --> 0.403843).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2891136
	speed: 0.4244s/iter; left time: 2597.2317s
	iters: 200, epoch: 2 | loss: 0.2900749
	speed: 0.0542s/iter; left time: 326.3424s
	iters: 300, epoch: 2 | loss: 0.2860386
	speed: 0.0542s/iter; left time: 321.0535s
	iters: 400, epoch: 2 | loss: 0.2912339
	speed: 0.0542s/iter; left time: 315.3339s
	iters: 500, epoch: 2 | loss: 0.2846702
	speed: 0.0548s/iter; left time: 313.6633s
	iters: 600, epoch: 2 | loss: 0.2736004
	speed: 0.0549s/iter; left time: 308.4440s
Epoch: 2 cost time: 38.62250995635986
Epoch: 2, Steps: 691 | Train Loss: 0.2766641 Vali Loss: 0.3980447 Test Loss: 0.4530836
Validation loss decreased (0.403843 --> 0.398045).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2818392
	speed: 0.4194s/iter; left time: 2277.0428s
	iters: 200, epoch: 3 | loss: 0.2646582
	speed: 0.0533s/iter; left time: 283.9695s
	iters: 300, epoch: 3 | loss: 0.2595638
	speed: 0.0536s/iter; left time: 280.4555s
	iters: 400, epoch: 3 | loss: 0.2543392
	speed: 0.0537s/iter; left time: 275.3835s
	iters: 500, epoch: 3 | loss: 0.2559830
	speed: 0.0535s/iter; left time: 269.1886s
	iters: 600, epoch: 3 | loss: 0.2792765
	speed: 0.0535s/iter; left time: 263.7393s
Epoch: 3 cost time: 38.1329026222229
Epoch: 3, Steps: 691 | Train Loss: 0.2694735 Vali Loss: 0.3932637 Test Loss: 0.4487933
Validation loss decreased (0.398045 --> 0.393264).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2543147
	speed: 0.4182s/iter; left time: 1981.4399s
	iters: 200, epoch: 4 | loss: 0.2822604
	speed: 0.0544s/iter; left time: 252.4088s
	iters: 300, epoch: 4 | loss: 0.2792914
	speed: 0.0536s/iter; left time: 243.3094s
	iters: 400, epoch: 4 | loss: 0.2771084
	speed: 0.0542s/iter; left time: 240.7149s
	iters: 500, epoch: 4 | loss: 0.2719770
	speed: 0.0543s/iter; left time: 235.5821s
	iters: 600, epoch: 4 | loss: 0.2531445
	speed: 0.0544s/iter; left time: 230.6944s
Epoch: 4 cost time: 38.60516166687012
Epoch: 4, Steps: 691 | Train Loss: 0.2662014 Vali Loss: 0.3908771 Test Loss: 0.4472642
Validation loss decreased (0.393264 --> 0.390877).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2610291
	speed: 0.4219s/iter; left time: 1707.2282s
	iters: 200, epoch: 5 | loss: 0.2565814
	speed: 0.0533s/iter; left time: 210.5530s
	iters: 300, epoch: 5 | loss: 0.2580476
	speed: 0.0530s/iter; left time: 203.7195s
	iters: 400, epoch: 5 | loss: 0.2895295
	speed: 0.0527s/iter; left time: 197.5296s
	iters: 500, epoch: 5 | loss: 0.2760573
	speed: 0.0535s/iter; left time: 195.2013s
	iters: 600, epoch: 5 | loss: 0.2627489
	speed: 0.0538s/iter; left time: 190.8441s
Epoch: 5 cost time: 38.13360238075256
Epoch: 5, Steps: 691 | Train Loss: 0.2646011 Vali Loss: 0.3891459 Test Loss: 0.4431753
Validation loss decreased (0.390877 --> 0.389146).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2772670
	speed: 0.4171s/iter; left time: 1399.6217s
	iters: 200, epoch: 6 | loss: 0.2888859
	speed: 0.0539s/iter; left time: 175.4061s
	iters: 300, epoch: 6 | loss: 0.2690834
	speed: 0.0542s/iter; left time: 171.2105s
	iters: 400, epoch: 6 | loss: 0.2694118
	speed: 0.0552s/iter; left time: 168.7502s
	iters: 500, epoch: 6 | loss: 0.2320187
	speed: 0.0550s/iter; left time: 162.5090s
	iters: 600, epoch: 6 | loss: 0.2476330
	speed: 0.0543s/iter; left time: 154.9739s
Epoch: 6 cost time: 38.762516498565674
Epoch: 6, Steps: 691 | Train Loss: 0.2637134 Vali Loss: 0.3887663 Test Loss: 0.4416933
Validation loss decreased (0.389146 --> 0.388766).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2643813
	speed: 0.4147s/iter; left time: 1105.2207s
	iters: 200, epoch: 7 | loss: 0.2810422
	speed: 0.0518s/iter; left time: 132.8780s
	iters: 300, epoch: 7 | loss: 0.2666706
	speed: 0.0521s/iter; left time: 128.4557s
	iters: 400, epoch: 7 | loss: 0.2977881
	speed: 0.0535s/iter; left time: 126.5202s
	iters: 500, epoch: 7 | loss: 0.2648919
	speed: 0.0539s/iter; left time: 122.1039s
	iters: 600, epoch: 7 | loss: 0.2597117
	speed: 0.0533s/iter; left time: 115.4665s
Epoch: 7 cost time: 37.71611833572388
Epoch: 7, Steps: 691 | Train Loss: 0.2632365 Vali Loss: 0.3878703 Test Loss: 0.4411026
Validation loss decreased (0.388766 --> 0.387870).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2758478
	speed: 0.4186s/iter; left time: 826.2890s
	iters: 200, epoch: 8 | loss: 0.2580438
	speed: 0.0544s/iter; left time: 101.9445s
	iters: 300, epoch: 8 | loss: 0.2725821
	speed: 0.0535s/iter; left time: 94.8477s
	iters: 400, epoch: 8 | loss: 0.2757771
	speed: 0.0544s/iter; left time: 91.0856s
	iters: 500, epoch: 8 | loss: 0.2444880
	speed: 0.0532s/iter; left time: 83.7717s
	iters: 600, epoch: 8 | loss: 0.2615116
	speed: 0.0530s/iter; left time: 78.1856s
Epoch: 8 cost time: 38.19653582572937
Epoch: 8, Steps: 691 | Train Loss: 0.2629708 Vali Loss: 0.3879595 Test Loss: 0.4411580
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2517315
	speed: 0.4172s/iter; left time: 535.2569s
	iters: 200, epoch: 9 | loss: 0.2621540
	speed: 0.0534s/iter; left time: 63.1903s
	iters: 300, epoch: 9 | loss: 0.2632624
	speed: 0.0535s/iter; left time: 57.9778s
	iters: 400, epoch: 9 | loss: 0.2617792
	speed: 0.0539s/iter; left time: 52.9989s
	iters: 500, epoch: 9 | loss: 0.2823969
	speed: 0.0537s/iter; left time: 47.3942s
	iters: 600, epoch: 9 | loss: 0.2526664
	speed: 0.0539s/iter; left time: 42.2034s
Epoch: 9 cost time: 38.228270053863525
Epoch: 9, Steps: 691 | Train Loss: 0.2628329 Vali Loss: 0.3879103 Test Loss: 0.4406811
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2817017
	speed: 0.4196s/iter; left time: 248.4275s
	iters: 200, epoch: 10 | loss: 0.2475003
	speed: 0.0533s/iter; left time: 26.2391s
	iters: 300, epoch: 10 | loss: 0.2670025
	speed: 0.0528s/iter; left time: 20.7088s
	iters: 400, epoch: 10 | loss: 0.2656763
	speed: 0.0536s/iter; left time: 15.6650s
	iters: 500, epoch: 10 | loss: 0.2660886
	speed: 0.0537s/iter; left time: 10.3100s
	iters: 600, epoch: 10 | loss: 0.2464205
	speed: 0.0531s/iter; left time: 4.8833s
Epoch: 10 cost time: 37.8528687953949
Epoch: 10, Steps: 691 | Train Loss: 0.2627469 Vali Loss: 0.3880831 Test Loss: 0.4409676
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_504_720_GRevagLinear_custom_ftM_sl504_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.44094929099082947, mae:0.2985648214817047
