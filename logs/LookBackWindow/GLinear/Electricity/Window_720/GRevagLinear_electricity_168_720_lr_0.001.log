Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_168_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=168, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_168_720_GRevagLinear_custom_ftM_sl168_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17525
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3004552
	speed: 0.0241s/iter; left time: 261.7573s
	iters: 200, epoch: 1 | loss: 0.2656233
	speed: 0.0180s/iter; left time: 193.5342s
	iters: 300, epoch: 1 | loss: 0.2682457
	speed: 0.0179s/iter; left time: 190.3754s
	iters: 400, epoch: 1 | loss: 0.2828137
	speed: 0.0181s/iter; left time: 190.5794s
	iters: 500, epoch: 1 | loss: 0.2595966
	speed: 0.0178s/iter; left time: 186.3945s
	iters: 600, epoch: 1 | loss: 0.2486047
	speed: 0.0176s/iter; left time: 182.3198s
	iters: 700, epoch: 1 | loss: 0.2555584
	speed: 0.0185s/iter; left time: 189.9797s
	iters: 800, epoch: 1 | loss: 0.2578930
	speed: 0.0182s/iter; left time: 185.1532s
	iters: 900, epoch: 1 | loss: 0.2257544
	speed: 0.0184s/iter; left time: 184.4629s
	iters: 1000, epoch: 1 | loss: 0.2333251
	speed: 0.0188s/iter; left time: 187.3786s
Epoch: 1 cost time: 20.6263325214386
Epoch: 1, Steps: 1095 | Train Loss: 0.2615926 Vali Loss: 0.1931542 Test Loss: 0.2252921
Validation loss decreased (inf --> 0.193154).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3028966
	speed: 0.1630s/iter; left time: 1589.9055s
	iters: 200, epoch: 2 | loss: 0.2454580
	speed: 0.0188s/iter; left time: 181.2902s
	iters: 300, epoch: 2 | loss: 0.2217567
	speed: 0.0183s/iter; left time: 175.2361s
	iters: 400, epoch: 2 | loss: 0.2115002
	speed: 0.0194s/iter; left time: 183.6526s
	iters: 500, epoch: 2 | loss: 0.2315184
	speed: 0.0194s/iter; left time: 181.1056s
	iters: 600, epoch: 2 | loss: 0.2439687
	speed: 0.0192s/iter; left time: 177.2811s
	iters: 700, epoch: 2 | loss: 0.1877902
	speed: 0.0185s/iter; left time: 169.3441s
	iters: 800, epoch: 2 | loss: 0.2715932
	speed: 0.0190s/iter; left time: 171.7236s
	iters: 900, epoch: 2 | loss: 0.2581348
	speed: 0.0187s/iter; left time: 167.6233s
	iters: 1000, epoch: 2 | loss: 0.2068744
	speed: 0.0190s/iter; left time: 168.0495s
Epoch: 2 cost time: 21.39257025718689
Epoch: 2, Steps: 1095 | Train Loss: 0.2349505 Vali Loss: 0.1881902 Test Loss: 0.2177054
Validation loss decreased (0.193154 --> 0.188190).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2249518
	speed: 0.1610s/iter; left time: 1394.1969s
	iters: 200, epoch: 3 | loss: 0.2232522
	speed: 0.0189s/iter; left time: 162.1185s
	iters: 300, epoch: 3 | loss: 0.2408744
	speed: 0.0193s/iter; left time: 163.0938s
	iters: 400, epoch: 3 | loss: 0.2297116
	speed: 0.0184s/iter; left time: 153.7022s
	iters: 500, epoch: 3 | loss: 0.2354690
	speed: 0.0189s/iter; left time: 155.8020s
	iters: 600, epoch: 3 | loss: 0.2030867
	speed: 0.0185s/iter; left time: 150.6104s
	iters: 700, epoch: 3 | loss: 0.2308125
	speed: 0.0186s/iter; left time: 149.5800s
	iters: 800, epoch: 3 | loss: 0.2890491
	speed: 0.0185s/iter; left time: 147.3623s
	iters: 900, epoch: 3 | loss: 0.2160627
	speed: 0.0194s/iter; left time: 152.7016s
	iters: 1000, epoch: 3 | loss: 0.2480731
	speed: 0.0190s/iter; left time: 147.7774s
Epoch: 3 cost time: 21.513209104537964
Epoch: 3, Steps: 1095 | Train Loss: 0.2295882 Vali Loss: 0.1885163 Test Loss: 0.2144614
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1952471
	speed: 0.1597s/iter; left time: 1208.3815s
	iters: 200, epoch: 4 | loss: 0.1915838
	speed: 0.0183s/iter; left time: 136.5211s
	iters: 300, epoch: 4 | loss: 0.2373694
	speed: 0.0178s/iter; left time: 131.1188s
	iters: 400, epoch: 4 | loss: 0.2509792
	speed: 0.0181s/iter; left time: 131.6987s
	iters: 500, epoch: 4 | loss: 0.2522582
	speed: 0.0180s/iter; left time: 129.1920s
	iters: 600, epoch: 4 | loss: 0.2406414
	speed: 0.0182s/iter; left time: 128.7386s
	iters: 700, epoch: 4 | loss: 0.1836877
	speed: 0.0185s/iter; left time: 129.1028s
	iters: 800, epoch: 4 | loss: 0.2267610
	speed: 0.0182s/iter; left time: 125.2425s
	iters: 900, epoch: 4 | loss: 0.2411461
	speed: 0.0183s/iter; left time: 123.9258s
	iters: 1000, epoch: 4 | loss: 0.2393870
	speed: 0.0188s/iter; left time: 125.4129s
Epoch: 4 cost time: 20.95861315727234
Epoch: 4, Steps: 1095 | Train Loss: 0.2278627 Vali Loss: 0.1850900 Test Loss: 0.2150752
Validation loss decreased (0.188190 --> 0.185090).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2113465
	speed: 0.1615s/iter; left time: 1045.1813s
	iters: 200, epoch: 5 | loss: 0.2470974
	speed: 0.0182s/iter; left time: 115.7339s
	iters: 300, epoch: 5 | loss: 0.2324281
	speed: 0.0186s/iter; left time: 116.4444s
	iters: 400, epoch: 5 | loss: 0.2341498
	speed: 0.0188s/iter; left time: 115.7881s
	iters: 500, epoch: 5 | loss: 0.2230542
	speed: 0.0186s/iter; left time: 112.7725s
	iters: 600, epoch: 5 | loss: 0.2573478
	speed: 0.0185s/iter; left time: 110.5395s
	iters: 700, epoch: 5 | loss: 0.2615931
	speed: 0.0188s/iter; left time: 110.5930s
	iters: 800, epoch: 5 | loss: 0.2099301
	speed: 0.0182s/iter; left time: 105.1982s
	iters: 900, epoch: 5 | loss: 0.2148713
	speed: 0.0193s/iter; left time: 109.1711s
	iters: 1000, epoch: 5 | loss: 0.2154287
	speed: 0.0194s/iter; left time: 108.2538s
Epoch: 5 cost time: 21.341181993484497
Epoch: 5, Steps: 1095 | Train Loss: 0.2270947 Vali Loss: 0.1862101 Test Loss: 0.2128368
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2597074
	speed: 0.1589s/iter; left time: 854.4359s
	iters: 200, epoch: 6 | loss: 0.2340080
	speed: 0.0187s/iter; left time: 98.8191s
	iters: 300, epoch: 6 | loss: 0.2351046
	speed: 0.0184s/iter; left time: 95.1644s
	iters: 400, epoch: 6 | loss: 0.2553139
	speed: 0.0184s/iter; left time: 93.5021s
	iters: 500, epoch: 6 | loss: 0.1993775
	speed: 0.0188s/iter; left time: 93.5604s
	iters: 600, epoch: 6 | loss: 0.2140827
	speed: 0.0186s/iter; left time: 90.5332s
	iters: 700, epoch: 6 | loss: 0.2085951
	speed: 0.0185s/iter; left time: 88.3437s
	iters: 800, epoch: 6 | loss: 0.2153189
	speed: 0.0184s/iter; left time: 86.1686s
	iters: 900, epoch: 6 | loss: 0.2336239
	speed: 0.0188s/iter; left time: 86.0260s
	iters: 1000, epoch: 6 | loss: 0.2484408
	speed: 0.0190s/iter; left time: 85.2612s
Epoch: 6 cost time: 21.160749197006226
Epoch: 6, Steps: 1095 | Train Loss: 0.2267081 Vali Loss: 0.1855516 Test Loss: 0.2128506
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2241308
	speed: 0.1589s/iter; left time: 680.0973s
	iters: 200, epoch: 7 | loss: 0.2160130
	speed: 0.0185s/iter; left time: 77.3807s
	iters: 300, epoch: 7 | loss: 0.2381863
	speed: 0.0187s/iter; left time: 76.2452s
	iters: 400, epoch: 7 | loss: 0.2240315
	speed: 0.0184s/iter; left time: 73.1978s
	iters: 500, epoch: 7 | loss: 0.2178525
	speed: 0.0183s/iter; left time: 70.8473s
	iters: 600, epoch: 7 | loss: 0.2538864
	speed: 0.0184s/iter; left time: 69.6980s
	iters: 700, epoch: 7 | loss: 0.2140471
	speed: 0.0187s/iter; left time: 68.6727s
	iters: 800, epoch: 7 | loss: 0.2343410
	speed: 0.0186s/iter; left time: 66.5710s
	iters: 900, epoch: 7 | loss: 0.2138898
	speed: 0.0189s/iter; left time: 65.7377s
	iters: 1000, epoch: 7 | loss: 0.2255928
	speed: 0.0185s/iter; left time: 62.6549s
Epoch: 7 cost time: 21.166985273361206
Epoch: 7, Steps: 1095 | Train Loss: 0.2264904 Vali Loss: 0.1851810 Test Loss: 0.2128398
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_168_720_GRevagLinear_custom_ftM_sl168_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.21498015522956848, mae:0.30114084482192993
