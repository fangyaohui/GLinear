Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_96_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=96, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_96_720_GRevagLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3130974
	speed: 0.0241s/iter; left time: 262.4138s
	iters: 200, epoch: 1 | loss: 0.2903487
	speed: 0.0175s/iter; left time: 188.7713s
	iters: 300, epoch: 1 | loss: 0.3131777
	speed: 0.0176s/iter; left time: 187.9599s
	iters: 400, epoch: 1 | loss: 0.2858955
	speed: 0.0173s/iter; left time: 183.4653s
	iters: 500, epoch: 1 | loss: 0.2647448
	speed: 0.0170s/iter; left time: 177.9810s
	iters: 600, epoch: 1 | loss: 0.2568313
	speed: 0.0172s/iter; left time: 179.2337s
	iters: 700, epoch: 1 | loss: 0.2895507
	speed: 0.0169s/iter; left time: 174.0949s
	iters: 800, epoch: 1 | loss: 0.2926040
	speed: 0.0181s/iter; left time: 184.0518s
	iters: 900, epoch: 1 | loss: 0.2510298
	speed: 0.0172s/iter; left time: 173.0679s
	iters: 1000, epoch: 1 | loss: 0.2616040
	speed: 0.0179s/iter; left time: 178.9089s
Epoch: 1 cost time: 19.930137395858765
Epoch: 1, Steps: 1099 | Train Loss: 0.2948156 Vali Loss: 0.2194579 Test Loss: 0.2535914
Validation loss decreased (inf --> 0.219458).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2857117
	speed: 0.1639s/iter; left time: 1604.5475s
	iters: 200, epoch: 2 | loss: 0.2589084
	speed: 0.0197s/iter; left time: 191.1263s
	iters: 300, epoch: 2 | loss: 0.3145491
	speed: 0.0229s/iter; left time: 220.0722s
	iters: 400, epoch: 2 | loss: 0.2696791
	speed: 0.0240s/iter; left time: 227.5503s
	iters: 500, epoch: 2 | loss: 0.2558921
	speed: 0.0243s/iter; left time: 228.3765s
	iters: 600, epoch: 2 | loss: 0.2421663
	speed: 0.0266s/iter; left time: 247.3860s
	iters: 700, epoch: 2 | loss: 0.2714396
	speed: 0.0260s/iter; left time: 239.1939s
	iters: 800, epoch: 2 | loss: 0.2248903
	speed: 0.0225s/iter; left time: 204.6148s
	iters: 900, epoch: 2 | loss: 0.2752124
	speed: 0.0182s/iter; left time: 163.5875s
	iters: 1000, epoch: 2 | loss: 0.2431123
	speed: 0.0189s/iter; left time: 168.3627s
Epoch: 2 cost time: 25.508681058883667
Epoch: 2, Steps: 1099 | Train Loss: 0.2622562 Vali Loss: 0.2141589 Test Loss: 0.2462242
Validation loss decreased (0.219458 --> 0.214159).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2374039
	speed: 0.1540s/iter; left time: 1338.5154s
	iters: 200, epoch: 3 | loss: 0.2564609
	speed: 0.0176s/iter; left time: 151.4593s
	iters: 300, epoch: 3 | loss: 0.2693046
	speed: 0.0178s/iter; left time: 151.2194s
	iters: 400, epoch: 3 | loss: 0.2701811
	speed: 0.0167s/iter; left time: 139.9635s
	iters: 500, epoch: 3 | loss: 0.2322794
	speed: 0.0172s/iter; left time: 142.8642s
	iters: 600, epoch: 3 | loss: 0.2305278
	speed: 0.0171s/iter; left time: 140.3312s
	iters: 700, epoch: 3 | loss: 0.2912297
	speed: 0.0169s/iter; left time: 136.5054s
	iters: 800, epoch: 3 | loss: 0.2336217
	speed: 0.0169s/iter; left time: 134.8044s
	iters: 900, epoch: 3 | loss: 0.2583035
	speed: 0.0173s/iter; left time: 136.2962s
	iters: 1000, epoch: 3 | loss: 0.2435149
	speed: 0.0178s/iter; left time: 138.5699s
Epoch: 3 cost time: 19.64100456237793
Epoch: 3, Steps: 1099 | Train Loss: 0.2573558 Vali Loss: 0.2157055 Test Loss: 0.2426914
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2743056
	speed: 0.1578s/iter; left time: 1198.5540s
	iters: 200, epoch: 4 | loss: 0.2523007
	speed: 0.0180s/iter; left time: 134.6805s
	iters: 300, epoch: 4 | loss: 0.2468593
	speed: 0.0176s/iter; left time: 130.0265s
	iters: 400, epoch: 4 | loss: 0.2354575
	speed: 0.0176s/iter; left time: 128.1671s
	iters: 500, epoch: 4 | loss: 0.2459452
	speed: 0.0177s/iter; left time: 127.3742s
	iters: 600, epoch: 4 | loss: 0.2729132
	speed: 0.0175s/iter; left time: 124.0730s
	iters: 700, epoch: 4 | loss: 0.2358882
	speed: 0.0180s/iter; left time: 125.5507s
	iters: 800, epoch: 4 | loss: 0.2531789
	speed: 0.0184s/iter; left time: 126.7793s
	iters: 900, epoch: 4 | loss: 0.2405389
	speed: 0.0179s/iter; left time: 121.3310s
	iters: 1000, epoch: 4 | loss: 0.2940846
	speed: 0.0177s/iter; left time: 118.3487s
Epoch: 4 cost time: 20.44220495223999
Epoch: 4, Steps: 1099 | Train Loss: 0.2556650 Vali Loss: 0.2097633 Test Loss: 0.2426568
Validation loss decreased (0.214159 --> 0.209763).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2388278
	speed: 0.1582s/iter; left time: 1027.5825s
	iters: 200, epoch: 5 | loss: 0.3018365
	speed: 0.0175s/iter; left time: 111.7276s
	iters: 300, epoch: 5 | loss: 0.2629259
	speed: 0.0172s/iter; left time: 108.0718s
	iters: 400, epoch: 5 | loss: 0.2600931
	speed: 0.0174s/iter; left time: 108.1017s
	iters: 500, epoch: 5 | loss: 0.2749473
	speed: 0.0182s/iter; left time: 111.0953s
	iters: 600, epoch: 5 | loss: 0.2291648
	speed: 0.0171s/iter; left time: 102.5000s
	iters: 700, epoch: 5 | loss: 0.3020513
	speed: 0.0177s/iter; left time: 104.3574s
	iters: 800, epoch: 5 | loss: 0.2446375
	speed: 0.0176s/iter; left time: 101.7647s
	iters: 900, epoch: 5 | loss: 0.2469111
	speed: 0.0194s/iter; left time: 110.2959s
	iters: 1000, epoch: 5 | loss: 0.2562514
	speed: 0.0177s/iter; left time: 99.0756s
Epoch: 5 cost time: 20.225486040115356
Epoch: 5, Steps: 1099 | Train Loss: 0.2547661 Vali Loss: 0.2097031 Test Loss: 0.2422561
Validation loss decreased (0.209763 --> 0.209703).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2331152
	speed: 0.1569s/iter; left time: 846.3937s
	iters: 200, epoch: 6 | loss: 0.2316958
	speed: 0.0166s/iter; left time: 88.0266s
	iters: 300, epoch: 6 | loss: 0.2312660
	speed: 0.0171s/iter; left time: 88.9993s
	iters: 400, epoch: 6 | loss: 0.2469730
	speed: 0.0172s/iter; left time: 87.4478s
	iters: 500, epoch: 6 | loss: 0.2491735
	speed: 0.0172s/iter; left time: 86.0041s
	iters: 600, epoch: 6 | loss: 0.2302022
	speed: 0.0177s/iter; left time: 86.8312s
	iters: 700, epoch: 6 | loss: 0.2300861
	speed: 0.0172s/iter; left time: 82.7169s
	iters: 800, epoch: 6 | loss: 0.2410716
	speed: 0.0169s/iter; left time: 79.5700s
	iters: 900, epoch: 6 | loss: 0.2455831
	speed: 0.0171s/iter; left time: 78.3632s
	iters: 1000, epoch: 6 | loss: 0.2582255
	speed: 0.0175s/iter; left time: 78.7509s
Epoch: 6 cost time: 19.709901094436646
Epoch: 6, Steps: 1099 | Train Loss: 0.2543283 Vali Loss: 0.2107629 Test Loss: 0.2411602
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2402590
	speed: 0.1608s/iter; left time: 690.9596s
	iters: 200, epoch: 7 | loss: 0.2320271
	speed: 0.0172s/iter; left time: 72.1993s
	iters: 300, epoch: 7 | loss: 0.2936531
	speed: 0.0179s/iter; left time: 73.4466s
	iters: 400, epoch: 7 | loss: 0.2672679
	speed: 0.0172s/iter; left time: 68.6082s
	iters: 500, epoch: 7 | loss: 0.2477213
	speed: 0.0175s/iter; left time: 68.3224s
	iters: 600, epoch: 7 | loss: 0.2591337
	speed: 0.0176s/iter; left time: 66.6769s
	iters: 700, epoch: 7 | loss: 0.2627164
	speed: 0.0176s/iter; left time: 65.0939s
	iters: 800, epoch: 7 | loss: 0.2704010
	speed: 0.0171s/iter; left time: 61.4083s
	iters: 900, epoch: 7 | loss: 0.2614891
	speed: 0.0190s/iter; left time: 66.5044s
	iters: 1000, epoch: 7 | loss: 0.2499944
	speed: 0.0178s/iter; left time: 60.5708s
Epoch: 7 cost time: 20.226212739944458
Epoch: 7, Steps: 1099 | Train Loss: 0.2541294 Vali Loss: 0.2092363 Test Loss: 0.2415753
Validation loss decreased (0.209703 --> 0.209236).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2300943
	speed: 0.1633s/iter; left time: 522.1140s
	iters: 200, epoch: 8 | loss: 0.2361096
	speed: 0.0178s/iter; left time: 55.0345s
	iters: 300, epoch: 8 | loss: 0.2619071
	speed: 0.0174s/iter; left time: 52.0318s
	iters: 400, epoch: 8 | loss: 0.2562366
	speed: 0.0174s/iter; left time: 50.4578s
	iters: 500, epoch: 8 | loss: 0.2604658
	speed: 0.0183s/iter; left time: 51.1172s
	iters: 600, epoch: 8 | loss: 0.2402201
	speed: 0.0175s/iter; left time: 47.2101s
	iters: 700, epoch: 8 | loss: 0.2635836
	speed: 0.0173s/iter; left time: 45.0639s
	iters: 800, epoch: 8 | loss: 0.2546290
	speed: 0.0173s/iter; left time: 43.1752s
	iters: 900, epoch: 8 | loss: 0.2413945
	speed: 0.0186s/iter; left time: 44.6859s
	iters: 1000, epoch: 8 | loss: 0.2774725
	speed: 0.0183s/iter; left time: 42.0868s
Epoch: 8 cost time: 20.385953903198242
Epoch: 8, Steps: 1099 | Train Loss: 0.2540014 Vali Loss: 0.2088343 Test Loss: 0.2417888
Validation loss decreased (0.209236 --> 0.208834).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2758323
	speed: 0.1538s/iter; left time: 322.7786s
	iters: 200, epoch: 9 | loss: 0.2243699
	speed: 0.0168s/iter; left time: 33.6137s
	iters: 300, epoch: 9 | loss: 0.3011943
	speed: 0.0173s/iter; left time: 32.8133s
	iters: 400, epoch: 9 | loss: 0.2271880
	speed: 0.0176s/iter; left time: 31.6741s
	iters: 500, epoch: 9 | loss: 0.2522685
	speed: 0.0171s/iter; left time: 29.0560s
	iters: 600, epoch: 9 | loss: 0.2790762
	speed: 0.0173s/iter; left time: 27.5913s
	iters: 700, epoch: 9 | loss: 0.2526819
	speed: 0.0168s/iter; left time: 25.2121s
	iters: 800, epoch: 9 | loss: 0.2473449
	speed: 0.0177s/iter; left time: 24.7068s
	iters: 900, epoch: 9 | loss: 0.2230423
	speed: 0.0171s/iter; left time: 22.2688s
	iters: 1000, epoch: 9 | loss: 0.2896851
	speed: 0.0174s/iter; left time: 20.8477s
Epoch: 9 cost time: 19.74762749671936
Epoch: 9, Steps: 1099 | Train Loss: 0.2539559 Vali Loss: 0.2096248 Test Loss: 0.2411966
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2544069
	speed: 0.1627s/iter; left time: 162.7161s
	iters: 200, epoch: 10 | loss: 0.2645686
	speed: 0.0174s/iter; left time: 15.6762s
	iters: 300, epoch: 10 | loss: 0.2586740
	speed: 0.0178s/iter; left time: 14.2558s
	iters: 400, epoch: 10 | loss: 0.2628504
	speed: 0.0174s/iter; left time: 12.2125s
	iters: 500, epoch: 10 | loss: 0.2581748
	speed: 0.0174s/iter; left time: 10.4558s
	iters: 600, epoch: 10 | loss: 0.2305589
	speed: 0.0175s/iter; left time: 8.7569s
	iters: 700, epoch: 10 | loss: 0.2909767
	speed: 0.0175s/iter; left time: 6.9949s
	iters: 800, epoch: 10 | loss: 0.2773726
	speed: 0.0176s/iter; left time: 5.2943s
	iters: 900, epoch: 10 | loss: 0.2466654
	speed: 0.0173s/iter; left time: 3.4602s
	iters: 1000, epoch: 10 | loss: 0.3057977
	speed: 0.0176s/iter; left time: 1.7613s
Epoch: 10 cost time: 20.18458580970764
Epoch: 10, Steps: 1099 | Train Loss: 0.2539154 Vali Loss: 0.2096359 Test Loss: 0.2412633
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_96_720_GRevagLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2417123168706894, mae:0.3203124701976776
