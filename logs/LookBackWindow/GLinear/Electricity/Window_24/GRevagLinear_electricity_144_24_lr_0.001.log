Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_144_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_144_24_GRevagLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18245
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1787512
	speed: 0.0152s/iter; left time: 171.7853s
	iters: 200, epoch: 1 | loss: 0.1354444
	speed: 0.0088s/iter; left time: 98.9152s
	iters: 300, epoch: 1 | loss: 0.1316231
	speed: 0.0086s/iter; left time: 95.6278s
	iters: 400, epoch: 1 | loss: 0.1483085
	speed: 0.0084s/iter; left time: 92.1470s
	iters: 500, epoch: 1 | loss: 0.1802197
	speed: 0.0085s/iter; left time: 92.4712s
	iters: 600, epoch: 1 | loss: 0.1848686
	speed: 0.0083s/iter; left time: 89.9251s
	iters: 700, epoch: 1 | loss: 0.1329042
	speed: 0.0085s/iter; left time: 90.7658s
	iters: 800, epoch: 1 | loss: 0.1516551
	speed: 0.0089s/iter; left time: 94.8055s
	iters: 900, epoch: 1 | loss: 0.1133586
	speed: 0.0083s/iter; left time: 87.3444s
	iters: 1000, epoch: 1 | loss: 0.1335659
	speed: 0.0087s/iter; left time: 90.5489s
	iters: 1100, epoch: 1 | loss: 0.1663430
	speed: 0.0094s/iter; left time: 96.8831s
Epoch: 1 cost time: 10.593931674957275
Epoch: 1, Steps: 1140 | Train Loss: 0.1540326 Vali Loss: 0.1241942 Test Loss: 0.1341837
Validation loss decreased (inf --> 0.124194).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1354565
	speed: 0.0703s/iter; left time: 714.4553s
	iters: 200, epoch: 2 | loss: 0.1672339
	speed: 0.0089s/iter; left time: 89.1217s
	iters: 300, epoch: 2 | loss: 0.1369455
	speed: 0.0082s/iter; left time: 81.7097s
	iters: 400, epoch: 2 | loss: 0.1534026
	speed: 0.0076s/iter; left time: 75.0672s
	iters: 500, epoch: 2 | loss: 0.1219919
	speed: 0.0084s/iter; left time: 82.4595s
	iters: 600, epoch: 2 | loss: 0.1038911
	speed: 0.0084s/iter; left time: 81.4518s
	iters: 700, epoch: 2 | loss: 0.1092194
	speed: 0.0084s/iter; left time: 80.2683s
	iters: 800, epoch: 2 | loss: 0.1295554
	speed: 0.0103s/iter; left time: 97.2562s
	iters: 900, epoch: 2 | loss: 0.1148249
	speed: 0.0088s/iter; left time: 82.3583s
	iters: 1000, epoch: 2 | loss: 0.1476320
	speed: 0.0086s/iter; left time: 79.9395s
	iters: 1100, epoch: 2 | loss: 0.1217836
	speed: 0.0083s/iter; left time: 75.6065s
Epoch: 2 cost time: 10.617722034454346
Epoch: 2, Steps: 1140 | Train Loss: 0.1316334 Vali Loss: 0.1179938 Test Loss: 0.1271180
Validation loss decreased (0.124194 --> 0.117994).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1372856
	speed: 0.0694s/iter; left time: 626.3758s
	iters: 200, epoch: 3 | loss: 0.1124459
	speed: 0.0103s/iter; left time: 91.7534s
	iters: 300, epoch: 3 | loss: 0.1126540
	speed: 0.0084s/iter; left time: 74.4795s
	iters: 400, epoch: 3 | loss: 0.1225910
	speed: 0.0088s/iter; left time: 76.5713s
	iters: 500, epoch: 3 | loss: 0.1186155
	speed: 0.0086s/iter; left time: 74.2683s
	iters: 600, epoch: 3 | loss: 0.1134379
	speed: 0.0084s/iter; left time: 71.6664s
	iters: 700, epoch: 3 | loss: 0.1300222
	speed: 0.0099s/iter; left time: 83.0572s
	iters: 800, epoch: 3 | loss: 0.1213735
	speed: 0.0093s/iter; left time: 77.5527s
	iters: 900, epoch: 3 | loss: 0.1259613
	speed: 0.0083s/iter; left time: 68.5377s
	iters: 1000, epoch: 3 | loss: 0.1090263
	speed: 0.0088s/iter; left time: 71.4357s
	iters: 1100, epoch: 3 | loss: 0.1553057
	speed: 0.0088s/iter; left time: 70.4564s
Epoch: 3 cost time: 10.867845058441162
Epoch: 3, Steps: 1140 | Train Loss: 0.1273792 Vali Loss: 0.1170225 Test Loss: 0.1265083
Validation loss decreased (0.117994 --> 0.117023).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1117935
	speed: 0.0685s/iter; left time: 540.1423s
	iters: 200, epoch: 4 | loss: 0.1446322
	speed: 0.0083s/iter; left time: 64.5329s
	iters: 300, epoch: 4 | loss: 0.0993791
	speed: 0.0081s/iter; left time: 62.2014s
	iters: 400, epoch: 4 | loss: 0.1145689
	speed: 0.0079s/iter; left time: 60.2601s
	iters: 500, epoch: 4 | loss: 0.1272252
	speed: 0.0083s/iter; left time: 62.1398s
	iters: 600, epoch: 4 | loss: 0.1367816
	speed: 0.0084s/iter; left time: 62.2493s
	iters: 700, epoch: 4 | loss: 0.1427531
	speed: 0.0090s/iter; left time: 65.6653s
	iters: 800, epoch: 4 | loss: 0.1499886
	speed: 0.0083s/iter; left time: 59.6497s
	iters: 900, epoch: 4 | loss: 0.1255134
	speed: 0.0085s/iter; left time: 59.8926s
	iters: 1000, epoch: 4 | loss: 0.0962705
	speed: 0.0084s/iter; left time: 58.9566s
	iters: 1100, epoch: 4 | loss: 0.1054141
	speed: 0.0085s/iter; left time: 58.1940s
Epoch: 4 cost time: 10.355448007583618
Epoch: 4, Steps: 1140 | Train Loss: 0.1257377 Vali Loss: 0.1159950 Test Loss: 0.1250166
Validation loss decreased (0.117023 --> 0.115995).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1011432
	speed: 0.0728s/iter; left time: 490.6359s
	iters: 200, epoch: 5 | loss: 0.1264912
	speed: 0.0088s/iter; left time: 58.3649s
	iters: 300, epoch: 5 | loss: 0.1371158
	speed: 0.0087s/iter; left time: 56.8375s
	iters: 400, epoch: 5 | loss: 0.1201130
	speed: 0.0090s/iter; left time: 57.8116s
	iters: 500, epoch: 5 | loss: 0.1433119
	speed: 0.0092s/iter; left time: 58.1815s
	iters: 600, epoch: 5 | loss: 0.0937798
	speed: 0.0088s/iter; left time: 55.1080s
	iters: 700, epoch: 5 | loss: 0.1267197
	speed: 0.0088s/iter; left time: 53.7973s
	iters: 800, epoch: 5 | loss: 0.1164857
	speed: 0.0089s/iter; left time: 54.0203s
	iters: 900, epoch: 5 | loss: 0.1608921
	speed: 0.0090s/iter; left time: 53.6488s
	iters: 1000, epoch: 5 | loss: 0.1074431
	speed: 0.0089s/iter; left time: 52.0911s
	iters: 1100, epoch: 5 | loss: 0.1349964
	speed: 0.0091s/iter; left time: 51.9578s
Epoch: 5 cost time: 10.899887084960938
Epoch: 5, Steps: 1140 | Train Loss: 0.1248759 Vali Loss: 0.1152574 Test Loss: 0.1243380
Validation loss decreased (0.115995 --> 0.115257).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1458854
	speed: 0.0723s/iter; left time: 404.9432s
	iters: 200, epoch: 6 | loss: 0.1344478
	speed: 0.0091s/iter; left time: 50.0118s
	iters: 300, epoch: 6 | loss: 0.0982249
	speed: 0.0085s/iter; left time: 45.7572s
	iters: 400, epoch: 6 | loss: 0.1396911
	speed: 0.0090s/iter; left time: 47.5371s
	iters: 500, epoch: 6 | loss: 0.1337878
	speed: 0.0089s/iter; left time: 46.2087s
	iters: 600, epoch: 6 | loss: 0.1389598
	speed: 0.0088s/iter; left time: 44.9150s
	iters: 700, epoch: 6 | loss: 0.1399350
	speed: 0.0090s/iter; left time: 45.1135s
	iters: 800, epoch: 6 | loss: 0.1116049
	speed: 0.0090s/iter; left time: 43.9197s
	iters: 900, epoch: 6 | loss: 0.1201860
	speed: 0.0088s/iter; left time: 42.1898s
	iters: 1000, epoch: 6 | loss: 0.1291030
	speed: 0.0087s/iter; left time: 40.7849s
	iters: 1100, epoch: 6 | loss: 0.1117432
	speed: 0.0087s/iter; left time: 40.0463s
Epoch: 6 cost time: 10.869425535202026
Epoch: 6, Steps: 1140 | Train Loss: 0.1244737 Vali Loss: 0.1151275 Test Loss: 0.1240919
Validation loss decreased (0.115257 --> 0.115128).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1223178
	speed: 0.0671s/iter; left time: 299.5178s
	iters: 200, epoch: 7 | loss: 0.1346652
	speed: 0.0088s/iter; left time: 38.4614s
	iters: 300, epoch: 7 | loss: 0.1050793
	speed: 0.0080s/iter; left time: 34.1853s
	iters: 400, epoch: 7 | loss: 0.1103467
	speed: 0.0080s/iter; left time: 33.3737s
	iters: 500, epoch: 7 | loss: 0.1256535
	speed: 0.0085s/iter; left time: 34.6941s
	iters: 600, epoch: 7 | loss: 0.1196222
	speed: 0.0083s/iter; left time: 32.6975s
	iters: 700, epoch: 7 | loss: 0.1019890
	speed: 0.0084s/iter; left time: 32.6030s
	iters: 800, epoch: 7 | loss: 0.1069454
	speed: 0.0088s/iter; left time: 33.0094s
	iters: 900, epoch: 7 | loss: 0.1201995
	speed: 0.0083s/iter; left time: 30.4534s
	iters: 1000, epoch: 7 | loss: 0.1313686
	speed: 0.0086s/iter; left time: 30.4555s
	iters: 1100, epoch: 7 | loss: 0.1165844
	speed: 0.0085s/iter; left time: 29.3518s
Epoch: 7 cost time: 10.32900333404541
Epoch: 7, Steps: 1140 | Train Loss: 0.1242619 Vali Loss: 0.1150335 Test Loss: 0.1240467
Validation loss decreased (0.115128 --> 0.115033).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1768099
	speed: 0.0677s/iter; left time: 224.6675s
	iters: 200, epoch: 8 | loss: 0.1314597
	speed: 0.0084s/iter; left time: 27.1653s
	iters: 300, epoch: 8 | loss: 0.1270034
	speed: 0.0086s/iter; left time: 26.7428s
	iters: 400, epoch: 8 | loss: 0.1262485
	speed: 0.0083s/iter; left time: 25.1950s
	iters: 500, epoch: 8 | loss: 0.1387414
	speed: 0.0085s/iter; left time: 24.7114s
	iters: 600, epoch: 8 | loss: 0.1171582
	speed: 0.0087s/iter; left time: 24.6206s
	iters: 700, epoch: 8 | loss: 0.1849050
	speed: 0.0088s/iter; left time: 23.9994s
	iters: 800, epoch: 8 | loss: 0.1312080
	speed: 0.0093s/iter; left time: 24.4939s
	iters: 900, epoch: 8 | loss: 0.1382794
	speed: 0.0087s/iter; left time: 22.0172s
	iters: 1000, epoch: 8 | loss: 0.1237659
	speed: 0.0089s/iter; left time: 21.5142s
	iters: 1100, epoch: 8 | loss: 0.1287588
	speed: 0.0095s/iter; left time: 21.9566s
Epoch: 8 cost time: 10.700843095779419
Epoch: 8, Steps: 1140 | Train Loss: 0.1241389 Vali Loss: 0.1148582 Test Loss: 0.1239522
Validation loss decreased (0.115033 --> 0.114858).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1070798
	speed: 0.0747s/iter; left time: 162.8346s
	iters: 200, epoch: 9 | loss: 0.1386892
	speed: 0.0092s/iter; left time: 19.0710s
	iters: 300, epoch: 9 | loss: 0.1238042
	speed: 0.0082s/iter; left time: 16.1836s
	iters: 400, epoch: 9 | loss: 0.1190215
	speed: 0.0084s/iter; left time: 15.7824s
	iters: 500, epoch: 9 | loss: 0.1327512
	speed: 0.0082s/iter; left time: 14.6689s
	iters: 600, epoch: 9 | loss: 0.1113787
	speed: 0.0086s/iter; left time: 14.3987s
	iters: 700, epoch: 9 | loss: 0.1131837
	speed: 0.0089s/iter; left time: 14.0705s
	iters: 800, epoch: 9 | loss: 0.1208245
	speed: 0.0087s/iter; left time: 12.8870s
	iters: 900, epoch: 9 | loss: 0.1122104
	speed: 0.0086s/iter; left time: 11.9054s
	iters: 1000, epoch: 9 | loss: 0.1711915
	speed: 0.0083s/iter; left time: 10.5928s
	iters: 1100, epoch: 9 | loss: 0.1264297
	speed: 0.0086s/iter; left time: 10.1415s
Epoch: 9 cost time: 10.586720943450928
Epoch: 9, Steps: 1140 | Train Loss: 0.1240747 Vali Loss: 0.1149398 Test Loss: 0.1239233
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1124332
	speed: 0.0695s/iter; left time: 72.3884s
	iters: 200, epoch: 10 | loss: 0.1191171
	speed: 0.0088s/iter; left time: 8.3094s
	iters: 300, epoch: 10 | loss: 0.1418971
	speed: 0.0085s/iter; left time: 7.1673s
	iters: 400, epoch: 10 | loss: 0.1135704
	speed: 0.0088s/iter; left time: 6.5089s
	iters: 500, epoch: 10 | loss: 0.1349066
	speed: 0.0087s/iter; left time: 5.5919s
	iters: 600, epoch: 10 | loss: 0.1136879
	speed: 0.0083s/iter; left time: 4.4938s
	iters: 700, epoch: 10 | loss: 0.1168015
	speed: 0.0084s/iter; left time: 3.6925s
	iters: 800, epoch: 10 | loss: 0.1068460
	speed: 0.0091s/iter; left time: 3.1166s
	iters: 900, epoch: 10 | loss: 0.1146851
	speed: 0.0084s/iter; left time: 2.0222s
	iters: 1000, epoch: 10 | loss: 0.1013219
	speed: 0.0088s/iter; left time: 1.2437s
	iters: 1100, epoch: 10 | loss: 0.1180617
	speed: 0.0087s/iter; left time: 0.3583s
Epoch: 10 cost time: 10.63437795639038
Epoch: 10, Steps: 1140 | Train Loss: 0.1240332 Vali Loss: 0.1148275 Test Loss: 0.1239109
Validation loss decreased (0.114858 --> 0.114827).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_144_24_GRevagLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.12335900962352753, mae:0.21863211691379547
