Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_72_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=72, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_72_24_GRevagLinear_custom_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18317
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2043674
	speed: 0.0141s/iter; left time: 159.5091s
	iters: 200, epoch: 1 | loss: 0.1972156
	speed: 0.0075s/iter; left time: 83.9121s
	iters: 300, epoch: 1 | loss: 0.1986331
	speed: 0.0076s/iter; left time: 84.5390s
	iters: 400, epoch: 1 | loss: 0.2082028
	speed: 0.0073s/iter; left time: 80.6005s
	iters: 500, epoch: 1 | loss: 0.1893938
	speed: 0.0070s/iter; left time: 76.3104s
	iters: 600, epoch: 1 | loss: 0.1672295
	speed: 0.0071s/iter; left time: 76.5549s
	iters: 700, epoch: 1 | loss: 0.1793417
	speed: 0.0071s/iter; left time: 75.9264s
	iters: 800, epoch: 1 | loss: 0.1594269
	speed: 0.0076s/iter; left time: 80.7175s
	iters: 900, epoch: 1 | loss: 0.1771304
	speed: 0.0074s/iter; left time: 77.7978s
	iters: 1000, epoch: 1 | loss: 0.1438929
	speed: 0.0071s/iter; left time: 74.1986s
	iters: 1100, epoch: 1 | loss: 0.2314606
	speed: 0.0076s/iter; left time: 78.3797s
Epoch: 1 cost time: 9.137953996658325
Epoch: 1, Steps: 1144 | Train Loss: 0.1914703 Vali Loss: 0.1478677 Test Loss: 0.1578253
Validation loss decreased (inf --> 0.147868).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1852918
	speed: 0.0635s/iter; left time: 647.5703s
	iters: 200, epoch: 2 | loss: 0.1918123
	speed: 0.0072s/iter; left time: 72.7132s
	iters: 300, epoch: 2 | loss: 0.1956685
	speed: 0.0070s/iter; left time: 70.3715s
	iters: 400, epoch: 2 | loss: 0.1886665
	speed: 0.0070s/iter; left time: 68.8113s
	iters: 500, epoch: 2 | loss: 0.1761865
	speed: 0.0071s/iter; left time: 69.5065s
	iters: 600, epoch: 2 | loss: 0.1619135
	speed: 0.0073s/iter; left time: 70.4728s
	iters: 700, epoch: 2 | loss: 0.1551644
	speed: 0.0073s/iter; left time: 70.3576s
	iters: 800, epoch: 2 | loss: 0.1344342
	speed: 0.0073s/iter; left time: 69.5450s
	iters: 900, epoch: 2 | loss: 0.1217166
	speed: 0.0075s/iter; left time: 70.0455s
	iters: 1000, epoch: 2 | loss: 0.1538572
	speed: 0.0078s/iter; left time: 72.9042s
	iters: 1100, epoch: 2 | loss: 0.2088094
	speed: 0.0072s/iter; left time: 66.5876s
Epoch: 2 cost time: 9.239997148513794
Epoch: 2, Steps: 1144 | Train Loss: 0.1580979 Vali Loss: 0.1431912 Test Loss: 0.1525523
Validation loss decreased (0.147868 --> 0.143191).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1668847
	speed: 0.0646s/iter; left time: 584.4218s
	iters: 200, epoch: 3 | loss: 0.1400418
	speed: 0.0074s/iter; left time: 66.3796s
	iters: 300, epoch: 3 | loss: 0.1601958
	speed: 0.0075s/iter; left time: 66.1738s
	iters: 400, epoch: 3 | loss: 0.1366765
	speed: 0.0072s/iter; left time: 63.2333s
	iters: 500, epoch: 3 | loss: 0.1452020
	speed: 0.0072s/iter; left time: 62.3560s
	iters: 600, epoch: 3 | loss: 0.1619356
	speed: 0.0071s/iter; left time: 60.4890s
	iters: 700, epoch: 3 | loss: 0.1536284
	speed: 0.0072s/iter; left time: 60.9238s
	iters: 800, epoch: 3 | loss: 0.1694430
	speed: 0.0073s/iter; left time: 60.7718s
	iters: 900, epoch: 3 | loss: 0.1775573
	speed: 0.0072s/iter; left time: 59.8179s
	iters: 1000, epoch: 3 | loss: 0.1473231
	speed: 0.0071s/iter; left time: 58.1155s
	iters: 1100, epoch: 3 | loss: 0.1416235
	speed: 0.0071s/iter; left time: 57.5562s
Epoch: 3 cost time: 9.152702808380127
Epoch: 3, Steps: 1144 | Train Loss: 0.1541821 Vali Loss: 0.1411688 Test Loss: 0.1503832
Validation loss decreased (0.143191 --> 0.141169).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1382391
	speed: 0.0644s/iter; left time: 509.5022s
	iters: 200, epoch: 4 | loss: 0.1699709
	speed: 0.0073s/iter; left time: 57.0438s
	iters: 300, epoch: 4 | loss: 0.1298374
	speed: 0.0071s/iter; left time: 55.0138s
	iters: 400, epoch: 4 | loss: 0.2450225
	speed: 0.0073s/iter; left time: 55.2770s
	iters: 500, epoch: 4 | loss: 0.1438521
	speed: 0.0074s/iter; left time: 55.6997s
	iters: 600, epoch: 4 | loss: 0.1565967
	speed: 0.0073s/iter; left time: 54.3538s
	iters: 700, epoch: 4 | loss: 0.1427519
	speed: 0.0073s/iter; left time: 53.4779s
	iters: 800, epoch: 4 | loss: 0.1317263
	speed: 0.0073s/iter; left time: 52.9850s
	iters: 900, epoch: 4 | loss: 0.1575130
	speed: 0.0073s/iter; left time: 51.7904s
	iters: 1000, epoch: 4 | loss: 0.1421168
	speed: 0.0076s/iter; left time: 53.5605s
	iters: 1100, epoch: 4 | loss: 0.1387854
	speed: 0.0075s/iter; left time: 51.6210s
Epoch: 4 cost time: 9.323511838912964
Epoch: 4, Steps: 1144 | Train Loss: 0.1527219 Vali Loss: 0.1402922 Test Loss: 0.1495625
Validation loss decreased (0.141169 --> 0.140292).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1345607
	speed: 0.0643s/iter; left time: 435.1618s
	iters: 200, epoch: 5 | loss: 0.1419262
	speed: 0.0069s/iter; left time: 46.0040s
	iters: 300, epoch: 5 | loss: 0.1475255
	speed: 0.0071s/iter; left time: 46.5540s
	iters: 400, epoch: 5 | loss: 0.1447709
	speed: 0.0069s/iter; left time: 44.7884s
	iters: 500, epoch: 5 | loss: 0.1537275
	speed: 0.0072s/iter; left time: 45.8314s
	iters: 600, epoch: 5 | loss: 0.1329607
	speed: 0.0071s/iter; left time: 44.3937s
	iters: 700, epoch: 5 | loss: 0.1360537
	speed: 0.0070s/iter; left time: 43.3871s
	iters: 800, epoch: 5 | loss: 0.1469034
	speed: 0.0071s/iter; left time: 43.1503s
	iters: 900, epoch: 5 | loss: 0.1434202
	speed: 0.0077s/iter; left time: 45.8883s
	iters: 1000, epoch: 5 | loss: 0.1536914
	speed: 0.0078s/iter; left time: 45.4847s
	iters: 1100, epoch: 5 | loss: 0.1529857
	speed: 0.0076s/iter; left time: 43.6269s
Epoch: 5 cost time: 9.11791443824768
Epoch: 5, Steps: 1144 | Train Loss: 0.1520382 Vali Loss: 0.1398259 Test Loss: 0.1489650
Validation loss decreased (0.140292 --> 0.139826).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1402736
	speed: 0.0651s/iter; left time: 366.1876s
	iters: 200, epoch: 6 | loss: 0.1476463
	speed: 0.0077s/iter; left time: 42.6195s
	iters: 300, epoch: 6 | loss: 0.1287703
	speed: 0.0074s/iter; left time: 40.0360s
	iters: 400, epoch: 6 | loss: 0.1338737
	speed: 0.0070s/iter; left time: 37.3992s
	iters: 500, epoch: 6 | loss: 0.1427260
	speed: 0.0070s/iter; left time: 36.4789s
	iters: 600, epoch: 6 | loss: 0.1376685
	speed: 0.0069s/iter; left time: 35.4752s
	iters: 700, epoch: 6 | loss: 0.1347207
	speed: 0.0070s/iter; left time: 34.9964s
	iters: 800, epoch: 6 | loss: 0.1364999
	speed: 0.0071s/iter; left time: 34.9630s
	iters: 900, epoch: 6 | loss: 0.1483668
	speed: 0.0072s/iter; left time: 34.7571s
	iters: 1000, epoch: 6 | loss: 0.1285632
	speed: 0.0072s/iter; left time: 33.8642s
	iters: 1100, epoch: 6 | loss: 0.1432913
	speed: 0.0075s/iter; left time: 34.4266s
Epoch: 6 cost time: 9.142244338989258
Epoch: 6, Steps: 1144 | Train Loss: 0.1517012 Vali Loss: 0.1395241 Test Loss: 0.1487182
Validation loss decreased (0.139826 --> 0.139524).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2264993
	speed: 0.0627s/iter; left time: 280.8819s
	iters: 200, epoch: 7 | loss: 0.1739473
	speed: 0.0077s/iter; left time: 33.5220s
	iters: 300, epoch: 7 | loss: 0.1893434
	speed: 0.0074s/iter; left time: 31.7123s
	iters: 400, epoch: 7 | loss: 0.1489167
	speed: 0.0073s/iter; left time: 30.4131s
	iters: 500, epoch: 7 | loss: 0.1523520
	speed: 0.0074s/iter; left time: 30.2779s
	iters: 600, epoch: 7 | loss: 0.1452418
	speed: 0.0073s/iter; left time: 29.2162s
	iters: 700, epoch: 7 | loss: 0.1278322
	speed: 0.0073s/iter; left time: 28.3515s
	iters: 800, epoch: 7 | loss: 0.1276762
	speed: 0.0072s/iter; left time: 27.0872s
	iters: 900, epoch: 7 | loss: 0.1585738
	speed: 0.0071s/iter; left time: 26.0997s
	iters: 1000, epoch: 7 | loss: 0.1371957
	speed: 0.0069s/iter; left time: 24.8526s
	iters: 1100, epoch: 7 | loss: 0.1420450
	speed: 0.0070s/iter; left time: 24.3146s
Epoch: 7 cost time: 9.137037515640259
Epoch: 7, Steps: 1144 | Train Loss: 0.1514749 Vali Loss: 0.1395065 Test Loss: 0.1485077
Validation loss decreased (0.139524 --> 0.139506).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1862850
	speed: 0.0649s/iter; left time: 216.2876s
	iters: 200, epoch: 8 | loss: 0.1220404
	speed: 0.0071s/iter; left time: 22.8881s
	iters: 300, epoch: 8 | loss: 0.1463061
	speed: 0.0070s/iter; left time: 21.8485s
	iters: 400, epoch: 8 | loss: 0.1261799
	speed: 0.0075s/iter; left time: 22.8841s
	iters: 500, epoch: 8 | loss: 0.1567488
	speed: 0.0074s/iter; left time: 21.6302s
	iters: 600, epoch: 8 | loss: 0.1422248
	speed: 0.0072s/iter; left time: 20.4360s
	iters: 700, epoch: 8 | loss: 0.1497672
	speed: 0.0074s/iter; left time: 20.3316s
	iters: 800, epoch: 8 | loss: 0.1436622
	speed: 0.0072s/iter; left time: 19.0105s
	iters: 900, epoch: 8 | loss: 0.1270929
	speed: 0.0072s/iter; left time: 18.1692s
	iters: 1000, epoch: 8 | loss: 0.1611404
	speed: 0.0073s/iter; left time: 17.6925s
	iters: 1100, epoch: 8 | loss: 0.1358940
	speed: 0.0072s/iter; left time: 16.8294s
Epoch: 8 cost time: 9.179785251617432
Epoch: 8, Steps: 1144 | Train Loss: 0.1513630 Vali Loss: 0.1393356 Test Loss: 0.1484545
Validation loss decreased (0.139506 --> 0.139336).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1583540
	speed: 0.0646s/iter; left time: 141.5107s
	iters: 200, epoch: 9 | loss: 0.1686610
	speed: 0.0076s/iter; left time: 15.9005s
	iters: 300, epoch: 9 | loss: 0.1724845
	speed: 0.0075s/iter; left time: 15.0022s
	iters: 400, epoch: 9 | loss: 0.1442435
	speed: 0.0077s/iter; left time: 14.5595s
	iters: 500, epoch: 9 | loss: 0.1382463
	speed: 0.0072s/iter; left time: 12.9606s
	iters: 600, epoch: 9 | loss: 0.1560130
	speed: 0.0069s/iter; left time: 11.6719s
	iters: 700, epoch: 9 | loss: 0.1467251
	speed: 0.0071s/iter; left time: 11.2608s
	iters: 800, epoch: 9 | loss: 0.1379142
	speed: 0.0071s/iter; left time: 10.5258s
	iters: 900, epoch: 9 | loss: 0.1429657
	speed: 0.0074s/iter; left time: 10.2665s
	iters: 1000, epoch: 9 | loss: 0.1418333
	speed: 0.0071s/iter; left time: 9.2067s
	iters: 1100, epoch: 9 | loss: 0.1446037
	speed: 0.0086s/iter; left time: 10.2563s
Epoch: 9 cost time: 9.419883489608765
Epoch: 9, Steps: 1144 | Train Loss: 0.1513067 Vali Loss: 0.1393216 Test Loss: 0.1484238
Validation loss decreased (0.139336 --> 0.139322).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1722243
	speed: 0.0656s/iter; left time: 68.5633s
	iters: 200, epoch: 10 | loss: 0.1576889
	speed: 0.0073s/iter; left time: 6.9305s
	iters: 300, epoch: 10 | loss: 0.1392180
	speed: 0.0073s/iter; left time: 6.1369s
	iters: 400, epoch: 10 | loss: 0.1274585
	speed: 0.0073s/iter; left time: 5.4340s
	iters: 500, epoch: 10 | loss: 0.1507082
	speed: 0.0079s/iter; left time: 5.0881s
	iters: 600, epoch: 10 | loss: 0.1670095
	speed: 0.0075s/iter; left time: 4.0680s
	iters: 700, epoch: 10 | loss: 0.1930837
	speed: 0.0074s/iter; left time: 3.2888s
	iters: 800, epoch: 10 | loss: 0.1405783
	speed: 0.0073s/iter; left time: 2.5237s
	iters: 900, epoch: 10 | loss: 0.1591386
	speed: 0.0073s/iter; left time: 1.7931s
	iters: 1000, epoch: 10 | loss: 0.1430146
	speed: 0.0074s/iter; left time: 1.0730s
	iters: 1100, epoch: 10 | loss: 0.1666203
	speed: 0.0073s/iter; left time: 0.3287s
Epoch: 10 cost time: 9.31746530532837
Epoch: 10, Steps: 1144 | Train Loss: 0.1512799 Vali Loss: 0.1392692 Test Loss: 0.1484166
Validation loss decreased (0.139322 --> 0.139269).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_72_24_GRevagLinear_custom_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.1479358822107315, mae:0.2382500171661377
