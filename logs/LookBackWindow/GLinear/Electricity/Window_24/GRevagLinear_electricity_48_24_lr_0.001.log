Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_48_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=48, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_48_24_GRevagLinear_custom_ftM_sl48_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18341
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2537182
	speed: 0.0226s/iter; left time: 257.1007s
	iters: 200, epoch: 1 | loss: 0.2033725
	speed: 0.0153s/iter; left time: 171.9326s
	iters: 300, epoch: 1 | loss: 0.3257712
	speed: 0.0148s/iter; left time: 165.6169s
	iters: 400, epoch: 1 | loss: 0.1395826
	speed: 0.0142s/iter; left time: 157.0538s
	iters: 500, epoch: 1 | loss: 0.1957729
	speed: 0.0152s/iter; left time: 166.5226s
	iters: 600, epoch: 1 | loss: 0.2486031
	speed: 0.0145s/iter; left time: 157.6714s
	iters: 700, epoch: 1 | loss: 0.2107403
	speed: 0.0153s/iter; left time: 164.7743s
	iters: 800, epoch: 1 | loss: 0.1890822
	speed: 0.0144s/iter; left time: 153.6794s
	iters: 900, epoch: 1 | loss: 0.2631834
	speed: 0.0150s/iter; left time: 158.2771s
	iters: 1000, epoch: 1 | loss: 0.1444747
	speed: 0.0148s/iter; left time: 154.8931s
	iters: 1100, epoch: 1 | loss: 0.1741854
	speed: 0.0147s/iter; left time: 152.6024s
Epoch: 1 cost time: 17.79656958580017
Epoch: 1, Steps: 1146 | Train Loss: 0.2150137 Vali Loss: 0.1659970 Test Loss: 0.1784747
Validation loss decreased (inf --> 0.165997).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1559577
	speed: 0.1068s/iter; left time: 1090.5908s
	iters: 200, epoch: 2 | loss: 0.1801290
	speed: 0.0144s/iter; left time: 145.7351s
	iters: 300, epoch: 2 | loss: 0.1497377
	speed: 0.0142s/iter; left time: 142.0793s
	iters: 400, epoch: 2 | loss: 0.2040501
	speed: 0.0155s/iter; left time: 153.2214s
	iters: 500, epoch: 2 | loss: 0.1582676
	speed: 0.0145s/iter; left time: 142.7645s
	iters: 600, epoch: 2 | loss: 0.1743125
	speed: 0.0151s/iter; left time: 147.1096s
	iters: 700, epoch: 2 | loss: 0.2498951
	speed: 0.0151s/iter; left time: 145.5152s
	iters: 800, epoch: 2 | loss: 0.1503816
	speed: 0.0149s/iter; left time: 141.7859s
	iters: 900, epoch: 2 | loss: 0.1815487
	speed: 0.0146s/iter; left time: 137.5709s
	iters: 1000, epoch: 2 | loss: 0.1688477
	speed: 0.0147s/iter; left time: 136.5049s
	iters: 1100, epoch: 2 | loss: 0.1723626
	speed: 0.0153s/iter; left time: 141.4163s
Epoch: 2 cost time: 17.7962749004364
Epoch: 2, Steps: 1146 | Train Loss: 0.1774227 Vali Loss: 0.1607990 Test Loss: 0.1724473
Validation loss decreased (0.165997 --> 0.160799).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1425187
	speed: 0.1077s/iter; left time: 976.7748s
	iters: 200, epoch: 3 | loss: 0.1549963
	speed: 0.0137s/iter; left time: 122.7903s
	iters: 300, epoch: 3 | loss: 0.2112076
	speed: 0.0149s/iter; left time: 132.3242s
	iters: 400, epoch: 3 | loss: 0.1792722
	speed: 0.0150s/iter; left time: 131.9033s
	iters: 500, epoch: 3 | loss: 0.1880356
	speed: 0.0149s/iter; left time: 128.9752s
	iters: 600, epoch: 3 | loss: 0.1703302
	speed: 0.0145s/iter; left time: 124.5357s
	iters: 700, epoch: 3 | loss: 0.1743440
	speed: 0.0145s/iter; left time: 123.1301s
	iters: 800, epoch: 3 | loss: 0.1483998
	speed: 0.0147s/iter; left time: 123.3800s
	iters: 900, epoch: 3 | loss: 0.1872039
	speed: 0.0138s/iter; left time: 114.1739s
	iters: 1000, epoch: 3 | loss: 0.2053747
	speed: 0.0143s/iter; left time: 116.9666s
	iters: 1100, epoch: 3 | loss: 0.1818614
	speed: 0.0149s/iter; left time: 120.2963s
Epoch: 3 cost time: 17.599989891052246
Epoch: 3, Steps: 1146 | Train Loss: 0.1740632 Vali Loss: 0.1586261 Test Loss: 0.1700225
Validation loss decreased (0.160799 --> 0.158626).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1731128
	speed: 0.1121s/iter; left time: 888.0511s
	iters: 200, epoch: 4 | loss: 0.2006366
	speed: 0.0146s/iter; left time: 113.9327s
	iters: 300, epoch: 4 | loss: 0.1401677
	speed: 0.0149s/iter; left time: 115.1661s
	iters: 400, epoch: 4 | loss: 0.1742997
	speed: 0.0152s/iter; left time: 116.2405s
	iters: 500, epoch: 4 | loss: 0.1789869
	speed: 0.0149s/iter; left time: 111.9094s
	iters: 600, epoch: 4 | loss: 0.1562198
	speed: 0.0143s/iter; left time: 106.2545s
	iters: 700, epoch: 4 | loss: 0.2211828
	speed: 0.0149s/iter; left time: 108.8573s
	iters: 800, epoch: 4 | loss: 0.1493152
	speed: 0.0154s/iter; left time: 110.9510s
	iters: 900, epoch: 4 | loss: 0.1524534
	speed: 0.0136s/iter; left time: 97.0222s
	iters: 1000, epoch: 4 | loss: 0.1632819
	speed: 0.0149s/iter; left time: 104.7739s
	iters: 1100, epoch: 4 | loss: 0.1329797
	speed: 0.0144s/iter; left time: 99.7669s
Epoch: 4 cost time: 17.743404626846313
Epoch: 4, Steps: 1146 | Train Loss: 0.1728851 Vali Loss: 0.1579842 Test Loss: 0.1692216
Validation loss decreased (0.158626 --> 0.157984).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1561497
	speed: 0.1101s/iter; left time: 746.1083s
	iters: 200, epoch: 5 | loss: 0.1634451
	speed: 0.0147s/iter; left time: 98.1045s
	iters: 300, epoch: 5 | loss: 0.1660755
	speed: 0.0147s/iter; left time: 96.6006s
	iters: 400, epoch: 5 | loss: 0.1724883
	speed: 0.0147s/iter; left time: 95.0070s
	iters: 500, epoch: 5 | loss: 0.1573355
	speed: 0.0148s/iter; left time: 94.3731s
	iters: 600, epoch: 5 | loss: 0.1548687
	speed: 0.0137s/iter; left time: 85.8183s
	iters: 700, epoch: 5 | loss: 0.1586836
	speed: 0.0150s/iter; left time: 92.8860s
	iters: 800, epoch: 5 | loss: 0.1356757
	speed: 0.0150s/iter; left time: 90.9307s
	iters: 900, epoch: 5 | loss: 0.1749899
	speed: 0.0151s/iter; left time: 90.0620s
	iters: 1000, epoch: 5 | loss: 0.1892307
	speed: 0.0145s/iter; left time: 85.4142s
	iters: 1100, epoch: 5 | loss: 0.1681257
	speed: 0.0148s/iter; left time: 85.3081s
Epoch: 5 cost time: 17.635685682296753
Epoch: 5, Steps: 1146 | Train Loss: 0.1723275 Vali Loss: 0.1575642 Test Loss: 0.1688136
Validation loss decreased (0.157984 --> 0.157564).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1553566
	speed: 0.1068s/iter; left time: 601.4023s
	iters: 200, epoch: 6 | loss: 0.1823904
	speed: 0.0137s/iter; left time: 75.8406s
	iters: 300, epoch: 6 | loss: 0.1605455
	speed: 0.0143s/iter; left time: 77.4594s
	iters: 400, epoch: 6 | loss: 0.1593875
	speed: 0.0150s/iter; left time: 80.1348s
	iters: 500, epoch: 6 | loss: 0.2258691
	speed: 0.0148s/iter; left time: 77.2566s
	iters: 600, epoch: 6 | loss: 0.1573560
	speed: 0.0153s/iter; left time: 78.2657s
	iters: 700, epoch: 6 | loss: 0.1369656
	speed: 0.0152s/iter; left time: 76.2504s
	iters: 800, epoch: 6 | loss: 0.1600823
	speed: 0.0149s/iter; left time: 73.5873s
	iters: 900, epoch: 6 | loss: 0.1519955
	speed: 0.0159s/iter; left time: 76.6167s
	iters: 1000, epoch: 6 | loss: 0.1729895
	speed: 0.0134s/iter; left time: 63.2111s
	iters: 1100, epoch: 6 | loss: 0.2018741
	speed: 0.0148s/iter; left time: 68.4087s
Epoch: 6 cost time: 17.913466691970825
Epoch: 6, Steps: 1146 | Train Loss: 0.1720375 Vali Loss: 0.1572593 Test Loss: 0.1687881
Validation loss decreased (0.157564 --> 0.157259).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1861721
	speed: 0.1083s/iter; left time: 485.6195s
	iters: 200, epoch: 7 | loss: 0.1718242
	speed: 0.0145s/iter; left time: 63.6616s
	iters: 300, epoch: 7 | loss: 0.1839401
	speed: 0.0145s/iter; left time: 62.0449s
	iters: 400, epoch: 7 | loss: 0.1902708
	speed: 0.0150s/iter; left time: 62.9725s
	iters: 500, epoch: 7 | loss: 0.1647843
	speed: 0.0148s/iter; left time: 60.5323s
	iters: 600, epoch: 7 | loss: 0.1738806
	speed: 0.0142s/iter; left time: 56.4809s
	iters: 700, epoch: 7 | loss: 0.1958341
	speed: 0.0134s/iter; left time: 51.9211s
	iters: 800, epoch: 7 | loss: 0.1831104
	speed: 0.0148s/iter; left time: 55.9287s
	iters: 900, epoch: 7 | loss: 0.1436359
	speed: 0.0148s/iter; left time: 54.4023s
	iters: 1000, epoch: 7 | loss: 0.1853577
	speed: 0.0153s/iter; left time: 54.8452s
	iters: 1100, epoch: 7 | loss: 0.1957556
	speed: 0.0151s/iter; left time: 52.6815s
Epoch: 7 cost time: 17.49404263496399
Epoch: 7, Steps: 1146 | Train Loss: 0.1718609 Vali Loss: 0.1571168 Test Loss: 0.1685305
Validation loss decreased (0.157259 --> 0.157117).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1809154
	speed: 0.1077s/iter; left time: 359.4806s
	iters: 200, epoch: 8 | loss: 0.1846025
	speed: 0.0143s/iter; left time: 46.2019s
	iters: 300, epoch: 8 | loss: 0.1765571
	speed: 0.0139s/iter; left time: 43.7227s
	iters: 400, epoch: 8 | loss: 0.2045061
	speed: 0.0135s/iter; left time: 41.0981s
	iters: 500, epoch: 8 | loss: 0.1671849
	speed: 0.0148s/iter; left time: 43.5368s
	iters: 600, epoch: 8 | loss: 0.1636981
	speed: 0.0148s/iter; left time: 41.9720s
	iters: 700, epoch: 8 | loss: 0.2030472
	speed: 0.0151s/iter; left time: 41.2408s
	iters: 800, epoch: 8 | loss: 0.1399258
	speed: 0.0153s/iter; left time: 40.4000s
	iters: 900, epoch: 8 | loss: 0.1489644
	speed: 0.0148s/iter; left time: 37.4942s
	iters: 1000, epoch: 8 | loss: 0.1762891
	speed: 0.0142s/iter; left time: 34.5255s
	iters: 1100, epoch: 8 | loss: 0.1738725
	speed: 0.0144s/iter; left time: 33.5670s
Epoch: 8 cost time: 17.635797023773193
Epoch: 8, Steps: 1146 | Train Loss: 0.1717923 Vali Loss: 0.1570783 Test Loss: 0.1684900
Validation loss decreased (0.157117 --> 0.157078).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1624660
	speed: 0.1098s/iter; left time: 240.6925s
	iters: 200, epoch: 9 | loss: 0.2102642
	speed: 0.0148s/iter; left time: 30.8875s
	iters: 300, epoch: 9 | loss: 0.1387250
	speed: 0.0146s/iter; left time: 29.1322s
	iters: 400, epoch: 9 | loss: 0.1969528
	speed: 0.0149s/iter; left time: 28.1257s
	iters: 500, epoch: 9 | loss: 0.1828141
	speed: 0.0150s/iter; left time: 26.9742s
	iters: 600, epoch: 9 | loss: 0.1769643
	speed: 0.0152s/iter; left time: 25.7755s
	iters: 700, epoch: 9 | loss: 0.1652200
	speed: 0.0152s/iter; left time: 24.1542s
	iters: 800, epoch: 9 | loss: 0.1458165
	speed: 0.0145s/iter; left time: 21.6269s
	iters: 900, epoch: 9 | loss: 0.1417224
	speed: 0.0144s/iter; left time: 20.0426s
	iters: 1000, epoch: 9 | loss: 0.1462229
	speed: 0.0136s/iter; left time: 17.5665s
	iters: 1100, epoch: 9 | loss: 0.1610924
	speed: 0.0146s/iter; left time: 17.4271s
Epoch: 9 cost time: 17.694418907165527
Epoch: 9, Steps: 1146 | Train Loss: 0.1717643 Vali Loss: 0.1570819 Test Loss: 0.1684437
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1734544
	speed: 0.1140s/iter; left time: 119.3266s
	iters: 200, epoch: 10 | loss: 0.1503067
	speed: 0.0138s/iter; left time: 13.0946s
	iters: 300, epoch: 10 | loss: 0.1867154
	speed: 0.0143s/iter; left time: 12.0725s
	iters: 400, epoch: 10 | loss: 0.2170318
	speed: 0.0147s/iter; left time: 11.0012s
	iters: 500, epoch: 10 | loss: 0.1816173
	speed: 0.0154s/iter; left time: 9.9902s
	iters: 600, epoch: 10 | loss: 0.1800515
	speed: 0.0152s/iter; left time: 8.3083s
	iters: 700, epoch: 10 | loss: 0.2049949
	speed: 0.0150s/iter; left time: 6.7121s
	iters: 800, epoch: 10 | loss: 0.1356153
	speed: 0.0149s/iter; left time: 5.1682s
	iters: 900, epoch: 10 | loss: 0.1243473
	speed: 0.0149s/iter; left time: 3.6911s
	iters: 1000, epoch: 10 | loss: 0.1518793
	speed: 0.0136s/iter; left time: 1.9932s
	iters: 1100, epoch: 10 | loss: 0.1534989
	speed: 0.0152s/iter; left time: 0.7165s
Epoch: 10 cost time: 17.923736572265625
Epoch: 10, Steps: 1146 | Train Loss: 0.1717269 Vali Loss: 0.1570650 Test Loss: 0.1684241
Validation loss decreased (0.157078 --> 0.157065).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_48_24_GRevagLinear_custom_ftM_sl48_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.16798429191112518, mae:0.2500912845134735
