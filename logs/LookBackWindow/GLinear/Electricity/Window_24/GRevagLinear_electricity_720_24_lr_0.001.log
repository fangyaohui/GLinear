Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_720_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_24_GRevagLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17669
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1439083
	speed: 0.0223s/iter; left time: 243.4767s
	iters: 200, epoch: 1 | loss: 0.1051220
	speed: 0.0166s/iter; left time: 179.5137s
	iters: 300, epoch: 1 | loss: 0.0985369
	speed: 0.0170s/iter; left time: 183.0875s
	iters: 400, epoch: 1 | loss: 0.1153082
	speed: 0.0167s/iter; left time: 177.7331s
	iters: 500, epoch: 1 | loss: 0.1168761
	speed: 0.0165s/iter; left time: 173.5638s
	iters: 600, epoch: 1 | loss: 0.1252696
	speed: 0.0166s/iter; left time: 173.4547s
	iters: 700, epoch: 1 | loss: 0.0904918
	speed: 0.0165s/iter; left time: 170.4372s
	iters: 800, epoch: 1 | loss: 0.1009509
	speed: 0.0170s/iter; left time: 173.7536s
	iters: 900, epoch: 1 | loss: 0.0900203
	speed: 0.0173s/iter; left time: 175.8692s
	iters: 1000, epoch: 1 | loss: 0.0889365
	speed: 0.0171s/iter; left time: 172.1981s
	iters: 1100, epoch: 1 | loss: 0.0961028
	speed: 0.0167s/iter; left time: 166.4361s
Epoch: 1 cost time: 19.22797179222107
Epoch: 1, Steps: 1104 | Train Loss: 0.1175693 Vali Loss: 0.0930928 Test Loss: 0.1041849
Validation loss decreased (inf --> 0.093093).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1183665
	speed: 0.1165s/iter; left time: 1145.7505s
	iters: 200, epoch: 2 | loss: 0.0945403
	speed: 0.0162s/iter; left time: 157.4343s
	iters: 300, epoch: 2 | loss: 0.0900525
	speed: 0.0162s/iter; left time: 155.9216s
	iters: 400, epoch: 2 | loss: 0.1253980
	speed: 0.0162s/iter; left time: 154.5752s
	iters: 500, epoch: 2 | loss: 0.1840214
	speed: 0.0165s/iter; left time: 155.7560s
	iters: 600, epoch: 2 | loss: 0.0930360
	speed: 0.0168s/iter; left time: 156.9369s
	iters: 700, epoch: 2 | loss: 0.0928913
	speed: 0.0167s/iter; left time: 154.1779s
	iters: 800, epoch: 2 | loss: 0.1088960
	speed: 0.0169s/iter; left time: 154.4267s
	iters: 900, epoch: 2 | loss: 0.0850859
	speed: 0.0176s/iter; left time: 158.7736s
	iters: 1000, epoch: 2 | loss: 0.0867314
	speed: 0.0169s/iter; left time: 151.4335s
	iters: 1100, epoch: 2 | loss: 0.1033427
	speed: 0.0164s/iter; left time: 144.8494s
Epoch: 2 cost time: 19.117815732955933
Epoch: 2, Steps: 1104 | Train Loss: 0.1052631 Vali Loss: 0.0928967 Test Loss: 0.1033457
Validation loss decreased (0.093093 --> 0.092897).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0989612
	speed: 0.1148s/iter; left time: 1002.1223s
	iters: 200, epoch: 3 | loss: 0.0959809
	speed: 0.0165s/iter; left time: 142.1498s
	iters: 300, epoch: 3 | loss: 0.0989224
	speed: 0.0160s/iter; left time: 136.7741s
	iters: 400, epoch: 3 | loss: 0.0942632
	speed: 0.0163s/iter; left time: 137.8281s
	iters: 500, epoch: 3 | loss: 0.1121149
	speed: 0.0163s/iter; left time: 135.7144s
	iters: 600, epoch: 3 | loss: 0.0874576
	speed: 0.0166s/iter; left time: 136.8664s
	iters: 700, epoch: 3 | loss: 0.0870199
	speed: 0.0164s/iter; left time: 133.1881s
	iters: 800, epoch: 3 | loss: 0.0882338
	speed: 0.0165s/iter; left time: 132.9036s
	iters: 900, epoch: 3 | loss: 0.1152529
	speed: 0.0170s/iter; left time: 134.5195s
	iters: 1000, epoch: 3 | loss: 0.1118147
	speed: 0.0172s/iter; left time: 135.0391s
	iters: 1100, epoch: 3 | loss: 0.1021322
	speed: 0.0166s/iter; left time: 128.0801s
Epoch: 3 cost time: 19.173437356948853
Epoch: 3, Steps: 1104 | Train Loss: 0.0993275 Vali Loss: 0.0891873 Test Loss: 0.0986875
Validation loss decreased (0.092897 --> 0.089187).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0785319
	speed: 0.1181s/iter; left time: 900.6057s
	iters: 200, epoch: 4 | loss: 0.0893101
	speed: 0.0183s/iter; left time: 137.7175s
	iters: 300, epoch: 4 | loss: 0.1163509
	speed: 0.0170s/iter; left time: 125.9321s
	iters: 400, epoch: 4 | loss: 0.1092337
	speed: 0.0172s/iter; left time: 125.7392s
	iters: 500, epoch: 4 | loss: 0.0753227
	speed: 0.0165s/iter; left time: 119.6098s
	iters: 600, epoch: 4 | loss: 0.0858684
	speed: 0.0171s/iter; left time: 121.7050s
	iters: 700, epoch: 4 | loss: 0.1097751
	speed: 0.0174s/iter; left time: 122.0247s
	iters: 800, epoch: 4 | loss: 0.0864928
	speed: 0.0171s/iter; left time: 118.5621s
	iters: 900, epoch: 4 | loss: 0.0916995
	speed: 0.0175s/iter; left time: 119.4377s
	iters: 1000, epoch: 4 | loss: 0.0777174
	speed: 0.0173s/iter; left time: 116.3857s
	iters: 1100, epoch: 4 | loss: 0.0919127
	speed: 0.0169s/iter; left time: 112.1552s
Epoch: 4 cost time: 19.855451822280884
Epoch: 4, Steps: 1104 | Train Loss: 0.0969796 Vali Loss: 0.0882861 Test Loss: 0.0973881
Validation loss decreased (0.089187 --> 0.088286).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0955279
	speed: 0.1161s/iter; left time: 757.3345s
	iters: 200, epoch: 5 | loss: 0.1023408
	speed: 0.0171s/iter; left time: 109.9144s
	iters: 300, epoch: 5 | loss: 0.0891928
	speed: 0.0169s/iter; left time: 106.9674s
	iters: 400, epoch: 5 | loss: 0.0958589
	speed: 0.0171s/iter; left time: 106.7281s
	iters: 500, epoch: 5 | loss: 0.0948452
	speed: 0.0166s/iter; left time: 101.9519s
	iters: 600, epoch: 5 | loss: 0.0832549
	speed: 0.0171s/iter; left time: 103.0669s
	iters: 700, epoch: 5 | loss: 0.0877895
	speed: 0.0169s/iter; left time: 100.3424s
	iters: 800, epoch: 5 | loss: 0.1178295
	speed: 0.0168s/iter; left time: 97.6743s
	iters: 900, epoch: 5 | loss: 0.1519475
	speed: 0.0168s/iter; left time: 96.2098s
	iters: 1000, epoch: 5 | loss: 0.0822184
	speed: 0.0171s/iter; left time: 95.9378s
	iters: 1100, epoch: 5 | loss: 0.0937856
	speed: 0.0169s/iter; left time: 93.4828s
Epoch: 5 cost time: 19.575334310531616
Epoch: 5, Steps: 1104 | Train Loss: 0.0956530 Vali Loss: 0.0878897 Test Loss: 0.0968791
Validation loss decreased (0.088286 --> 0.087890).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1005158
	speed: 0.1165s/iter; left time: 631.5390s
	iters: 200, epoch: 6 | loss: 0.1000923
	speed: 0.0166s/iter; left time: 88.1958s
	iters: 300, epoch: 6 | loss: 0.0837863
	speed: 0.0175s/iter; left time: 91.4377s
	iters: 400, epoch: 6 | loss: 0.0886428
	speed: 0.0172s/iter; left time: 88.2769s
	iters: 500, epoch: 6 | loss: 0.1693700
	speed: 0.0170s/iter; left time: 85.3310s
	iters: 600, epoch: 6 | loss: 0.0942689
	speed: 0.0168s/iter; left time: 82.8507s
	iters: 700, epoch: 6 | loss: 0.0909095
	speed: 0.0170s/iter; left time: 82.1049s
	iters: 800, epoch: 6 | loss: 0.1064843
	speed: 0.0171s/iter; left time: 80.9054s
	iters: 900, epoch: 6 | loss: 0.0987229
	speed: 0.0167s/iter; left time: 77.1139s
	iters: 1000, epoch: 6 | loss: 0.0865033
	speed: 0.0168s/iter; left time: 75.9732s
	iters: 1100, epoch: 6 | loss: 0.0883207
	speed: 0.0167s/iter; left time: 73.7593s
Epoch: 6 cost time: 19.493852853775024
Epoch: 6, Steps: 1104 | Train Loss: 0.0948434 Vali Loss: 0.0874057 Test Loss: 0.0964772
Validation loss decreased (0.087890 --> 0.087406).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0954684
	speed: 0.1175s/iter; left time: 507.1545s
	iters: 200, epoch: 7 | loss: 0.0881593
	speed: 0.0168s/iter; left time: 70.6735s
	iters: 300, epoch: 7 | loss: 0.0967593
	speed: 0.0171s/iter; left time: 70.3257s
	iters: 400, epoch: 7 | loss: 0.0941921
	speed: 0.0165s/iter; left time: 66.4409s
	iters: 500, epoch: 7 | loss: 0.1021422
	speed: 0.0168s/iter; left time: 65.6612s
	iters: 600, epoch: 7 | loss: 0.0806775
	speed: 0.0168s/iter; left time: 64.1428s
	iters: 700, epoch: 7 | loss: 0.0853341
	speed: 0.0169s/iter; left time: 62.8598s
	iters: 800, epoch: 7 | loss: 0.1024804
	speed: 0.0167s/iter; left time: 60.4123s
	iters: 900, epoch: 7 | loss: 0.0779456
	speed: 0.0176s/iter; left time: 61.8814s
	iters: 1000, epoch: 7 | loss: 0.0818713
	speed: 0.0169s/iter; left time: 57.7760s
	iters: 1100, epoch: 7 | loss: 0.0735446
	speed: 0.0162s/iter; left time: 53.7032s
Epoch: 7 cost time: 19.441354751586914
Epoch: 7, Steps: 1104 | Train Loss: 0.0943890 Vali Loss: 0.0870377 Test Loss: 0.0963403
Validation loss decreased (0.087406 --> 0.087038).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0844593
	speed: 0.1172s/iter; left time: 376.6306s
	iters: 200, epoch: 8 | loss: 0.0841136
	speed: 0.0166s/iter; left time: 51.7677s
	iters: 300, epoch: 8 | loss: 0.0911726
	speed: 0.0167s/iter; left time: 50.2990s
	iters: 400, epoch: 8 | loss: 0.1173054
	speed: 0.0166s/iter; left time: 48.4959s
	iters: 500, epoch: 8 | loss: 0.0754589
	speed: 0.0173s/iter; left time: 48.7219s
	iters: 600, epoch: 8 | loss: 0.0850416
	speed: 0.0167s/iter; left time: 45.2020s
	iters: 700, epoch: 8 | loss: 0.0758771
	speed: 0.0168s/iter; left time: 43.8963s
	iters: 800, epoch: 8 | loss: 0.0842527
	speed: 0.0167s/iter; left time: 42.0408s
	iters: 900, epoch: 8 | loss: 0.1003338
	speed: 0.0174s/iter; left time: 42.0549s
	iters: 1000, epoch: 8 | loss: 0.0838936
	speed: 0.0176s/iter; left time: 40.6237s
	iters: 1100, epoch: 8 | loss: 0.0919955
	speed: 0.0173s/iter; left time: 38.1874s
Epoch: 8 cost time: 19.63009762763977
Epoch: 8, Steps: 1104 | Train Loss: 0.0941571 Vali Loss: 0.0869402 Test Loss: 0.0960181
Validation loss decreased (0.087038 --> 0.086940).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0843361
	speed: 0.1185s/iter; left time: 249.8925s
	iters: 200, epoch: 9 | loss: 0.1110295
	speed: 0.0170s/iter; left time: 34.0623s
	iters: 300, epoch: 9 | loss: 0.0797046
	speed: 0.0174s/iter; left time: 33.2140s
	iters: 400, epoch: 9 | loss: 0.0943013
	speed: 0.0170s/iter; left time: 30.7712s
	iters: 500, epoch: 9 | loss: 0.0789903
	speed: 0.0169s/iter; left time: 28.9012s
	iters: 600, epoch: 9 | loss: 0.1091328
	speed: 0.0169s/iter; left time: 27.2400s
	iters: 700, epoch: 9 | loss: 0.0979368
	speed: 0.0173s/iter; left time: 26.0482s
	iters: 800, epoch: 9 | loss: 0.1411319
	speed: 0.0170s/iter; left time: 23.9844s
	iters: 900, epoch: 9 | loss: 0.0932210
	speed: 0.0172s/iter; left time: 22.5657s
	iters: 1000, epoch: 9 | loss: 0.0893501
	speed: 0.0176s/iter; left time: 21.3362s
	iters: 1100, epoch: 9 | loss: 0.0885684
	speed: 0.0171s/iter; left time: 18.9254s
Epoch: 9 cost time: 19.82858371734619
Epoch: 9, Steps: 1104 | Train Loss: 0.0939971 Vali Loss: 0.0869235 Test Loss: 0.0959587
Validation loss decreased (0.086940 --> 0.086923).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1148511
	speed: 0.1167s/iter; left time: 117.3039s
	iters: 200, epoch: 10 | loss: 0.1087398
	speed: 0.0170s/iter; left time: 15.4211s
	iters: 300, epoch: 10 | loss: 0.0946730
	speed: 0.0163s/iter; left time: 13.1109s
	iters: 400, epoch: 10 | loss: 0.1023048
	speed: 0.0170s/iter; left time: 12.0121s
	iters: 500, epoch: 10 | loss: 0.0976012
	speed: 0.0175s/iter; left time: 10.5850s
	iters: 600, epoch: 10 | loss: 0.0828127
	speed: 0.0173s/iter; left time: 8.7604s
	iters: 700, epoch: 10 | loss: 0.0853888
	speed: 0.0173s/iter; left time: 7.0259s
	iters: 800, epoch: 10 | loss: 0.0933185
	speed: 0.0173s/iter; left time: 5.2761s
	iters: 900, epoch: 10 | loss: 0.0800904
	speed: 0.0184s/iter; left time: 3.7717s
	iters: 1000, epoch: 10 | loss: 0.1042392
	speed: 0.0171s/iter; left time: 1.7928s
	iters: 1100, epoch: 10 | loss: 0.0866696
	speed: 0.0176s/iter; left time: 0.0882s
Epoch: 10 cost time: 19.959404945373535
Epoch: 10, Steps: 1104 | Train Loss: 0.0939395 Vali Loss: 0.0868614 Test Loss: 0.0959056
Validation loss decreased (0.086923 --> 0.086861).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_720_24_GRevagLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.09556326270103455, mae:0.19182461500167847
