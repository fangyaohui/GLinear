Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_504_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_504_24_GRevagLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1385793
	speed: 0.0197s/iter; left time: 218.2987s
	iters: 200, epoch: 1 | loss: 0.1002109
	speed: 0.0133s/iter; left time: 145.7855s
	iters: 300, epoch: 1 | loss: 0.1409775
	speed: 0.0137s/iter; left time: 148.5007s
	iters: 400, epoch: 1 | loss: 0.1034165
	speed: 0.0134s/iter; left time: 143.9490s
	iters: 500, epoch: 1 | loss: 0.0954970
	speed: 0.0134s/iter; left time: 143.2702s
	iters: 600, epoch: 1 | loss: 0.1019866
	speed: 0.0138s/iter; left time: 146.3055s
	iters: 700, epoch: 1 | loss: 0.1454392
	speed: 0.0138s/iter; left time: 144.2244s
	iters: 800, epoch: 1 | loss: 0.1023357
	speed: 0.0139s/iter; left time: 144.6421s
	iters: 900, epoch: 1 | loss: 0.1132208
	speed: 0.0143s/iter; left time: 147.3416s
	iters: 1000, epoch: 1 | loss: 0.1099342
	speed: 0.0138s/iter; left time: 140.0244s
	iters: 1100, epoch: 1 | loss: 0.1004820
	speed: 0.0132s/iter; left time: 133.0673s
Epoch: 1 cost time: 15.935335397720337
Epoch: 1, Steps: 1117 | Train Loss: 0.1184851 Vali Loss: 0.0937300 Test Loss: 0.1047461
Validation loss decreased (inf --> 0.093730).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1024230
	speed: 0.0952s/iter; left time: 948.0797s
	iters: 200, epoch: 2 | loss: 0.0846772
	speed: 0.0131s/iter; left time: 128.6404s
	iters: 300, epoch: 2 | loss: 0.1027891
	speed: 0.0133s/iter; left time: 130.0558s
	iters: 400, epoch: 2 | loss: 0.1275115
	speed: 0.0136s/iter; left time: 131.6737s
	iters: 500, epoch: 2 | loss: 0.0913825
	speed: 0.0139s/iter; left time: 132.5469s
	iters: 600, epoch: 2 | loss: 0.0933347
	speed: 0.0141s/iter; left time: 133.4333s
	iters: 700, epoch: 2 | loss: 0.0763192
	speed: 0.0139s/iter; left time: 130.0054s
	iters: 800, epoch: 2 | loss: 0.1054512
	speed: 0.0131s/iter; left time: 121.6389s
	iters: 900, epoch: 2 | loss: 0.1237373
	speed: 0.0150s/iter; left time: 137.6896s
	iters: 1000, epoch: 2 | loss: 0.0956019
	speed: 0.0145s/iter; left time: 131.5948s
	iters: 1100, epoch: 2 | loss: 0.0886954
	speed: 0.0141s/iter; left time: 126.0752s
Epoch: 2 cost time: 16.233227968215942
Epoch: 2, Steps: 1117 | Train Loss: 0.1051273 Vali Loss: 0.0912718 Test Loss: 0.1012570
Validation loss decreased (0.093730 --> 0.091272).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0773123
	speed: 0.0955s/iter; left time: 843.7089s
	iters: 200, epoch: 3 | loss: 0.1144734
	speed: 0.0131s/iter; left time: 114.7071s
	iters: 300, epoch: 3 | loss: 0.1013630
	speed: 0.0126s/iter; left time: 108.4240s
	iters: 400, epoch: 3 | loss: 0.0790838
	speed: 0.0130s/iter; left time: 111.0235s
	iters: 500, epoch: 3 | loss: 0.0945165
	speed: 0.0128s/iter; left time: 107.6115s
	iters: 600, epoch: 3 | loss: 0.1048009
	speed: 0.0127s/iter; left time: 105.8107s
	iters: 700, epoch: 3 | loss: 0.0777309
	speed: 0.0133s/iter; left time: 109.8545s
	iters: 800, epoch: 3 | loss: 0.0949085
	speed: 0.0142s/iter; left time: 115.9397s
	iters: 900, epoch: 3 | loss: 0.1949678
	speed: 0.0132s/iter; left time: 106.4484s
	iters: 1000, epoch: 3 | loss: 0.0884234
	speed: 0.0135s/iter; left time: 107.4629s
	iters: 1100, epoch: 3 | loss: 0.1018704
	speed: 0.0135s/iter; left time: 105.6109s
Epoch: 3 cost time: 15.508628606796265
Epoch: 3, Steps: 1117 | Train Loss: 0.1004720 Vali Loss: 0.0902292 Test Loss: 0.0993054
Validation loss decreased (0.091272 --> 0.090229).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0972684
	speed: 0.0953s/iter; left time: 735.8773s
	iters: 200, epoch: 4 | loss: 0.0927642
	speed: 0.0137s/iter; left time: 104.0857s
	iters: 300, epoch: 4 | loss: 0.0911520
	speed: 0.0132s/iter; left time: 98.9521s
	iters: 400, epoch: 4 | loss: 0.0892162
	speed: 0.0133s/iter; left time: 98.8238s
	iters: 500, epoch: 4 | loss: 0.1093178
	speed: 0.0133s/iter; left time: 97.6380s
	iters: 600, epoch: 4 | loss: 0.0979784
	speed: 0.0143s/iter; left time: 103.5173s
	iters: 700, epoch: 4 | loss: 0.1023494
	speed: 0.0138s/iter; left time: 98.1741s
	iters: 800, epoch: 4 | loss: 0.1151944
	speed: 0.0133s/iter; left time: 93.2150s
	iters: 900, epoch: 4 | loss: 0.1048531
	speed: 0.0135s/iter; left time: 93.3828s
	iters: 1000, epoch: 4 | loss: 0.1071371
	speed: 0.0133s/iter; left time: 90.8002s
	iters: 1100, epoch: 4 | loss: 0.0837053
	speed: 0.0136s/iter; left time: 91.2707s
Epoch: 4 cost time: 15.890612125396729
Epoch: 4, Steps: 1117 | Train Loss: 0.0988806 Vali Loss: 0.0894832 Test Loss: 0.0990115
Validation loss decreased (0.090229 --> 0.089483).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0748742
	speed: 0.0947s/iter; left time: 625.1384s
	iters: 200, epoch: 5 | loss: 0.0967068
	speed: 0.0132s/iter; left time: 85.5681s
	iters: 300, epoch: 5 | loss: 0.0829071
	speed: 0.0133s/iter; left time: 85.0806s
	iters: 400, epoch: 5 | loss: 0.0808427
	speed: 0.0139s/iter; left time: 87.5107s
	iters: 500, epoch: 5 | loss: 0.1015615
	speed: 0.0135s/iter; left time: 83.9378s
	iters: 600, epoch: 5 | loss: 0.0834893
	speed: 0.0135s/iter; left time: 82.2072s
	iters: 700, epoch: 5 | loss: 0.0962709
	speed: 0.0136s/iter; left time: 81.4007s
	iters: 800, epoch: 5 | loss: 0.0781721
	speed: 0.0139s/iter; left time: 81.9144s
	iters: 900, epoch: 5 | loss: 0.1078568
	speed: 0.0139s/iter; left time: 80.5841s
	iters: 1000, epoch: 5 | loss: 0.1042197
	speed: 0.0146s/iter; left time: 83.2407s
	iters: 1100, epoch: 5 | loss: 0.0899117
	speed: 0.0138s/iter; left time: 77.5049s
Epoch: 5 cost time: 16.105695247650146
Epoch: 5, Steps: 1117 | Train Loss: 0.0978446 Vali Loss: 0.0887248 Test Loss: 0.0976152
Validation loss decreased (0.089483 --> 0.088725).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0892799
	speed: 0.0945s/iter; left time: 518.6600s
	iters: 200, epoch: 6 | loss: 0.0976934
	speed: 0.0135s/iter; left time: 72.6988s
	iters: 300, epoch: 6 | loss: 0.1005369
	speed: 0.0132s/iter; left time: 69.5368s
	iters: 400, epoch: 6 | loss: 0.0831221
	speed: 0.0140s/iter; left time: 72.8621s
	iters: 500, epoch: 6 | loss: 0.0828762
	speed: 0.0128s/iter; left time: 64.8587s
	iters: 600, epoch: 6 | loss: 0.1296525
	speed: 0.0135s/iter; left time: 67.1916s
	iters: 700, epoch: 6 | loss: 0.0987717
	speed: 0.0139s/iter; left time: 67.8949s
	iters: 800, epoch: 6 | loss: 0.1553631
	speed: 0.0137s/iter; left time: 65.4649s
	iters: 900, epoch: 6 | loss: 0.0871370
	speed: 0.0135s/iter; left time: 63.0931s
	iters: 1000, epoch: 6 | loss: 0.1488832
	speed: 0.0137s/iter; left time: 63.0484s
	iters: 1100, epoch: 6 | loss: 0.0892429
	speed: 0.0136s/iter; left time: 60.8393s
Epoch: 6 cost time: 15.816767454147339
Epoch: 6, Steps: 1117 | Train Loss: 0.0972504 Vali Loss: 0.0886715 Test Loss: 0.0974183
Validation loss decreased (0.088725 --> 0.088672).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0884912
	speed: 0.0959s/iter; left time: 418.9582s
	iters: 200, epoch: 7 | loss: 0.0931495
	speed: 0.0131s/iter; left time: 56.0261s
	iters: 300, epoch: 7 | loss: 0.1108183
	speed: 0.0140s/iter; left time: 58.4415s
	iters: 400, epoch: 7 | loss: 0.0832867
	speed: 0.0140s/iter; left time: 56.7725s
	iters: 500, epoch: 7 | loss: 0.0932089
	speed: 0.0136s/iter; left time: 53.8245s
	iters: 600, epoch: 7 | loss: 0.0851561
	speed: 0.0132s/iter; left time: 51.0750s
	iters: 700, epoch: 7 | loss: 0.0982770
	speed: 0.0138s/iter; left time: 52.0349s
	iters: 800, epoch: 7 | loss: 0.0975362
	speed: 0.0134s/iter; left time: 49.2600s
	iters: 900, epoch: 7 | loss: 0.1092866
	speed: 0.0144s/iter; left time: 51.2877s
	iters: 1000, epoch: 7 | loss: 0.0818895
	speed: 0.0140s/iter; left time: 48.4456s
	iters: 1100, epoch: 7 | loss: 0.0922836
	speed: 0.0137s/iter; left time: 46.0566s
Epoch: 7 cost time: 16.05127191543579
Epoch: 7, Steps: 1117 | Train Loss: 0.0969033 Vali Loss: 0.0886785 Test Loss: 0.0973862
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0840014
	speed: 0.0962s/iter; left time: 312.8646s
	iters: 200, epoch: 8 | loss: 0.0810251
	speed: 0.0140s/iter; left time: 44.1255s
	iters: 300, epoch: 8 | loss: 0.0897411
	speed: 0.0138s/iter; left time: 42.1181s
	iters: 400, epoch: 8 | loss: 0.0817395
	speed: 0.0131s/iter; left time: 38.6364s
	iters: 500, epoch: 8 | loss: 0.0833526
	speed: 0.0132s/iter; left time: 37.5735s
	iters: 600, epoch: 8 | loss: 0.0875351
	speed: 0.0136s/iter; left time: 37.4578s
	iters: 700, epoch: 8 | loss: 0.0859062
	speed: 0.0133s/iter; left time: 35.3637s
	iters: 800, epoch: 8 | loss: 0.0864230
	speed: 0.0132s/iter; left time: 33.5614s
	iters: 900, epoch: 8 | loss: 0.1034853
	speed: 0.0135s/iter; left time: 33.1337s
	iters: 1000, epoch: 8 | loss: 0.0806720
	speed: 0.0136s/iter; left time: 32.0215s
	iters: 1100, epoch: 8 | loss: 0.0859226
	speed: 0.0133s/iter; left time: 29.9170s
Epoch: 8 cost time: 15.83819031715393
Epoch: 8, Steps: 1117 | Train Loss: 0.0967161 Vali Loss: 0.0883660 Test Loss: 0.0972033
Validation loss decreased (0.088672 --> 0.088366).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0910434
	speed: 0.0956s/iter; left time: 204.1661s
	iters: 200, epoch: 9 | loss: 0.0962722
	speed: 0.0132s/iter; left time: 26.9302s
	iters: 300, epoch: 9 | loss: 0.1088646
	speed: 0.0128s/iter; left time: 24.8450s
	iters: 400, epoch: 9 | loss: 0.0890388
	speed: 0.0133s/iter; left time: 24.3647s
	iters: 500, epoch: 9 | loss: 0.0809837
	speed: 0.0130s/iter; left time: 22.6193s
	iters: 600, epoch: 9 | loss: 0.1061161
	speed: 0.0135s/iter; left time: 22.0524s
	iters: 700, epoch: 9 | loss: 0.1003925
	speed: 0.0131s/iter; left time: 20.1212s
	iters: 800, epoch: 9 | loss: 0.1058296
	speed: 0.0132s/iter; left time: 18.9427s
	iters: 900, epoch: 9 | loss: 0.1166420
	speed: 0.0137s/iter; left time: 18.2388s
	iters: 1000, epoch: 9 | loss: 0.0916648
	speed: 0.0141s/iter; left time: 17.4016s
	iters: 1100, epoch: 9 | loss: 0.0774054
	speed: 0.0129s/iter; left time: 14.6959s
Epoch: 9 cost time: 15.720279693603516
Epoch: 9, Steps: 1117 | Train Loss: 0.0966134 Vali Loss: 0.0882911 Test Loss: 0.0970584
Validation loss decreased (0.088366 --> 0.088291).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1465380
	speed: 0.0961s/iter; left time: 97.8784s
	iters: 200, epoch: 10 | loss: 0.0831871
	speed: 0.0126s/iter; left time: 11.6036s
	iters: 300, epoch: 10 | loss: 0.0888221
	speed: 0.0133s/iter; left time: 10.8868s
	iters: 400, epoch: 10 | loss: 0.0990340
	speed: 0.0137s/iter; left time: 9.8194s
	iters: 500, epoch: 10 | loss: 0.0958782
	speed: 0.0128s/iter; left time: 7.9163s
	iters: 600, epoch: 10 | loss: 0.1094709
	speed: 0.0138s/iter; left time: 7.1695s
	iters: 700, epoch: 10 | loss: 0.0878346
	speed: 0.0140s/iter; left time: 5.8332s
	iters: 800, epoch: 10 | loss: 0.0847790
	speed: 0.0124s/iter; left time: 3.9444s
	iters: 900, epoch: 10 | loss: 0.0943389
	speed: 0.0139s/iter; left time: 3.0259s
	iters: 1000, epoch: 10 | loss: 0.1013481
	speed: 0.0150s/iter; left time: 1.7643s
	iters: 1100, epoch: 10 | loss: 0.1062596
	speed: 0.0137s/iter; left time: 0.2461s
Epoch: 10 cost time: 15.771120309829712
Epoch: 10, Steps: 1117 | Train Loss: 0.0965649 Vali Loss: 0.0882932 Test Loss: 0.0970480
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_504_24_GRevagLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.09672999382019043, mae:0.1931590884923935
