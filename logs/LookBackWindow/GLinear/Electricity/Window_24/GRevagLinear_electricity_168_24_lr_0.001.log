Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='Electricity_168_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=168, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_168_24_GRevagLinear_custom_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1440060
	speed: 0.0168s/iter; left time: 189.9581s
	iters: 200, epoch: 1 | loss: 0.1192807
	speed: 0.0087s/iter; left time: 96.7738s
	iters: 300, epoch: 1 | loss: 0.1292709
	speed: 0.0083s/iter; left time: 91.5660s
	iters: 400, epoch: 1 | loss: 0.1312576
	speed: 0.0085s/iter; left time: 93.4758s
	iters: 500, epoch: 1 | loss: 0.1117796
	speed: 0.0087s/iter; left time: 94.5978s
	iters: 600, epoch: 1 | loss: 0.1221091
	speed: 0.0090s/iter; left time: 96.6559s
	iters: 700, epoch: 1 | loss: 0.1094280
	speed: 0.0085s/iter; left time: 91.2666s
	iters: 800, epoch: 1 | loss: 0.1135935
	speed: 0.0086s/iter; left time: 91.0443s
	iters: 900, epoch: 1 | loss: 0.1703612
	speed: 0.0087s/iter; left time: 91.1950s
	iters: 1000, epoch: 1 | loss: 0.1122007
	speed: 0.0089s/iter; left time: 92.8212s
	iters: 1100, epoch: 1 | loss: 0.1920290
	speed: 0.0088s/iter; left time: 90.6088s
Epoch: 1 cost time: 10.764696836471558
Epoch: 1, Steps: 1138 | Train Loss: 0.1337884 Vali Loss: 0.1052100 Test Loss: 0.1155401
Validation loss decreased (inf --> 0.105210).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1288687
	speed: 0.0661s/iter; left time: 670.6081s
	iters: 200, epoch: 2 | loss: 0.1033885
	speed: 0.0090s/iter; left time: 90.2371s
	iters: 300, epoch: 2 | loss: 0.1156105
	speed: 0.0091s/iter; left time: 90.1299s
	iters: 400, epoch: 2 | loss: 0.1064069
	speed: 0.0090s/iter; left time: 88.4899s
	iters: 500, epoch: 2 | loss: 0.1529825
	speed: 0.0091s/iter; left time: 89.1196s
	iters: 600, epoch: 2 | loss: 0.1258632
	speed: 0.0086s/iter; left time: 82.6272s
	iters: 700, epoch: 2 | loss: 0.1082370
	speed: 0.0085s/iter; left time: 80.8247s
	iters: 800, epoch: 2 | loss: 0.1142284
	speed: 0.0087s/iter; left time: 82.5906s
	iters: 900, epoch: 2 | loss: 0.1073776
	speed: 0.0084s/iter; left time: 78.4225s
	iters: 1000, epoch: 2 | loss: 0.1034704
	speed: 0.0087s/iter; left time: 80.3513s
	iters: 1100, epoch: 2 | loss: 0.1077218
	speed: 0.0095s/iter; left time: 86.5864s
Epoch: 2 cost time: 10.756838321685791
Epoch: 2, Steps: 1138 | Train Loss: 0.1153217 Vali Loss: 0.1016154 Test Loss: 0.1112141
Validation loss decreased (0.105210 --> 0.101615).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1127784
	speed: 0.0705s/iter; left time: 634.5951s
	iters: 200, epoch: 3 | loss: 0.1403371
	speed: 0.0084s/iter; left time: 75.1225s
	iters: 300, epoch: 3 | loss: 0.0947256
	speed: 0.0084s/iter; left time: 73.6977s
	iters: 400, epoch: 3 | loss: 0.1065146
	speed: 0.0084s/iter; left time: 73.1479s
	iters: 500, epoch: 3 | loss: 0.1081460
	speed: 0.0083s/iter; left time: 71.3439s
	iters: 600, epoch: 3 | loss: 0.1045700
	speed: 0.0084s/iter; left time: 71.1752s
	iters: 700, epoch: 3 | loss: 0.1068624
	speed: 0.0083s/iter; left time: 69.6914s
	iters: 800, epoch: 3 | loss: 0.0998584
	speed: 0.0089s/iter; left time: 74.0544s
	iters: 900, epoch: 3 | loss: 0.1062011
	speed: 0.0085s/iter; left time: 69.5259s
	iters: 1000, epoch: 3 | loss: 0.0977080
	speed: 0.0084s/iter; left time: 67.9172s
	iters: 1100, epoch: 3 | loss: 0.1082731
	speed: 0.0085s/iter; left time: 68.0153s
Epoch: 3 cost time: 10.42157244682312
Epoch: 3, Steps: 1138 | Train Loss: 0.1097182 Vali Loss: 0.0982424 Test Loss: 0.1071168
Validation loss decreased (0.101615 --> 0.098242).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1040359
	speed: 0.0707s/iter; left time: 556.4582s
	iters: 200, epoch: 4 | loss: 0.1241642
	speed: 0.0089s/iter; left time: 68.9885s
	iters: 300, epoch: 4 | loss: 0.1865323
	speed: 0.0086s/iter; left time: 66.1955s
	iters: 400, epoch: 4 | loss: 0.1044849
	speed: 0.0083s/iter; left time: 63.1213s
	iters: 500, epoch: 4 | loss: 0.0946486
	speed: 0.0081s/iter; left time: 60.2635s
	iters: 600, epoch: 4 | loss: 0.0936460
	speed: 0.0080s/iter; left time: 59.1869s
	iters: 700, epoch: 4 | loss: 0.0960395
	speed: 0.0080s/iter; left time: 58.3191s
	iters: 800, epoch: 4 | loss: 0.1058189
	speed: 0.0081s/iter; left time: 57.8924s
	iters: 900, epoch: 4 | loss: 0.1179569
	speed: 0.0082s/iter; left time: 57.6085s
	iters: 1000, epoch: 4 | loss: 0.1133146
	speed: 0.0091s/iter; left time: 63.2285s
	iters: 1100, epoch: 4 | loss: 0.1051026
	speed: 0.0084s/iter; left time: 57.7507s
Epoch: 4 cost time: 10.384517669677734
Epoch: 4, Steps: 1138 | Train Loss: 0.1075676 Vali Loss: 0.0976319 Test Loss: 0.1065156
Validation loss decreased (0.098242 --> 0.097632).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1027067
	speed: 0.0696s/iter; left time: 468.3128s
	iters: 200, epoch: 5 | loss: 0.0971636
	speed: 0.0084s/iter; left time: 55.9581s
	iters: 300, epoch: 5 | loss: 0.1134194
	speed: 0.0086s/iter; left time: 55.9003s
	iters: 400, epoch: 5 | loss: 0.1062645
	speed: 0.0083s/iter; left time: 53.5853s
	iters: 500, epoch: 5 | loss: 0.0950306
	speed: 0.0084s/iter; left time: 53.2369s
	iters: 600, epoch: 5 | loss: 0.1322086
	speed: 0.0086s/iter; left time: 53.4254s
	iters: 700, epoch: 5 | loss: 0.0929024
	speed: 0.0088s/iter; left time: 53.8480s
	iters: 800, epoch: 5 | loss: 0.0885652
	speed: 0.0083s/iter; left time: 50.3297s
	iters: 900, epoch: 5 | loss: 0.0875989
	speed: 0.0084s/iter; left time: 49.6015s
	iters: 1000, epoch: 5 | loss: 0.1153065
	speed: 0.0087s/iter; left time: 50.7048s
	iters: 1100, epoch: 5 | loss: 0.0926013
	speed: 0.0089s/iter; left time: 50.9427s
Epoch: 5 cost time: 10.43583607673645
Epoch: 5, Steps: 1138 | Train Loss: 0.1068849 Vali Loss: 0.0972109 Test Loss: 0.1060720
Validation loss decreased (0.097632 --> 0.097211).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1022289
	speed: 0.0708s/iter; left time: 395.5882s
	iters: 200, epoch: 6 | loss: 0.0943649
	speed: 0.0088s/iter; left time: 48.2765s
	iters: 300, epoch: 6 | loss: 0.1125330
	speed: 0.0092s/iter; left time: 49.6759s
	iters: 400, epoch: 6 | loss: 0.1165733
	speed: 0.0089s/iter; left time: 47.0093s
	iters: 500, epoch: 6 | loss: 0.1310743
	speed: 0.0087s/iter; left time: 44.9199s
	iters: 600, epoch: 6 | loss: 0.0987913
	speed: 0.0089s/iter; left time: 45.1919s
	iters: 700, epoch: 6 | loss: 0.1000524
	speed: 0.0090s/iter; left time: 44.8697s
	iters: 800, epoch: 6 | loss: 0.1452241
	speed: 0.0089s/iter; left time: 43.3451s
	iters: 900, epoch: 6 | loss: 0.0978735
	speed: 0.0088s/iter; left time: 42.2959s
	iters: 1000, epoch: 6 | loss: 0.1057931
	speed: 0.0093s/iter; left time: 43.7325s
	iters: 1100, epoch: 6 | loss: 0.0985082
	speed: 0.0088s/iter; left time: 40.2636s
Epoch: 6 cost time: 11.046838760375977
Epoch: 6, Steps: 1138 | Train Loss: 0.1064971 Vali Loss: 0.0970507 Test Loss: 0.1058384
Validation loss decreased (0.097211 --> 0.097051).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0950425
	speed: 0.0713s/iter; left time: 317.3689s
	iters: 200, epoch: 7 | loss: 0.0936825
	speed: 0.0089s/iter; left time: 38.5704s
	iters: 300, epoch: 7 | loss: 0.1042087
	speed: 0.0087s/iter; left time: 37.1086s
	iters: 400, epoch: 7 | loss: 0.0918020
	speed: 0.0095s/iter; left time: 39.4250s
	iters: 500, epoch: 7 | loss: 0.0898666
	speed: 0.0091s/iter; left time: 37.0562s
	iters: 600, epoch: 7 | loss: 0.1119683
	speed: 0.0086s/iter; left time: 34.1815s
	iters: 700, epoch: 7 | loss: 0.1105539
	speed: 0.0088s/iter; left time: 34.0849s
	iters: 800, epoch: 7 | loss: 0.1092583
	speed: 0.0085s/iter; left time: 31.9984s
	iters: 900, epoch: 7 | loss: 0.1045888
	speed: 0.0086s/iter; left time: 31.3336s
	iters: 1000, epoch: 7 | loss: 0.1033183
	speed: 0.0087s/iter; left time: 30.9958s
	iters: 1100, epoch: 7 | loss: 0.1047150
	speed: 0.0088s/iter; left time: 30.3180s
Epoch: 7 cost time: 10.882659196853638
Epoch: 7, Steps: 1138 | Train Loss: 0.1063581 Vali Loss: 0.0970458 Test Loss: 0.1056853
Validation loss decreased (0.097051 --> 0.097046).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1203560
	speed: 0.0727s/iter; left time: 241.0209s
	iters: 200, epoch: 8 | loss: 0.1114662
	speed: 0.0089s/iter; left time: 28.4803s
	iters: 300, epoch: 8 | loss: 0.1131897
	speed: 0.0090s/iter; left time: 28.0280s
	iters: 400, epoch: 8 | loss: 0.1642194
	speed: 0.0094s/iter; left time: 28.3989s
	iters: 500, epoch: 8 | loss: 0.1026523
	speed: 0.0098s/iter; left time: 28.6591s
	iters: 600, epoch: 8 | loss: 0.0958964
	speed: 0.0096s/iter; left time: 26.9073s
	iters: 700, epoch: 8 | loss: 0.0946873
	speed: 0.0086s/iter; left time: 23.3365s
	iters: 800, epoch: 8 | loss: 0.1028668
	speed: 0.0085s/iter; left time: 22.1866s
	iters: 900, epoch: 8 | loss: 0.0912398
	speed: 0.0086s/iter; left time: 21.6153s
	iters: 1000, epoch: 8 | loss: 0.1015404
	speed: 0.0086s/iter; left time: 20.7809s
	iters: 1100, epoch: 8 | loss: 0.1303157
	speed: 0.0087s/iter; left time: 20.0448s
Epoch: 8 cost time: 11.070407629013062
Epoch: 8, Steps: 1138 | Train Loss: 0.1062558 Vali Loss: 0.0969874 Test Loss: 0.1056319
Validation loss decreased (0.097046 --> 0.096987).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0912175
	speed: 0.0721s/iter; left time: 157.0328s
	iters: 200, epoch: 9 | loss: 0.1029802
	speed: 0.0095s/iter; left time: 19.6633s
	iters: 300, epoch: 9 | loss: 0.1045741
	speed: 0.0087s/iter; left time: 17.2603s
	iters: 400, epoch: 9 | loss: 0.1023031
	speed: 0.0092s/iter; left time: 17.2721s
	iters: 500, epoch: 9 | loss: 0.1046071
	speed: 0.0089s/iter; left time: 15.8569s
	iters: 600, epoch: 9 | loss: 0.1278605
	speed: 0.0089s/iter; left time: 14.8475s
	iters: 700, epoch: 9 | loss: 0.0934558
	speed: 0.0091s/iter; left time: 14.3446s
	iters: 800, epoch: 9 | loss: 0.0970249
	speed: 0.0096s/iter; left time: 14.2434s
	iters: 900, epoch: 9 | loss: 0.1270628
	speed: 0.0090s/iter; left time: 12.3585s
	iters: 1000, epoch: 9 | loss: 0.1753133
	speed: 0.0091s/iter; left time: 11.5634s
	iters: 1100, epoch: 9 | loss: 0.0991547
	speed: 0.0093s/iter; left time: 10.9335s
Epoch: 9 cost time: 11.223573446273804
Epoch: 9, Steps: 1138 | Train Loss: 0.1061986 Vali Loss: 0.0968935 Test Loss: 0.1055919
Validation loss decreased (0.096987 --> 0.096894).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0934821
	speed: 0.0727s/iter; left time: 75.5339s
	iters: 200, epoch: 10 | loss: 0.1085544
	speed: 0.0089s/iter; left time: 8.3885s
	iters: 300, epoch: 10 | loss: 0.0885467
	speed: 0.0089s/iter; left time: 7.4888s
	iters: 400, epoch: 10 | loss: 0.0955688
	speed: 0.0088s/iter; left time: 6.5092s
	iters: 500, epoch: 10 | loss: 0.1031556
	speed: 0.0097s/iter; left time: 6.2109s
	iters: 600, epoch: 10 | loss: 0.1032505
	speed: 0.0096s/iter; left time: 5.1800s
	iters: 700, epoch: 10 | loss: 0.0960815
	speed: 0.0085s/iter; left time: 3.7379s
	iters: 800, epoch: 10 | loss: 0.1052663
	speed: 0.0086s/iter; left time: 2.9205s
	iters: 900, epoch: 10 | loss: 0.1026918
	speed: 0.0091s/iter; left time: 2.1738s
	iters: 1000, epoch: 10 | loss: 0.1110927
	speed: 0.0090s/iter; left time: 1.2441s
	iters: 1100, epoch: 10 | loss: 0.1039592
	speed: 0.0086s/iter; left time: 0.3363s
Epoch: 10 cost time: 11.0654616355896
Epoch: 10, Steps: 1138 | Train Loss: 0.1061813 Vali Loss: 0.0968547 Test Loss: 0.1055675
Validation loss decreased (0.096894 --> 0.096855).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_168_24_GRevagLinear_custom_ftM_sl168_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10527213662862778, mae:0.20186680555343628
