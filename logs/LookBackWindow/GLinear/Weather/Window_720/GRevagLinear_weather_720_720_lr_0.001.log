Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='weather_720_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_720_GRevagLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35448
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7889935
	speed: 0.0121s/iter; left time: 267.3121s
	iters: 200, epoch: 1 | loss: 0.7084032
	speed: 0.0068s/iter; left time: 149.9188s
	iters: 300, epoch: 1 | loss: 0.6534663
	speed: 0.0068s/iter; left time: 147.8156s
	iters: 400, epoch: 1 | loss: 0.4190297
	speed: 0.0070s/iter; left time: 151.9975s
	iters: 500, epoch: 1 | loss: 0.6784393
	speed: 0.0077s/iter; left time: 165.6630s
	iters: 600, epoch: 1 | loss: 0.4728592
	speed: 0.0069s/iter; left time: 148.6683s
	iters: 700, epoch: 1 | loss: 0.7805680
	speed: 0.0069s/iter; left time: 148.1631s
	iters: 800, epoch: 1 | loss: 0.4772534
	speed: 0.0072s/iter; left time: 153.1430s
	iters: 900, epoch: 1 | loss: 0.4483816
	speed: 0.0067s/iter; left time: 142.6223s
	iters: 1000, epoch: 1 | loss: 0.6118258
	speed: 0.0067s/iter; left time: 140.7245s
	iters: 1100, epoch: 1 | loss: 0.5507049
	speed: 0.0077s/iter; left time: 161.4554s
	iters: 1200, epoch: 1 | loss: 0.4693159
	speed: 0.0071s/iter; left time: 148.5034s
	iters: 1300, epoch: 1 | loss: 0.4751984
	speed: 0.0073s/iter; left time: 152.1201s
	iters: 1400, epoch: 1 | loss: 0.5684544
	speed: 0.0071s/iter; left time: 146.4793s
	iters: 1500, epoch: 1 | loss: 0.4331194
	speed: 0.0072s/iter; left time: 147.7354s
	iters: 1600, epoch: 1 | loss: 0.3853557
	speed: 0.0070s/iter; left time: 142.9314s
	iters: 1700, epoch: 1 | loss: 0.6764161
	speed: 0.0072s/iter; left time: 146.7466s
	iters: 1800, epoch: 1 | loss: 0.5393355
	speed: 0.0068s/iter; left time: 137.7936s
	iters: 1900, epoch: 1 | loss: 0.6482736
	speed: 0.0068s/iter; left time: 137.7456s
	iters: 2000, epoch: 1 | loss: 0.5061113
	speed: 0.0071s/iter; left time: 142.9563s
	iters: 2100, epoch: 1 | loss: 0.5041581
	speed: 0.0071s/iter; left time: 142.6352s
	iters: 2200, epoch: 1 | loss: 0.3754897
	speed: 0.0077s/iter; left time: 154.1074s
Epoch: 1 cost time: 16.259793519973755
Epoch: 1, Steps: 2215 | Train Loss: 0.5746428 Vali Loss: 0.6049265 Test Loss: 0.3223468
Validation loss decreased (inf --> 0.604927).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5336861
	speed: 0.0819s/iter; left time: 1623.7752s
	iters: 200, epoch: 2 | loss: 0.4964085
	speed: 0.0071s/iter; left time: 140.4222s
	iters: 300, epoch: 2 | loss: 0.5798873
	speed: 0.0070s/iter; left time: 137.5719s
	iters: 400, epoch: 2 | loss: 0.4092771
	speed: 0.0072s/iter; left time: 141.2142s
	iters: 500, epoch: 2 | loss: 0.5360150
	speed: 0.0076s/iter; left time: 148.5915s
	iters: 600, epoch: 2 | loss: 0.4682454
	speed: 0.0077s/iter; left time: 148.0940s
	iters: 700, epoch: 2 | loss: 0.4863742
	speed: 0.0076s/iter; left time: 146.2778s
	iters: 800, epoch: 2 | loss: 0.4197089
	speed: 0.0068s/iter; left time: 129.7411s
	iters: 900, epoch: 2 | loss: 0.6581358
	speed: 0.0068s/iter; left time: 129.4462s
	iters: 1000, epoch: 2 | loss: 0.9334584
	speed: 0.0071s/iter; left time: 134.4785s
	iters: 1100, epoch: 2 | loss: 0.4515659
	speed: 0.0072s/iter; left time: 135.1058s
	iters: 1200, epoch: 2 | loss: 0.4718356
	speed: 0.0069s/iter; left time: 129.1061s
	iters: 1300, epoch: 2 | loss: 0.5613359
	speed: 0.0074s/iter; left time: 137.6527s
	iters: 1400, epoch: 2 | loss: 0.4676410
	speed: 0.0070s/iter; left time: 130.1073s
	iters: 1500, epoch: 2 | loss: 0.4655497
	speed: 0.0066s/iter; left time: 122.2238s
	iters: 1600, epoch: 2 | loss: 0.3303407
	speed: 0.0068s/iter; left time: 125.4116s
	iters: 1700, epoch: 2 | loss: 0.3606909
	speed: 0.0068s/iter; left time: 124.5964s
	iters: 1800, epoch: 2 | loss: 0.3744220
	speed: 0.0072s/iter; left time: 130.3634s
	iters: 1900, epoch: 2 | loss: 0.5117469
	speed: 0.0069s/iter; left time: 124.8873s
	iters: 2000, epoch: 2 | loss: 0.4602959
	speed: 0.0072s/iter; left time: 128.3218s
	iters: 2100, epoch: 2 | loss: 0.4090725
	speed: 0.0072s/iter; left time: 127.6769s
	iters: 2200, epoch: 2 | loss: 0.5073294
	speed: 0.0076s/iter; left time: 134.6625s
Epoch: 2 cost time: 16.463615894317627
Epoch: 2, Steps: 2215 | Train Loss: 0.5200632 Vali Loss: 0.6260075 Test Loss: 0.3549514
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3505269
	speed: 0.0782s/iter; left time: 1378.1512s
	iters: 200, epoch: 3 | loss: 0.5003006
	speed: 0.0071s/iter; left time: 124.7180s
	iters: 300, epoch: 3 | loss: 0.4657342
	speed: 0.0071s/iter; left time: 123.4257s
	iters: 400, epoch: 3 | loss: 0.5714477
	speed: 0.0069s/iter; left time: 119.8210s
	iters: 500, epoch: 3 | loss: 0.4478261
	speed: 0.0068s/iter; left time: 117.2893s
	iters: 600, epoch: 3 | loss: 0.2844896
	speed: 0.0068s/iter; left time: 116.1243s
	iters: 700, epoch: 3 | loss: 0.4447684
	speed: 0.0071s/iter; left time: 121.3252s
	iters: 800, epoch: 3 | loss: 0.3179976
	speed: 0.0071s/iter; left time: 119.8447s
	iters: 900, epoch: 3 | loss: 0.4038865
	speed: 0.0070s/iter; left time: 118.1644s
	iters: 1000, epoch: 3 | loss: 0.5934821
	speed: 0.0071s/iter; left time: 118.9161s
	iters: 1100, epoch: 3 | loss: 0.3560783
	speed: 0.0072s/iter; left time: 119.9471s
	iters: 1200, epoch: 3 | loss: 0.6095238
	speed: 0.0072s/iter; left time: 118.4182s
	iters: 1300, epoch: 3 | loss: 0.8071560
	speed: 0.0069s/iter; left time: 112.7553s
	iters: 1400, epoch: 3 | loss: 0.4031807
	speed: 0.0069s/iter; left time: 112.7825s
	iters: 1500, epoch: 3 | loss: 0.3281444
	speed: 0.0069s/iter; left time: 111.2374s
	iters: 1600, epoch: 3 | loss: 0.4740707
	speed: 0.0074s/iter; left time: 118.9479s
	iters: 1700, epoch: 3 | loss: 0.6471974
	speed: 0.0068s/iter; left time: 109.4211s
	iters: 1800, epoch: 3 | loss: 0.3907763
	speed: 0.0067s/iter; left time: 106.3972s
	iters: 1900, epoch: 3 | loss: 0.4237316
	speed: 0.0066s/iter; left time: 105.0923s
	iters: 2000, epoch: 3 | loss: 0.3541274
	speed: 0.0066s/iter; left time: 104.4693s
	iters: 2100, epoch: 3 | loss: 0.3022326
	speed: 0.0069s/iter; left time: 108.3891s
	iters: 2200, epoch: 3 | loss: 0.2996833
	speed: 0.0071s/iter; left time: 110.0314s
Epoch: 3 cost time: 16.08751678466797
Epoch: 3, Steps: 2215 | Train Loss: 0.4596043 Vali Loss: 0.6650928 Test Loss: 0.3662241
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4935061
	speed: 0.0817s/iter; left time: 1258.2472s
	iters: 200, epoch: 4 | loss: 0.4463043
	speed: 0.0070s/iter; left time: 107.3023s
	iters: 300, epoch: 4 | loss: 0.3025814
	speed: 0.0069s/iter; left time: 104.4445s
	iters: 400, epoch: 4 | loss: 0.3062959
	speed: 0.0075s/iter; left time: 112.7679s
	iters: 500, epoch: 4 | loss: 0.2883524
	speed: 0.0076s/iter; left time: 114.4541s
	iters: 600, epoch: 4 | loss: 0.3992826
	speed: 0.0074s/iter; left time: 110.4657s
	iters: 700, epoch: 4 | loss: 0.2889421
	speed: 0.0072s/iter; left time: 106.6655s
	iters: 800, epoch: 4 | loss: 0.3747610
	speed: 0.0072s/iter; left time: 105.1815s
	iters: 900, epoch: 4 | loss: 0.5606335
	speed: 0.0071s/iter; left time: 104.0979s
	iters: 1000, epoch: 4 | loss: 0.3907306
	speed: 0.0070s/iter; left time: 100.8561s
	iters: 1100, epoch: 4 | loss: 0.3579685
	speed: 0.0069s/iter; left time: 99.4437s
	iters: 1200, epoch: 4 | loss: 0.4717591
	speed: 0.0073s/iter; left time: 104.7650s
	iters: 1300, epoch: 4 | loss: 0.4090624
	speed: 0.0071s/iter; left time: 101.4032s
	iters: 1400, epoch: 4 | loss: 0.4080471
	speed: 0.0071s/iter; left time: 99.9989s
	iters: 1500, epoch: 4 | loss: 0.3079010
	speed: 0.0072s/iter; left time: 101.3079s
	iters: 1600, epoch: 4 | loss: 0.3049535
	speed: 0.0071s/iter; left time: 98.7552s
	iters: 1700, epoch: 4 | loss: 0.4300488
	speed: 0.0072s/iter; left time: 98.9481s
	iters: 1800, epoch: 4 | loss: 0.5510402
	speed: 0.0072s/iter; left time: 99.3199s
	iters: 1900, epoch: 4 | loss: 0.3537283
	speed: 0.0073s/iter; left time: 98.9186s
	iters: 2000, epoch: 4 | loss: 0.3662319
	speed: 0.0071s/iter; left time: 95.2315s
	iters: 2100, epoch: 4 | loss: 0.3604685
	speed: 0.0072s/iter; left time: 96.3131s
	iters: 2200, epoch: 4 | loss: 0.2964002
	speed: 0.0069s/iter; left time: 92.1601s
Epoch: 4 cost time: 16.523324966430664
Epoch: 4, Steps: 2215 | Train Loss: 0.4329713 Vali Loss: 0.6700121 Test Loss: 0.3771077
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_720_GRevagLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32224372029304504, mae:0.33541569113731384
