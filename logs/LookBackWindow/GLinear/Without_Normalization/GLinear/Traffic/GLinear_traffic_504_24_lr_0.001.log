Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='traffic_504_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=504, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_504_24_GLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1733
test 3485
	iters: 100, epoch: 1 | loss: 0.2202049
	speed: 0.0330s/iter; left time: 238.6430s
	iters: 200, epoch: 1 | loss: 0.1955460
	speed: 0.0254s/iter; left time: 181.4329s
	iters: 300, epoch: 1 | loss: 0.1872766
	speed: 0.0250s/iter; left time: 175.7941s
	iters: 400, epoch: 1 | loss: 0.2419938
	speed: 0.0251s/iter; left time: 173.9481s
	iters: 500, epoch: 1 | loss: 0.2110970
	speed: 0.0254s/iter; left time: 173.6578s
	iters: 600, epoch: 1 | loss: 0.1836223
	speed: 0.0250s/iter; left time: 168.2001s
	iters: 700, epoch: 1 | loss: 0.2997232
	speed: 0.0253s/iter; left time: 167.7013s
Epoch: 1 cost time: 19.33583116531372
Epoch: 1, Steps: 734 | Train Loss: 0.2354147 Vali Loss: 0.3187262 Test Loss: 0.3563597
Validation loss decreased (inf --> 0.318726).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2003034
	speed: 0.1435s/iter; left time: 933.6820s
	iters: 200, epoch: 2 | loss: 0.2496613
	speed: 0.0247s/iter; left time: 158.4696s
	iters: 300, epoch: 2 | loss: 0.2173365
	speed: 0.0252s/iter; left time: 158.7830s
	iters: 400, epoch: 2 | loss: 0.2338540
	speed: 0.0260s/iter; left time: 161.5063s
	iters: 500, epoch: 2 | loss: 0.2145396
	speed: 0.0253s/iter; left time: 154.7587s
	iters: 600, epoch: 2 | loss: 0.2164639
	speed: 0.0255s/iter; left time: 153.4560s
	iters: 700, epoch: 2 | loss: 0.2139314
	speed: 0.0261s/iter; left time: 153.8964s
Epoch: 2 cost time: 19.685222864151
Epoch: 2, Steps: 734 | Train Loss: 0.2158770 Vali Loss: 0.3164492 Test Loss: 0.3512852
Validation loss decreased (0.318726 --> 0.316449).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2038361
	speed: 0.1465s/iter; left time: 845.8052s
	iters: 200, epoch: 3 | loss: 0.1918281
	speed: 0.0254s/iter; left time: 144.2752s
	iters: 300, epoch: 3 | loss: 0.1628878
	speed: 0.0253s/iter; left time: 141.0181s
	iters: 400, epoch: 3 | loss: 0.1680680
	speed: 0.0251s/iter; left time: 137.3093s
	iters: 500, epoch: 3 | loss: 0.2174792
	speed: 0.0256s/iter; left time: 137.7781s
	iters: 600, epoch: 3 | loss: 0.2108515
	speed: 0.0249s/iter; left time: 131.2594s
	iters: 700, epoch: 3 | loss: 0.2070556
	speed: 0.0250s/iter; left time: 129.5812s
Epoch: 3 cost time: 19.56143307685852
Epoch: 3, Steps: 734 | Train Loss: 0.2070773 Vali Loss: 0.3071075 Test Loss: 0.3396570
Validation loss decreased (0.316449 --> 0.307108).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2105919
	speed: 0.1431s/iter; left time: 721.0690s
	iters: 200, epoch: 4 | loss: 0.2406658
	speed: 0.0247s/iter; left time: 121.9617s
	iters: 300, epoch: 4 | loss: 0.1722964
	speed: 0.0250s/iter; left time: 120.7919s
	iters: 400, epoch: 4 | loss: 0.1817578
	speed: 0.0250s/iter; left time: 118.4065s
	iters: 500, epoch: 4 | loss: 0.1746147
	speed: 0.0246s/iter; left time: 114.0728s
	iters: 600, epoch: 4 | loss: 0.1880050
	speed: 0.0251s/iter; left time: 114.0412s
	iters: 700, epoch: 4 | loss: 0.1976523
	speed: 0.0249s/iter; left time: 110.3572s
Epoch: 4 cost time: 19.248568773269653
Epoch: 4, Steps: 734 | Train Loss: 0.2028814 Vali Loss: 0.3054109 Test Loss: 0.3356339
Validation loss decreased (0.307108 --> 0.305411).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2210242
	speed: 0.1443s/iter; left time: 621.0480s
	iters: 200, epoch: 5 | loss: 0.1765242
	speed: 0.0252s/iter; left time: 106.0076s
	iters: 300, epoch: 5 | loss: 0.1871152
	speed: 0.0251s/iter; left time: 103.0605s
	iters: 400, epoch: 5 | loss: 0.1597933
	speed: 0.0249s/iter; left time: 99.6284s
	iters: 500, epoch: 5 | loss: 0.2062962
	speed: 0.0254s/iter; left time: 99.0910s
	iters: 600, epoch: 5 | loss: 0.1810842
	speed: 0.0250s/iter; left time: 95.1350s
	iters: 700, epoch: 5 | loss: 0.2021985
	speed: 0.0251s/iter; left time: 93.1075s
Epoch: 5 cost time: 19.482587814331055
Epoch: 5, Steps: 734 | Train Loss: 0.2008759 Vali Loss: 0.3030931 Test Loss: 0.3325320
Validation loss decreased (0.305411 --> 0.303093).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2469928
	speed: 0.1447s/iter; left time: 516.8092s
	iters: 200, epoch: 6 | loss: 0.1926047
	speed: 0.0247s/iter; left time: 85.8988s
	iters: 300, epoch: 6 | loss: 0.1589808
	speed: 0.0244s/iter; left time: 82.3610s
	iters: 400, epoch: 6 | loss: 0.1939117
	speed: 0.0247s/iter; left time: 80.8280s
	iters: 500, epoch: 6 | loss: 0.2255105
	speed: 0.0245s/iter; left time: 77.7018s
	iters: 600, epoch: 6 | loss: 0.2942446
	speed: 0.0252s/iter; left time: 77.3003s
	iters: 700, epoch: 6 | loss: 0.1690854
	speed: 0.0246s/iter; left time: 73.0217s
Epoch: 6 cost time: 19.18256640434265
Epoch: 6, Steps: 734 | Train Loss: 0.1996993 Vali Loss: 0.3018956 Test Loss: 0.3307463
Validation loss decreased (0.303093 --> 0.301896).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1701975
	speed: 0.1445s/iter; left time: 409.8504s
	iters: 200, epoch: 7 | loss: 0.3264553
	speed: 0.0256s/iter; left time: 70.1672s
	iters: 300, epoch: 7 | loss: 0.2048645
	speed: 0.0250s/iter; left time: 65.8095s
	iters: 400, epoch: 7 | loss: 0.1953905
	speed: 0.0250s/iter; left time: 63.5310s
	iters: 500, epoch: 7 | loss: 0.1781140
	speed: 0.0248s/iter; left time: 60.3357s
	iters: 600, epoch: 7 | loss: 0.1989666
	speed: 0.0251s/iter; left time: 58.6797s
	iters: 700, epoch: 7 | loss: 0.2111555
	speed: 0.0247s/iter; left time: 55.2345s
Epoch: 7 cost time: 19.38520312309265
Epoch: 7, Steps: 734 | Train Loss: 0.1989765 Vali Loss: 0.3012734 Test Loss: 0.3299784
Validation loss decreased (0.301896 --> 0.301273).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1945827
	speed: 0.1426s/iter; left time: 299.8935s
	iters: 200, epoch: 8 | loss: 0.2499677
	speed: 0.0250s/iter; left time: 50.0987s
	iters: 300, epoch: 8 | loss: 0.2246300
	speed: 0.0252s/iter; left time: 47.9228s
	iters: 400, epoch: 8 | loss: 0.2150941
	speed: 0.0244s/iter; left time: 43.9334s
	iters: 500, epoch: 8 | loss: 0.1790938
	speed: 0.0253s/iter; left time: 43.1608s
	iters: 600, epoch: 8 | loss: 0.2141218
	speed: 0.0247s/iter; left time: 39.6263s
	iters: 700, epoch: 8 | loss: 0.1833354
	speed: 0.0250s/iter; left time: 37.6155s
Epoch: 8 cost time: 19.313137769699097
Epoch: 8, Steps: 734 | Train Loss: 0.1987095 Vali Loss: 0.3018908 Test Loss: 0.3301168
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1685627
	speed: 0.1423s/iter; left time: 194.8451s
	iters: 200, epoch: 9 | loss: 0.1638412
	speed: 0.0247s/iter; left time: 31.3226s
	iters: 300, epoch: 9 | loss: 0.2037705
	speed: 0.0248s/iter; left time: 29.0371s
	iters: 400, epoch: 9 | loss: 0.1728299
	speed: 0.0253s/iter; left time: 27.0837s
	iters: 500, epoch: 9 | loss: 0.1465332
	speed: 0.0249s/iter; left time: 24.1411s
	iters: 600, epoch: 9 | loss: 0.2112009
	speed: 0.0249s/iter; left time: 21.6511s
	iters: 700, epoch: 9 | loss: 0.1775728
	speed: 0.0254s/iter; left time: 19.5455s
Epoch: 9 cost time: 19.350545406341553
Epoch: 9, Steps: 734 | Train Loss: 0.1984583 Vali Loss: 0.3012946 Test Loss: 0.3297736
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2420663
	speed: 0.1396s/iter; left time: 88.6222s
	iters: 200, epoch: 10 | loss: 0.1672399
	speed: 0.0253s/iter; left time: 13.5393s
	iters: 300, epoch: 10 | loss: 0.1773689
	speed: 0.0258s/iter; left time: 11.2180s
	iters: 400, epoch: 10 | loss: 0.2028878
	speed: 0.0253s/iter; left time: 8.4864s
	iters: 500, epoch: 10 | loss: 0.2050971
	speed: 0.0252s/iter; left time: 5.9248s
	iters: 600, epoch: 10 | loss: 0.2387909
	speed: 0.0255s/iter; left time: 3.4417s
	iters: 700, epoch: 10 | loss: 0.2285328
	speed: 0.0252s/iter; left time: 0.8835s
Epoch: 10 cost time: 19.594841718673706
Epoch: 10, Steps: 734 | Train Loss: 0.1983562 Vali Loss: 0.3011210 Test Loss: 0.3296638
Validation loss decreased (0.301273 --> 0.301121).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_504_24_GLinear_custom_ftM_sl504_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3485
mse:0.32979607582092285, mae:0.24260000884532928
