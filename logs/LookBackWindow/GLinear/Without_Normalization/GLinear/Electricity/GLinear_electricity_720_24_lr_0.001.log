Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='Electricity_720_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_24_GLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17669
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1482286
	speed: 0.0230s/iter; left time: 251.7199s
	iters: 200, epoch: 1 | loss: 0.1071715
	speed: 0.0149s/iter; left time: 161.6025s
	iters: 300, epoch: 1 | loss: 0.1003641
	speed: 0.0152s/iter; left time: 163.2842s
	iters: 400, epoch: 1 | loss: 0.1155676
	speed: 0.0149s/iter; left time: 158.5789s
	iters: 500, epoch: 1 | loss: 0.1201607
	speed: 0.0151s/iter; left time: 158.6972s
	iters: 600, epoch: 1 | loss: 0.1263798
	speed: 0.0153s/iter; left time: 159.6667s
	iters: 700, epoch: 1 | loss: 0.0917064
	speed: 0.0150s/iter; left time: 155.1939s
	iters: 800, epoch: 1 | loss: 0.1040037
	speed: 0.0154s/iter; left time: 157.9836s
	iters: 900, epoch: 1 | loss: 0.0927879
	speed: 0.0152s/iter; left time: 153.8227s
	iters: 1000, epoch: 1 | loss: 0.0914036
	speed: 0.0156s/iter; left time: 156.8957s
	iters: 1100, epoch: 1 | loss: 0.0991872
	speed: 0.0148s/iter; left time: 146.7894s
Epoch: 1 cost time: 17.606577396392822
Epoch: 1, Steps: 1104 | Train Loss: 0.1198938 Vali Loss: 0.0977854 Test Loss: 0.1090101
Validation loss decreased (inf --> 0.097785).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1247516
	speed: 0.1131s/iter; left time: 1112.6421s
	iters: 200, epoch: 2 | loss: 0.0966227
	speed: 0.0150s/iter; left time: 145.8066s
	iters: 300, epoch: 2 | loss: 0.0888235
	speed: 0.0152s/iter; left time: 146.8358s
	iters: 400, epoch: 2 | loss: 0.1311827
	speed: 0.0149s/iter; left time: 142.2867s
	iters: 500, epoch: 2 | loss: 0.1824793
	speed: 0.0157s/iter; left time: 148.5012s
	iters: 600, epoch: 2 | loss: 0.0973519
	speed: 0.0161s/iter; left time: 150.2339s
	iters: 700, epoch: 2 | loss: 0.0962919
	speed: 0.0158s/iter; left time: 145.7807s
	iters: 800, epoch: 2 | loss: 0.1133459
	speed: 0.0155s/iter; left time: 141.8557s
	iters: 900, epoch: 2 | loss: 0.0897381
	speed: 0.0153s/iter; left time: 138.3097s
	iters: 1000, epoch: 2 | loss: 0.0900552
	speed: 0.0160s/iter; left time: 142.9376s
	iters: 1100, epoch: 2 | loss: 0.1111172
	speed: 0.0150s/iter; left time: 132.2101s
Epoch: 2 cost time: 17.915313482284546
Epoch: 2, Steps: 1104 | Train Loss: 0.1086907 Vali Loss: 0.0968555 Test Loss: 0.1066996
Validation loss decreased (0.097785 --> 0.096855).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1020928
	speed: 0.1144s/iter; left time: 998.7777s
	iters: 200, epoch: 3 | loss: 0.0998815
	speed: 0.0154s/iter; left time: 133.2457s
	iters: 300, epoch: 3 | loss: 0.1009509
	speed: 0.0154s/iter; left time: 131.4368s
	iters: 400, epoch: 3 | loss: 0.0955175
	speed: 0.0152s/iter; left time: 128.0472s
	iters: 500, epoch: 3 | loss: 0.1163054
	speed: 0.0152s/iter; left time: 126.4879s
	iters: 600, epoch: 3 | loss: 0.0887263
	speed: 0.0155s/iter; left time: 127.7156s
	iters: 700, epoch: 3 | loss: 0.0907883
	speed: 0.0151s/iter; left time: 122.5578s
	iters: 800, epoch: 3 | loss: 0.0905050
	speed: 0.0152s/iter; left time: 122.2867s
	iters: 900, epoch: 3 | loss: 0.1191449
	speed: 0.0154s/iter; left time: 122.0165s
	iters: 1000, epoch: 3 | loss: 0.1143598
	speed: 0.0155s/iter; left time: 121.1538s
	iters: 1100, epoch: 3 | loss: 0.1047794
	speed: 0.0157s/iter; left time: 121.2191s
Epoch: 3 cost time: 17.887279510498047
Epoch: 3, Steps: 1104 | Train Loss: 0.1025222 Vali Loss: 0.0913132 Test Loss: 0.1008835
Validation loss decreased (0.096855 --> 0.091313).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0805222
	speed: 0.1154s/iter; left time: 880.7539s
	iters: 200, epoch: 4 | loss: 0.0931602
	speed: 0.0152s/iter; left time: 114.6243s
	iters: 300, epoch: 4 | loss: 0.1178000
	speed: 0.0158s/iter; left time: 117.0790s
	iters: 400, epoch: 4 | loss: 0.1161234
	speed: 0.0153s/iter; left time: 112.2824s
	iters: 500, epoch: 4 | loss: 0.0770683
	speed: 0.0155s/iter; left time: 111.7471s
	iters: 600, epoch: 4 | loss: 0.0885629
	speed: 0.0154s/iter; left time: 110.0491s
	iters: 700, epoch: 4 | loss: 0.1168932
	speed: 0.0152s/iter; left time: 106.4901s
	iters: 800, epoch: 4 | loss: 0.0885085
	speed: 0.0150s/iter; left time: 103.6432s
	iters: 900, epoch: 4 | loss: 0.0950804
	speed: 0.0160s/iter; left time: 109.4257s
	iters: 1000, epoch: 4 | loss: 0.0825532
	speed: 0.0158s/iter; left time: 106.4529s
	iters: 1100, epoch: 4 | loss: 0.0949549
	speed: 0.0153s/iter; left time: 101.6005s
Epoch: 4 cost time: 18.041610717773438
Epoch: 4, Steps: 1104 | Train Loss: 0.0999148 Vali Loss: 0.0907053 Test Loss: 0.0995288
Validation loss decreased (0.091313 --> 0.090705).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0986564
	speed: 0.1156s/iter; left time: 754.0574s
	iters: 200, epoch: 5 | loss: 0.1037428
	speed: 0.0153s/iter; left time: 98.1692s
	iters: 300, epoch: 5 | loss: 0.0925800
	speed: 0.0162s/iter; left time: 102.1758s
	iters: 400, epoch: 5 | loss: 0.0982335
	speed: 0.0155s/iter; left time: 96.7846s
	iters: 500, epoch: 5 | loss: 0.0976515
	speed: 0.0160s/iter; left time: 97.7532s
	iters: 600, epoch: 5 | loss: 0.0853659
	speed: 0.0159s/iter; left time: 95.7313s
	iters: 700, epoch: 5 | loss: 0.0903812
	speed: 0.0152s/iter; left time: 89.8032s
	iters: 800, epoch: 5 | loss: 0.1197459
	speed: 0.0155s/iter; left time: 90.4754s
	iters: 900, epoch: 5 | loss: 0.1549917
	speed: 0.0153s/iter; left time: 87.4430s
	iters: 1000, epoch: 5 | loss: 0.0837246
	speed: 0.0153s/iter; left time: 86.2352s
	iters: 1100, epoch: 5 | loss: 0.0970501
	speed: 0.0153s/iter; left time: 84.3628s
Epoch: 5 cost time: 18.11131763458252
Epoch: 5, Steps: 1104 | Train Loss: 0.0983867 Vali Loss: 0.0901295 Test Loss: 0.0989905
Validation loss decreased (0.090705 --> 0.090129).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1025135
	speed: 0.1144s/iter; left time: 619.9289s
	iters: 200, epoch: 6 | loss: 0.1021515
	speed: 0.0152s/iter; left time: 80.9855s
	iters: 300, epoch: 6 | loss: 0.0864938
	speed: 0.0150s/iter; left time: 78.3479s
	iters: 400, epoch: 6 | loss: 0.0903389
	speed: 0.0151s/iter; left time: 77.3515s
	iters: 500, epoch: 6 | loss: 0.1692729
	speed: 0.0156s/iter; left time: 78.3630s
	iters: 600, epoch: 6 | loss: 0.0957465
	speed: 0.0154s/iter; left time: 76.0241s
	iters: 700, epoch: 6 | loss: 0.0926596
	speed: 0.0151s/iter; left time: 72.9878s
	iters: 800, epoch: 6 | loss: 0.1094516
	speed: 0.0157s/iter; left time: 74.1622s
	iters: 900, epoch: 6 | loss: 0.1020622
	speed: 0.0155s/iter; left time: 71.6462s
	iters: 1000, epoch: 6 | loss: 0.0900195
	speed: 0.0155s/iter; left time: 69.9265s
	iters: 1100, epoch: 6 | loss: 0.0902820
	speed: 0.0152s/iter; left time: 67.0305s
Epoch: 6 cost time: 17.952533721923828
Epoch: 6, Steps: 1104 | Train Loss: 0.0974744 Vali Loss: 0.0892450 Test Loss: 0.0981651
Validation loss decreased (0.090129 --> 0.089245).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0972422
	speed: 0.1124s/iter; left time: 485.2361s
	iters: 200, epoch: 7 | loss: 0.0909125
	speed: 0.0150s/iter; left time: 63.4019s
	iters: 300, epoch: 7 | loss: 0.0986006
	speed: 0.0148s/iter; left time: 61.0884s
	iters: 400, epoch: 7 | loss: 0.0958074
	speed: 0.0149s/iter; left time: 59.7790s
	iters: 500, epoch: 7 | loss: 0.1050850
	speed: 0.0148s/iter; left time: 58.0491s
	iters: 600, epoch: 7 | loss: 0.0827330
	speed: 0.0149s/iter; left time: 56.9183s
	iters: 700, epoch: 7 | loss: 0.0883578
	speed: 0.0149s/iter; left time: 55.2713s
	iters: 800, epoch: 7 | loss: 0.1039936
	speed: 0.0151s/iter; left time: 54.7065s
	iters: 900, epoch: 7 | loss: 0.0820040
	speed: 0.0152s/iter; left time: 53.3193s
	iters: 1000, epoch: 7 | loss: 0.0843616
	speed: 0.0152s/iter; left time: 52.0641s
	iters: 1100, epoch: 7 | loss: 0.0743278
	speed: 0.0147s/iter; left time: 48.8258s
Epoch: 7 cost time: 17.249107122421265
Epoch: 7, Steps: 1104 | Train Loss: 0.0969614 Vali Loss: 0.0886660 Test Loss: 0.0981649
Validation loss decreased (0.089245 --> 0.088666).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0880569
	speed: 0.1128s/iter; left time: 362.3021s
	iters: 200, epoch: 8 | loss: 0.0875945
	speed: 0.0155s/iter; left time: 48.1466s
	iters: 300, epoch: 8 | loss: 0.0945684
	speed: 0.0153s/iter; left time: 46.0225s
	iters: 400, epoch: 8 | loss: 0.1204055
	speed: 0.0158s/iter; left time: 45.8925s
	iters: 500, epoch: 8 | loss: 0.0777735
	speed: 0.0158s/iter; left time: 44.3491s
	iters: 600, epoch: 8 | loss: 0.0874505
	speed: 0.0159s/iter; left time: 43.0786s
	iters: 700, epoch: 8 | loss: 0.0781859
	speed: 0.0152s/iter; left time: 39.6288s
	iters: 800, epoch: 8 | loss: 0.0864490
	speed: 0.0159s/iter; left time: 39.9950s
	iters: 900, epoch: 8 | loss: 0.1051051
	speed: 0.0164s/iter; left time: 39.5307s
	iters: 1000, epoch: 8 | loss: 0.0878618
	speed: 0.0164s/iter; left time: 37.8927s
	iters: 1100, epoch: 8 | loss: 0.0944247
	speed: 0.0152s/iter; left time: 33.5895s
Epoch: 8 cost time: 18.319445371627808
Epoch: 8, Steps: 1104 | Train Loss: 0.0966948 Vali Loss: 0.0886154 Test Loss: 0.0978096
Validation loss decreased (0.088666 --> 0.088615).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0870368
	speed: 0.1149s/iter; left time: 242.3253s
	iters: 200, epoch: 9 | loss: 0.1117006
	speed: 0.0154s/iter; left time: 31.0102s
	iters: 300, epoch: 9 | loss: 0.0824665
	speed: 0.0153s/iter; left time: 29.2648s
	iters: 400, epoch: 9 | loss: 0.0965962
	speed: 0.0150s/iter; left time: 27.0874s
	iters: 500, epoch: 9 | loss: 0.0819069
	speed: 0.0154s/iter; left time: 26.2581s
	iters: 600, epoch: 9 | loss: 0.1117449
	speed: 0.0153s/iter; left time: 24.5946s
	iters: 700, epoch: 9 | loss: 0.1023175
	speed: 0.0154s/iter; left time: 23.2207s
	iters: 800, epoch: 9 | loss: 0.1424305
	speed: 0.0152s/iter; left time: 21.4668s
	iters: 900, epoch: 9 | loss: 0.0954291
	speed: 0.0152s/iter; left time: 19.8819s
	iters: 1000, epoch: 9 | loss: 0.0922758
	speed: 0.0155s/iter; left time: 18.7064s
	iters: 1100, epoch: 9 | loss: 0.0908488
	speed: 0.0160s/iter; left time: 17.7682s
Epoch: 9 cost time: 17.902016401290894
Epoch: 9, Steps: 1104 | Train Loss: 0.0965184 Vali Loss: 0.0885880 Test Loss: 0.0976910
Validation loss decreased (0.088615 --> 0.088588).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1153855
	speed: 0.1160s/iter; left time: 116.6122s
	iters: 200, epoch: 10 | loss: 0.1113272
	speed: 0.0152s/iter; left time: 13.7701s
	iters: 300, epoch: 10 | loss: 0.0992124
	speed: 0.0152s/iter; left time: 12.2212s
	iters: 400, epoch: 10 | loss: 0.1048589
	speed: 0.0149s/iter; left time: 10.4755s
	iters: 500, epoch: 10 | loss: 0.1040458
	speed: 0.0147s/iter; left time: 8.8763s
	iters: 600, epoch: 10 | loss: 0.0841835
	speed: 0.0153s/iter; left time: 7.7357s
	iters: 700, epoch: 10 | loss: 0.0892938
	speed: 0.0153s/iter; left time: 6.1791s
	iters: 800, epoch: 10 | loss: 0.0959634
	speed: 0.0152s/iter; left time: 4.6351s
	iters: 900, epoch: 10 | loss: 0.0811830
	speed: 0.0154s/iter; left time: 3.1612s
	iters: 1000, epoch: 10 | loss: 0.1057869
	speed: 0.0156s/iter; left time: 1.6350s
	iters: 1100, epoch: 10 | loss: 0.0886904
	speed: 0.0150s/iter; left time: 0.0748s
Epoch: 10 cost time: 17.680842399597168
Epoch: 10, Steps: 1104 | Train Loss: 0.0964511 Vali Loss: 0.0885302 Test Loss: 0.0976597
Validation loss decreased (0.088588 --> 0.088530).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_720_24_GLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.09734569489955902, mae:0.19485117495059967
