Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='Electricity_672_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=672, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_672_720_GLinear_custom_ftM_sl672_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17021
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2033982
	speed: 0.0308s/iter; left time: 323.8982s
	iters: 200, epoch: 1 | loss: 0.2109764
	speed: 0.0238s/iter; left time: 248.1713s
	iters: 300, epoch: 1 | loss: 0.2383552
	speed: 0.0232s/iter; left time: 239.9561s
	iters: 400, epoch: 1 | loss: 0.2125397
	speed: 0.0231s/iter; left time: 236.5201s
	iters: 500, epoch: 1 | loss: 0.1995127
	speed: 0.0237s/iter; left time: 240.1037s
	iters: 600, epoch: 1 | loss: 0.1972194
	speed: 0.0246s/iter; left time: 246.6717s
	iters: 700, epoch: 1 | loss: 0.2169180
	speed: 0.0237s/iter; left time: 235.5762s
	iters: 800, epoch: 1 | loss: 0.2396148
	speed: 0.0240s/iter; left time: 236.1847s
	iters: 900, epoch: 1 | loss: 0.2049720
	speed: 0.0240s/iter; left time: 233.4292s
	iters: 1000, epoch: 1 | loss: 0.2630455
	speed: 0.0251s/iter; left time: 241.7896s
Epoch: 1 cost time: 26.21072244644165
Epoch: 1, Steps: 1063 | Train Loss: 0.2264339 Vali Loss: 0.1746413 Test Loss: 0.2052926
Validation loss decreased (inf --> 0.174641).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1917084
	speed: 0.1865s/iter; left time: 1765.9673s
	iters: 200, epoch: 2 | loss: 0.2090140
	speed: 0.0238s/iter; left time: 223.1355s
	iters: 300, epoch: 2 | loss: 0.2010353
	speed: 0.0231s/iter; left time: 214.2003s
	iters: 400, epoch: 2 | loss: 0.2394670
	speed: 0.0237s/iter; left time: 217.3582s
	iters: 500, epoch: 2 | loss: 0.2111450
	speed: 0.0240s/iter; left time: 217.9781s
	iters: 600, epoch: 2 | loss: 0.1914623
	speed: 0.0240s/iter; left time: 215.0438s
	iters: 700, epoch: 2 | loss: 0.1827489
	speed: 0.0240s/iter; left time: 212.7626s
	iters: 800, epoch: 2 | loss: 0.2105141
	speed: 0.0238s/iter; left time: 208.3223s
	iters: 900, epoch: 2 | loss: 0.2369510
	speed: 0.0246s/iter; left time: 213.2731s
	iters: 1000, epoch: 2 | loss: 0.2261854
	speed: 0.0237s/iter; left time: 203.2448s
Epoch: 2 cost time: 26.378626823425293
Epoch: 2, Steps: 1063 | Train Loss: 0.2110552 Vali Loss: 0.1743037 Test Loss: 0.2027722
Validation loss decreased (0.174641 --> 0.174304).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2027283
	speed: 0.1875s/iter; left time: 1575.9972s
	iters: 200, epoch: 3 | loss: 0.2375697
	speed: 0.0238s/iter; left time: 197.8272s
	iters: 300, epoch: 3 | loss: 0.2366497
	speed: 0.0239s/iter; left time: 195.7730s
	iters: 400, epoch: 3 | loss: 0.2177282
	speed: 0.0234s/iter; left time: 190.0004s
	iters: 500, epoch: 3 | loss: 0.1981745
	speed: 0.0238s/iter; left time: 190.5846s
	iters: 600, epoch: 3 | loss: 0.2023146
	speed: 0.0245s/iter; left time: 193.7798s
	iters: 700, epoch: 3 | loss: 0.2280358
	speed: 0.0239s/iter; left time: 186.9205s
	iters: 800, epoch: 3 | loss: 0.2417505
	speed: 0.0238s/iter; left time: 183.6945s
	iters: 900, epoch: 3 | loss: 0.2058706
	speed: 0.0248s/iter; left time: 188.6733s
	iters: 1000, epoch: 3 | loss: 0.1818332
	speed: 0.0245s/iter; left time: 183.6131s
Epoch: 3 cost time: 26.300923347473145
Epoch: 3, Steps: 1063 | Train Loss: 0.2047514 Vali Loss: 0.1642942 Test Loss: 0.1997263
Validation loss decreased (0.174304 --> 0.164294).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1828011
	speed: 0.1849s/iter; left time: 1357.7082s
	iters: 200, epoch: 4 | loss: 0.2037837
	speed: 0.0241s/iter; left time: 174.4973s
	iters: 300, epoch: 4 | loss: 0.1886408
	speed: 0.0240s/iter; left time: 171.3305s
	iters: 400, epoch: 4 | loss: 0.1972550
	speed: 0.0242s/iter; left time: 170.1490s
	iters: 500, epoch: 4 | loss: 0.1990520
	speed: 0.0245s/iter; left time: 169.9025s
	iters: 600, epoch: 4 | loss: 0.1818499
	speed: 0.0245s/iter; left time: 167.6923s
	iters: 700, epoch: 4 | loss: 0.1644130
	speed: 0.0242s/iter; left time: 163.1674s
	iters: 800, epoch: 4 | loss: 0.2105242
	speed: 0.0244s/iter; left time: 162.2034s
	iters: 900, epoch: 4 | loss: 0.2427844
	speed: 0.0245s/iter; left time: 160.3579s
	iters: 1000, epoch: 4 | loss: 0.2329997
	speed: 0.0238s/iter; left time: 153.4138s
Epoch: 4 cost time: 26.561079025268555
Epoch: 4, Steps: 1063 | Train Loss: 0.2014184 Vali Loss: 0.1627252 Test Loss: 0.1976621
Validation loss decreased (0.164294 --> 0.162725).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1863722
	speed: 0.1908s/iter; left time: 1198.0119s
	iters: 200, epoch: 5 | loss: 0.1779441
	speed: 0.0240s/iter; left time: 148.1183s
	iters: 300, epoch: 5 | loss: 0.2083278
	speed: 0.0239s/iter; left time: 145.5479s
	iters: 400, epoch: 5 | loss: 0.2002154
	speed: 0.0237s/iter; left time: 141.8299s
	iters: 500, epoch: 5 | loss: 0.1859200
	speed: 0.0235s/iter; left time: 138.4115s
	iters: 600, epoch: 5 | loss: 0.1857032
	speed: 0.0238s/iter; left time: 137.7567s
	iters: 700, epoch: 5 | loss: 0.1837945
	speed: 0.0240s/iter; left time: 136.0126s
	iters: 800, epoch: 5 | loss: 0.1958323
	speed: 0.0236s/iter; left time: 131.5887s
	iters: 900, epoch: 5 | loss: 0.2385692
	speed: 0.0239s/iter; left time: 130.9603s
	iters: 1000, epoch: 5 | loss: 0.1936242
	speed: 0.0244s/iter; left time: 131.2293s
Epoch: 5 cost time: 26.375235080718994
Epoch: 5, Steps: 1063 | Train Loss: 0.1995892 Vali Loss: 0.1656126 Test Loss: 0.1972826
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2220772
	speed: 0.1884s/iter; left time: 982.7557s
	iters: 200, epoch: 6 | loss: 0.2007925
	speed: 0.0241s/iter; left time: 123.3624s
	iters: 300, epoch: 6 | loss: 0.2053541
	speed: 0.0236s/iter; left time: 118.4673s
	iters: 400, epoch: 6 | loss: 0.2009740
	speed: 0.0247s/iter; left time: 121.3935s
	iters: 500, epoch: 6 | loss: 0.2173815
	speed: 0.0247s/iter; left time: 119.1153s
	iters: 600, epoch: 6 | loss: 0.1902587
	speed: 0.0239s/iter; left time: 112.6135s
	iters: 700, epoch: 6 | loss: 0.1884860
	speed: 0.0248s/iter; left time: 114.3150s
	iters: 800, epoch: 6 | loss: 0.2335186
	speed: 0.0245s/iter; left time: 110.7419s
	iters: 900, epoch: 6 | loss: 0.1708912
	speed: 0.0254s/iter; left time: 112.2042s
	iters: 1000, epoch: 6 | loss: 0.2115690
	speed: 0.0252s/iter; left time: 108.8890s
Epoch: 6 cost time: 27.043275356292725
Epoch: 6, Steps: 1063 | Train Loss: 0.1983950 Vali Loss: 0.1668799 Test Loss: 0.1960575
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1890089
	speed: 0.1940s/iter; left time: 805.6176s
	iters: 200, epoch: 7 | loss: 0.2008688
	speed: 0.0230s/iter; left time: 93.2854s
	iters: 300, epoch: 7 | loss: 0.1891898
	speed: 0.0237s/iter; left time: 93.6937s
	iters: 400, epoch: 7 | loss: 0.2042723
	speed: 0.0234s/iter; left time: 90.0282s
	iters: 500, epoch: 7 | loss: 0.2254034
	speed: 0.0238s/iter; left time: 89.3191s
	iters: 600, epoch: 7 | loss: 0.2266949
	speed: 0.0235s/iter; left time: 85.9813s
	iters: 700, epoch: 7 | loss: 0.1936880
	speed: 0.0237s/iter; left time: 84.2268s
	iters: 800, epoch: 7 | loss: 0.1745103
	speed: 0.0232s/iter; left time: 79.9631s
	iters: 900, epoch: 7 | loss: 0.1968319
	speed: 0.0237s/iter; left time: 79.5140s
	iters: 1000, epoch: 7 | loss: 0.1943426
	speed: 0.0240s/iter; left time: 77.9914s
Epoch: 7 cost time: 26.13068413734436
Epoch: 7, Steps: 1063 | Train Loss: 0.1977735 Vali Loss: 0.1648057 Test Loss: 0.1953183
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_672_720_GLinear_custom_ftM_sl672_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.1975623518228531, mae:0.2960716187953949
