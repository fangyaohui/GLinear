Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GLinear', model_id='weather_720_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_720_GLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35448
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8044036
	speed: 0.0120s/iter; left time: 263.9563s
	iters: 200, epoch: 1 | loss: 0.7045611
	speed: 0.0059s/iter; left time: 129.2360s
	iters: 300, epoch: 1 | loss: 0.6636604
	speed: 0.0058s/iter; left time: 126.6580s
	iters: 400, epoch: 1 | loss: 0.4147880
	speed: 0.0058s/iter; left time: 126.4224s
	iters: 500, epoch: 1 | loss: 0.8138102
	speed: 0.0059s/iter; left time: 126.6720s
	iters: 600, epoch: 1 | loss: 0.4634528
	speed: 0.0057s/iter; left time: 122.6331s
	iters: 700, epoch: 1 | loss: 0.7743509
	speed: 0.0057s/iter; left time: 122.7303s
	iters: 800, epoch: 1 | loss: 0.4867289
	speed: 0.0058s/iter; left time: 124.5130s
	iters: 900, epoch: 1 | loss: 0.4351279
	speed: 0.0058s/iter; left time: 123.8017s
	iters: 1000, epoch: 1 | loss: 0.6137043
	speed: 0.0058s/iter; left time: 121.6779s
	iters: 1100, epoch: 1 | loss: 0.5820245
	speed: 0.0058s/iter; left time: 123.0131s
	iters: 1200, epoch: 1 | loss: 0.4898180
	speed: 0.0061s/iter; left time: 128.0683s
	iters: 1300, epoch: 1 | loss: 0.4940441
	speed: 0.0057s/iter; left time: 119.7004s
	iters: 1400, epoch: 1 | loss: 0.5765571
	speed: 0.0057s/iter; left time: 117.6643s
	iters: 1500, epoch: 1 | loss: 0.4342136
	speed: 0.0058s/iter; left time: 119.6281s
	iters: 1600, epoch: 1 | loss: 0.4252452
	speed: 0.0058s/iter; left time: 118.8006s
	iters: 1700, epoch: 1 | loss: 0.6825249
	speed: 0.0058s/iter; left time: 117.6569s
	iters: 1800, epoch: 1 | loss: 0.5612448
	speed: 0.0058s/iter; left time: 118.9284s
	iters: 1900, epoch: 1 | loss: 0.6728765
	speed: 0.0058s/iter; left time: 117.3257s
	iters: 2000, epoch: 1 | loss: 0.5520226
	speed: 0.0058s/iter; left time: 115.8945s
	iters: 2100, epoch: 1 | loss: 0.6130774
	speed: 0.0057s/iter; left time: 114.7051s
	iters: 2200, epoch: 1 | loss: 0.4189111
	speed: 0.0057s/iter; left time: 113.5998s
Epoch: 1 cost time: 13.534622192382812
Epoch: 1, Steps: 2215 | Train Loss: 0.5821813 Vali Loss: 0.5927263 Test Loss: 0.3276169
Validation loss decreased (inf --> 0.592726).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5477121
	speed: 0.0763s/iter; left time: 1514.3906s
	iters: 200, epoch: 2 | loss: 0.5269283
	speed: 0.0058s/iter; left time: 113.7332s
	iters: 300, epoch: 2 | loss: 0.5962920
	speed: 0.0058s/iter; left time: 113.4429s
	iters: 400, epoch: 2 | loss: 0.4589759
	speed: 0.0057s/iter; left time: 112.1952s
	iters: 500, epoch: 2 | loss: 0.5531666
	speed: 0.0059s/iter; left time: 114.3152s
	iters: 600, epoch: 2 | loss: 0.4950028
	speed: 0.0058s/iter; left time: 112.7080s
	iters: 700, epoch: 2 | loss: 0.5294356
	speed: 0.0057s/iter; left time: 110.2205s
	iters: 800, epoch: 2 | loss: 0.4833235
	speed: 0.0058s/iter; left time: 110.4341s
	iters: 900, epoch: 2 | loss: 0.6582680
	speed: 0.0058s/iter; left time: 111.3519s
	iters: 1000, epoch: 2 | loss: 0.9892626
	speed: 0.0059s/iter; left time: 112.2712s
	iters: 1100, epoch: 2 | loss: 0.5094258
	speed: 0.0061s/iter; left time: 114.6206s
	iters: 1200, epoch: 2 | loss: 0.5351285
	speed: 0.0064s/iter; left time: 120.0292s
	iters: 1300, epoch: 2 | loss: 0.5960909
	speed: 0.0060s/iter; left time: 112.6656s
	iters: 1400, epoch: 2 | loss: 0.5388838
	speed: 0.0058s/iter; left time: 108.2039s
	iters: 1500, epoch: 2 | loss: 0.5186366
	speed: 0.0061s/iter; left time: 112.9775s
	iters: 1600, epoch: 2 | loss: 0.3792778
	speed: 0.0055s/iter; left time: 101.1366s
	iters: 1700, epoch: 2 | loss: 0.4061531
	speed: 0.0058s/iter; left time: 106.3149s
	iters: 1800, epoch: 2 | loss: 0.4693971
	speed: 0.0058s/iter; left time: 105.4969s
	iters: 1900, epoch: 2 | loss: 0.5315467
	speed: 0.0058s/iter; left time: 103.9268s
	iters: 2000, epoch: 2 | loss: 0.5366987
	speed: 0.0057s/iter; left time: 101.4044s
	iters: 2100, epoch: 2 | loss: 0.5289463
	speed: 0.0055s/iter; left time: 98.1332s
	iters: 2200, epoch: 2 | loss: 0.5949592
	speed: 0.0056s/iter; left time: 99.4446s
Epoch: 2 cost time: 13.64542007446289
Epoch: 2, Steps: 2215 | Train Loss: 0.5659024 Vali Loss: 0.5930641 Test Loss: 0.3292026
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4391158
	speed: 0.0771s/iter; left time: 1358.4162s
	iters: 200, epoch: 3 | loss: 0.6127756
	speed: 0.0054s/iter; left time: 94.6451s
	iters: 300, epoch: 3 | loss: 0.5338668
	speed: 0.0058s/iter; left time: 101.1269s
	iters: 400, epoch: 3 | loss: 0.6753387
	speed: 0.0061s/iter; left time: 106.1239s
	iters: 500, epoch: 3 | loss: 0.5190144
	speed: 0.0057s/iter; left time: 98.0625s
	iters: 600, epoch: 3 | loss: 0.3811707
	speed: 0.0057s/iter; left time: 97.1500s
	iters: 700, epoch: 3 | loss: 0.5230762
	speed: 0.0056s/iter; left time: 96.1325s
	iters: 800, epoch: 3 | loss: 0.4171730
	speed: 0.0056s/iter; left time: 93.9302s
	iters: 900, epoch: 3 | loss: 0.5339129
	speed: 0.0059s/iter; left time: 99.2499s
	iters: 1000, epoch: 3 | loss: 0.6999633
	speed: 0.0057s/iter; left time: 95.2176s
	iters: 1100, epoch: 3 | loss: 0.4235044
	speed: 0.0060s/iter; left time: 100.4558s
	iters: 1200, epoch: 3 | loss: 0.6737032
	speed: 0.0058s/iter; left time: 95.5364s
	iters: 1300, epoch: 3 | loss: 0.8568171
	speed: 0.0062s/iter; left time: 101.8374s
	iters: 1400, epoch: 3 | loss: 0.4862774
	speed: 0.0058s/iter; left time: 94.6310s
	iters: 1500, epoch: 3 | loss: 0.4164615
	speed: 0.0060s/iter; left time: 96.9522s
	iters: 1600, epoch: 3 | loss: 0.5713491
	speed: 0.0059s/iter; left time: 95.7438s
	iters: 1700, epoch: 3 | loss: 0.7447457
	speed: 0.0057s/iter; left time: 90.6360s
	iters: 1800, epoch: 3 | loss: 0.4936230
	speed: 0.0059s/iter; left time: 94.0696s
	iters: 1900, epoch: 3 | loss: 0.5262628
	speed: 0.0059s/iter; left time: 92.5617s
	iters: 2000, epoch: 3 | loss: 0.4376587
	speed: 0.0061s/iter; left time: 96.0169s
	iters: 2100, epoch: 3 | loss: 0.3764479
	speed: 0.0056s/iter; left time: 87.8596s
	iters: 2200, epoch: 3 | loss: 0.3759476
	speed: 0.0062s/iter; left time: 96.2527s
Epoch: 3 cost time: 13.65466046333313
Epoch: 3, Steps: 2215 | Train Loss: 0.5423063 Vali Loss: 0.5996009 Test Loss: 0.3156292
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5822005
	speed: 0.0750s/iter; left time: 1155.7404s
	iters: 200, epoch: 4 | loss: 0.5656382
	speed: 0.0057s/iter; left time: 87.5791s
	iters: 300, epoch: 4 | loss: 0.4030916
	speed: 0.0058s/iter; left time: 87.7542s
	iters: 400, epoch: 4 | loss: 0.4131275
	speed: 0.0056s/iter; left time: 84.2309s
	iters: 500, epoch: 4 | loss: 0.3687782
	speed: 0.0059s/iter; left time: 88.9246s
	iters: 600, epoch: 4 | loss: 0.4806818
	speed: 0.0058s/iter; left time: 86.9558s
	iters: 700, epoch: 4 | loss: 0.3747669
	speed: 0.0056s/iter; left time: 83.4504s
	iters: 800, epoch: 4 | loss: 0.4589022
	speed: 0.0059s/iter; left time: 87.1118s
	iters: 900, epoch: 4 | loss: 0.6446017
	speed: 0.0057s/iter; left time: 83.4126s
	iters: 1000, epoch: 4 | loss: 0.4697336
	speed: 0.0058s/iter; left time: 83.8507s
	iters: 1100, epoch: 4 | loss: 0.4323227
	speed: 0.0063s/iter; left time: 91.1388s
	iters: 1200, epoch: 4 | loss: 0.5733207
	speed: 0.0059s/iter; left time: 84.3213s
	iters: 1300, epoch: 4 | loss: 0.4986618
	speed: 0.0055s/iter; left time: 78.7654s
	iters: 1400, epoch: 4 | loss: 0.5515477
	speed: 0.0054s/iter; left time: 75.7756s
	iters: 1500, epoch: 4 | loss: 0.3652031
	speed: 0.0059s/iter; left time: 82.5083s
	iters: 1600, epoch: 4 | loss: 0.3981410
	speed: 0.0059s/iter; left time: 82.6706s
	iters: 1700, epoch: 4 | loss: 0.5352921
	speed: 0.0057s/iter; left time: 79.3474s
	iters: 1800, epoch: 4 | loss: 0.6074947
	speed: 0.0058s/iter; left time: 79.5287s
	iters: 1900, epoch: 4 | loss: 0.4767537
	speed: 0.0061s/iter; left time: 82.5320s
	iters: 2000, epoch: 4 | loss: 0.4326381
	speed: 0.0060s/iter; left time: 80.5960s
	iters: 2100, epoch: 4 | loss: 0.4304048
	speed: 0.0058s/iter; left time: 78.2717s
	iters: 2200, epoch: 4 | loss: 0.3822884
	speed: 0.0060s/iter; left time: 79.8755s
Epoch: 4 cost time: 13.627315998077393
Epoch: 4, Steps: 2215 | Train Loss: 0.5220805 Vali Loss: 0.5972766 Test Loss: 0.3255599
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_720_GLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3275267779827118, mae:0.36762359738349915
