Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='GRevagLinear', model_id='ETTh1_72_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=72, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_72_24_GRevagLinear_ETTh1_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2857
test 2857
	iters: 100, epoch: 1 | loss: 0.2412282
	speed: 0.0120s/iter; left time: 126.5174s
	iters: 200, epoch: 1 | loss: 0.3206856
	speed: 0.0049s/iter; left time: 51.2001s
	iters: 300, epoch: 1 | loss: 0.2368379
	speed: 0.0050s/iter; left time: 51.8570s
	iters: 400, epoch: 1 | loss: 0.3108538
	speed: 0.0055s/iter; left time: 56.4983s
	iters: 500, epoch: 1 | loss: 0.2430898
	speed: 0.0060s/iter; left time: 60.9196s
	iters: 600, epoch: 1 | loss: 0.2811738
	speed: 0.0060s/iter; left time: 60.1263s
	iters: 700, epoch: 1 | loss: 0.3281000
	speed: 0.0058s/iter; left time: 57.9888s
	iters: 800, epoch: 1 | loss: 0.2071621
	speed: 0.0058s/iter; left time: 57.7488s
	iters: 900, epoch: 1 | loss: 0.2581834
	speed: 0.0053s/iter; left time: 52.0172s
	iters: 1000, epoch: 1 | loss: 0.1494426
	speed: 0.0051s/iter; left time: 48.9945s
Epoch: 1 cost time: 6.5779125690460205
Epoch: 1, Steps: 1068 | Train Loss: 0.2952330 Vali Loss: 0.4142612 Test Loss: 0.3105944
Validation loss decreased (inf --> 0.414261).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2341839
	speed: 0.0514s/iter; left time: 488.8536s
	iters: 200, epoch: 2 | loss: 0.3378155
	speed: 0.0051s/iter; left time: 48.2389s
	iters: 300, epoch: 2 | loss: 0.2525072
	speed: 0.0052s/iter; left time: 48.5618s
	iters: 400, epoch: 2 | loss: 0.3069404
	speed: 0.0052s/iter; left time: 47.6880s
	iters: 500, epoch: 2 | loss: 0.3374646
	speed: 0.0053s/iter; left time: 48.4665s
	iters: 600, epoch: 2 | loss: 0.2648681
	speed: 0.0057s/iter; left time: 51.7398s
	iters: 700, epoch: 2 | loss: 0.2143308
	speed: 0.0061s/iter; left time: 54.3848s
	iters: 800, epoch: 2 | loss: 0.5836906
	speed: 0.0061s/iter; left time: 53.4049s
	iters: 900, epoch: 2 | loss: 0.2223313
	speed: 0.0060s/iter; left time: 52.2313s
	iters: 1000, epoch: 2 | loss: 0.2570595
	speed: 0.0052s/iter; left time: 44.6809s
Epoch: 2 cost time: 6.563381195068359
Epoch: 2, Steps: 1068 | Train Loss: 0.2731195 Vali Loss: 0.4053105 Test Loss: 0.3015164
Validation loss decreased (0.414261 --> 0.405310).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1612068
	speed: 0.0505s/iter; left time: 426.8357s
	iters: 200, epoch: 3 | loss: 0.2259031
	speed: 0.0052s/iter; left time: 43.3599s
	iters: 300, epoch: 3 | loss: 0.3402632
	speed: 0.0052s/iter; left time: 42.7510s
	iters: 400, epoch: 3 | loss: 0.2791792
	speed: 0.0052s/iter; left time: 42.0043s
	iters: 500, epoch: 3 | loss: 0.2270844
	speed: 0.0053s/iter; left time: 42.3766s
	iters: 600, epoch: 3 | loss: 0.2371663
	speed: 0.0051s/iter; left time: 40.8847s
	iters: 700, epoch: 3 | loss: 0.1842201
	speed: 0.0051s/iter; left time: 40.3918s
	iters: 800, epoch: 3 | loss: 0.2165003
	speed: 0.0051s/iter; left time: 39.8225s
	iters: 900, epoch: 3 | loss: 0.2389843
	speed: 0.0051s/iter; left time: 39.2106s
	iters: 1000, epoch: 3 | loss: 0.2089229
	speed: 0.0053s/iter; left time: 39.6585s
Epoch: 3 cost time: 6.3033483028411865
Epoch: 3, Steps: 1068 | Train Loss: 0.2646980 Vali Loss: 0.3996132 Test Loss: 0.2981299
Validation loss decreased (0.405310 --> 0.399613).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1580381
	speed: 0.0546s/iter; left time: 402.6835s
	iters: 200, epoch: 4 | loss: 0.2136543
	speed: 0.0052s/iter; left time: 37.5519s
	iters: 300, epoch: 4 | loss: 0.2624629
	speed: 0.0053s/iter; left time: 37.8545s
	iters: 400, epoch: 4 | loss: 0.1563745
	speed: 0.0051s/iter; left time: 36.2652s
	iters: 500, epoch: 4 | loss: 0.2565661
	speed: 0.0052s/iter; left time: 36.1418s
	iters: 600, epoch: 4 | loss: 0.2260616
	speed: 0.0051s/iter; left time: 35.2832s
	iters: 700, epoch: 4 | loss: 0.3615640
	speed: 0.0051s/iter; left time: 34.8923s
	iters: 800, epoch: 4 | loss: 0.2082849
	speed: 0.0053s/iter; left time: 35.3146s
	iters: 900, epoch: 4 | loss: 0.2652727
	speed: 0.0061s/iter; left time: 40.4161s
	iters: 1000, epoch: 4 | loss: 0.2648375
	speed: 0.0054s/iter; left time: 34.6919s
Epoch: 4 cost time: 6.531210422515869
Epoch: 4, Steps: 1068 | Train Loss: 0.2610824 Vali Loss: 0.3983159 Test Loss: 0.2978127
Validation loss decreased (0.399613 --> 0.398316).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2550695
	speed: 0.0506s/iter; left time: 319.5182s
	iters: 200, epoch: 5 | loss: 0.2815736
	speed: 0.0052s/iter; left time: 32.1214s
	iters: 300, epoch: 5 | loss: 0.3314711
	speed: 0.0051s/iter; left time: 30.8771s
	iters: 400, epoch: 5 | loss: 0.1818664
	speed: 0.0050s/iter; left time: 30.1552s
	iters: 500, epoch: 5 | loss: 0.1610889
	speed: 0.0050s/iter; left time: 29.6813s
	iters: 600, epoch: 5 | loss: 0.3843020
	speed: 0.0052s/iter; left time: 30.3450s
	iters: 700, epoch: 5 | loss: 0.3326879
	speed: 0.0050s/iter; left time: 28.2607s
	iters: 800, epoch: 5 | loss: 0.6766565
	speed: 0.0050s/iter; left time: 28.0651s
	iters: 900, epoch: 5 | loss: 0.2577538
	speed: 0.0052s/iter; left time: 28.3779s
	iters: 1000, epoch: 5 | loss: 0.2974914
	speed: 0.0053s/iter; left time: 28.7095s
Epoch: 5 cost time: 6.335946321487427
Epoch: 5, Steps: 1068 | Train Loss: 0.2591347 Vali Loss: 0.3980887 Test Loss: 0.2972313
Validation loss decreased (0.398316 --> 0.398089).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4755273
	speed: 0.0519s/iter; left time: 272.2470s
	iters: 200, epoch: 6 | loss: 0.2257995
	speed: 0.0052s/iter; left time: 26.4888s
	iters: 300, epoch: 6 | loss: 0.2265915
	speed: 0.0054s/iter; left time: 27.4327s
	iters: 400, epoch: 6 | loss: 0.2390714
	speed: 0.0051s/iter; left time: 25.0936s
	iters: 500, epoch: 6 | loss: 0.1727282
	speed: 0.0052s/iter; left time: 25.3356s
	iters: 600, epoch: 6 | loss: 0.2301196
	speed: 0.0053s/iter; left time: 24.8945s
	iters: 700, epoch: 6 | loss: 0.2989630
	speed: 0.0052s/iter; left time: 24.1995s
	iters: 800, epoch: 6 | loss: 0.2276337
	speed: 0.0052s/iter; left time: 23.6190s
	iters: 900, epoch: 6 | loss: 0.2636097
	speed: 0.0052s/iter; left time: 23.2104s
	iters: 1000, epoch: 6 | loss: 0.2165190
	speed: 0.0052s/iter; left time: 22.6050s
Epoch: 6 cost time: 6.253415822982788
Epoch: 6, Steps: 1068 | Train Loss: 0.2580119 Vali Loss: 0.3972260 Test Loss: 0.2977463
Validation loss decreased (0.398089 --> 0.397226).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2236733
	speed: 0.0516s/iter; left time: 215.1572s
	iters: 200, epoch: 7 | loss: 0.1981262
	speed: 0.0052s/iter; left time: 21.1325s
	iters: 300, epoch: 7 | loss: 0.1879848
	speed: 0.0052s/iter; left time: 20.6056s
	iters: 400, epoch: 7 | loss: 0.2768750
	speed: 0.0053s/iter; left time: 20.4545s
	iters: 500, epoch: 7 | loss: 0.3352794
	speed: 0.0052s/iter; left time: 19.6402s
	iters: 600, epoch: 7 | loss: 0.2643256
	speed: 0.0052s/iter; left time: 19.1354s
	iters: 700, epoch: 7 | loss: 0.1860250
	speed: 0.0052s/iter; left time: 18.4506s
	iters: 800, epoch: 7 | loss: 0.1863565
	speed: 0.0052s/iter; left time: 18.0081s
	iters: 900, epoch: 7 | loss: 0.2174831
	speed: 0.0052s/iter; left time: 17.4847s
	iters: 1000, epoch: 7 | loss: 0.2964731
	speed: 0.0052s/iter; left time: 16.9638s
Epoch: 7 cost time: 6.230286598205566
Epoch: 7, Steps: 1068 | Train Loss: 0.2575100 Vali Loss: 0.3973167 Test Loss: 0.2968595
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2338556
	speed: 0.0535s/iter; left time: 166.2304s
	iters: 200, epoch: 8 | loss: 0.4447391
	speed: 0.0051s/iter; left time: 15.2884s
	iters: 300, epoch: 8 | loss: 0.1993079
	speed: 0.0050s/iter; left time: 14.4642s
	iters: 400, epoch: 8 | loss: 0.2270021
	speed: 0.0051s/iter; left time: 14.2660s
	iters: 500, epoch: 8 | loss: 0.2515000
	speed: 0.0050s/iter; left time: 13.5368s
	iters: 600, epoch: 8 | loss: 0.2147454
	speed: 0.0054s/iter; left time: 13.9600s
	iters: 700, epoch: 8 | loss: 0.2655386
	speed: 0.0052s/iter; left time: 12.9636s
	iters: 800, epoch: 8 | loss: 0.1617548
	speed: 0.0052s/iter; left time: 12.4346s
	iters: 900, epoch: 8 | loss: 0.3745698
	speed: 0.0058s/iter; left time: 13.4272s
	iters: 1000, epoch: 8 | loss: 0.2404342
	speed: 0.0054s/iter; left time: 12.0089s
Epoch: 8 cost time: 6.406924247741699
Epoch: 8, Steps: 1068 | Train Loss: 0.2572267 Vali Loss: 0.3973348 Test Loss: 0.2966554
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3036169
	speed: 0.0507s/iter; left time: 103.3506s
	iters: 200, epoch: 9 | loss: 0.2118301
	speed: 0.0052s/iter; left time: 10.0691s
	iters: 300, epoch: 9 | loss: 0.1982882
	speed: 0.0051s/iter; left time: 9.3359s
	iters: 400, epoch: 9 | loss: 0.4228557
	speed: 0.0051s/iter; left time: 8.9426s
	iters: 500, epoch: 9 | loss: 0.3110219
	speed: 0.0051s/iter; left time: 8.3305s
	iters: 600, epoch: 9 | loss: 0.2702345
	speed: 0.0051s/iter; left time: 7.8184s
	iters: 700, epoch: 9 | loss: 0.3044371
	speed: 0.0051s/iter; left time: 7.3180s
	iters: 800, epoch: 9 | loss: 0.2994269
	speed: 0.0051s/iter; left time: 6.8404s
	iters: 900, epoch: 9 | loss: 0.2680684
	speed: 0.0051s/iter; left time: 6.3119s
	iters: 1000, epoch: 9 | loss: 0.2507986
	speed: 0.0051s/iter; left time: 5.7941s
Epoch: 9 cost time: 6.136282682418823
Epoch: 9, Steps: 1068 | Train Loss: 0.2570763 Vali Loss: 0.3971468 Test Loss: 0.2966545
Validation loss decreased (0.397226 --> 0.397147).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1667143
	speed: 0.0506s/iter; left time: 48.9832s
	iters: 200, epoch: 10 | loss: 0.1810435
	speed: 0.0052s/iter; left time: 4.4972s
	iters: 300, epoch: 10 | loss: 0.1764274
	speed: 0.0052s/iter; left time: 3.9927s
	iters: 400, epoch: 10 | loss: 0.2055864
	speed: 0.0052s/iter; left time: 3.4809s
	iters: 500, epoch: 10 | loss: 0.3551519
	speed: 0.0058s/iter; left time: 3.2907s
	iters: 600, epoch: 10 | loss: 0.2835073
	speed: 0.0054s/iter; left time: 2.5327s
	iters: 700, epoch: 10 | loss: 0.2695145
	speed: 0.0052s/iter; left time: 1.9115s
	iters: 800, epoch: 10 | loss: 0.2730775
	speed: 0.0051s/iter; left time: 1.3784s
	iters: 900, epoch: 10 | loss: 0.3037759
	speed: 0.0055s/iter; left time: 0.9372s
	iters: 1000, epoch: 10 | loss: 0.3144784
	speed: 0.0052s/iter; left time: 0.3573s
Epoch: 10 cost time: 6.315191268920898
Epoch: 10, Steps: 1068 | Train Loss: 0.2569873 Vali Loss: 0.3972681 Test Loss: 0.2966280
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : ETTh1_72_24_GRevagLinear_ETTh1_ftM_sl72_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2857
mse:0.2971513867378235, mae:0.35032856464385986
