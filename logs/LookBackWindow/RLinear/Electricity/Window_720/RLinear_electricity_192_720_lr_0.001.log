Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_192_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=192, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_192_720_RLinear_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2933668
	speed: 0.2176s/iter; left time: 2356.4694s
	iters: 200, epoch: 1 | loss: 0.2500679
	speed: 0.2055s/iter; left time: 2205.5616s
	iters: 300, epoch: 1 | loss: 0.2862948
	speed: 0.2056s/iter; left time: 2185.9051s
	iters: 400, epoch: 1 | loss: 0.2423260
	speed: 0.2054s/iter; left time: 2163.3597s
	iters: 500, epoch: 1 | loss: 0.2520313
	speed: 0.2055s/iter; left time: 2143.2554s
	iters: 600, epoch: 1 | loss: 0.2370611
	speed: 0.2050s/iter; left time: 2118.2612s
	iters: 700, epoch: 1 | loss: 0.2170597
	speed: 0.2070s/iter; left time: 2118.1971s
	iters: 800, epoch: 1 | loss: 0.2724113
	speed: 0.2277s/iter; left time: 2306.5159s
	iters: 900, epoch: 1 | loss: 0.2269901
	speed: 0.2513s/iter; left time: 2521.1545s
	iters: 1000, epoch: 1 | loss: 0.2269922
	speed: 0.2509s/iter; left time: 2491.8557s
Epoch: 1 cost time: 241.86508679389954
Epoch: 1, Steps: 1093 | Train Loss: 0.2721482 Vali Loss: 0.1916366 Test Loss: 0.2232494
Validation loss decreased (inf --> 0.191637).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2352687
	speed: 0.7007s/iter; left time: 6823.0398s
	iters: 200, epoch: 2 | loss: 0.2413846
	speed: 0.2096s/iter; left time: 2019.8807s
	iters: 300, epoch: 2 | loss: 0.2307805
	speed: 0.2159s/iter; left time: 2058.9195s
	iters: 400, epoch: 2 | loss: 0.2447489
	speed: 0.2418s/iter; left time: 2282.1445s
	iters: 500, epoch: 2 | loss: 0.2013336
	speed: 0.2417s/iter; left time: 2256.7677s
	iters: 600, epoch: 2 | loss: 0.2887266
	speed: 0.2119s/iter; left time: 1957.5138s
	iters: 700, epoch: 2 | loss: 0.2387072
	speed: 0.2111s/iter; left time: 1929.3488s
	iters: 800, epoch: 2 | loss: 0.2236771
	speed: 0.2116s/iter; left time: 1912.6038s
	iters: 900, epoch: 2 | loss: 0.2468069
	speed: 0.2398s/iter; left time: 2143.1393s
	iters: 1000, epoch: 2 | loss: 0.2306562
	speed: 0.2172s/iter; left time: 1919.6285s
Epoch: 2 cost time: 240.3998260498047
Epoch: 2, Steps: 1093 | Train Loss: 0.2408941 Vali Loss: 0.1888703 Test Loss: 0.2224047
Validation loss decreased (0.191637 --> 0.188870).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2076742
	speed: 0.6784s/iter; left time: 5864.3690s
	iters: 200, epoch: 3 | loss: 0.2230643
	speed: 0.2367s/iter; left time: 2022.3596s
	iters: 300, epoch: 3 | loss: 0.2724091
	speed: 0.2165s/iter; left time: 1828.3572s
	iters: 400, epoch: 3 | loss: 0.2051733
	speed: 0.2412s/iter; left time: 2013.2170s
	iters: 500, epoch: 3 | loss: 0.3015458
	speed: 0.2414s/iter; left time: 1990.0481s
	iters: 600, epoch: 3 | loss: 0.2244805
	speed: 0.2286s/iter; left time: 1862.1734s
	iters: 700, epoch: 3 | loss: 0.2947876
	speed: 0.2114s/iter; left time: 1700.7448s
	iters: 800, epoch: 3 | loss: 0.2170780
	speed: 0.2116s/iter; left time: 1681.3502s
	iters: 900, epoch: 3 | loss: 0.2746899
	speed: 0.2105s/iter; left time: 1651.3809s
	iters: 1000, epoch: 3 | loss: 0.2281059
	speed: 0.2102s/iter; left time: 1628.1572s
Epoch: 3 cost time: 244.8722677230835
Epoch: 3, Steps: 1093 | Train Loss: 0.2344094 Vali Loss: 0.1851496 Test Loss: 0.2170695
Validation loss decreased (0.188870 --> 0.185150).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2040518
	speed: 0.6584s/iter; left time: 4972.3809s
	iters: 200, epoch: 4 | loss: 0.2411837
	speed: 0.2121s/iter; left time: 1580.2796s
	iters: 300, epoch: 4 | loss: 0.2445791
	speed: 0.2068s/iter; left time: 1520.4694s
	iters: 400, epoch: 4 | loss: 0.2044013
	speed: 0.2049s/iter; left time: 1485.8640s
	iters: 500, epoch: 4 | loss: 0.2915358
	speed: 0.2104s/iter; left time: 1504.9292s
	iters: 600, epoch: 4 | loss: 0.2380870
	speed: 0.2218s/iter; left time: 1564.0939s
	iters: 700, epoch: 4 | loss: 0.2396495
	speed: 0.2075s/iter; left time: 1442.5321s
	iters: 800, epoch: 4 | loss: 0.1993585
	speed: 0.2101s/iter; left time: 1439.4516s
	iters: 900, epoch: 4 | loss: 0.2517155
	speed: 0.2180s/iter; left time: 1471.8905s
	iters: 1000, epoch: 4 | loss: 0.2239621
	speed: 0.2255s/iter; left time: 1499.8539s
Epoch: 4 cost time: 233.07922196388245
Epoch: 4, Steps: 1093 | Train Loss: 0.2314252 Vali Loss: 0.1819198 Test Loss: 0.2151472
Validation loss decreased (0.185150 --> 0.181920).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2486210
	speed: 0.6818s/iter; left time: 4403.9391s
	iters: 200, epoch: 5 | loss: 0.2513341
	speed: 0.2068s/iter; left time: 1314.8427s
	iters: 300, epoch: 5 | loss: 0.2018067
	speed: 0.2227s/iter; left time: 1393.5921s
	iters: 400, epoch: 5 | loss: 0.2300192
	speed: 0.2145s/iter; left time: 1321.1522s
	iters: 500, epoch: 5 | loss: 0.2035373
	speed: 0.2109s/iter; left time: 1277.7138s
	iters: 600, epoch: 5 | loss: 0.2240948
	speed: 0.2146s/iter; left time: 1278.6865s
	iters: 700, epoch: 5 | loss: 0.1922209
	speed: 0.2104s/iter; left time: 1232.4657s
	iters: 800, epoch: 5 | loss: 0.2556165
	speed: 0.2101s/iter; left time: 1210.1652s
	iters: 900, epoch: 5 | loss: 0.2076091
	speed: 0.2146s/iter; left time: 1214.6960s
	iters: 1000, epoch: 5 | loss: 0.2392642
	speed: 0.2076s/iter; left time: 1153.9518s
Epoch: 5 cost time: 234.2675530910492
Epoch: 5, Steps: 1093 | Train Loss: 0.2299475 Vali Loss: 0.1820452 Test Loss: 0.2143005
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2208581
	speed: 0.7012s/iter; left time: 3762.4672s
	iters: 200, epoch: 6 | loss: 0.2348571
	speed: 0.2519s/iter; left time: 1326.2936s
	iters: 300, epoch: 6 | loss: 0.2733254
	speed: 0.2312s/iter; left time: 1194.4318s
	iters: 400, epoch: 6 | loss: 0.2174022
	speed: 0.2161s/iter; left time: 1094.7853s
	iters: 500, epoch: 6 | loss: 0.2079717
	speed: 0.2115s/iter; left time: 1050.3886s
	iters: 600, epoch: 6 | loss: 0.2366057
	speed: 0.2095s/iter; left time: 1019.5003s
	iters: 700, epoch: 6 | loss: 0.2325046
	speed: 0.2090s/iter; left time: 995.8651s
	iters: 800, epoch: 6 | loss: 0.2312372
	speed: 0.2219s/iter; left time: 1035.2212s
	iters: 900, epoch: 6 | loss: 0.2084273
	speed: 0.2286s/iter; left time: 1043.8846s
	iters: 1000, epoch: 6 | loss: 0.2280882
	speed: 0.2184s/iter; left time: 975.2044s
Epoch: 6 cost time: 245.28076577186584
Epoch: 6, Steps: 1093 | Train Loss: 0.2291573 Vali Loss: 0.1815743 Test Loss: 0.2137277
Validation loss decreased (0.181920 --> 0.181574).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2371397
	speed: 0.6668s/iter; left time: 2849.0303s
	iters: 200, epoch: 7 | loss: 0.2049403
	speed: 0.2148s/iter; left time: 896.3299s
	iters: 300, epoch: 7 | loss: 0.2691944
	speed: 0.2162s/iter; left time: 880.5300s
	iters: 400, epoch: 7 | loss: 0.2254190
	speed: 0.2196s/iter; left time: 872.5966s
	iters: 500, epoch: 7 | loss: 0.2188778
	speed: 0.2153s/iter; left time: 833.8268s
	iters: 600, epoch: 7 | loss: 0.2169083
	speed: 0.2185s/iter; left time: 824.4369s
	iters: 700, epoch: 7 | loss: 0.2577083
	speed: 0.2166s/iter; left time: 795.6090s
	iters: 800, epoch: 7 | loss: 0.2603189
	speed: 0.2409s/iter; left time: 860.8720s
	iters: 900, epoch: 7 | loss: 0.2775162
	speed: 0.2155s/iter; left time: 748.3561s
	iters: 1000, epoch: 7 | loss: 0.2072919
	speed: 0.2110s/iter; left time: 711.7093s
Epoch: 7 cost time: 238.24131393432617
Epoch: 7, Steps: 1093 | Train Loss: 0.2287362 Vali Loss: 0.1813853 Test Loss: 0.2135649
Validation loss decreased (0.181574 --> 0.181385).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2373654
	speed: 0.6852s/iter; left time: 2178.8088s
	iters: 200, epoch: 8 | loss: 0.2355304
	speed: 0.2092s/iter; left time: 644.3160s
	iters: 300, epoch: 8 | loss: 0.2537540
	speed: 0.2079s/iter; left time: 619.6431s
	iters: 400, epoch: 8 | loss: 0.2266389
	speed: 0.2091s/iter; left time: 602.1447s
	iters: 500, epoch: 8 | loss: 0.2203594
	speed: 0.2104s/iter; left time: 585.0375s
	iters: 600, epoch: 8 | loss: 0.2146854
	speed: 0.2185s/iter; left time: 585.6337s
	iters: 700, epoch: 8 | loss: 0.2681749
	speed: 0.2093s/iter; left time: 540.0114s
	iters: 800, epoch: 8 | loss: 0.2058959
	speed: 0.2209s/iter; left time: 547.8469s
	iters: 900, epoch: 8 | loss: 0.2268659
	speed: 0.2169s/iter; left time: 516.2824s
	iters: 1000, epoch: 8 | loss: 0.2146638
	speed: 0.2097s/iter; left time: 478.2133s
Epoch: 8 cost time: 235.25991296768188
Epoch: 8, Steps: 1093 | Train Loss: 0.2284991 Vali Loss: 0.1812590 Test Loss: 0.2134648
Validation loss decreased (0.181385 --> 0.181259).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2138109
	speed: 0.6604s/iter; left time: 1378.3473s
	iters: 200, epoch: 9 | loss: 0.2403620
	speed: 0.2141s/iter; left time: 425.4441s
	iters: 300, epoch: 9 | loss: 0.2475130
	speed: 0.2167s/iter; left time: 408.9553s
	iters: 400, epoch: 9 | loss: 0.2057113
	speed: 0.2101s/iter; left time: 375.5301s
	iters: 500, epoch: 9 | loss: 0.2124745
	speed: 0.2223s/iter; left time: 374.9660s
	iters: 600, epoch: 9 | loss: 0.2626718
	speed: 0.2230s/iter; left time: 353.8652s
	iters: 700, epoch: 9 | loss: 0.2186027
	speed: 0.2457s/iter; left time: 365.4275s
	iters: 800, epoch: 9 | loss: 0.2079754
	speed: 0.2113s/iter; left time: 293.0347s
	iters: 900, epoch: 9 | loss: 0.2403770
	speed: 0.2133s/iter; left time: 274.5788s
	iters: 1000, epoch: 9 | loss: 0.2436836
	speed: 0.2116s/iter; left time: 251.1685s
Epoch: 9 cost time: 238.2557294368744
Epoch: 9, Steps: 1093 | Train Loss: 0.2284437 Vali Loss: 0.1810875 Test Loss: 0.2133870
Validation loss decreased (0.181259 --> 0.181087).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2127879
	speed: 0.6836s/iter; left time: 679.5053s
	iters: 200, epoch: 10 | loss: 0.2090673
	speed: 0.2112s/iter; left time: 188.8211s
	iters: 300, epoch: 10 | loss: 0.1956383
	speed: 0.2119s/iter; left time: 168.2675s
	iters: 400, epoch: 10 | loss: 0.2144306
	speed: 0.2110s/iter; left time: 146.4531s
	iters: 500, epoch: 10 | loss: 0.2323445
	speed: 0.2045s/iter; left time: 121.4643s
	iters: 600, epoch: 10 | loss: 0.2276846
	speed: 0.2239s/iter; left time: 110.6083s
	iters: 700, epoch: 10 | loss: 0.2010328
	speed: 0.2122s/iter; left time: 83.6009s
	iters: 800, epoch: 10 | loss: 0.2210515
	speed: 0.2070s/iter; left time: 60.8524s
	iters: 900, epoch: 10 | loss: 0.2016778
	speed: 0.2081s/iter; left time: 40.3633s
	iters: 1000, epoch: 10 | loss: 0.2384877
	speed: 0.2095s/iter; left time: 19.6912s
Epoch: 10 cost time: 233.36060905456543
Epoch: 10, Steps: 1093 | Train Loss: 0.2283584 Vali Loss: 0.1811516 Test Loss: 0.2133649
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_192_720_RLinear_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.21329611539840698, mae:0.299708753824234
