Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_120_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=120, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_120_720_RLinear_custom_ftM_sl120_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17573
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3137127
	speed: 0.2356s/iter; left time: 2563.9632s
	iters: 200, epoch: 1 | loss: 0.3072359
	speed: 0.2354s/iter; left time: 2538.2725s
	iters: 300, epoch: 1 | loss: 0.2710600
	speed: 0.2280s/iter; left time: 2435.3508s
	iters: 400, epoch: 1 | loss: 0.2722277
	speed: 0.2034s/iter; left time: 2152.0757s
	iters: 500, epoch: 1 | loss: 0.2849089
	speed: 0.2013s/iter; left time: 2109.9450s
	iters: 600, epoch: 1 | loss: 0.2602007
	speed: 0.2015s/iter; left time: 2091.3475s
	iters: 700, epoch: 1 | loss: 0.2688125
	speed: 0.2028s/iter; left time: 2085.1185s
	iters: 800, epoch: 1 | loss: 0.2488477
	speed: 0.2071s/iter; left time: 2108.7714s
	iters: 900, epoch: 1 | loss: 0.2853652
	speed: 0.2279s/iter; left time: 2297.0744s
	iters: 1000, epoch: 1 | loss: 0.2363401
	speed: 0.2043s/iter; left time: 2038.6533s
Epoch: 1 cost time: 234.20235681533813
Epoch: 1, Steps: 1098 | Train Loss: 0.2932890 Vali Loss: 0.2053688 Test Loss: 0.2383812
Validation loss decreased (inf --> 0.205369).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2676607
	speed: 0.6159s/iter; left time: 6024.8665s
	iters: 200, epoch: 2 | loss: 0.2476467
	speed: 0.1960s/iter; left time: 1897.5992s
	iters: 300, epoch: 2 | loss: 0.2642496
	speed: 0.2057s/iter; left time: 1971.0166s
	iters: 400, epoch: 2 | loss: 0.2886324
	speed: 0.2286s/iter; left time: 2167.6109s
	iters: 500, epoch: 2 | loss: 0.2249446
	speed: 0.2319s/iter; left time: 2176.2169s
	iters: 600, epoch: 2 | loss: 0.2643481
	speed: 0.2193s/iter; left time: 2035.4458s
	iters: 700, epoch: 2 | loss: 0.2592753
	speed: 0.2061s/iter; left time: 1892.9414s
	iters: 800, epoch: 2 | loss: 0.2244378
	speed: 0.2225s/iter; left time: 2021.2008s
	iters: 900, epoch: 2 | loss: 0.2680905
	speed: 0.2343s/iter; left time: 2104.3207s
	iters: 1000, epoch: 2 | loss: 0.2664647
	speed: 0.1988s/iter; left time: 1765.9436s
Epoch: 2 cost time: 234.4674289226532
Epoch: 2, Steps: 1098 | Train Loss: 0.2575956 Vali Loss: 0.2017453 Test Loss: 0.2355915
Validation loss decreased (0.205369 --> 0.201745).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2764442
	speed: 0.6238s/iter; left time: 5417.5734s
	iters: 200, epoch: 3 | loss: 0.2639873
	speed: 0.1973s/iter; left time: 1694.2461s
	iters: 300, epoch: 3 | loss: 0.2435195
	speed: 0.1966s/iter; left time: 1668.3656s
	iters: 400, epoch: 3 | loss: 0.2468633
	speed: 0.1963s/iter; left time: 1646.2615s
	iters: 500, epoch: 3 | loss: 0.2627984
	speed: 0.2088s/iter; left time: 1729.5988s
	iters: 600, epoch: 3 | loss: 0.2249481
	speed: 0.2039s/iter; left time: 1668.7607s
	iters: 700, epoch: 3 | loss: 0.2755073
	speed: 0.1953s/iter; left time: 1578.7401s
	iters: 800, epoch: 3 | loss: 0.2392706
	speed: 0.2056s/iter; left time: 1641.6239s
	iters: 900, epoch: 3 | loss: 0.2510000
	speed: 0.2003s/iter; left time: 1579.4902s
	iters: 1000, epoch: 3 | loss: 0.3200077
	speed: 0.2136s/iter; left time: 1662.9767s
Epoch: 3 cost time: 222.58331680297852
Epoch: 3, Steps: 1098 | Train Loss: 0.2525675 Vali Loss: 0.1994217 Test Loss: 0.2326054
Validation loss decreased (0.201745 --> 0.199422).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2216674
	speed: 0.6167s/iter; left time: 4678.8012s
	iters: 200, epoch: 4 | loss: 0.2525870
	speed: 0.2158s/iter; left time: 1616.0050s
	iters: 300, epoch: 4 | loss: 0.2430547
	speed: 0.2222s/iter; left time: 1641.4835s
	iters: 400, epoch: 4 | loss: 0.2613001
	speed: 0.2169s/iter; left time: 1580.3179s
	iters: 500, epoch: 4 | loss: 0.2749766
	speed: 0.2003s/iter; left time: 1439.6683s
	iters: 600, epoch: 4 | loss: 0.2523245
	speed: 0.1977s/iter; left time: 1401.1115s
	iters: 700, epoch: 4 | loss: 0.3120396
	speed: 0.1944s/iter; left time: 1358.0874s
	iters: 800, epoch: 4 | loss: 0.2351164
	speed: 0.1996s/iter; left time: 1374.8472s
	iters: 900, epoch: 4 | loss: 0.2281563
	speed: 0.1976s/iter; left time: 1341.1462s
	iters: 1000, epoch: 4 | loss: 0.2429980
	speed: 0.2401s/iter; left time: 1605.8278s
Epoch: 4 cost time: 230.4411461353302
Epoch: 4, Steps: 1098 | Train Loss: 0.2505510 Vali Loss: 0.1980294 Test Loss: 0.2316025
Validation loss decreased (0.199422 --> 0.198029).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2612773
	speed: 0.6368s/iter; left time: 4132.2771s
	iters: 200, epoch: 5 | loss: 0.2485420
	speed: 0.1985s/iter; left time: 1268.4204s
	iters: 300, epoch: 5 | loss: 0.2363904
	speed: 0.1985s/iter; left time: 1248.5329s
	iters: 400, epoch: 5 | loss: 0.2695582
	speed: 0.1966s/iter; left time: 1217.0645s
	iters: 500, epoch: 5 | loss: 0.2624727
	speed: 0.1972s/iter; left time: 1200.7480s
	iters: 600, epoch: 5 | loss: 0.2331108
	speed: 0.2067s/iter; left time: 1238.0553s
	iters: 700, epoch: 5 | loss: 0.2615446
	speed: 0.1983s/iter; left time: 1167.5928s
	iters: 800, epoch: 5 | loss: 0.2613257
	speed: 0.1970s/iter; left time: 1140.1972s
	iters: 900, epoch: 5 | loss: 0.2300187
	speed: 0.2144s/iter; left time: 1219.9698s
	iters: 1000, epoch: 5 | loss: 0.2561091
	speed: 0.1935s/iter; left time: 1081.5927s
Epoch: 5 cost time: 219.85693907737732
Epoch: 5, Steps: 1098 | Train Loss: 0.2495216 Vali Loss: 0.1980059 Test Loss: 0.2309067
Validation loss decreased (0.198029 --> 0.198006).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2592817
	speed: 0.6114s/iter; left time: 3295.8831s
	iters: 200, epoch: 6 | loss: 0.2603101
	speed: 0.1932s/iter; left time: 1022.2474s
	iters: 300, epoch: 6 | loss: 0.2331254
	speed: 0.2010s/iter; left time: 1043.5396s
	iters: 400, epoch: 6 | loss: 0.2374145
	speed: 0.2094s/iter; left time: 1066.0030s
	iters: 500, epoch: 6 | loss: 0.2481865
	speed: 0.1963s/iter; left time: 979.9459s
	iters: 600, epoch: 6 | loss: 0.2499996
	speed: 0.1965s/iter; left time: 960.9923s
	iters: 700, epoch: 6 | loss: 0.2423921
	speed: 0.1999s/iter; left time: 957.6968s
	iters: 800, epoch: 6 | loss: 0.2696367
	speed: 0.1962s/iter; left time: 920.2227s
	iters: 900, epoch: 6 | loss: 0.2512719
	speed: 0.2105s/iter; left time: 966.2283s
	iters: 1000, epoch: 6 | loss: 0.2454323
	speed: 0.2027s/iter; left time: 910.1370s
Epoch: 6 cost time: 220.28237128257751
Epoch: 6, Steps: 1098 | Train Loss: 0.2489699 Vali Loss: 0.1977111 Test Loss: 0.2305492
Validation loss decreased (0.198006 --> 0.197711).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2481717
	speed: 0.6213s/iter; left time: 2667.3543s
	iters: 200, epoch: 7 | loss: 0.2488977
	speed: 0.1988s/iter; left time: 833.5334s
	iters: 300, epoch: 7 | loss: 0.2263347
	speed: 0.1971s/iter; left time: 806.5435s
	iters: 400, epoch: 7 | loss: 0.2699126
	speed: 0.1962s/iter; left time: 783.4150s
	iters: 500, epoch: 7 | loss: 0.2625257
	speed: 0.2022s/iter; left time: 787.3323s
	iters: 600, epoch: 7 | loss: 0.2569084
	speed: 0.2046s/iter; left time: 775.9235s
	iters: 700, epoch: 7 | loss: 0.2694887
	speed: 0.2312s/iter; left time: 853.8483s
	iters: 800, epoch: 7 | loss: 0.2343052
	speed: 0.2245s/iter; left time: 806.4666s
	iters: 900, epoch: 7 | loss: 0.2726001
	speed: 0.2132s/iter; left time: 744.8044s
	iters: 1000, epoch: 7 | loss: 0.2163669
	speed: 0.2153s/iter; left time: 730.6115s
Epoch: 7 cost time: 231.70546007156372
Epoch: 7, Steps: 1098 | Train Loss: 0.2486829 Vali Loss: 0.1976551 Test Loss: 0.2303246
Validation loss decreased (0.197711 --> 0.197655).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2883010
	speed: 0.6607s/iter; left time: 2110.9424s
	iters: 200, epoch: 8 | loss: 0.2117975
	speed: 0.2017s/iter; left time: 624.1305s
	iters: 300, epoch: 8 | loss: 0.3025225
	speed: 0.2055s/iter; left time: 615.3368s
	iters: 400, epoch: 8 | loss: 0.2458184
	speed: 0.2107s/iter; left time: 609.9680s
	iters: 500, epoch: 8 | loss: 0.2177359
	speed: 0.2180s/iter; left time: 609.2416s
	iters: 600, epoch: 8 | loss: 0.2185543
	speed: 0.2000s/iter; left time: 538.9382s
	iters: 700, epoch: 8 | loss: 0.2277637
	speed: 0.1984s/iter; left time: 514.8295s
	iters: 800, epoch: 8 | loss: 0.2480243
	speed: 0.1974s/iter; left time: 492.4198s
	iters: 900, epoch: 8 | loss: 0.2310581
	speed: 0.2185s/iter; left time: 523.3896s
	iters: 1000, epoch: 8 | loss: 0.2619771
	speed: 0.2406s/iter; left time: 552.2120s
Epoch: 8 cost time: 231.71158480644226
Epoch: 8, Steps: 1098 | Train Loss: 0.2485557 Vali Loss: 0.1975954 Test Loss: 0.2302595
Validation loss decreased (0.197655 --> 0.197595).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2255038
	speed: 0.6739s/iter; left time: 1413.1677s
	iters: 200, epoch: 9 | loss: 0.2315086
	speed: 0.2299s/iter; left time: 459.0542s
	iters: 300, epoch: 9 | loss: 0.2370310
	speed: 0.2139s/iter; left time: 405.7306s
	iters: 400, epoch: 9 | loss: 0.2755000
	speed: 0.1995s/iter; left time: 358.4465s
	iters: 500, epoch: 9 | loss: 0.2502740
	speed: 0.2019s/iter; left time: 342.6245s
	iters: 600, epoch: 9 | loss: 0.2505925
	speed: 0.2118s/iter; left time: 338.2325s
	iters: 700, epoch: 9 | loss: 0.2526833
	speed: 0.2016s/iter; left time: 301.8046s
	iters: 800, epoch: 9 | loss: 0.2731614
	speed: 0.1988s/iter; left time: 277.7243s
	iters: 900, epoch: 9 | loss: 0.2286595
	speed: 0.2122s/iter; left time: 275.1861s
	iters: 1000, epoch: 9 | loss: 0.2524514
	speed: 0.2347s/iter; left time: 280.9020s
Epoch: 9 cost time: 233.17713975906372
Epoch: 9, Steps: 1098 | Train Loss: 0.2484713 Vali Loss: 0.1976028 Test Loss: 0.2302166
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2415621
	speed: 0.6111s/iter; left time: 610.5365s
	iters: 200, epoch: 10 | loss: 0.2522561
	speed: 0.2044s/iter; left time: 183.7879s
	iters: 300, epoch: 10 | loss: 0.2421152
	speed: 0.1946s/iter; left time: 155.4715s
	iters: 400, epoch: 10 | loss: 0.2657608
	speed: 0.1978s/iter; left time: 138.2917s
	iters: 500, epoch: 10 | loss: 0.2447919
	speed: 0.1939s/iter; left time: 116.1328s
	iters: 600, epoch: 10 | loss: 0.2717854
	speed: 0.2083s/iter; left time: 103.9381s
	iters: 700, epoch: 10 | loss: 0.2509949
	speed: 0.2055s/iter; left time: 82.0011s
	iters: 800, epoch: 10 | loss: 0.2314257
	speed: 0.2023s/iter; left time: 60.4786s
	iters: 900, epoch: 10 | loss: 0.2433919
	speed: 0.1973s/iter; left time: 39.2549s
	iters: 1000, epoch: 10 | loss: 0.2131299
	speed: 0.1970s/iter; left time: 19.5016s
Epoch: 10 cost time: 220.98058772087097
Epoch: 10, Steps: 1098 | Train Loss: 0.2484209 Vali Loss: 0.1975704 Test Loss: 0.2302122
Validation loss decreased (0.197595 --> 0.197570).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_120_720_RLinear_custom_ftM_sl120_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2301311194896698, mae:0.3121687173843384
