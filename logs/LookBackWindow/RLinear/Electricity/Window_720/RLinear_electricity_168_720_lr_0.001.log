Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_168_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=168, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_168_720_RLinear_custom_ftM_sl168_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17525
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3103057
	speed: 0.2276s/iter; left time: 2469.2736s
	iters: 200, epoch: 1 | loss: 0.2494081
	speed: 0.2160s/iter; left time: 2322.2326s
	iters: 300, epoch: 1 | loss: 0.3267306
	speed: 0.2534s/iter; left time: 2699.2492s
	iters: 400, epoch: 1 | loss: 0.2851172
	speed: 0.2282s/iter; left time: 2407.8149s
	iters: 500, epoch: 1 | loss: 0.2487220
	speed: 0.2251s/iter; left time: 2352.2593s
	iters: 600, epoch: 1 | loss: 0.2479487
	speed: 0.2250s/iter; left time: 2328.7488s
	iters: 700, epoch: 1 | loss: 0.2427979
	speed: 0.2170s/iter; left time: 2224.3681s
	iters: 800, epoch: 1 | loss: 0.3203803
	speed: 0.2191s/iter; left time: 2224.3785s
	iters: 900, epoch: 1 | loss: 0.3120752
	speed: 0.2205s/iter; left time: 2216.5056s
	iters: 1000, epoch: 1 | loss: 0.2904072
	speed: 0.2227s/iter; left time: 2215.6148s
Epoch: 1 cost time: 246.75622534751892
Epoch: 1, Steps: 1095 | Train Loss: 0.2745628 Vali Loss: 0.1901449 Test Loss: 0.2232260
Validation loss decreased (inf --> 0.190145).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2854473
	speed: 0.6736s/iter; left time: 6571.8154s
	iters: 200, epoch: 2 | loss: 0.2521545
	speed: 0.2199s/iter; left time: 2123.1655s
	iters: 300, epoch: 2 | loss: 0.1951112
	speed: 0.2217s/iter; left time: 2118.4090s
	iters: 400, epoch: 2 | loss: 0.2146629
	speed: 0.1988s/iter; left time: 1879.5092s
	iters: 500, epoch: 2 | loss: 0.2240484
	speed: 0.2105s/iter; left time: 1969.6595s
	iters: 600, epoch: 2 | loss: 0.2695224
	speed: 0.2131s/iter; left time: 1972.1339s
	iters: 700, epoch: 2 | loss: 0.2592836
	speed: 0.2130s/iter; left time: 1950.2837s
	iters: 800, epoch: 2 | loss: 0.2385671
	speed: 0.2304s/iter; left time: 2086.7372s
	iters: 900, epoch: 2 | loss: 0.2472936
	speed: 0.2280s/iter; left time: 2041.9925s
	iters: 1000, epoch: 2 | loss: 0.2531693
	speed: 0.2298s/iter; left time: 2035.1076s
Epoch: 2 cost time: 239.17187428474426
Epoch: 2, Steps: 1095 | Train Loss: 0.2420011 Vali Loss: 0.1895856 Test Loss: 0.2228589
Validation loss decreased (0.190145 --> 0.189586).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2459690
	speed: 0.6869s/iter; left time: 5949.3799s
	iters: 200, epoch: 3 | loss: 0.2505122
	speed: 0.2336s/iter; left time: 2000.2704s
	iters: 300, epoch: 3 | loss: 0.2297300
	speed: 0.2198s/iter; left time: 1860.0103s
	iters: 400, epoch: 3 | loss: 0.2945489
	speed: 0.2297s/iter; left time: 1920.2017s
	iters: 500, epoch: 3 | loss: 0.2481501
	speed: 0.2324s/iter; left time: 1920.0845s
	iters: 600, epoch: 3 | loss: 0.2203240
	speed: 0.2283s/iter; left time: 1863.0181s
	iters: 700, epoch: 3 | loss: 0.2388275
	speed: 0.2269s/iter; left time: 1829.3666s
	iters: 800, epoch: 3 | loss: 0.2922725
	speed: 0.2297s/iter; left time: 1828.8882s
	iters: 900, epoch: 3 | loss: 0.2358334
	speed: 0.2305s/iter; left time: 1812.2384s
	iters: 1000, epoch: 3 | loss: 0.2141362
	speed: 0.2323s/iter; left time: 1802.8566s
Epoch: 3 cost time: 250.75307059288025
Epoch: 3, Steps: 1095 | Train Loss: 0.2361090 Vali Loss: 0.1858136 Test Loss: 0.2182865
Validation loss decreased (0.189586 --> 0.185814).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2288433
	speed: 0.6730s/iter; left time: 5091.7740s
	iters: 200, epoch: 4 | loss: 0.2204423
	speed: 0.2156s/iter; left time: 1609.4350s
	iters: 300, epoch: 4 | loss: 0.2349785
	speed: 0.2142s/iter; left time: 1577.9335s
	iters: 400, epoch: 4 | loss: 0.2881710
	speed: 0.2233s/iter; left time: 1622.4904s
	iters: 500, epoch: 4 | loss: 0.2425596
	speed: 0.2409s/iter; left time: 1726.0097s
	iters: 600, epoch: 4 | loss: 0.2471615
	speed: 0.2329s/iter; left time: 1645.4985s
	iters: 700, epoch: 4 | loss: 0.2216036
	speed: 0.2149s/iter; left time: 1497.0308s
	iters: 800, epoch: 4 | loss: 0.2271765
	speed: 0.2242s/iter; left time: 1539.5288s
	iters: 900, epoch: 4 | loss: 0.2167246
	speed: 0.2200s/iter; left time: 1488.8393s
	iters: 1000, epoch: 4 | loss: 0.2808544
	speed: 0.2558s/iter; left time: 1705.4558s
Epoch: 4 cost time: 247.5221745967865
Epoch: 4, Steps: 1095 | Train Loss: 0.2334895 Vali Loss: 0.1840287 Test Loss: 0.2167720
Validation loss decreased (0.185814 --> 0.184029).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2232444
	speed: 0.6909s/iter; left time: 4471.0860s
	iters: 200, epoch: 5 | loss: 0.2182879
	speed: 0.2147s/iter; left time: 1367.6078s
	iters: 300, epoch: 5 | loss: 0.2213973
	speed: 0.2493s/iter; left time: 1563.1816s
	iters: 400, epoch: 5 | loss: 0.2436094
	speed: 0.2141s/iter; left time: 1321.4406s
	iters: 500, epoch: 5 | loss: 0.2208624
	speed: 0.2109s/iter; left time: 1280.4378s
	iters: 600, epoch: 5 | loss: 0.2227233
	speed: 0.2113s/iter; left time: 1261.7763s
	iters: 700, epoch: 5 | loss: 0.2222035
	speed: 0.2036s/iter; left time: 1195.5534s
	iters: 800, epoch: 5 | loss: 0.2090649
	speed: 0.2116s/iter; left time: 1220.8667s
	iters: 900, epoch: 5 | loss: 0.2416821
	speed: 0.2195s/iter; left time: 1244.8464s
	iters: 1000, epoch: 5 | loss: 0.2465864
	speed: 0.2316s/iter; left time: 1290.2250s
Epoch: 5 cost time: 240.5484161376953
Epoch: 5, Steps: 1095 | Train Loss: 0.2321150 Vali Loss: 0.1838947 Test Loss: 0.2156426
Validation loss decreased (0.184029 --> 0.183895).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2435910
	speed: 0.6785s/iter; left time: 3647.7063s
	iters: 200, epoch: 6 | loss: 0.2382424
	speed: 0.2118s/iter; left time: 1117.3231s
	iters: 300, epoch: 6 | loss: 0.2199228
	speed: 0.2084s/iter; left time: 1078.6720s
	iters: 400, epoch: 6 | loss: 0.2421253
	speed: 0.2154s/iter; left time: 1093.4422s
	iters: 500, epoch: 6 | loss: 0.2555102
	speed: 0.2097s/iter; left time: 1043.2740s
	iters: 600, epoch: 6 | loss: 0.2157132
	speed: 0.2100s/iter; left time: 1023.9120s
	iters: 700, epoch: 6 | loss: 0.2124884
	speed: 0.2171s/iter; left time: 1036.8764s
	iters: 800, epoch: 6 | loss: 0.2103873
	speed: 0.2120s/iter; left time: 991.4060s
	iters: 900, epoch: 6 | loss: 0.2339357
	speed: 0.2101s/iter; left time: 961.2365s
	iters: 1000, epoch: 6 | loss: 0.2322400
	speed: 0.2073s/iter; left time: 927.8194s
Epoch: 6 cost time: 232.19047927856445
Epoch: 6, Steps: 1095 | Train Loss: 0.2314304 Vali Loss: 0.1827891 Test Loss: 0.2153045
Validation loss decreased (0.183895 --> 0.182789).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2529000
	speed: 0.6875s/iter; left time: 2943.3723s
	iters: 200, epoch: 7 | loss: 0.2525318
	speed: 0.2381s/iter; left time: 995.6621s
	iters: 300, epoch: 7 | loss: 0.2342894
	speed: 0.2448s/iter; left time: 999.0286s
	iters: 400, epoch: 7 | loss: 0.2267296
	speed: 0.2105s/iter; left time: 837.8629s
	iters: 500, epoch: 7 | loss: 0.2550198
	speed: 0.2069s/iter; left time: 803.0878s
	iters: 600, epoch: 7 | loss: 0.2670003
	speed: 0.2068s/iter; left time: 782.0811s
	iters: 700, epoch: 7 | loss: 0.2800879
	speed: 0.2103s/iter; left time: 773.9820s
	iters: 800, epoch: 7 | loss: 0.2276563
	speed: 0.2185s/iter; left time: 782.5117s
	iters: 900, epoch: 7 | loss: 0.2466672
	speed: 0.2105s/iter; left time: 732.7716s
	iters: 1000, epoch: 7 | loss: 0.2228482
	speed: 0.2081s/iter; left time: 703.6922s
Epoch: 7 cost time: 241.87158608436584
Epoch: 7, Steps: 1095 | Train Loss: 0.2310560 Vali Loss: 0.1828547 Test Loss: 0.2150010
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2064479
	speed: 0.6733s/iter; left time: 2145.0212s
	iters: 200, epoch: 8 | loss: 0.2074158
	speed: 0.2147s/iter; left time: 662.4582s
	iters: 300, epoch: 8 | loss: 0.2425801
	speed: 0.2180s/iter; left time: 650.9718s
	iters: 400, epoch: 8 | loss: 0.2125756
	speed: 0.2178s/iter; left time: 628.4281s
	iters: 500, epoch: 8 | loss: 0.2259827
	speed: 0.2140s/iter; left time: 596.2096s
	iters: 600, epoch: 8 | loss: 0.2029283
	speed: 0.2131s/iter; left time: 572.2908s
	iters: 700, epoch: 8 | loss: 0.2503114
	speed: 0.2148s/iter; left time: 555.3726s
	iters: 800, epoch: 8 | loss: 0.2721666
	speed: 0.2410s/iter; left time: 599.1531s
	iters: 900, epoch: 8 | loss: 0.2078469
	speed: 0.2115s/iter; left time: 504.6828s
	iters: 1000, epoch: 8 | loss: 0.2024475
	speed: 0.2150s/iter; left time: 491.4590s
Epoch: 8 cost time: 241.74044585227966
Epoch: 8, Steps: 1095 | Train Loss: 0.2308232 Vali Loss: 0.1826979 Test Loss: 0.2149943
Validation loss decreased (0.182789 --> 0.182698).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2258256
	speed: 0.7101s/iter; left time: 1484.8739s
	iters: 200, epoch: 9 | loss: 0.2481157
	speed: 0.2076s/iter; left time: 413.3878s
	iters: 300, epoch: 9 | loss: 0.1971347
	speed: 0.2088s/iter; left time: 394.8619s
	iters: 400, epoch: 9 | loss: 0.2378820
	speed: 0.2393s/iter; left time: 428.5234s
	iters: 500, epoch: 9 | loss: 0.2324764
	speed: 0.2392s/iter; left time: 404.4151s
	iters: 600, epoch: 9 | loss: 0.2057109
	speed: 0.2390s/iter; left time: 380.3038s
	iters: 700, epoch: 9 | loss: 0.2578505
	speed: 0.2544s/iter; left time: 379.2729s
	iters: 800, epoch: 9 | loss: 0.2125543
	speed: 0.2224s/iter; left time: 309.4224s
	iters: 900, epoch: 9 | loss: 0.2610975
	speed: 0.2086s/iter; left time: 269.2596s
	iters: 1000, epoch: 9 | loss: 0.2663759
	speed: 0.2094s/iter; left time: 249.3744s
Epoch: 9 cost time: 245.30059480667114
Epoch: 9, Steps: 1095 | Train Loss: 0.2307732 Vali Loss: 0.1826640 Test Loss: 0.2149319
Validation loss decreased (0.182698 --> 0.182664).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2427568
	speed: 0.6615s/iter; left time: 658.8945s
	iters: 200, epoch: 10 | loss: 0.2122742
	speed: 0.2151s/iter; left time: 192.7276s
	iters: 300, epoch: 10 | loss: 0.2696413
	speed: 0.2292s/iter; left time: 182.4233s
	iters: 400, epoch: 10 | loss: 0.1946270
	speed: 0.2242s/iter; left time: 156.0683s
	iters: 500, epoch: 10 | loss: 0.2347966
	speed: 0.2163s/iter; left time: 128.9299s
	iters: 600, epoch: 10 | loss: 0.2030160
	speed: 0.2268s/iter; left time: 112.4720s
	iters: 700, epoch: 10 | loss: 0.2177342
	speed: 0.2272s/iter; left time: 89.9776s
	iters: 800, epoch: 10 | loss: 0.2343079
	speed: 0.2281s/iter; left time: 67.5272s
	iters: 900, epoch: 10 | loss: 0.2365497
	speed: 0.2213s/iter; left time: 43.3704s
	iters: 1000, epoch: 10 | loss: 0.2116136
	speed: 0.2119s/iter; left time: 20.3413s
Epoch: 10 cost time: 244.341863155365
Epoch: 10, Steps: 1095 | Train Loss: 0.2307004 Vali Loss: 0.1827175 Test Loss: 0.2149126
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_168_720_RLinear_custom_ftM_sl168_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2148417830467224, mae:0.3010716438293457
