Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_144_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_144_720_RLinear_custom_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17549
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2982471
	speed: 0.2086s/iter; left time: 2265.3985s
	iters: 200, epoch: 1 | loss: 0.2851455
	speed: 0.1999s/iter; left time: 2151.1507s
	iters: 300, epoch: 1 | loss: 0.2827013
	speed: 0.1991s/iter; left time: 2122.2746s
	iters: 400, epoch: 1 | loss: 0.2744265
	speed: 0.2021s/iter; left time: 2134.8903s
	iters: 500, epoch: 1 | loss: 0.2572742
	speed: 0.1983s/iter; left time: 2074.2573s
	iters: 600, epoch: 1 | loss: 0.2623563
	speed: 0.1973s/iter; left time: 2044.2032s
	iters: 700, epoch: 1 | loss: 0.2396798
	speed: 0.2004s/iter; left time: 2055.8847s
	iters: 800, epoch: 1 | loss: 0.2492713
	speed: 0.1960s/iter; left time: 1991.5131s
	iters: 900, epoch: 1 | loss: 0.2173302
	speed: 0.1992s/iter; left time: 2004.4024s
	iters: 1000, epoch: 1 | loss: 0.3098488
	speed: 0.2016s/iter; left time: 2007.7034s
Epoch: 1 cost time: 219.77919936180115
Epoch: 1, Steps: 1096 | Train Loss: 0.2804884 Vali Loss: 0.1958053 Test Loss: 0.2289459
Validation loss decreased (inf --> 0.195805).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2263002
	speed: 0.6351s/iter; left time: 6201.8057s
	iters: 200, epoch: 2 | loss: 0.2269728
	speed: 0.2232s/iter; left time: 2157.6896s
	iters: 300, epoch: 2 | loss: 0.2736328
	speed: 0.2019s/iter; left time: 1930.7510s
	iters: 400, epoch: 2 | loss: 0.2396645
	speed: 0.2013s/iter; left time: 1905.5704s
	iters: 500, epoch: 2 | loss: 0.2760242
	speed: 0.2015s/iter; left time: 1886.6988s
	iters: 600, epoch: 2 | loss: 0.2291135
	speed: 0.2227s/iter; left time: 2063.4605s
	iters: 700, epoch: 2 | loss: 0.2560569
	speed: 0.2292s/iter; left time: 2100.5294s
	iters: 800, epoch: 2 | loss: 0.2540804
	speed: 0.2303s/iter; left time: 2087.9079s
	iters: 900, epoch: 2 | loss: 0.2480331
	speed: 0.2572s/iter; left time: 2305.8669s
	iters: 1000, epoch: 2 | loss: 0.2547790
	speed: 0.2277s/iter; left time: 2018.7236s
Epoch: 2 cost time: 242.91247034072876
Epoch: 2, Steps: 1096 | Train Loss: 0.2467091 Vali Loss: 0.1940018 Test Loss: 0.2254468
Validation loss decreased (0.195805 --> 0.194002).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2637921
	speed: 0.6868s/iter; left time: 5954.2968s
	iters: 200, epoch: 3 | loss: 0.2231377
	speed: 0.2249s/iter; left time: 1927.4510s
	iters: 300, epoch: 3 | loss: 0.2225176
	speed: 0.2245s/iter; left time: 1901.5481s
	iters: 400, epoch: 3 | loss: 0.2405480
	speed: 0.1942s/iter; left time: 1625.1213s
	iters: 500, epoch: 3 | loss: 0.2535573
	speed: 0.1958s/iter; left time: 1619.1054s
	iters: 600, epoch: 3 | loss: 0.2677717
	speed: 0.2117s/iter; left time: 1729.6171s
	iters: 700, epoch: 3 | loss: 0.2100159
	speed: 0.2141s/iter; left time: 1727.7351s
	iters: 800, epoch: 3 | loss: 0.2406710
	speed: 0.2011s/iter; left time: 1602.3113s
	iters: 900, epoch: 3 | loss: 0.2501456
	speed: 0.2055s/iter; left time: 1616.7178s
	iters: 1000, epoch: 3 | loss: 0.2871426
	speed: 0.1991s/iter; left time: 1546.9639s
Epoch: 3 cost time: 229.7287952899933
Epoch: 3, Steps: 1096 | Train Loss: 0.2412294 Vali Loss: 0.1896438 Test Loss: 0.2233059
Validation loss decreased (0.194002 --> 0.189644).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2086692
	speed: 0.6306s/iter; left time: 4775.5662s
	iters: 200, epoch: 4 | loss: 0.2537164
	speed: 0.2025s/iter; left time: 1513.3688s
	iters: 300, epoch: 4 | loss: 0.2456020
	speed: 0.1989s/iter; left time: 1466.3304s
	iters: 400, epoch: 4 | loss: 0.2707226
	speed: 0.1969s/iter; left time: 1432.2732s
	iters: 500, epoch: 4 | loss: 0.2175390
	speed: 0.1956s/iter; left time: 1402.7851s
	iters: 600, epoch: 4 | loss: 0.2327897
	speed: 0.2009s/iter; left time: 1420.6803s
	iters: 700, epoch: 4 | loss: 0.2511661
	speed: 0.1968s/iter; left time: 1372.1222s
	iters: 800, epoch: 4 | loss: 0.2187346
	speed: 0.1953s/iter; left time: 1342.1919s
	iters: 900, epoch: 4 | loss: 0.2245722
	speed: 0.2011s/iter; left time: 1361.9517s
	iters: 1000, epoch: 4 | loss: 0.2295481
	speed: 0.1987s/iter; left time: 1326.1729s
Epoch: 4 cost time: 219.12642073631287
Epoch: 4, Steps: 1096 | Train Loss: 0.2388919 Vali Loss: 0.1891336 Test Loss: 0.2210518
Validation loss decreased (0.189644 --> 0.189134).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2320648
	speed: 0.6225s/iter; left time: 4031.7964s
	iters: 200, epoch: 5 | loss: 0.2073786
	speed: 0.2011s/iter; left time: 1282.4811s
	iters: 300, epoch: 5 | loss: 0.2139374
	speed: 0.2127s/iter; left time: 1335.3061s
	iters: 400, epoch: 5 | loss: 0.2102700
	speed: 0.1947s/iter; left time: 1202.6805s
	iters: 500, epoch: 5 | loss: 0.2431566
	speed: 0.1980s/iter; left time: 1203.2219s
	iters: 600, epoch: 5 | loss: 0.2060343
	speed: 0.2068s/iter; left time: 1236.0828s
	iters: 700, epoch: 5 | loss: 0.2368469
	speed: 0.1948s/iter; left time: 1144.8122s
	iters: 800, epoch: 5 | loss: 0.2436526
	speed: 0.1942s/iter; left time: 1122.0953s
	iters: 900, epoch: 5 | loss: 0.2269771
	speed: 0.1950s/iter; left time: 1106.7816s
	iters: 1000, epoch: 5 | loss: 0.2557441
	speed: 0.1935s/iter; left time: 1079.2606s
Epoch: 5 cost time: 220.15562319755554
Epoch: 5, Steps: 1096 | Train Loss: 0.2377237 Vali Loss: 0.1877770 Test Loss: 0.2201453
Validation loss decreased (0.189134 --> 0.187777).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2042737
	speed: 0.6445s/iter; left time: 3468.1188s
	iters: 200, epoch: 6 | loss: 0.1949912
	speed: 0.1979s/iter; left time: 1044.8949s
	iters: 300, epoch: 6 | loss: 0.2359972
	speed: 0.1982s/iter; left time: 1026.9249s
	iters: 400, epoch: 6 | loss: 0.2989464
	speed: 0.2021s/iter; left time: 1027.0634s
	iters: 500, epoch: 6 | loss: 0.2443762
	speed: 0.1950s/iter; left time: 971.1921s
	iters: 600, epoch: 6 | loss: 0.2481342
	speed: 0.1956s/iter; left time: 954.4963s
	iters: 700, epoch: 6 | loss: 0.2735186
	speed: 0.2020s/iter; left time: 965.9865s
	iters: 800, epoch: 6 | loss: 0.2355848
	speed: 0.2059s/iter; left time: 963.8837s
	iters: 900, epoch: 6 | loss: 0.2306613
	speed: 0.1967s/iter; left time: 901.0488s
	iters: 1000, epoch: 6 | loss: 0.2848123
	speed: 0.1934s/iter; left time: 866.4533s
Epoch: 6 cost time: 219.08650994300842
Epoch: 6, Steps: 1096 | Train Loss: 0.2370925 Vali Loss: 0.1876718 Test Loss: 0.2197753
Validation loss decreased (0.187777 --> 0.187672).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2450233
	speed: 0.6272s/iter; left time: 2687.6397s
	iters: 200, epoch: 7 | loss: 0.2242278
	speed: 0.1949s/iter; left time: 815.7268s
	iters: 300, epoch: 7 | loss: 0.2297108
	speed: 0.1995s/iter; left time: 814.8843s
	iters: 400, epoch: 7 | loss: 0.2333103
	speed: 0.1987s/iter; left time: 791.9199s
	iters: 500, epoch: 7 | loss: 0.2447812
	speed: 0.1943s/iter; left time: 755.0168s
	iters: 600, epoch: 7 | loss: 0.2746413
	speed: 0.2197s/iter; left time: 831.6400s
	iters: 700, epoch: 7 | loss: 0.2471641
	speed: 0.1954s/iter; left time: 720.1095s
	iters: 800, epoch: 7 | loss: 0.2539889
	speed: 0.1985s/iter; left time: 711.6960s
	iters: 900, epoch: 7 | loss: 0.2348053
	speed: 0.2098s/iter; left time: 731.2873s
	iters: 1000, epoch: 7 | loss: 0.2245258
	speed: 0.1982s/iter; left time: 670.8200s
Epoch: 7 cost time: 220.58454394340515
Epoch: 7, Steps: 1096 | Train Loss: 0.2367973 Vali Loss: 0.1874626 Test Loss: 0.2195605
Validation loss decreased (0.187672 --> 0.187463).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2134291
	speed: 0.6375s/iter; left time: 2032.8987s
	iters: 200, epoch: 8 | loss: 0.2376546
	speed: 0.2302s/iter; left time: 711.2096s
	iters: 300, epoch: 8 | loss: 0.2661048
	speed: 0.2010s/iter; left time: 600.7767s
	iters: 400, epoch: 8 | loss: 0.2162423
	speed: 0.2044s/iter; left time: 590.3746s
	iters: 500, epoch: 8 | loss: 0.2674660
	speed: 0.2051s/iter; left time: 571.9918s
	iters: 600, epoch: 8 | loss: 0.2542217
	speed: 0.2044s/iter; left time: 549.5109s
	iters: 700, epoch: 8 | loss: 0.2072993
	speed: 0.2032s/iter; left time: 526.1839s
	iters: 800, epoch: 8 | loss: 0.2076017
	speed: 0.2026s/iter; left time: 504.3162s
	iters: 900, epoch: 8 | loss: 0.2164742
	speed: 0.1978s/iter; left time: 472.6472s
	iters: 1000, epoch: 8 | loss: 0.2364523
	speed: 0.1958s/iter; left time: 448.2953s
Epoch: 8 cost time: 227.4501793384552
Epoch: 8, Steps: 1096 | Train Loss: 0.2366064 Vali Loss: 0.1872485 Test Loss: 0.2195678
Validation loss decreased (0.187463 --> 0.187248).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2193584
	speed: 0.6947s/iter; left time: 1453.9998s
	iters: 200, epoch: 9 | loss: 0.2788490
	speed: 0.2058s/iter; left time: 410.1853s
	iters: 300, epoch: 9 | loss: 0.2423258
	speed: 0.1964s/iter; left time: 371.8639s
	iters: 400, epoch: 9 | loss: 0.2271939
	speed: 0.1958s/iter; left time: 351.1508s
	iters: 500, epoch: 9 | loss: 0.2254905
	speed: 0.1947s/iter; left time: 329.5994s
	iters: 600, epoch: 9 | loss: 0.2501487
	speed: 0.2079s/iter; left time: 331.2172s
	iters: 700, epoch: 9 | loss: 0.2111930
	speed: 0.2074s/iter; left time: 309.6745s
	iters: 800, epoch: 9 | loss: 0.2491383
	speed: 0.1973s/iter; left time: 274.7710s
	iters: 900, epoch: 9 | loss: 0.2127699
	speed: 0.1977s/iter; left time: 255.6817s
	iters: 1000, epoch: 9 | loss: 0.2350477
	speed: 0.1987s/iter; left time: 237.0735s
Epoch: 9 cost time: 222.89909195899963
Epoch: 9, Steps: 1096 | Train Loss: 0.2365009 Vali Loss: 0.1872513 Test Loss: 0.2195206
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2370862
	speed: 0.6263s/iter; left time: 624.4435s
	iters: 200, epoch: 10 | loss: 0.2357951
	speed: 0.1926s/iter; left time: 172.7471s
	iters: 300, epoch: 10 | loss: 0.2894799
	speed: 0.1938s/iter; left time: 154.4346s
	iters: 400, epoch: 10 | loss: 0.2318115
	speed: 0.2131s/iter; left time: 148.5200s
	iters: 500, epoch: 10 | loss: 0.2389695
	speed: 0.1970s/iter; left time: 117.6306s
	iters: 600, epoch: 10 | loss: 0.2154516
	speed: 0.1961s/iter; left time: 97.4519s
	iters: 700, epoch: 10 | loss: 0.2201583
	speed: 0.1960s/iter; left time: 77.8160s
	iters: 800, epoch: 10 | loss: 0.2392230
	speed: 0.2046s/iter; left time: 60.7754s
	iters: 900, epoch: 10 | loss: 0.2523851
	speed: 0.2093s/iter; left time: 41.2412s
	iters: 1000, epoch: 10 | loss: 0.2207871
	speed: 0.2333s/iter; left time: 22.6259s
Epoch: 10 cost time: 223.801682472229
Epoch: 10, Steps: 1096 | Train Loss: 0.2364866 Vali Loss: 0.1872226 Test Loss: 0.2194969
Validation loss decreased (0.187248 --> 0.187223).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_144_720_RLinear_custom_ftM_sl144_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.21940943598747253, mae:0.3047582805156708
