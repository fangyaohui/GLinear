Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_672_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=672, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_672_24_RLinear_custom_ftM_sl672_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17717
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1805039
	speed: 0.2181s/iter; left time: 2393.1836s
	iters: 200, epoch: 1 | loss: 0.1704813
	speed: 0.1969s/iter; left time: 2140.9659s
	iters: 300, epoch: 1 | loss: 0.1411327
	speed: 0.1975s/iter; left time: 2126.9479s
	iters: 400, epoch: 1 | loss: 0.1361702
	speed: 0.1951s/iter; left time: 2081.9941s
	iters: 500, epoch: 1 | loss: 0.1380942
	speed: 0.1949s/iter; left time: 2060.4544s
	iters: 600, epoch: 1 | loss: 0.1671009
	speed: 0.2002s/iter; left time: 2096.7769s
	iters: 700, epoch: 1 | loss: 0.1443586
	speed: 0.1952s/iter; left time: 2024.1268s
	iters: 800, epoch: 1 | loss: 0.1185519
	speed: 0.1949s/iter; left time: 2001.8967s
	iters: 900, epoch: 1 | loss: 0.1279419
	speed: 0.1955s/iter; left time: 1988.9010s
	iters: 1000, epoch: 1 | loss: 0.1320134
	speed: 0.1947s/iter; left time: 1960.9403s
	iters: 1100, epoch: 1 | loss: 0.1416122
	speed: 0.1943s/iter; left time: 1937.6554s
Epoch: 1 cost time: 219.37023043632507
Epoch: 1, Steps: 1107 | Train Loss: 0.1594197 Vali Loss: 0.1105225 Test Loss: 0.1249938
Validation loss decreased (inf --> 0.110522).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1651966
	speed: 0.4456s/iter; left time: 4395.0405s
	iters: 200, epoch: 2 | loss: 0.1402824
	speed: 0.1971s/iter; left time: 1924.4725s
	iters: 300, epoch: 2 | loss: 0.1621803
	speed: 0.1956s/iter; left time: 1889.7978s
	iters: 400, epoch: 2 | loss: 0.1182133
	speed: 0.1930s/iter; left time: 1846.1107s
	iters: 500, epoch: 2 | loss: 0.1343936
	speed: 0.1927s/iter; left time: 1823.5627s
	iters: 600, epoch: 2 | loss: 0.1424751
	speed: 0.1937s/iter; left time: 1814.2403s
	iters: 700, epoch: 2 | loss: 0.1372003
	speed: 0.1928s/iter; left time: 1786.3568s
	iters: 800, epoch: 2 | loss: 0.2076081
	speed: 0.1936s/iter; left time: 1773.9432s
	iters: 900, epoch: 2 | loss: 0.1148999
	speed: 0.1940s/iter; left time: 1758.1410s
	iters: 1000, epoch: 2 | loss: 0.1599090
	speed: 0.1953s/iter; left time: 1750.9062s
	iters: 1100, epoch: 2 | loss: 0.1378011
	speed: 0.1973s/iter; left time: 1748.4778s
Epoch: 2 cost time: 216.87201809883118
Epoch: 2, Steps: 1107 | Train Loss: 0.1311369 Vali Loss: 0.1087430 Test Loss: 0.1222383
Validation loss decreased (0.110522 --> 0.108743).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1138066
	speed: 0.4425s/iter; left time: 3875.3046s
	iters: 200, epoch: 3 | loss: 0.1318712
	speed: 0.1971s/iter; left time: 1706.3525s
	iters: 300, epoch: 3 | loss: 0.1187942
	speed: 0.1972s/iter; left time: 1687.4649s
	iters: 400, epoch: 3 | loss: 0.1049726
	speed: 0.1966s/iter; left time: 1662.5525s
	iters: 500, epoch: 3 | loss: 0.0948791
	speed: 0.1967s/iter; left time: 1643.9323s
	iters: 600, epoch: 3 | loss: 0.1178181
	speed: 0.1969s/iter; left time: 1626.1956s
	iters: 700, epoch: 3 | loss: 0.1361129
	speed: 0.1966s/iter; left time: 1603.4549s
	iters: 800, epoch: 3 | loss: 0.1116815
	speed: 0.1961s/iter; left time: 1579.9768s
	iters: 900, epoch: 3 | loss: 0.1051594
	speed: 0.1950s/iter; left time: 1551.7734s
	iters: 1000, epoch: 3 | loss: 0.1826794
	speed: 0.1958s/iter; left time: 1538.1664s
	iters: 1100, epoch: 3 | loss: 0.1209319
	speed: 0.1960s/iter; left time: 1520.7057s
Epoch: 3 cost time: 218.33860301971436
Epoch: 3, Steps: 1107 | Train Loss: 0.1178229 Vali Loss: 0.1008052 Test Loss: 0.1141673
Validation loss decreased (0.108743 --> 0.100805).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0895733
	speed: 0.4397s/iter; left time: 3363.6392s
	iters: 200, epoch: 4 | loss: 0.0871192
	speed: 0.1959s/iter; left time: 1479.3079s
	iters: 300, epoch: 4 | loss: 0.1153375
	speed: 0.1954s/iter; left time: 1455.9450s
	iters: 400, epoch: 4 | loss: 0.1169031
	speed: 0.1971s/iter; left time: 1448.9697s
	iters: 500, epoch: 4 | loss: 0.0973897
	speed: 0.1979s/iter; left time: 1434.8291s
	iters: 600, epoch: 4 | loss: 0.0987555
	speed: 0.1975s/iter; left time: 1411.8265s
	iters: 700, epoch: 4 | loss: 0.1107845
	speed: 0.1969s/iter; left time: 1388.1903s
	iters: 800, epoch: 4 | loss: 0.0986373
	speed: 0.1966s/iter; left time: 1366.4409s
	iters: 900, epoch: 4 | loss: 0.1071913
	speed: 0.1974s/iter; left time: 1352.5244s
	iters: 1000, epoch: 4 | loss: 0.1057928
	speed: 0.1970s/iter; left time: 1329.8188s
	iters: 1100, epoch: 4 | loss: 0.0954036
	speed: 0.1967s/iter; left time: 1307.9771s
Epoch: 4 cost time: 218.72806239128113
Epoch: 4, Steps: 1107 | Train Loss: 0.1115893 Vali Loss: 0.0955473 Test Loss: 0.1086505
Validation loss decreased (0.100805 --> 0.095547).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0941058
	speed: 0.4527s/iter; left time: 2961.8188s
	iters: 200, epoch: 5 | loss: 0.0877559
	speed: 0.1956s/iter; left time: 1260.3161s
	iters: 300, epoch: 5 | loss: 0.1379268
	speed: 0.1973s/iter; left time: 1251.6540s
	iters: 400, epoch: 5 | loss: 0.0944181
	speed: 0.1971s/iter; left time: 1230.5946s
	iters: 500, epoch: 5 | loss: 0.1047326
	speed: 0.1970s/iter; left time: 1209.9050s
	iters: 600, epoch: 5 | loss: 0.1157552
	speed: 0.1972s/iter; left time: 1191.4105s
	iters: 700, epoch: 5 | loss: 0.1003319
	speed: 0.1972s/iter; left time: 1171.8568s
	iters: 800, epoch: 5 | loss: 0.1239657
	speed: 0.1945s/iter; left time: 1136.5428s
	iters: 900, epoch: 5 | loss: 0.0944621
	speed: 0.1966s/iter; left time: 1129.1863s
	iters: 1000, epoch: 5 | loss: 0.0961933
	speed: 0.1957s/iter; left time: 1104.1891s
	iters: 1100, epoch: 5 | loss: 0.1023671
	speed: 0.1975s/iter; left time: 1094.7505s
Epoch: 5 cost time: 218.62139201164246
Epoch: 5, Steps: 1107 | Train Loss: 0.1083193 Vali Loss: 0.0934081 Test Loss: 0.1065262
Validation loss decreased (0.095547 --> 0.093408).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1172664
	speed: 0.4479s/iter; left time: 2434.8469s
	iters: 200, epoch: 6 | loss: 0.0984949
	speed: 0.1987s/iter; left time: 1060.3302s
	iters: 300, epoch: 6 | loss: 0.1284511
	speed: 0.1977s/iter; left time: 1035.2454s
	iters: 400, epoch: 6 | loss: 0.0888987
	speed: 0.1983s/iter; left time: 1018.4062s
	iters: 500, epoch: 6 | loss: 0.0874557
	speed: 0.1962s/iter; left time: 987.8195s
	iters: 600, epoch: 6 | loss: 0.0959493
	speed: 0.2002s/iter; left time: 988.3549s
	iters: 700, epoch: 6 | loss: 0.0889735
	speed: 0.1967s/iter; left time: 951.2350s
	iters: 800, epoch: 6 | loss: 0.0999288
	speed: 0.1971s/iter; left time: 933.5267s
	iters: 900, epoch: 6 | loss: 0.0966505
	speed: 0.1970s/iter; left time: 913.1984s
	iters: 1000, epoch: 6 | loss: 0.1061808
	speed: 0.1984s/iter; left time: 900.1504s
	iters: 1100, epoch: 6 | loss: 0.1093581
	speed: 0.1971s/iter; left time: 874.2083s
Epoch: 6 cost time: 219.95044922828674
Epoch: 6, Steps: 1107 | Train Loss: 0.1066442 Vali Loss: 0.0922266 Test Loss: 0.1047421
Validation loss decreased (0.093408 --> 0.092227).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0897456
	speed: 0.4488s/iter; left time: 1942.8374s
	iters: 200, epoch: 7 | loss: 0.1098928
	speed: 0.1953s/iter; left time: 826.0891s
	iters: 300, epoch: 7 | loss: 0.0999473
	speed: 0.1967s/iter; left time: 812.3211s
	iters: 400, epoch: 7 | loss: 0.0913182
	speed: 0.1975s/iter; left time: 795.6260s
	iters: 500, epoch: 7 | loss: 0.0880957
	speed: 0.1995s/iter; left time: 783.7965s
	iters: 600, epoch: 7 | loss: 0.1404413
	speed: 0.1977s/iter; left time: 756.9418s
	iters: 700, epoch: 7 | loss: 0.1029746
	speed: 0.1984s/iter; left time: 739.8800s
	iters: 800, epoch: 7 | loss: 0.1041543
	speed: 0.1989s/iter; left time: 721.6867s
	iters: 900, epoch: 7 | loss: 0.0940705
	speed: 0.2001s/iter; left time: 706.1731s
	iters: 1000, epoch: 7 | loss: 0.1138589
	speed: 0.2000s/iter; left time: 685.8898s
	iters: 1100, epoch: 7 | loss: 0.1041935
	speed: 0.1976s/iter; left time: 657.7996s
Epoch: 7 cost time: 220.18542456626892
Epoch: 7, Steps: 1107 | Train Loss: 0.1056454 Vali Loss: 0.0916522 Test Loss: 0.1043589
Validation loss decreased (0.092227 --> 0.091652).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0898507
	speed: 0.4641s/iter; left time: 1495.3326s
	iters: 200, epoch: 8 | loss: 0.1081450
	speed: 0.2008s/iter; left time: 626.8929s
	iters: 300, epoch: 8 | loss: 0.1063341
	speed: 0.1995s/iter; left time: 603.0216s
	iters: 400, epoch: 8 | loss: 0.1084332
	speed: 0.1977s/iter; left time: 577.8057s
	iters: 500, epoch: 8 | loss: 0.0963168
	speed: 0.1996s/iter; left time: 563.1722s
	iters: 600, epoch: 8 | loss: 0.1013802
	speed: 0.1991s/iter; left time: 541.8328s
	iters: 700, epoch: 8 | loss: 0.0975107
	speed: 0.1987s/iter; left time: 520.9504s
	iters: 800, epoch: 8 | loss: 0.1051428
	speed: 0.2001s/iter; left time: 504.7736s
	iters: 900, epoch: 8 | loss: 0.1825163
	speed: 0.2014s/iter; left time: 487.8786s
	iters: 1000, epoch: 8 | loss: 0.0953318
	speed: 0.1989s/iter; left time: 461.7383s
	iters: 1100, epoch: 8 | loss: 0.1073226
	speed: 0.2000s/iter; left time: 444.3395s
Epoch: 8 cost time: 222.53859758377075
Epoch: 8, Steps: 1107 | Train Loss: 0.1051869 Vali Loss: 0.0913541 Test Loss: 0.1039743
Validation loss decreased (0.091652 --> 0.091354).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0947725
	speed: 0.4576s/iter; left time: 967.8103s
	iters: 200, epoch: 9 | loss: 0.1042175
	speed: 0.1981s/iter; left time: 399.1610s
	iters: 300, epoch: 9 | loss: 0.0851294
	speed: 0.1986s/iter; left time: 380.4066s
	iters: 400, epoch: 9 | loss: 0.1096221
	speed: 0.1980s/iter; left time: 359.4374s
	iters: 500, epoch: 9 | loss: 0.0866490
	speed: 0.1962s/iter; left time: 336.4675s
	iters: 600, epoch: 9 | loss: 0.1082356
	speed: 0.2027s/iter; left time: 327.4398s
	iters: 700, epoch: 9 | loss: 0.1017737
	speed: 0.1965s/iter; left time: 297.6850s
	iters: 800, epoch: 9 | loss: 0.0849462
	speed: 0.1945s/iter; left time: 275.2673s
	iters: 900, epoch: 9 | loss: 0.0970507
	speed: 0.1959s/iter; left time: 257.6333s
	iters: 1000, epoch: 9 | loss: 0.0870395
	speed: 0.1986s/iter; left time: 241.2393s
	iters: 1100, epoch: 9 | loss: 0.0924625
	speed: 0.1964s/iter; left time: 219.0411s
Epoch: 9 cost time: 220.09264659881592
Epoch: 9, Steps: 1107 | Train Loss: 0.1049260 Vali Loss: 0.0912244 Test Loss: 0.1039013
Validation loss decreased (0.091354 --> 0.091224).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1067315
	speed: 0.4473s/iter; left time: 450.8902s
	iters: 200, epoch: 10 | loss: 0.1007145
	speed: 0.1995s/iter; left time: 181.1443s
	iters: 300, epoch: 10 | loss: 0.1110897
	speed: 0.1995s/iter; left time: 161.1808s
	iters: 400, epoch: 10 | loss: 0.1017073
	speed: 0.1986s/iter; left time: 140.6411s
	iters: 500, epoch: 10 | loss: 0.1039627
	speed: 0.1985s/iter; left time: 120.6619s
	iters: 600, epoch: 10 | loss: 0.0917496
	speed: 0.1972s/iter; left time: 100.1579s
	iters: 700, epoch: 10 | loss: 0.1048879
	speed: 0.1968s/iter; left time: 80.3051s
	iters: 800, epoch: 10 | loss: 0.1133080
	speed: 0.1976s/iter; left time: 60.8683s
	iters: 900, epoch: 10 | loss: 0.1067014
	speed: 0.1973s/iter; left time: 41.0383s
	iters: 1000, epoch: 10 | loss: 0.1006287
	speed: 0.1973s/iter; left time: 21.3114s
	iters: 1100, epoch: 10 | loss: 0.0893626
	speed: 0.1957s/iter; left time: 1.5654s
Epoch: 10 cost time: 219.97819638252258
Epoch: 10, Steps: 1107 | Train Loss: 0.1047724 Vali Loss: 0.0911864 Test Loss: 0.1037954
Validation loss decreased (0.091224 --> 0.091186).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_672_24_RLinear_custom_ftM_sl672_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10339310020208359, mae:0.2023281306028366
