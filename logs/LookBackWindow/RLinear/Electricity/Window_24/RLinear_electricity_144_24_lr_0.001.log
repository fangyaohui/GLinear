Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_144_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=144, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_144_24_RLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18245
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.2404653
	speed: 0.2782s/iter; left time: 3144.2117s
	iters: 200, epoch: 1 | loss: 0.2014628
	speed: 0.1997s/iter; left time: 2236.3470s
	iters: 300, epoch: 1 | loss: 0.1573338
	speed: 0.2233s/iter; left time: 2479.3264s
	iters: 400, epoch: 1 | loss: 0.1620533
	speed: 0.2116s/iter; left time: 2327.3735s
	iters: 500, epoch: 1 | loss: 0.1495223
	speed: 0.2137s/iter; left time: 2329.0710s
	iters: 600, epoch: 1 | loss: 0.1299774
	speed: 0.2115s/iter; left time: 2284.1321s
	iters: 700, epoch: 1 | loss: 0.1903972
	speed: 0.2119s/iter; left time: 2267.8412s
	iters: 800, epoch: 1 | loss: 0.1580873
	speed: 0.2104s/iter; left time: 2230.6254s
	iters: 900, epoch: 1 | loss: 0.1562227
	speed: 0.2080s/iter; left time: 2184.5253s
	iters: 1000, epoch: 1 | loss: 0.1478803
	speed: 0.2003s/iter; left time: 2083.1454s
	iters: 1100, epoch: 1 | loss: 0.1565847
	speed: 0.2089s/iter; left time: 2152.1819s
Epoch: 1 cost time: 246.21715927124023
Epoch: 1, Steps: 1140 | Train Loss: 0.1849030 Vali Loss: 0.1269517 Test Loss: 0.1414650
Validation loss decreased (inf --> 0.126952).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1634041
	speed: 0.5045s/iter; left time: 5126.0730s
	iters: 200, epoch: 2 | loss: 0.1304617
	speed: 0.2066s/iter; left time: 2078.6853s
	iters: 300, epoch: 2 | loss: 0.1445735
	speed: 0.2228s/iter; left time: 2218.8679s
	iters: 400, epoch: 2 | loss: 0.1609357
	speed: 0.2285s/iter; left time: 2253.2960s
	iters: 500, epoch: 2 | loss: 0.1400965
	speed: 0.2130s/iter; left time: 2078.7475s
	iters: 600, epoch: 2 | loss: 0.1227900
	speed: 0.2177s/iter; left time: 2103.4036s
	iters: 700, epoch: 2 | loss: 0.1384215
	speed: 0.2193s/iter; left time: 2096.2684s
	iters: 800, epoch: 2 | loss: 0.1442010
	speed: 0.2158s/iter; left time: 2042.0941s
	iters: 900, epoch: 2 | loss: 0.1503567
	speed: 0.2032s/iter; left time: 1902.4676s
	iters: 1000, epoch: 2 | loss: 0.1573465
	speed: 0.2006s/iter; left time: 1857.5039s
	iters: 1100, epoch: 2 | loss: 0.1358187
	speed: 0.2022s/iter; left time: 1852.1186s
Epoch: 2 cost time: 241.97592520713806
Epoch: 2, Steps: 1140 | Train Loss: 0.1494130 Vali Loss: 0.1252030 Test Loss: 0.1392635
Validation loss decreased (0.126952 --> 0.125203).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1358764
	speed: 0.5095s/iter; left time: 4596.1770s
	iters: 200, epoch: 3 | loss: 0.1338830
	speed: 0.2118s/iter; left time: 1889.5665s
	iters: 300, epoch: 3 | loss: 0.1368388
	speed: 0.2078s/iter; left time: 1833.0908s
	iters: 400, epoch: 3 | loss: 0.1251137
	speed: 0.2094s/iter; left time: 1825.8058s
	iters: 500, epoch: 3 | loss: 0.1458380
	speed: 0.2056s/iter; left time: 1772.3403s
	iters: 600, epoch: 3 | loss: 0.2069101
	speed: 0.2072s/iter; left time: 1765.3197s
	iters: 700, epoch: 3 | loss: 0.1463286
	speed: 0.2041s/iter; left time: 1718.6235s
	iters: 800, epoch: 3 | loss: 0.1307665
	speed: 0.1981s/iter; left time: 1648.6265s
	iters: 900, epoch: 3 | loss: 0.1624332
	speed: 0.2082s/iter; left time: 1711.3173s
	iters: 1000, epoch: 3 | loss: 0.1474623
	speed: 0.2178s/iter; left time: 1768.6340s
	iters: 1100, epoch: 3 | loss: 0.1434037
	speed: 0.2051s/iter; left time: 1645.1762s
Epoch: 3 cost time: 237.3806369304657
Epoch: 3, Steps: 1140 | Train Loss: 0.1454390 Vali Loss: 0.1220678 Test Loss: 0.1361309
Validation loss decreased (0.125203 --> 0.122068).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1395651
	speed: 0.5149s/iter; left time: 4057.7077s
	iters: 200, epoch: 4 | loss: 0.1575256
	speed: 0.2080s/iter; left time: 1618.6197s
	iters: 300, epoch: 4 | loss: 0.1188407
	speed: 0.2164s/iter; left time: 1662.0917s
	iters: 400, epoch: 4 | loss: 0.1746010
	speed: 0.2150s/iter; left time: 1629.6226s
	iters: 500, epoch: 4 | loss: 0.1286986
	speed: 0.2123s/iter; left time: 1588.2868s
	iters: 600, epoch: 4 | loss: 0.1428351
	speed: 0.2177s/iter; left time: 1607.1117s
	iters: 700, epoch: 4 | loss: 0.1331810
	speed: 0.2056s/iter; left time: 1496.8933s
	iters: 800, epoch: 4 | loss: 0.1202364
	speed: 0.2112s/iter; left time: 1516.3711s
	iters: 900, epoch: 4 | loss: 0.1346760
	speed: 0.2061s/iter; left time: 1459.5902s
	iters: 1000, epoch: 4 | loss: 0.1507135
	speed: 0.1995s/iter; left time: 1392.4741s
	iters: 1100, epoch: 4 | loss: 0.1434501
	speed: 0.2072s/iter; left time: 1425.9334s
Epoch: 4 cost time: 239.41724038124084
Epoch: 4, Steps: 1140 | Train Loss: 0.1436645 Vali Loss: 0.1209281 Test Loss: 0.1348728
Validation loss decreased (0.122068 --> 0.120928).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1226330
	speed: 0.5194s/iter; left time: 3500.9417s
	iters: 200, epoch: 5 | loss: 0.1254156
	speed: 0.2029s/iter; left time: 1347.6216s
	iters: 300, epoch: 5 | loss: 0.1341078
	speed: 0.2093s/iter; left time: 1369.1036s
	iters: 400, epoch: 5 | loss: 0.1405873
	speed: 0.2005s/iter; left time: 1291.1580s
	iters: 500, epoch: 5 | loss: 0.1401932
	speed: 0.2034s/iter; left time: 1289.5239s
	iters: 600, epoch: 5 | loss: 0.1262977
	speed: 0.2158s/iter; left time: 1346.6970s
	iters: 700, epoch: 5 | loss: 0.1019986
	speed: 0.2218s/iter; left time: 1362.2691s
	iters: 800, epoch: 5 | loss: 0.1354425
	speed: 0.2195s/iter; left time: 1325.7446s
	iters: 900, epoch: 5 | loss: 0.1407477
	speed: 0.2274s/iter; left time: 1351.2079s
	iters: 1000, epoch: 5 | loss: 0.1324433
	speed: 0.2117s/iter; left time: 1236.2613s
	iters: 1100, epoch: 5 | loss: 0.1413013
	speed: 0.2269s/iter; left time: 1302.6806s
Epoch: 5 cost time: 243.79260325431824
Epoch: 5, Steps: 1140 | Train Loss: 0.1427458 Vali Loss: 0.1203648 Test Loss: 0.1342414
Validation loss decreased (0.120928 --> 0.120365).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1320831
	speed: 0.5034s/iter; left time: 2819.7766s
	iters: 200, epoch: 6 | loss: 0.1363952
	speed: 0.2184s/iter; left time: 1201.6003s
	iters: 300, epoch: 6 | loss: 0.1264008
	speed: 0.2043s/iter; left time: 1103.2818s
	iters: 400, epoch: 6 | loss: 0.1361493
	speed: 0.2140s/iter; left time: 1134.1802s
	iters: 500, epoch: 6 | loss: 0.1754803
	speed: 0.2090s/iter; left time: 1087.1423s
	iters: 600, epoch: 6 | loss: 0.1469230
	speed: 0.2058s/iter; left time: 1049.7971s
	iters: 700, epoch: 6 | loss: 0.1167922
	speed: 0.2036s/iter; left time: 1018.1642s
	iters: 800, epoch: 6 | loss: 0.1606559
	speed: 0.2096s/iter; left time: 1027.4616s
	iters: 900, epoch: 6 | loss: 0.2028135
	speed: 0.2161s/iter; left time: 1037.3135s
	iters: 1000, epoch: 6 | loss: 0.1532102
	speed: 0.2101s/iter; left time: 987.4508s
	iters: 1100, epoch: 6 | loss: 0.1418696
	speed: 0.2164s/iter; left time: 995.7800s
Epoch: 6 cost time: 240.28868436813354
Epoch: 6, Steps: 1140 | Train Loss: 0.1422699 Vali Loss: 0.1201006 Test Loss: 0.1339184
Validation loss decreased (0.120365 --> 0.120101).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1310546
	speed: 0.5075s/iter; left time: 2264.0221s
	iters: 200, epoch: 7 | loss: 0.1440038
	speed: 0.2089s/iter; left time: 911.0770s
	iters: 300, epoch: 7 | loss: 0.1764598
	speed: 0.2048s/iter; left time: 872.7943s
	iters: 400, epoch: 7 | loss: 0.1280760
	speed: 0.2123s/iter; left time: 883.3712s
	iters: 500, epoch: 7 | loss: 0.1340923
	speed: 0.2117s/iter; left time: 859.7169s
	iters: 600, epoch: 7 | loss: 0.1310287
	speed: 0.2186s/iter; left time: 865.8701s
	iters: 700, epoch: 7 | loss: 0.1255993
	speed: 0.2017s/iter; left time: 778.7432s
	iters: 800, epoch: 7 | loss: 0.1296498
	speed: 0.2010s/iter; left time: 755.8516s
	iters: 900, epoch: 7 | loss: 0.1315220
	speed: 0.2069s/iter; left time: 757.4515s
	iters: 1000, epoch: 7 | loss: 0.1494951
	speed: 0.2031s/iter; left time: 723.3722s
	iters: 1100, epoch: 7 | loss: 0.1231814
	speed: 0.2177s/iter; left time: 753.3741s
Epoch: 7 cost time: 238.48166847229004
Epoch: 7, Steps: 1140 | Train Loss: 0.1420067 Vali Loss: 0.1199523 Test Loss: 0.1338069
Validation loss decreased (0.120101 --> 0.119952).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1186598
	speed: 0.5174s/iter; left time: 1718.3219s
	iters: 200, epoch: 8 | loss: 0.1201568
	speed: 0.2127s/iter; left time: 685.2241s
	iters: 300, epoch: 8 | loss: 0.1250361
	speed: 0.2050s/iter; left time: 639.8157s
	iters: 400, epoch: 8 | loss: 0.1207348
	speed: 0.2017s/iter; left time: 609.3914s
	iters: 500, epoch: 8 | loss: 0.1544770
	speed: 0.2056s/iter; left time: 600.4617s
	iters: 600, epoch: 8 | loss: 0.1420407
	speed: 0.2013s/iter; left time: 567.8853s
	iters: 700, epoch: 8 | loss: 0.1375359
	speed: 0.2040s/iter; left time: 555.0654s
	iters: 800, epoch: 8 | loss: 0.1342222
	speed: 0.2208s/iter; left time: 578.7590s
	iters: 900, epoch: 8 | loss: 0.1182251
	speed: 0.2056s/iter; left time: 518.3925s
	iters: 1000, epoch: 8 | loss: 0.1144864
	speed: 0.2144s/iter; left time: 519.0653s
	iters: 1100, epoch: 8 | loss: 0.1489812
	speed: 0.2106s/iter; left time: 488.8695s
Epoch: 8 cost time: 239.07599759101868
Epoch: 8, Steps: 1140 | Train Loss: 0.1418812 Vali Loss: 0.1199096 Test Loss: 0.1337032
Validation loss decreased (0.119952 --> 0.119910).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1407428
	speed: 0.5346s/iter; left time: 1165.8950s
	iters: 200, epoch: 9 | loss: 0.1473463
	speed: 0.2080s/iter; left time: 432.7586s
	iters: 300, epoch: 9 | loss: 0.1300814
	speed: 0.2116s/iter; left time: 419.1472s
	iters: 400, epoch: 9 | loss: 0.1413323
	speed: 0.2003s/iter; left time: 376.8453s
	iters: 500, epoch: 9 | loss: 0.1603597
	speed: 0.2097s/iter; left time: 373.4594s
	iters: 600, epoch: 9 | loss: 0.1339633
	speed: 0.2074s/iter; left time: 348.6933s
	iters: 700, epoch: 9 | loss: 0.1289783
	speed: 0.2016s/iter; left time: 318.6997s
	iters: 800, epoch: 9 | loss: 0.1075140
	speed: 0.2014s/iter; left time: 298.2367s
	iters: 900, epoch: 9 | loss: 0.1276299
	speed: 0.2056s/iter; left time: 283.9361s
	iters: 1000, epoch: 9 | loss: 0.1408851
	speed: 0.2152s/iter; left time: 275.6435s
	iters: 1100, epoch: 9 | loss: 0.1270398
	speed: 0.2039s/iter; left time: 240.8021s
Epoch: 9 cost time: 237.03420782089233
Epoch: 9, Steps: 1140 | Train Loss: 0.1418263 Vali Loss: 0.1198846 Test Loss: 0.1336845
Validation loss decreased (0.119910 --> 0.119885).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1552063
	speed: 0.5068s/iter; left time: 527.5361s
	iters: 200, epoch: 10 | loss: 0.1180687
	speed: 0.2029s/iter; left time: 190.9419s
	iters: 300, epoch: 10 | loss: 0.1258800
	speed: 0.2047s/iter; left time: 172.1293s
	iters: 400, epoch: 10 | loss: 0.1246187
	speed: 0.2012s/iter; left time: 149.0553s
	iters: 500, epoch: 10 | loss: 0.1195926
	speed: 0.2070s/iter; left time: 132.7001s
	iters: 600, epoch: 10 | loss: 0.1474824
	speed: 0.2118s/iter; left time: 114.5965s
	iters: 700, epoch: 10 | loss: 0.1418274
	speed: 0.2230s/iter; left time: 98.3635s
	iters: 800, epoch: 10 | loss: 0.1562514
	speed: 0.2068s/iter; left time: 70.5022s
	iters: 900, epoch: 10 | loss: 0.1583909
	speed: 0.2112s/iter; left time: 50.9013s
	iters: 1000, epoch: 10 | loss: 0.1430535
	speed: 0.2251s/iter; left time: 31.7431s
	iters: 1100, epoch: 10 | loss: 0.1643126
	speed: 0.2195s/iter; left time: 8.9978s
Epoch: 10 cost time: 241.61556935310364
Epoch: 10, Steps: 1140 | Train Loss: 0.1417791 Vali Loss: 0.1198553 Test Loss: 0.1336712
Validation loss decreased (0.119885 --> 0.119855).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_144_24_RLinear_custom_ftM_sl144_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.13321083784103394, mae:0.23026159405708313
