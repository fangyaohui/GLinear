Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_720_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=720, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_24_RLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17669
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1685779
	speed: 0.2329s/iter; left time: 2548.4012s
	iters: 200, epoch: 1 | loss: 0.1610718
	speed: 0.2360s/iter; left time: 2558.8955s
	iters: 300, epoch: 1 | loss: 0.1971103
	speed: 0.2211s/iter; left time: 2374.5070s
	iters: 400, epoch: 1 | loss: 0.1599451
	speed: 0.2028s/iter; left time: 2157.5918s
	iters: 500, epoch: 1 | loss: 0.1666019
	speed: 0.2010s/iter; left time: 2118.8722s
	iters: 600, epoch: 1 | loss: 0.1582932
	speed: 0.2043s/iter; left time: 2133.4157s
	iters: 700, epoch: 1 | loss: 0.1355688
	speed: 0.2016s/iter; left time: 2084.5941s
	iters: 800, epoch: 1 | loss: 0.1427263
	speed: 0.2001s/iter; left time: 2049.2860s
	iters: 900, epoch: 1 | loss: 0.1313668
	speed: 0.2013s/iter; left time: 2041.7147s
	iters: 1000, epoch: 1 | loss: 0.1390619
	speed: 0.2043s/iter; left time: 2051.7379s
	iters: 1100, epoch: 1 | loss: 0.1510743
	speed: 0.2016s/iter; left time: 2004.2515s
Epoch: 1 cost time: 231.7604203224182
Epoch: 1, Steps: 1104 | Train Loss: 0.1609163 Vali Loss: 0.1134326 Test Loss: 0.1272891
Validation loss decreased (inf --> 0.113433).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1249101
	speed: 0.4573s/iter; left time: 4498.6024s
	iters: 200, epoch: 2 | loss: 0.1203858
	speed: 0.2104s/iter; left time: 2048.3337s
	iters: 300, epoch: 2 | loss: 0.1499940
	speed: 0.2080s/iter; left time: 2004.7254s
	iters: 400, epoch: 2 | loss: 0.1252200
	speed: 0.2083s/iter; left time: 1986.7291s
	iters: 500, epoch: 2 | loss: 0.1127475
	speed: 0.2132s/iter; left time: 2011.9080s
	iters: 600, epoch: 2 | loss: 0.1110035
	speed: 0.2124s/iter; left time: 1983.0842s
	iters: 700, epoch: 2 | loss: 0.1140779
	speed: 0.2091s/iter; left time: 1931.8097s
	iters: 800, epoch: 2 | loss: 0.1513559
	speed: 0.2089s/iter; left time: 1908.7462s
	iters: 900, epoch: 2 | loss: 0.1186749
	speed: 0.2133s/iter; left time: 1927.5120s
	iters: 1000, epoch: 2 | loss: 0.1160488
	speed: 0.2079s/iter; left time: 1858.3815s
	iters: 1100, epoch: 2 | loss: 0.1338918
	speed: 0.2131s/iter; left time: 1882.7266s
Epoch: 2 cost time: 233.19027304649353
Epoch: 2, Steps: 1104 | Train Loss: 0.1322054 Vali Loss: 0.1103229 Test Loss: 0.1239939
Validation loss decreased (0.113433 --> 0.110323).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0932974
	speed: 0.4580s/iter; left time: 3999.5927s
	iters: 200, epoch: 3 | loss: 0.1125614
	speed: 0.2027s/iter; left time: 1750.1813s
	iters: 300, epoch: 3 | loss: 0.1084856
	speed: 0.2064s/iter; left time: 1761.0241s
	iters: 400, epoch: 3 | loss: 0.2044589
	speed: 0.2050s/iter; left time: 1728.5647s
	iters: 500, epoch: 3 | loss: 0.1176484
	speed: 0.2045s/iter; left time: 1704.1647s
	iters: 600, epoch: 3 | loss: 0.1005393
	speed: 0.2045s/iter; left time: 1683.4899s
	iters: 700, epoch: 3 | loss: 0.0898316
	speed: 0.2013s/iter; left time: 1636.8126s
	iters: 800, epoch: 3 | loss: 0.1019697
	speed: 0.2054s/iter; left time: 1650.0269s
	iters: 900, epoch: 3 | loss: 0.1050481
	speed: 0.2009s/iter; left time: 1593.4957s
	iters: 1000, epoch: 3 | loss: 0.1538862
	speed: 0.2041s/iter; left time: 1598.4958s
	iters: 1100, epoch: 3 | loss: 0.1630523
	speed: 0.2047s/iter; left time: 1582.5779s
Epoch: 3 cost time: 226.32843160629272
Epoch: 3, Steps: 1104 | Train Loss: 0.1181555 Vali Loss: 0.1005266 Test Loss: 0.1136004
Validation loss decreased (0.110323 --> 0.100527).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1009850
	speed: 0.4582s/iter; left time: 3495.8954s
	iters: 200, epoch: 4 | loss: 0.0974018
	speed: 0.2053s/iter; left time: 1545.8860s
	iters: 300, epoch: 4 | loss: 0.0932127
	speed: 0.2053s/iter; left time: 1525.1317s
	iters: 400, epoch: 4 | loss: 0.1154979
	speed: 0.2058s/iter; left time: 1508.6321s
	iters: 500, epoch: 4 | loss: 0.1052680
	speed: 0.2055s/iter; left time: 1485.7586s
	iters: 600, epoch: 4 | loss: 0.1089197
	speed: 0.2062s/iter; left time: 1469.9993s
	iters: 700, epoch: 4 | loss: 0.0882379
	speed: 0.2052s/iter; left time: 1442.0522s
	iters: 800, epoch: 4 | loss: 0.1215684
	speed: 0.2062s/iter; left time: 1428.5165s
	iters: 900, epoch: 4 | loss: 0.1056807
	speed: 0.2057s/iter; left time: 1404.9081s
	iters: 1000, epoch: 4 | loss: 0.1450380
	speed: 0.2057s/iter; left time: 1384.0291s
	iters: 1100, epoch: 4 | loss: 0.1065611
	speed: 0.2070s/iter; left time: 1371.8738s
Epoch: 4 cost time: 227.9925892353058
Epoch: 4, Steps: 1104 | Train Loss: 0.1115365 Vali Loss: 0.0954184 Test Loss: 0.1083825
Validation loss decreased (0.100527 --> 0.095418).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.0881006
	speed: 0.4599s/iter; left time: 3001.0931s
	iters: 200, epoch: 5 | loss: 0.1248084
	speed: 0.2030s/iter; left time: 1304.1059s
	iters: 300, epoch: 5 | loss: 0.0946753
	speed: 0.2053s/iter; left time: 1298.3381s
	iters: 400, epoch: 5 | loss: 0.1191672
	speed: 0.2038s/iter; left time: 1268.4084s
	iters: 500, epoch: 5 | loss: 0.0978257
	speed: 0.2050s/iter; left time: 1255.4097s
	iters: 600, epoch: 5 | loss: 0.0903048
	speed: 0.2050s/iter; left time: 1235.3061s
	iters: 700, epoch: 5 | loss: 0.1094389
	speed: 0.2046s/iter; left time: 1212.4273s
	iters: 800, epoch: 5 | loss: 0.1128807
	speed: 0.2052s/iter; left time: 1195.2208s
	iters: 900, epoch: 5 | loss: 0.0904765
	speed: 0.2045s/iter; left time: 1170.8730s
	iters: 1000, epoch: 5 | loss: 0.1109766
	speed: 0.2003s/iter; left time: 1126.8391s
	iters: 1100, epoch: 5 | loss: 0.1179647
	speed: 0.2019s/iter; left time: 1115.6032s
Epoch: 5 cost time: 226.33393692970276
Epoch: 5, Steps: 1104 | Train Loss: 0.1080190 Vali Loss: 0.0931729 Test Loss: 0.1060336
Validation loss decreased (0.095418 --> 0.093173).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1053094
	speed: 0.4446s/iter; left time: 2410.4292s
	iters: 200, epoch: 6 | loss: 0.1258028
	speed: 0.2041s/iter; left time: 1086.2720s
	iters: 300, epoch: 6 | loss: 0.0967334
	speed: 0.1984s/iter; left time: 1035.9983s
	iters: 400, epoch: 6 | loss: 0.0944499
	speed: 0.2060s/iter; left time: 1054.7527s
	iters: 500, epoch: 6 | loss: 0.1065281
	speed: 0.2115s/iter; left time: 1061.9953s
	iters: 600, epoch: 6 | loss: 0.1025112
	speed: 0.2002s/iter; left time: 984.9543s
	iters: 700, epoch: 6 | loss: 0.1053903
	speed: 0.2030s/iter; left time: 978.5753s
	iters: 800, epoch: 6 | loss: 0.0966658
	speed: 0.2033s/iter; left time: 959.6595s
	iters: 900, epoch: 6 | loss: 0.0972345
	speed: 0.2014s/iter; left time: 930.6003s
	iters: 1000, epoch: 6 | loss: 0.0957370
	speed: 0.2033s/iter; left time: 918.9761s
	iters: 1100, epoch: 6 | loss: 0.0995539
	speed: 0.2031s/iter; left time: 897.8505s
Epoch: 6 cost time: 225.0684404373169
Epoch: 6, Steps: 1104 | Train Loss: 0.1061951 Vali Loss: 0.0922526 Test Loss: 0.1051159
Validation loss decreased (0.093173 --> 0.092253).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1061564
	speed: 0.4586s/iter; left time: 1979.7837s
	iters: 200, epoch: 7 | loss: 0.1653724
	speed: 0.2023s/iter; left time: 853.2446s
	iters: 300, epoch: 7 | loss: 0.1079907
	speed: 0.1999s/iter; left time: 823.0592s
	iters: 400, epoch: 7 | loss: 0.1331902
	speed: 0.2085s/iter; left time: 837.7438s
	iters: 500, epoch: 7 | loss: 0.1003396
	speed: 0.2046s/iter; left time: 801.6039s
	iters: 600, epoch: 7 | loss: 0.0982656
	speed: 0.2153s/iter; left time: 821.8620s
	iters: 700, epoch: 7 | loss: 0.1705548
	speed: 0.2176s/iter; left time: 808.7453s
	iters: 800, epoch: 7 | loss: 0.0992866
	speed: 0.2268s/iter; left time: 820.1640s
	iters: 900, epoch: 7 | loss: 0.1020859
	speed: 0.2069s/iter; left time: 727.8313s
	iters: 1000, epoch: 7 | loss: 0.0933766
	speed: 0.2304s/iter; left time: 787.3300s
	iters: 1100, epoch: 7 | loss: 0.1080629
	speed: 0.2076s/iter; left time: 688.5166s
Epoch: 7 cost time: 235.29552698135376
Epoch: 7, Steps: 1104 | Train Loss: 0.1052396 Vali Loss: 0.0914911 Test Loss: 0.1041515
Validation loss decreased (0.092253 --> 0.091491).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1002976
	speed: 0.4671s/iter; left time: 1500.9496s
	iters: 200, epoch: 8 | loss: 0.1100741
	speed: 0.1986s/iter; left time: 618.3960s
	iters: 300, epoch: 8 | loss: 0.1048642
	speed: 0.2014s/iter; left time: 606.8258s
	iters: 400, epoch: 8 | loss: 0.1078925
	speed: 0.2239s/iter; left time: 652.3626s
	iters: 500, epoch: 8 | loss: 0.0930060
	speed: 0.2401s/iter; left time: 675.5205s
	iters: 600, epoch: 8 | loss: 0.1041633
	speed: 0.2394s/iter; left time: 649.4622s
	iters: 700, epoch: 8 | loss: 0.1057794
	speed: 0.2401s/iter; left time: 627.4906s
	iters: 800, epoch: 8 | loss: 0.1138426
	speed: 0.2393s/iter; left time: 601.3069s
	iters: 900, epoch: 8 | loss: 0.0974841
	speed: 0.2392s/iter; left time: 577.1035s
	iters: 1000, epoch: 8 | loss: 0.0998704
	speed: 0.2135s/iter; left time: 493.9053s
	iters: 1100, epoch: 8 | loss: 0.1228775
	speed: 0.2065s/iter; left time: 456.9441s
Epoch: 8 cost time: 246.388925075531
Epoch: 8, Steps: 1104 | Train Loss: 0.1047249 Vali Loss: 0.0912452 Test Loss: 0.1039202
Validation loss decreased (0.091491 --> 0.091245).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1108153
	speed: 0.4574s/iter; left time: 964.5571s
	iters: 200, epoch: 9 | loss: 0.0946044
	speed: 0.2094s/iter; left time: 420.7449s
	iters: 300, epoch: 9 | loss: 0.1032242
	speed: 0.2073s/iter; left time: 395.8047s
	iters: 400, epoch: 9 | loss: 0.0900552
	speed: 0.2078s/iter; left time: 375.9360s
	iters: 500, epoch: 9 | loss: 0.1045198
	speed: 0.2055s/iter; left time: 351.1868s
	iters: 600, epoch: 9 | loss: 0.1120802
	speed: 0.2035s/iter; left time: 327.4317s
	iters: 700, epoch: 9 | loss: 0.0965122
	speed: 0.2040s/iter; left time: 307.7859s
	iters: 800, epoch: 9 | loss: 0.1005368
	speed: 0.2057s/iter; left time: 289.8310s
	iters: 900, epoch: 9 | loss: 0.0970597
	speed: 0.2185s/iter; left time: 286.0577s
	iters: 1000, epoch: 9 | loss: 0.1072153
	speed: 0.2405s/iter; left time: 290.7743s
	iters: 1100, epoch: 9 | loss: 0.0908070
	speed: 0.2301s/iter; left time: 255.1435s
Epoch: 9 cost time: 235.771484375
Epoch: 9, Steps: 1104 | Train Loss: 0.1044586 Vali Loss: 0.0910960 Test Loss: 0.1037802
Validation loss decreased (0.091245 --> 0.091096).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0877821
	speed: 0.4477s/iter; left time: 449.9814s
	iters: 200, epoch: 10 | loss: 0.1049685
	speed: 0.2026s/iter; left time: 183.3567s
	iters: 300, epoch: 10 | loss: 0.1056940
	speed: 0.2029s/iter; left time: 163.3106s
	iters: 400, epoch: 10 | loss: 0.0979527
	speed: 0.2022s/iter; left time: 142.5799s
	iters: 500, epoch: 10 | loss: 0.1111933
	speed: 0.2050s/iter; left time: 124.0118s
	iters: 600, epoch: 10 | loss: 0.0897472
	speed: 0.2116s/iter; left time: 106.8565s
	iters: 700, epoch: 10 | loss: 0.0818158
	speed: 0.2165s/iter; left time: 87.6873s
	iters: 800, epoch: 10 | loss: 0.0950507
	speed: 0.2050s/iter; left time: 62.5368s
	iters: 900, epoch: 10 | loss: 0.1049432
	speed: 0.2106s/iter; left time: 43.1745s
	iters: 1000, epoch: 10 | loss: 0.1725307
	speed: 0.2062s/iter; left time: 21.6467s
	iters: 1100, epoch: 10 | loss: 0.0883059
	speed: 0.2026s/iter; left time: 1.0131s
Epoch: 10 cost time: 228.28572726249695
Epoch: 10, Steps: 1104 | Train Loss: 0.1043194 Vali Loss: 0.0910216 Test Loss: 0.1037101
Validation loss decreased (0.091096 --> 0.091022).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_720_24_RLinear_custom_ftM_sl720_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10331037640571594, mae:0.20219723880290985
