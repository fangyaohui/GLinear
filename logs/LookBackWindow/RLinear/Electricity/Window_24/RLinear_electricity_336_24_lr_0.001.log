Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='Electricity_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_24_RLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18053
val 2609
test 5237
	iters: 100, epoch: 1 | loss: 0.1870123
	speed: 0.2257s/iter; left time: 2523.9409s
	iters: 200, epoch: 1 | loss: 0.1767778
	speed: 0.2200s/iter; left time: 2437.8077s
	iters: 300, epoch: 1 | loss: 0.1493319
	speed: 0.2141s/iter; left time: 2350.7674s
	iters: 400, epoch: 1 | loss: 0.1534522
	speed: 0.2157s/iter; left time: 2346.7186s
	iters: 500, epoch: 1 | loss: 0.1757014
	speed: 0.2148s/iter; left time: 2316.1134s
	iters: 600, epoch: 1 | loss: 0.1273361
	speed: 0.2207s/iter; left time: 2357.1516s
	iters: 700, epoch: 1 | loss: 0.1190102
	speed: 0.2180s/iter; left time: 2306.8176s
	iters: 800, epoch: 1 | loss: 0.1587018
	speed: 0.2231s/iter; left time: 2338.1238s
	iters: 900, epoch: 1 | loss: 0.1106585
	speed: 0.2153s/iter; left time: 2235.0701s
	iters: 1000, epoch: 1 | loss: 0.1324132
	speed: 0.2193s/iter; left time: 2254.2867s
	iters: 1100, epoch: 1 | loss: 0.1134561
	speed: 0.2175s/iter; left time: 2214.5226s
Epoch: 1 cost time: 247.0451099872589
Epoch: 1, Steps: 1128 | Train Loss: 0.1551349 Vali Loss: 0.1044885 Test Loss: 0.1172335
Validation loss decreased (inf --> 0.104488).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1236530
	speed: 0.5007s/iter; left time: 5033.9060s
	iters: 200, epoch: 2 | loss: 0.1510609
	speed: 0.2158s/iter; left time: 2147.8244s
	iters: 300, epoch: 2 | loss: 0.1244177
	speed: 0.2153s/iter; left time: 2120.8855s
	iters: 400, epoch: 2 | loss: 0.1174156
	speed: 0.2208s/iter; left time: 2153.2255s
	iters: 500, epoch: 2 | loss: 0.1245141
	speed: 0.2178s/iter; left time: 2102.1886s
	iters: 600, epoch: 2 | loss: 0.1205008
	speed: 0.2415s/iter; left time: 2307.3231s
	iters: 700, epoch: 2 | loss: 0.1419800
	speed: 0.2233s/iter; left time: 2110.9994s
	iters: 800, epoch: 2 | loss: 0.1246359
	speed: 0.2253s/iter; left time: 2107.6483s
	iters: 900, epoch: 2 | loss: 0.1267410
	speed: 0.2135s/iter; left time: 1975.4516s
	iters: 1000, epoch: 2 | loss: 0.1094631
	speed: 0.2240s/iter; left time: 2050.1165s
	iters: 1100, epoch: 2 | loss: 0.1185309
	speed: 0.2202s/iter; left time: 1993.0192s
Epoch: 2 cost time: 250.4823546409607
Epoch: 2, Steps: 1128 | Train Loss: 0.1250806 Vali Loss: 0.1033866 Test Loss: 0.1158661
Validation loss decreased (0.104488 --> 0.103387).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.0978448
	speed: 0.5081s/iter; left time: 4534.6272s
	iters: 200, epoch: 3 | loss: 0.1004090
	speed: 0.2193s/iter; left time: 1935.1845s
	iters: 300, epoch: 3 | loss: 0.1982483
	speed: 0.2187s/iter; left time: 1908.4162s
	iters: 400, epoch: 3 | loss: 0.1185313
	speed: 0.2143s/iter; left time: 1847.9763s
	iters: 500, epoch: 3 | loss: 0.1076323
	speed: 0.2302s/iter; left time: 1962.4466s
	iters: 600, epoch: 3 | loss: 0.1133669
	speed: 0.2206s/iter; left time: 1858.4664s
	iters: 700, epoch: 3 | loss: 0.1057022
	speed: 0.2262s/iter; left time: 1883.0215s
	iters: 800, epoch: 3 | loss: 0.1483564
	speed: 0.2226s/iter; left time: 1831.2767s
	iters: 900, epoch: 3 | loss: 0.0995469
	speed: 0.2147s/iter; left time: 1744.5309s
	iters: 1000, epoch: 3 | loss: 0.1067107
	speed: 0.2117s/iter; left time: 1698.7928s
	iters: 1100, epoch: 3 | loss: 0.1223857
	speed: 0.2181s/iter; left time: 1728.7530s
Epoch: 3 cost time: 249.34817385673523
Epoch: 3, Steps: 1128 | Train Loss: 0.1180033 Vali Loss: 0.0990206 Test Loss: 0.1114758
Validation loss decreased (0.103387 --> 0.099021).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1023889
	speed: 0.5267s/iter; left time: 4106.9569s
	iters: 200, epoch: 4 | loss: 0.1058727
	speed: 0.2253s/iter; left time: 1734.0306s
	iters: 300, epoch: 4 | loss: 0.0978401
	speed: 0.2034s/iter; left time: 1544.8651s
	iters: 400, epoch: 4 | loss: 0.1079794
	speed: 0.2487s/iter; left time: 1864.2194s
	iters: 500, epoch: 4 | loss: 0.1109322
	speed: 0.2420s/iter; left time: 1790.2976s
	iters: 600, epoch: 4 | loss: 0.0960961
	speed: 0.2415s/iter; left time: 1762.2471s
	iters: 700, epoch: 4 | loss: 0.1032865
	speed: 0.2361s/iter; left time: 1699.0534s
	iters: 800, epoch: 4 | loss: 0.1114091
	speed: 0.2308s/iter; left time: 1637.7748s
	iters: 900, epoch: 4 | loss: 0.0898489
	speed: 0.2175s/iter; left time: 1521.6470s
	iters: 1000, epoch: 4 | loss: 0.1050538
	speed: 0.2221s/iter; left time: 1532.0799s
	iters: 1100, epoch: 4 | loss: 0.1625998
	speed: 0.2172s/iter; left time: 1476.5779s
Epoch: 4 cost time: 257.58767676353455
Epoch: 4, Steps: 1128 | Train Loss: 0.1145835 Vali Loss: 0.0965177 Test Loss: 0.1089066
Validation loss decreased (0.099021 --> 0.096518).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1084012
	speed: 0.5091s/iter; left time: 3394.9525s
	iters: 200, epoch: 5 | loss: 0.1445390
	speed: 0.2249s/iter; left time: 1477.2068s
	iters: 300, epoch: 5 | loss: 0.1203736
	speed: 0.2267s/iter; left time: 1466.4892s
	iters: 400, epoch: 5 | loss: 0.1116365
	speed: 0.2172s/iter; left time: 1383.2357s
	iters: 500, epoch: 5 | loss: 0.1043870
	speed: 0.2222s/iter; left time: 1392.6643s
	iters: 600, epoch: 5 | loss: 0.1059813
	speed: 0.2223s/iter; left time: 1371.5756s
	iters: 700, epoch: 5 | loss: 0.1368131
	speed: 0.2254s/iter; left time: 1367.9930s
	iters: 800, epoch: 5 | loss: 0.1010077
	speed: 0.2342s/iter; left time: 1397.8456s
	iters: 900, epoch: 5 | loss: 0.1092169
	speed: 0.2174s/iter; left time: 1276.1081s
	iters: 1000, epoch: 5 | loss: 0.1033743
	speed: 0.2203s/iter; left time: 1270.7721s
	iters: 1100, epoch: 5 | loss: 0.1072180
	speed: 0.2220s/iter; left time: 1258.2674s
Epoch: 5 cost time: 252.37053322792053
Epoch: 5, Steps: 1128 | Train Loss: 0.1128350 Vali Loss: 0.0953450 Test Loss: 0.1074034
Validation loss decreased (0.096518 --> 0.095345).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1017295
	speed: 0.5130s/iter; left time: 2842.3843s
	iters: 200, epoch: 6 | loss: 0.1692735
	speed: 0.2272s/iter; left time: 1236.4079s
	iters: 300, epoch: 6 | loss: 0.1030025
	speed: 0.2206s/iter; left time: 1178.2343s
	iters: 400, epoch: 6 | loss: 0.1066357
	speed: 0.2206s/iter; left time: 1156.0889s
	iters: 500, epoch: 6 | loss: 0.1469616
	speed: 0.2301s/iter; left time: 1183.1536s
	iters: 600, epoch: 6 | loss: 0.1010794
	speed: 0.2182s/iter; left time: 1100.1506s
	iters: 700, epoch: 6 | loss: 0.1135572
	speed: 0.2170s/iter; left time: 1071.9628s
	iters: 800, epoch: 6 | loss: 0.1053384
	speed: 0.2191s/iter; left time: 1060.5908s
	iters: 900, epoch: 6 | loss: 0.0990818
	speed: 0.2274s/iter; left time: 1078.1052s
	iters: 1000, epoch: 6 | loss: 0.1037928
	speed: 0.2247s/iter; left time: 1042.8583s
	iters: 1100, epoch: 6 | loss: 0.1051429
	speed: 0.2359s/iter; left time: 1071.3984s
Epoch: 6 cost time: 253.78834080696106
Epoch: 6, Steps: 1128 | Train Loss: 0.1118873 Vali Loss: 0.0948627 Test Loss: 0.1068282
Validation loss decreased (0.095345 --> 0.094863).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1032854
	speed: 0.5125s/iter; left time: 2261.8132s
	iters: 200, epoch: 7 | loss: 0.1095416
	speed: 0.2294s/iter; left time: 989.5040s
	iters: 300, epoch: 7 | loss: 0.0952523
	speed: 0.2209s/iter; left time: 930.8488s
	iters: 400, epoch: 7 | loss: 0.1091583
	speed: 0.2229s/iter; left time: 916.9405s
	iters: 500, epoch: 7 | loss: 0.1125718
	speed: 0.2249s/iter; left time: 902.5767s
	iters: 600, epoch: 7 | loss: 0.1003844
	speed: 0.2241s/iter; left time: 876.7260s
	iters: 700, epoch: 7 | loss: 0.1077999
	speed: 0.2273s/iter; left time: 866.8732s
	iters: 800, epoch: 7 | loss: 0.1143680
	speed: 0.2292s/iter; left time: 850.8416s
	iters: 900, epoch: 7 | loss: 0.0929000
	speed: 0.2279s/iter; left time: 823.4263s
	iters: 1000, epoch: 7 | loss: 0.1091097
	speed: 0.2313s/iter; left time: 812.6366s
	iters: 1100, epoch: 7 | loss: 0.1077017
	speed: 0.2267s/iter; left time: 773.8353s
Epoch: 7 cost time: 255.75201988220215
Epoch: 7, Steps: 1128 | Train Loss: 0.1113952 Vali Loss: 0.0946604 Test Loss: 0.1065352
Validation loss decreased (0.094863 --> 0.094660).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1058066
	speed: 0.5108s/iter; left time: 1677.9935s
	iters: 200, epoch: 8 | loss: 0.1040985
	speed: 0.2250s/iter; left time: 716.4662s
	iters: 300, epoch: 8 | loss: 0.1306449
	speed: 0.2291s/iter; left time: 706.7812s
	iters: 400, epoch: 8 | loss: 0.1373152
	speed: 0.2306s/iter; left time: 688.4783s
	iters: 500, epoch: 8 | loss: 0.0933516
	speed: 0.2194s/iter; left time: 632.8724s
	iters: 600, epoch: 8 | loss: 0.1081003
	speed: 0.2272s/iter; left time: 632.7051s
	iters: 700, epoch: 8 | loss: 0.1036554
	speed: 0.2257s/iter; left time: 605.8857s
	iters: 800, epoch: 8 | loss: 0.1037641
	speed: 0.2200s/iter; left time: 568.7609s
	iters: 900, epoch: 8 | loss: 0.1101339
	speed: 0.2229s/iter; left time: 553.9505s
	iters: 1000, epoch: 8 | loss: 0.1089177
	speed: 0.2284s/iter; left time: 544.7180s
	iters: 1100, epoch: 8 | loss: 0.1126324
	speed: 0.2194s/iter; left time: 501.2558s
Epoch: 8 cost time: 253.92633867263794
Epoch: 8, Steps: 1128 | Train Loss: 0.1111230 Vali Loss: 0.0944560 Test Loss: 0.1064276
Validation loss decreased (0.094660 --> 0.094456).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.0890088
	speed: 0.5153s/iter; left time: 1111.4605s
	iters: 200, epoch: 9 | loss: 0.0921371
	speed: 0.2214s/iter; left time: 455.4174s
	iters: 300, epoch: 9 | loss: 0.0959451
	speed: 0.2275s/iter; left time: 445.1694s
	iters: 400, epoch: 9 | loss: 0.1137242
	speed: 0.2241s/iter; left time: 416.0777s
	iters: 500, epoch: 9 | loss: 0.1299197
	speed: 0.2299s/iter; left time: 403.9617s
	iters: 600, epoch: 9 | loss: 0.1560202
	speed: 0.2211s/iter; left time: 366.4299s
	iters: 700, epoch: 9 | loss: 0.1042778
	speed: 0.2231s/iter; left time: 347.4360s
	iters: 800, epoch: 9 | loss: 0.0974604
	speed: 0.2241s/iter; left time: 326.5050s
	iters: 900, epoch: 9 | loss: 0.1157938
	speed: 0.2087s/iter; left time: 283.2630s
	iters: 1000, epoch: 9 | loss: 0.1118862
	speed: 0.2318s/iter; left time: 291.3311s
	iters: 1100, epoch: 9 | loss: 0.0958774
	speed: 0.2482s/iter; left time: 287.1800s
Epoch: 9 cost time: 256.27743220329285
Epoch: 9, Steps: 1128 | Train Loss: 0.1110046 Vali Loss: 0.0943913 Test Loss: 0.1063510
Validation loss decreased (0.094456 --> 0.094391).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.0917900
	speed: 0.5407s/iter; left time: 556.3650s
	iters: 200, epoch: 10 | loss: 0.0967652
	speed: 0.2251s/iter; left time: 209.1501s
	iters: 300, epoch: 10 | loss: 0.1104996
	speed: 0.2234s/iter; left time: 185.2143s
	iters: 400, epoch: 10 | loss: 0.0979766
	speed: 0.2103s/iter; left time: 153.3333s
	iters: 500, epoch: 10 | loss: 0.1097304
	speed: 0.2205s/iter; left time: 138.7202s
	iters: 600, epoch: 10 | loss: 0.0956707
	speed: 0.2092s/iter; left time: 110.6861s
	iters: 700, epoch: 10 | loss: 0.1851913
	speed: 0.2108s/iter; left time: 90.4291s
	iters: 800, epoch: 10 | loss: 0.1085695
	speed: 0.2187s/iter; left time: 71.9590s
	iters: 900, epoch: 10 | loss: 0.1099730
	speed: 0.2208s/iter; left time: 50.5583s
	iters: 1000, epoch: 10 | loss: 0.1114316
	speed: 0.2139s/iter; left time: 27.5920s
	iters: 1100, epoch: 10 | loss: 0.0978738
	speed: 0.2114s/iter; left time: 6.1304s
Epoch: 10 cost time: 245.43750286102295
Epoch: 10, Steps: 1128 | Train Loss: 0.1109261 Vali Loss: 0.0943773 Test Loss: 0.1063225
Validation loss decreased (0.094391 --> 0.094377).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_336_24_RLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5237
mse:0.10596763342618942, mae:0.2049439698457718
