Args in experiment:
Namespace(activation='gelu', batch_size=8, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='ETTh1_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_24_RLinear_ETTh1_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8281
val 2857
test 2857
	iters: 100, epoch: 1 | loss: 0.3927180
	speed: 0.0256s/iter; left time: 262.8505s
	iters: 200, epoch: 1 | loss: 0.2430081
	speed: 0.0173s/iter; left time: 176.1127s
	iters: 300, epoch: 1 | loss: 0.2762712
	speed: 0.0179s/iter; left time: 179.9267s
	iters: 400, epoch: 1 | loss: 0.3663978
	speed: 0.0172s/iter; left time: 171.0905s
	iters: 500, epoch: 1 | loss: 0.1803612
	speed: 0.0186s/iter; left time: 183.0907s
	iters: 600, epoch: 1 | loss: 0.2133968
	speed: 0.0178s/iter; left time: 173.6386s
	iters: 700, epoch: 1 | loss: 0.4043724
	speed: 0.0175s/iter; left time: 168.5031s
	iters: 800, epoch: 1 | loss: 0.2918014
	speed: 0.0159s/iter; left time: 151.9190s
	iters: 900, epoch: 1 | loss: 0.2147831
	speed: 0.0161s/iter; left time: 152.6102s
	iters: 1000, epoch: 1 | loss: 0.2373842
	speed: 0.0162s/iter; left time: 151.5584s
Epoch: 1 cost time: 18.687724113464355
Epoch: 1, Steps: 1035 | Train Loss: 0.3015036 Vali Loss: 0.4309428 Test Loss: 0.3386623
Validation loss decreased (inf --> 0.430943).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3211803
	speed: 0.1111s/iter; left time: 1023.5493s
	iters: 200, epoch: 2 | loss: 0.2936934
	speed: 0.0164s/iter; left time: 149.1137s
	iters: 300, epoch: 2 | loss: 0.4258977
	speed: 0.0174s/iter; left time: 156.8501s
	iters: 400, epoch: 2 | loss: 0.3321874
	speed: 0.0173s/iter; left time: 153.9975s
	iters: 500, epoch: 2 | loss: 0.2720395
	speed: 0.0169s/iter; left time: 148.9478s
	iters: 600, epoch: 2 | loss: 0.3551145
	speed: 0.0177s/iter; left time: 154.6293s
	iters: 700, epoch: 2 | loss: 0.2345040
	speed: 0.0176s/iter; left time: 152.0083s
	iters: 800, epoch: 2 | loss: 0.2780680
	speed: 0.0179s/iter; left time: 152.5463s
	iters: 900, epoch: 2 | loss: 0.2105229
	speed: 0.0176s/iter; left time: 147.9702s
	iters: 1000, epoch: 2 | loss: 0.2047852
	speed: 0.0169s/iter; left time: 140.6957s
Epoch: 2 cost time: 18.591437578201294
Epoch: 2, Steps: 1035 | Train Loss: 0.2711636 Vali Loss: 0.4608363 Test Loss: 0.3446060
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2283315
	speed: 0.1180s/iter; left time: 965.0005s
	iters: 200, epoch: 3 | loss: 0.1883420
	speed: 0.0159s/iter; left time: 128.2692s
	iters: 300, epoch: 3 | loss: 0.2557367
	speed: 0.0171s/iter; left time: 136.7121s
	iters: 400, epoch: 3 | loss: 0.2305697
	speed: 0.0175s/iter; left time: 137.6538s
	iters: 500, epoch: 3 | loss: 0.1949849
	speed: 0.0176s/iter; left time: 136.8739s
	iters: 600, epoch: 3 | loss: 0.3569328
	speed: 0.0184s/iter; left time: 141.0852s
	iters: 700, epoch: 3 | loss: 0.2024998
	speed: 0.0172s/iter; left time: 130.3102s
	iters: 800, epoch: 3 | loss: 0.2284406
	speed: 0.0155s/iter; left time: 115.9580s
	iters: 900, epoch: 3 | loss: 0.2223201
	speed: 0.0171s/iter; left time: 126.2920s
	iters: 1000, epoch: 3 | loss: 0.1342623
	speed: 0.0171s/iter; left time: 124.6815s
Epoch: 3 cost time: 18.471599102020264
Epoch: 3, Steps: 1035 | Train Loss: 0.2560350 Vali Loss: 0.4132087 Test Loss: 0.3205723
Validation loss decreased (0.430943 --> 0.413209).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2167482
	speed: 0.1053s/iter; left time: 752.2619s
	iters: 200, epoch: 4 | loss: 0.3439801
	speed: 0.0174s/iter; left time: 122.4677s
	iters: 300, epoch: 4 | loss: 0.4224112
	speed: 0.0180s/iter; left time: 124.7326s
	iters: 400, epoch: 4 | loss: 0.3743496
	speed: 0.0174s/iter; left time: 119.2012s
	iters: 500, epoch: 4 | loss: 0.2479507
	speed: 0.0154s/iter; left time: 104.1230s
	iters: 600, epoch: 4 | loss: 0.2463961
	speed: 0.0158s/iter; left time: 104.9300s
	iters: 700, epoch: 4 | loss: 0.2777888
	speed: 0.0163s/iter; left time: 107.0224s
	iters: 800, epoch: 4 | loss: 0.1927606
	speed: 0.0156s/iter; left time: 100.7491s
	iters: 900, epoch: 4 | loss: 0.2466411
	speed: 0.0172s/iter; left time: 109.1274s
	iters: 1000, epoch: 4 | loss: 0.2495195
	speed: 0.0169s/iter; left time: 105.6562s
Epoch: 4 cost time: 18.041060209274292
Epoch: 4, Steps: 1035 | Train Loss: 0.2486429 Vali Loss: 0.4204675 Test Loss: 0.3122548
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2384822
	speed: 0.1123s/iter; left time: 686.2462s
	iters: 200, epoch: 5 | loss: 0.2332472
	speed: 0.0158s/iter; left time: 94.9911s
	iters: 300, epoch: 5 | loss: 0.2604343
	speed: 0.0175s/iter; left time: 103.6973s
	iters: 400, epoch: 5 | loss: 0.1863473
	speed: 0.0173s/iter; left time: 100.5389s
	iters: 500, epoch: 5 | loss: 0.2134064
	speed: 0.0179s/iter; left time: 102.2514s
	iters: 600, epoch: 5 | loss: 0.2664948
	speed: 0.0166s/iter; left time: 93.3920s
	iters: 700, epoch: 5 | loss: 0.1676016
	speed: 0.0163s/iter; left time: 90.0166s
	iters: 800, epoch: 5 | loss: 0.4724755
	speed: 0.0170s/iter; left time: 92.0200s
	iters: 900, epoch: 5 | loss: 0.2331273
	speed: 0.0168s/iter; left time: 89.4302s
	iters: 1000, epoch: 5 | loss: 0.4049942
	speed: 0.0169s/iter; left time: 87.8435s
Epoch: 5 cost time: 18.3954176902771
Epoch: 5, Steps: 1035 | Train Loss: 0.2453297 Vali Loss: 0.4081320 Test Loss: 0.3128939
Validation loss decreased (0.413209 --> 0.408132).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2023510
	speed: 0.1108s/iter; left time: 562.6397s
	iters: 200, epoch: 6 | loss: 0.2810680
	speed: 0.0166s/iter; left time: 82.8138s
	iters: 300, epoch: 6 | loss: 0.1760305
	speed: 0.0170s/iter; left time: 83.0705s
	iters: 400, epoch: 6 | loss: 0.1831586
	speed: 0.0173s/iter; left time: 82.7504s
	iters: 500, epoch: 6 | loss: 0.1693707
	speed: 0.0169s/iter; left time: 79.1018s
	iters: 600, epoch: 6 | loss: 0.2383123
	speed: 0.0165s/iter; left time: 75.5307s
	iters: 700, epoch: 6 | loss: 0.2573123
	speed: 0.0179s/iter; left time: 80.2838s
	iters: 800, epoch: 6 | loss: 0.2800087
	speed: 0.0179s/iter; left time: 78.3736s
	iters: 900, epoch: 6 | loss: 0.1423751
	speed: 0.0174s/iter; left time: 74.5539s
	iters: 1000, epoch: 6 | loss: 0.3262757
	speed: 0.0173s/iter; left time: 72.1198s
Epoch: 6 cost time: 18.519174098968506
Epoch: 6, Steps: 1035 | Train Loss: 0.2434164 Vali Loss: 0.4042112 Test Loss: 0.3099107
Validation loss decreased (0.408132 --> 0.404211).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2428440
	speed: 0.1142s/iter; left time: 461.6199s
	iters: 200, epoch: 7 | loss: 0.3123351
	speed: 0.0171s/iter; left time: 67.3728s
	iters: 300, epoch: 7 | loss: 0.3169335
	speed: 0.0168s/iter; left time: 64.4214s
	iters: 400, epoch: 7 | loss: 0.2343983
	speed: 0.0167s/iter; left time: 62.5242s
	iters: 500, epoch: 7 | loss: 0.1552091
	speed: 0.0167s/iter; left time: 60.6933s
	iters: 600, epoch: 7 | loss: 0.1945955
	speed: 0.0166s/iter; left time: 58.7940s
	iters: 700, epoch: 7 | loss: 0.2596254
	speed: 0.0169s/iter; left time: 58.1818s
	iters: 800, epoch: 7 | loss: 0.1841677
	speed: 0.0181s/iter; left time: 60.3061s
	iters: 900, epoch: 7 | loss: 0.2827886
	speed: 0.0174s/iter; left time: 56.4964s
	iters: 1000, epoch: 7 | loss: 0.1719937
	speed: 0.0168s/iter; left time: 52.8582s
Epoch: 7 cost time: 18.410649061203003
Epoch: 7, Steps: 1035 | Train Loss: 0.2418448 Vali Loss: 0.4008921 Test Loss: 0.3087578
Validation loss decreased (0.404211 --> 0.400892).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1934632
	speed: 0.1181s/iter; left time: 354.9176s
	iters: 200, epoch: 8 | loss: 0.3122525
	speed: 0.0187s/iter; left time: 54.2980s
	iters: 300, epoch: 8 | loss: 0.2400942
	speed: 0.0178s/iter; left time: 50.0370s
	iters: 400, epoch: 8 | loss: 0.2963029
	speed: 0.0175s/iter; left time: 47.3507s
	iters: 500, epoch: 8 | loss: 0.2601070
	speed: 0.0166s/iter; left time: 43.1795s
	iters: 600, epoch: 8 | loss: 0.1955909
	speed: 0.0181s/iter; left time: 45.3613s
	iters: 700, epoch: 8 | loss: 0.2183569
	speed: 0.0168s/iter; left time: 40.4118s
	iters: 800, epoch: 8 | loss: 0.2526209
	speed: 0.0175s/iter; left time: 40.2861s
	iters: 900, epoch: 8 | loss: 0.2288220
	speed: 0.0175s/iter; left time: 38.5239s
	iters: 1000, epoch: 8 | loss: 0.1932959
	speed: 0.0168s/iter; left time: 35.4722s
Epoch: 8 cost time: 18.838216543197632
Epoch: 8, Steps: 1035 | Train Loss: 0.2412399 Vali Loss: 0.4013903 Test Loss: 0.3086005
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2442832
	speed: 0.1204s/iter; left time: 237.2825s
	iters: 200, epoch: 9 | loss: 0.3002169
	speed: 0.0164s/iter; left time: 30.6624s
	iters: 300, epoch: 9 | loss: 0.2790724
	speed: 0.0169s/iter; left time: 29.8812s
	iters: 400, epoch: 9 | loss: 0.1607363
	speed: 0.0173s/iter; left time: 28.8264s
	iters: 500, epoch: 9 | loss: 0.2415267
	speed: 0.0169s/iter; left time: 26.6220s
	iters: 600, epoch: 9 | loss: 0.2000603
	speed: 0.0169s/iter; left time: 24.9242s
	iters: 700, epoch: 9 | loss: 0.2244315
	speed: 0.0172s/iter; left time: 23.6338s
	iters: 800, epoch: 9 | loss: 0.1899875
	speed: 0.0175s/iter; left time: 22.2716s
	iters: 900, epoch: 9 | loss: 0.2935869
	speed: 0.0186s/iter; left time: 21.8061s
	iters: 1000, epoch: 9 | loss: 0.2144825
	speed: 0.0170s/iter; left time: 18.2242s
Epoch: 9 cost time: 18.824264764785767
Epoch: 9, Steps: 1035 | Train Loss: 0.2412299 Vali Loss: 0.4013840 Test Loss: 0.3086054
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2847902
	speed: 0.1136s/iter; left time: 106.3661s
	iters: 200, epoch: 10 | loss: 0.4211113
	speed: 0.0189s/iter; left time: 15.7620s
	iters: 300, epoch: 10 | loss: 0.2163994
	speed: 0.0160s/iter; left time: 11.7632s
	iters: 400, epoch: 10 | loss: 0.2177093
	speed: 0.0167s/iter; left time: 10.5960s
	iters: 500, epoch: 10 | loss: 0.2464620
	speed: 0.0169s/iter; left time: 9.0685s
	iters: 600, epoch: 10 | loss: 0.1658285
	speed: 0.0168s/iter; left time: 7.3059s
	iters: 700, epoch: 10 | loss: 0.2297809
	speed: 0.0181s/iter; left time: 6.0716s
	iters: 800, epoch: 10 | loss: 0.2042191
	speed: 0.0174s/iter; left time: 4.1150s
	iters: 900, epoch: 10 | loss: 0.3722190
	speed: 0.0177s/iter; left time: 2.4022s
	iters: 1000, epoch: 10 | loss: 0.2919848
	speed: 0.0169s/iter; left time: 0.6101s
Epoch: 10 cost time: 18.7294180393219
Epoch: 10, Steps: 1035 | Train Loss: 0.2409257 Vali Loss: 0.4013255 Test Loss: 0.3085634
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_336_24_RLinear_ETTh1_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2857
mse:0.3090703785419464, mae:0.35586342215538025
