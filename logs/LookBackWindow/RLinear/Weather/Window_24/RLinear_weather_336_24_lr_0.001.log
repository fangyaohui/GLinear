Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='/spo/NewbornTime/tahir098/SVF/data/Extra/checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='RLinear', model_id='weather_336_24', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=24, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_24_RLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36528
val 5247
test 10516
	iters: 100, epoch: 1 | loss: 0.5659190
	speed: 0.0328s/iter; left time: 745.2549s
	iters: 200, epoch: 1 | loss: 0.4562216
	speed: 0.0262s/iter; left time: 592.2958s
	iters: 300, epoch: 1 | loss: 0.9091425
	speed: 0.0253s/iter; left time: 570.0174s
	iters: 400, epoch: 1 | loss: 0.1604452
	speed: 0.0257s/iter; left time: 575.8448s
	iters: 500, epoch: 1 | loss: 0.1162269
	speed: 0.0260s/iter; left time: 580.1465s
	iters: 600, epoch: 1 | loss: 0.2020105
	speed: 0.0251s/iter; left time: 558.8019s
	iters: 700, epoch: 1 | loss: 0.1101546
	speed: 0.0252s/iter; left time: 558.4788s
	iters: 800, epoch: 1 | loss: 0.1355882
	speed: 0.0258s/iter; left time: 569.1682s
	iters: 900, epoch: 1 | loss: 0.1955011
	speed: 0.0265s/iter; left time: 581.3841s
	iters: 1000, epoch: 1 | loss: 0.4151718
	speed: 0.0261s/iter; left time: 569.0953s
	iters: 1100, epoch: 1 | loss: 0.1583460
	speed: 0.0274s/iter; left time: 595.9567s
	iters: 1200, epoch: 1 | loss: 0.4214920
	speed: 0.0276s/iter; left time: 596.5923s
	iters: 1300, epoch: 1 | loss: 0.0773415
	speed: 0.0260s/iter; left time: 559.3045s
	iters: 1400, epoch: 1 | loss: 0.3197060
	speed: 0.0260s/iter; left time: 557.5046s
	iters: 1500, epoch: 1 | loss: 0.2214309
	speed: 0.0258s/iter; left time: 550.0775s
	iters: 1600, epoch: 1 | loss: 0.1994470
	speed: 0.0256s/iter; left time: 543.3862s
	iters: 1700, epoch: 1 | loss: 0.3013555
	speed: 0.0262s/iter; left time: 552.8772s
	iters: 1800, epoch: 1 | loss: 0.1683135
	speed: 0.0260s/iter; left time: 546.9468s
	iters: 1900, epoch: 1 | loss: 0.2107890
	speed: 0.0253s/iter; left time: 530.1877s
	iters: 2000, epoch: 1 | loss: 0.5740870
	speed: 0.0266s/iter; left time: 555.0299s
	iters: 2100, epoch: 1 | loss: 0.1214925
	speed: 0.0255s/iter; left time: 527.6629s
	iters: 2200, epoch: 1 | loss: 0.1639312
	speed: 0.0261s/iter; left time: 538.9732s
Epoch: 1 cost time: 60.22525453567505
Epoch: 1, Steps: 2283 | Train Loss: 0.3619729 Vali Loss: 0.2816202 Test Loss: 0.0952907
Validation loss decreased (inf --> 0.281620).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6295561
	speed: 0.1619s/iter; left time: 3309.5626s
	iters: 200, epoch: 2 | loss: 0.8618457
	speed: 0.0272s/iter; left time: 552.5031s
	iters: 300, epoch: 2 | loss: 0.7327444
	speed: 0.0264s/iter; left time: 534.7055s
	iters: 400, epoch: 2 | loss: 0.1791061
	speed: 0.0266s/iter; left time: 536.9083s
	iters: 500, epoch: 2 | loss: 0.1463255
	speed: 0.0250s/iter; left time: 501.6757s
	iters: 600, epoch: 2 | loss: 0.7570345
	speed: 0.0255s/iter; left time: 509.4979s
	iters: 700, epoch: 2 | loss: 0.1385999
	speed: 0.0254s/iter; left time: 504.3521s
	iters: 800, epoch: 2 | loss: 0.1030703
	speed: 0.0280s/iter; left time: 551.9767s
	iters: 900, epoch: 2 | loss: 0.1463537
	speed: 0.0261s/iter; left time: 513.5425s
	iters: 1000, epoch: 2 | loss: 0.2321405
	speed: 0.0265s/iter; left time: 518.4538s
	iters: 1100, epoch: 2 | loss: 0.4245284
	speed: 0.0252s/iter; left time: 490.4680s
	iters: 1200, epoch: 2 | loss: 0.1838721
	speed: 0.0253s/iter; left time: 489.9006s
	iters: 1300, epoch: 2 | loss: 0.4574887
	speed: 0.0249s/iter; left time: 479.4181s
	iters: 1400, epoch: 2 | loss: 0.3239638
	speed: 0.0264s/iter; left time: 505.7522s
	iters: 1500, epoch: 2 | loss: 0.5313337
	speed: 0.0246s/iter; left time: 467.8061s
	iters: 1600, epoch: 2 | loss: 6.1316576
	speed: 0.0274s/iter; left time: 519.0970s
	iters: 1700, epoch: 2 | loss: 0.3134615
	speed: 0.0250s/iter; left time: 470.3188s
	iters: 1800, epoch: 2 | loss: 0.2879974
	speed: 0.0258s/iter; left time: 483.3680s
	iters: 1900, epoch: 2 | loss: 0.5527216
	speed: 0.0264s/iter; left time: 492.8267s
	iters: 2000, epoch: 2 | loss: 1.1031265
	speed: 0.0272s/iter; left time: 504.6605s
	iters: 2100, epoch: 2 | loss: 0.5818503
	speed: 0.0251s/iter; left time: 462.8233s
	iters: 2200, epoch: 2 | loss: 0.1417386
	speed: 0.0255s/iter; left time: 468.6334s
Epoch: 2 cost time: 60.139344692230225
Epoch: 2, Steps: 2283 | Train Loss: 0.3854705 Vali Loss: 0.2713186 Test Loss: 0.0937284
Validation loss decreased (0.281620 --> 0.271319).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2346860
	speed: 0.1671s/iter; left time: 3034.9148s
	iters: 200, epoch: 3 | loss: 0.2622895
	speed: 0.0262s/iter; left time: 472.9170s
	iters: 300, epoch: 3 | loss: 0.4430222
	speed: 0.0246s/iter; left time: 442.1463s
	iters: 400, epoch: 3 | loss: 0.1608473
	speed: 0.0250s/iter; left time: 447.3466s
	iters: 500, epoch: 3 | loss: 0.1821650
	speed: 0.0279s/iter; left time: 496.2915s
	iters: 600, epoch: 3 | loss: 0.2570547
	speed: 0.0244s/iter; left time: 430.9870s
	iters: 700, epoch: 3 | loss: 0.2586777
	speed: 0.0248s/iter; left time: 435.7237s
	iters: 800, epoch: 3 | loss: 0.1407463
	speed: 0.0258s/iter; left time: 450.3050s
	iters: 900, epoch: 3 | loss: 0.1519805
	speed: 0.0256s/iter; left time: 445.1957s
	iters: 1000, epoch: 3 | loss: 0.1352157
	speed: 0.0272s/iter; left time: 468.9438s
	iters: 1100, epoch: 3 | loss: 0.1795662
	speed: 0.0254s/iter; left time: 436.3541s
	iters: 1200, epoch: 3 | loss: 0.2027851
	speed: 0.0261s/iter; left time: 444.6896s
	iters: 1300, epoch: 3 | loss: 0.3002428
	speed: 0.0264s/iter; left time: 447.1818s
	iters: 1400, epoch: 3 | loss: 0.3810685
	speed: 0.0255s/iter; left time: 430.3818s
	iters: 1500, epoch: 3 | loss: 0.1506940
	speed: 0.0251s/iter; left time: 421.0926s
	iters: 1600, epoch: 3 | loss: 0.2262983
	speed: 0.0280s/iter; left time: 466.6441s
	iters: 1700, epoch: 3 | loss: 1.4227451
	speed: 0.0254s/iter; left time: 420.2999s
	iters: 1800, epoch: 3 | loss: 0.5078807
	speed: 0.0247s/iter; left time: 407.4500s
	iters: 1900, epoch: 3 | loss: 0.1475459
	speed: 0.0282s/iter; left time: 460.6949s
	iters: 2000, epoch: 3 | loss: 0.2702489
	speed: 0.0255s/iter; left time: 414.2103s
	iters: 2100, epoch: 3 | loss: 0.3030419
	speed: 0.0254s/iter; left time: 410.1095s
	iters: 2200, epoch: 3 | loss: 0.2840926
	speed: 0.0263s/iter; left time: 423.0451s
Epoch: 3 cost time: 60.04152154922485
Epoch: 3, Steps: 2283 | Train Loss: 0.3339294 Vali Loss: 0.2668478 Test Loss: 0.0908126
Validation loss decreased (0.271319 --> 0.266848).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3327257
	speed: 0.1619s/iter; left time: 2571.4628s
	iters: 200, epoch: 4 | loss: 0.2274179
	speed: 0.0258s/iter; left time: 407.6045s
	iters: 300, epoch: 4 | loss: 0.2488939
	speed: 0.0253s/iter; left time: 396.1802s
	iters: 400, epoch: 4 | loss: 0.2385877
	speed: 0.0276s/iter; left time: 430.5243s
	iters: 500, epoch: 4 | loss: 0.2090176
	speed: 0.0260s/iter; left time: 403.0091s
	iters: 600, epoch: 4 | loss: 0.1369345
	speed: 0.0249s/iter; left time: 382.4925s
	iters: 700, epoch: 4 | loss: 0.1741287
	speed: 0.0252s/iter; left time: 385.5953s
	iters: 800, epoch: 4 | loss: 1.0614552
	speed: 0.0270s/iter; left time: 409.9979s
	iters: 900, epoch: 4 | loss: 0.4036808
	speed: 0.0262s/iter; left time: 394.8217s
	iters: 1000, epoch: 4 | loss: 0.6793784
	speed: 0.0250s/iter; left time: 374.8345s
	iters: 1100, epoch: 4 | loss: 0.1178233
	speed: 0.0268s/iter; left time: 398.5576s
	iters: 1200, epoch: 4 | loss: 1.4427474
	speed: 0.0263s/iter; left time: 389.0329s
	iters: 1300, epoch: 4 | loss: 0.3207680
	speed: 0.0276s/iter; left time: 405.5790s
	iters: 1400, epoch: 4 | loss: 0.1594689
	speed: 0.0254s/iter; left time: 370.9066s
	iters: 1500, epoch: 4 | loss: 0.1489912
	speed: 0.0254s/iter; left time: 367.8481s
	iters: 1600, epoch: 4 | loss: 0.1957218
	speed: 0.0256s/iter; left time: 367.5856s
	iters: 1700, epoch: 4 | loss: 0.1862888
	speed: 0.0267s/iter; left time: 380.6453s
	iters: 1800, epoch: 4 | loss: 0.0990842
	speed: 0.0258s/iter; left time: 366.3656s
	iters: 1900, epoch: 4 | loss: 0.1606691
	speed: 0.0251s/iter; left time: 354.0466s
	iters: 2000, epoch: 4 | loss: 0.2602537
	speed: 0.0272s/iter; left time: 380.8007s
	iters: 2100, epoch: 4 | loss: 0.1297804
	speed: 0.0275s/iter; left time: 381.4815s
	iters: 2200, epoch: 4 | loss: 0.2941197
	speed: 0.0255s/iter; left time: 351.8347s
Epoch: 4 cost time: 60.46961045265198
Epoch: 4, Steps: 2283 | Train Loss: 0.3172067 Vali Loss: 0.2572905 Test Loss: 0.0904569
Validation loss decreased (0.266848 --> 0.257291).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2493702
	speed: 0.1685s/iter; left time: 2291.3221s
	iters: 200, epoch: 5 | loss: 0.1310032
	speed: 0.0274s/iter; left time: 370.3573s
	iters: 300, epoch: 5 | loss: 0.2551489
	speed: 0.0258s/iter; left time: 345.1291s
	iters: 400, epoch: 5 | loss: 0.3251509
	speed: 0.0259s/iter; left time: 344.1250s
	iters: 500, epoch: 5 | loss: 1.3670697
	speed: 0.0272s/iter; left time: 359.1132s
	iters: 600, epoch: 5 | loss: 0.1754337
	speed: 0.0247s/iter; left time: 323.8724s
	iters: 700, epoch: 5 | loss: 0.1567497
	speed: 0.0264s/iter; left time: 342.6860s
	iters: 800, epoch: 5 | loss: 0.3965958
	speed: 0.0259s/iter; left time: 333.8286s
	iters: 900, epoch: 5 | loss: 0.3033976
	speed: 0.0267s/iter; left time: 341.6174s
	iters: 1000, epoch: 5 | loss: 0.1351714
	speed: 0.0252s/iter; left time: 319.4461s
	iters: 1100, epoch: 5 | loss: 0.1264155
	speed: 0.0257s/iter; left time: 323.4127s
	iters: 1200, epoch: 5 | loss: 0.1303381
	speed: 0.0259s/iter; left time: 324.0606s
	iters: 1300, epoch: 5 | loss: 0.2328500
	speed: 0.0271s/iter; left time: 336.0052s
	iters: 1400, epoch: 5 | loss: 0.1639674
	speed: 0.0257s/iter; left time: 315.7534s
	iters: 1500, epoch: 5 | loss: 0.2308440
	speed: 0.0263s/iter; left time: 320.3006s
	iters: 1600, epoch: 5 | loss: 1.7557015
	speed: 0.0268s/iter; left time: 323.8584s
	iters: 1700, epoch: 5 | loss: 0.1132728
	speed: 0.0246s/iter; left time: 295.3668s
	iters: 1800, epoch: 5 | loss: 0.1370637
	speed: 0.0255s/iter; left time: 303.6156s
	iters: 1900, epoch: 5 | loss: 0.1402940
	speed: 0.0253s/iter; left time: 298.0458s
	iters: 2000, epoch: 5 | loss: 0.3006935
	speed: 0.0269s/iter; left time: 315.1171s
	iters: 2100, epoch: 5 | loss: 0.2148461
	speed: 0.0254s/iter; left time: 295.1724s
	iters: 2200, epoch: 5 | loss: 0.2869953
	speed: 0.0265s/iter; left time: 304.4121s
Epoch: 5 cost time: 60.405486822128296
Epoch: 5, Steps: 2283 | Train Loss: 0.3084496 Vali Loss: 0.2598835 Test Loss: 0.0894813
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1594068
	speed: 0.1642s/iter; left time: 1858.2935s
	iters: 200, epoch: 6 | loss: 1.5728410
	speed: 0.0276s/iter; left time: 309.4392s
	iters: 300, epoch: 6 | loss: 0.1173545
	speed: 0.0277s/iter; left time: 307.4143s
	iters: 400, epoch: 6 | loss: 0.1021190
	speed: 0.0260s/iter; left time: 286.5437s
	iters: 500, epoch: 6 | loss: 0.2008162
	speed: 0.0235s/iter; left time: 256.9559s
	iters: 600, epoch: 6 | loss: 0.1533820
	speed: 0.0253s/iter; left time: 273.5489s
	iters: 700, epoch: 6 | loss: 0.1034465
	speed: 0.0255s/iter; left time: 272.8337s
	iters: 800, epoch: 6 | loss: 0.1338392
	speed: 0.0251s/iter; left time: 266.0361s
	iters: 900, epoch: 6 | loss: 0.1250056
	speed: 0.0249s/iter; left time: 262.2670s
	iters: 1000, epoch: 6 | loss: 0.6810418
	speed: 0.0262s/iter; left time: 272.8373s
	iters: 1100, epoch: 6 | loss: 0.1461323
	speed: 0.0247s/iter; left time: 254.5815s
	iters: 1200, epoch: 6 | loss: 0.2098250
	speed: 0.0251s/iter; left time: 256.0263s
	iters: 1300, epoch: 6 | loss: 0.1470329
	speed: 0.0264s/iter; left time: 267.0825s
	iters: 1400, epoch: 6 | loss: 0.1947433
	speed: 0.0260s/iter; left time: 260.5259s
	iters: 1500, epoch: 6 | loss: 0.1109242
	speed: 0.0263s/iter; left time: 260.8717s
	iters: 1600, epoch: 6 | loss: 0.5590045
	speed: 0.0264s/iter; left time: 259.2364s
	iters: 1700, epoch: 6 | loss: 0.3774500
	speed: 0.0259s/iter; left time: 251.1712s
	iters: 1800, epoch: 6 | loss: 0.2070525
	speed: 0.0255s/iter; left time: 245.5655s
	iters: 1900, epoch: 6 | loss: 0.1310078
	speed: 0.0249s/iter; left time: 237.0804s
	iters: 2000, epoch: 6 | loss: 0.0719664
	speed: 0.0259s/iter; left time: 243.4738s
	iters: 2100, epoch: 6 | loss: 0.2442617
	speed: 0.0265s/iter; left time: 246.4553s
	iters: 2200, epoch: 6 | loss: 0.1148762
	speed: 0.0285s/iter; left time: 262.4894s
Epoch: 6 cost time: 59.985177993774414
Epoch: 6, Steps: 2283 | Train Loss: 0.3080802 Vali Loss: 0.2587029 Test Loss: 0.0894198
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1446219
	speed: 0.1629s/iter; left time: 1471.4474s
	iters: 200, epoch: 7 | loss: 0.2061205
	speed: 0.0259s/iter; left time: 231.6507s
	iters: 300, epoch: 7 | loss: 0.1163106
	speed: 0.0265s/iter; left time: 234.0069s
	iters: 400, epoch: 7 | loss: 0.1714347
	speed: 0.0254s/iter; left time: 221.4985s
	iters: 500, epoch: 7 | loss: 0.2139362
	speed: 0.0243s/iter; left time: 210.0266s
	iters: 600, epoch: 7 | loss: 0.2088384
	speed: 0.0264s/iter; left time: 224.9382s
	iters: 700, epoch: 7 | loss: 0.0966806
	speed: 0.0255s/iter; left time: 214.8337s
	iters: 800, epoch: 7 | loss: 0.1910644
	speed: 0.0256s/iter; left time: 213.2775s
	iters: 900, epoch: 7 | loss: 0.1261698
	speed: 0.0256s/iter; left time: 210.5686s
	iters: 1000, epoch: 7 | loss: 0.1155166
	speed: 0.0261s/iter; left time: 212.6365s
	iters: 1100, epoch: 7 | loss: 0.1901001
	speed: 0.0258s/iter; left time: 207.5839s
	iters: 1200, epoch: 7 | loss: 0.1274645
	speed: 0.0256s/iter; left time: 202.7114s
	iters: 1300, epoch: 7 | loss: 0.1394107
	speed: 0.0256s/iter; left time: 200.8392s
	iters: 1400, epoch: 7 | loss: 0.1963855
	speed: 0.0255s/iter; left time: 197.2910s
	iters: 1500, epoch: 7 | loss: 0.9898456
	speed: 0.0257s/iter; left time: 196.1758s
	iters: 1600, epoch: 7 | loss: 0.1856329
	speed: 0.0244s/iter; left time: 183.5922s
	iters: 1700, epoch: 7 | loss: 0.1417309
	speed: 0.0268s/iter; left time: 199.5661s
	iters: 1800, epoch: 7 | loss: 0.1589801
	speed: 0.0257s/iter; left time: 188.3503s
	iters: 1900, epoch: 7 | loss: 0.3650543
	speed: 0.0253s/iter; left time: 182.8971s
	iters: 2000, epoch: 7 | loss: 0.6396906
	speed: 0.0254s/iter; left time: 180.8595s
	iters: 2100, epoch: 7 | loss: 0.1832005
	speed: 0.0255s/iter; left time: 179.4988s
	iters: 2200, epoch: 7 | loss: 0.1265610
	speed: 0.0279s/iter; left time: 193.4548s
Epoch: 7 cost time: 59.536508321762085
Epoch: 7, Steps: 2283 | Train Loss: 0.3041046 Vali Loss: 0.2581517 Test Loss: 0.0893106
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_24_RLinear_custom_ftM_sl336_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10516
mse:0.09054401516914368, mae:0.12475963681936264
